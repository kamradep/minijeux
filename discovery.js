/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.3.6 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, https://github.com/requirejs/requirejs/blob/master/LICENSE
 */
var requirejs,require,define;if(function(global,setTimeout){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.6",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){var n;if(e)for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}function eachReverse(e,t){var n;if(e)for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,(function(t,o){!n&&hasProp(e,o)||(!i||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[o]=t:(e[o]||(e[o]={}),mixin(e[o],t,n,i)))})),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),(function(e){t=t[e]})),t}function makeError(e,t,n,i){var o=new Error(t+"\nhttps://requirejs.org/docs/errors.html#"+e);return o.requireType=e,o.requireModules=i,n&&(o.originalError=n),o}if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var o,r,s=defContextName;return isArray(e)||"string"==typeof e||(r=e,isArray(t)?(e=t,t=n,n=i):e=[]),r&&r.context&&(s=r.context),(o=getOwn(contexts,s))||(o=contexts[s]=req.s.newContext(s)),r&&o.configure(r),o.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],(function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}})),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var i=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return i.type=e.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i},req.load=function(e,t,n){var i,o=e&&e.config||{};if(isBrowser)return(i=req.createNode(o,t,n)).setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,o.onNodeCreated&&o.onNodeCreated(i,o,t,n),currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{setTimeout((function(){}),0),importScripts(n),e.completeLoad(t)}catch(i){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,i,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),(function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0})),define=function(e,t,n){var i,o;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,(function(e,n){t.push(n)})),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript())&&(e||(e=i.getAttribute("data-requiremodule")),o=contexts[i.getAttribute("data-requirecontext")]),o?(o.defQueue.push([e,t,n]),o.defQueueMap[e]=!0):globalDefQueue.push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}function newContext(e){var t,n,i,o,r,s={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},a={},l={},c={},u=[],h={},d={},p={},f=1,g=1;function m(e,t,n){var i,o,r,a,l,c,u,h,d,p,f=t&&t.split("/"),g=s.map,m=g&&g["*"];if(e&&(c=(e=e.split("/")).length-1,s.nodeIdCompat&&jsSuffixRegExp.test(e[c])&&(e[c]=e[c].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&f&&(e=f.slice(0,f.length-1).concat(e)),function(e){var t,n;for(t=0;t<e.length;t++)if("."===(n=e[t]))e.splice(t,1),t-=1;else if(".."===n){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}(e),e=e.join("/")),n&&g&&(f||m)){e:for(r=(o=e.split("/")).length;r>0;r-=1){if(l=o.slice(0,r).join("/"),f)for(a=f.length;a>0;a-=1)if((i=getOwn(g,f.slice(0,a).join("/")))&&(i=getOwn(i,l))){u=i,h=r;break e}!d&&m&&getOwn(m,l)&&(d=getOwn(m,l),p=r)}!u&&d&&(u=d,h=p),u&&(o.splice(0,h,u),e=o.join("/"))}return getOwn(s.pkgs,e)||e}function y(e){isBrowser&&each(scripts(),(function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===i.contextName)return t.parentNode.removeChild(t),!0}))}function v(e){var t=getOwn(s.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),i.require.undef(e),i.makeRequire(null,{skipMap:!0})([e]),!0}function b(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function x(e,t,n,o){var r,s,a,l,c=null,u=t?t.name:null,d=e,p=!0,y="";return e||(p=!1,e="_@r"+(f+=1)),c=(l=b(e))[0],e=l[1],c&&(c=m(c,u,o),s=getOwn(h,c)),e&&(c?y=n?e:s&&s.normalize?s.normalize(e,(function(e){return m(e,u,o)})):-1===e.indexOf("!")?m(e,u,o):e:(c=(l=b(y=m(e,u,o)))[0],y=l[1],n=!0,r=i.nameToUrl(y))),{prefix:c,name:y,parentMap:t,unnormalized:!!(a=!c||s||n?"":"_unnormalized"+(g+=1)),url:r,originalName:d,isDefine:p,id:(c?c+"!"+y:y)+a}}function w(e){var t=e.id,n=getOwn(a,t);return n||(n=a[t]=new i.Module(e)),n}function _(e,t,n){var i=e.id,o=getOwn(a,i);!hasProp(h,i)||o&&!o.defineEmitComplete?(o=w(e)).error&&"error"===t?n(o.error):o.on(t,n):"defined"===t&&n(h[i])}function S(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,(function(t){var n=getOwn(a,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))})),i||req.onError(e))}function C(){globalDefQueue.length&&(each(globalDefQueue,(function(e){var t=e[0];"string"==typeof t&&(i.defQueueMap[t]=!0),u.push(e)})),globalDefQueue=[])}function k(e){delete a[e],delete l[e]}function A(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,(function(i,o){var r=i.id,s=getOwn(a,r);!s||e.depMatched[o]||n[r]||(getOwn(t,r)?(e.defineDep(o,h[r]),e.check()):A(s,t,n))})),n[i]=!0)}function M(){var e,n,o=1e3*s.waitSeconds,a=o&&i.startTime+o<(new Date).getTime(),c=[],u=[],h=!1,d=!0;if(!t){if(t=!0,eachProp(l,(function(e){var t=e.map,i=t.id;if(e.enabled&&(t.isDefine||u.push(e),!e.error))if(!e.inited&&a)v(i)?(n=!0,h=!0):(c.push(i),y(i));else if(!e.inited&&e.fetched&&t.isDefine&&(h=!0,!t.prefix))return d=!1})),a&&c.length)return(e=makeError("timeout","Load timeout for modules: "+c,null,c)).contextName=i.contextName,S(e);d&&each(u,(function(e){A(e,{},{})})),a&&!n||!h||!isBrowser&&!isWebWorker||r||(r=setTimeout((function(){r=0,M()}),50)),t=!1}}function T(e){hasProp(h,e[0])||w(x(e[0],null,!0)).init(e[1],e[2])}function E(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function $(e){var t=e.currentTarget||e.srcElement;return E(t,i.onScriptLoad,"load","onreadystatechange"),E(t,i.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function L(){var e;for(C();u.length;){if(null===(e=u.shift())[0])return S(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));T(e)}i.defQueueMap={}}return o={require:function(e){return e.require?e.require:e.require=i.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?h[e.map.id]=e.exports:e.exports=h[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(s.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},(n=function(e){this.events=getOwn(c,e.id)||{},this.map=e,this.shim=getOwn(s.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,(function(e){this.emit("error",e)}))),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,i.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();i.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,(function(){return e.prefix?this.callPlugin():this.load()})))}},load:function(){var e=this.map.url;d[e]||(d[e]=!0,i.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,o=this.depExports,r=this.exports,s=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(s)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=i.execCb(n,s,o,r)}catch(t){e=t}else r=i.execCb(n,s,o,r);if(this.map.isDefine&&void 0===r&&((t=this.module)?r=t.exports:this.usingExports&&(r=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",S(this.error=e)}else r=s;if(this.exports=r,this.map.isDefine&&!this.ignore&&(h[n]=r,req.onResourceLoad)){var a=[];each(this.depMaps,(function(e){a.push(e.normalizedMap||e)})),req.onResourceLoad(i,this.map,a)}k(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(i.defQueueMap,n)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,n=x(e.prefix);this.depMaps.push(n),_(n,"defined",bind(this,(function(n){var o,r,l,c=getOwn(p,this.map.id),u=this.map.name,h=this.map.parentMap?this.map.parentMap.name:null,d=i.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(u=n.normalize(u,(function(e){return m(e,h,!0)}))||""),_(r=x(e.prefix+"!"+u,this.map.parentMap,!0),"defined",bind(this,(function(e){this.map.normalizedMap=r,this.init([],(function(){return e}),null,{enabled:!0,ignore:!0})}))),void((l=getOwn(a,r.id))&&(this.depMaps.push(r),this.events.error&&l.on("error",bind(this,(function(e){this.emit("error",e)}))),l.enable()))):c?(this.map.url=i.nameToUrl(c),void this.load()):((o=bind(this,(function(e){this.init([],(function(){return e}),null,{enabled:!0})}))).error=bind(this,(function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(a,(function(e){0===e.map.id.indexOf(t+"_unnormalized")&&k(e.map.id)})),S(e)})),o.fromText=bind(this,(function(n,r){var a=e.name,l=x(a),c=useInteractive;r&&(n=r),c&&(useInteractive=!1),w(l),hasProp(s.config,t)&&(s.config[a]=s.config[t]);try{req.exec(n)}catch(e){return S(makeError("fromtexteval","fromText eval for "+t+" failed: "+e,e,[t]))}c&&(useInteractive=!0),this.depMaps.push(l),i.completeLoad(a),d([a],o)})),void n.load(e.name,d,o,s))}))),i.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){l[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,(function(e,t){var n,r,s;if("string"==typeof e){if(e=x(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,s=getOwn(o,e.id))return void(this.depExports[t]=s(this));this.depCount+=1,_(e,"defined",bind(this,(function(e){this.undefed||(this.defineDep(t,e),this.check())}))),this.errback?_(e,"error",bind(this,this.errback)):this.events.error&&_(e,"error",bind(this,(function(e){this.emit("error",e)})))}n=e.id,r=a[n],hasProp(o,n)||!r||r.enabled||i.enable(e,this)}))),eachProp(this.pluginMaps,bind(this,(function(e){var t=getOwn(a,e.id);t&&!t.enabled&&i.enable(e,this)}))),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],(function(e){e(t)})),"error"===e&&delete this.events[e]}},i={config:s,contextName:e,registry:a,defined:h,urlFetched:d,defQueue:u,defQueueMap:{},Module:n,makeModuleMap:x,nextTick:req.nextTick,onError:S,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,n){return(-1===n.indexOf("?")?"?":"&")+t}}var n=s.shim,o={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,(function(e,t){o[t]?(s[t]||(s[t]={}),mixin(s[t],e,!0,!0)):s[t]=e})),e.bundles&&eachProp(e.bundles,(function(e,t){each(e,(function(e){e!==t&&(p[e]=t)}))})),e.shim&&(eachProp(e.shim,(function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=i.makeShimExports(e)),n[t]=e})),s.shim=n),e.packages&&each(e.packages,(function(e){var t;t=(e="string"==typeof e?{name:e}:e).name,e.location&&(s.paths[t]=e.location),s.pkgs[t]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")})),eachProp(a,(function(e,t){e.inited||e.map.unnormalized||(e.map=x(t,null,!0))})),(e.deps||e.callback)&&i.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}},makeRequire:function(t,n){function r(s,l,c){var u,d;return n.enableBuildCallback&&l&&isFunction(l)&&(l.__requireJsBuild=!0),"string"==typeof s?isFunction(l)?S(makeError("requireargs","Invalid require call"),c):t&&hasProp(o,s)?o[s](a[t.id]):req.get?req.get(i,s,t,r):(u=x(s,t,!1,!0).id,hasProp(h,u)?h[u]:S(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(L(),i.nextTick((function(){L(),(d=w(x(null,t))).skipMap=n.skipMap,d.init(s,l,c,{enabled:!0}),M()})),r)}return n=n||{},mixin(r,{isBrowser:isBrowser,toUrl:function(e){var n,o=e.lastIndexOf("."),r=e.split("/")[0];return-1!==o&&(!("."===r||".."===r)||o>1)&&(n=e.substring(o,e.length),e=e.substring(0,o)),i.nameToUrl(m(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(h,x(e,t,!1,!0).id)},specified:function(e){return e=x(e,t,!1,!0).id,hasProp(h,e)||hasProp(a,e)}}),t||(r.undef=function(e){C();var n=x(e,t,!0),o=getOwn(a,e);o.undefed=!0,y(e),delete h[e],delete d[n.url],delete c[e],eachReverse(u,(function(t,n){t[0]===e&&u.splice(n,1)})),delete i.defQueueMap[e],o&&(o.events.defined&&(c[e]=o.events),k(e))}),r},enable:function(e){getOwn(a,e.id)&&w(e).enable()},completeLoad:function(e){var t,n,o,r=getOwn(s.shim,e)||{},l=r.exports;for(C();u.length;){if(null===(n=u.shift())[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);T(n)}if(i.defQueueMap={},o=getOwn(a,e),!t&&!hasProp(h,e)&&o&&!o.inited){if(!(!s.enforceDefine||l&&getGlobal(l)))return v(e)?void 0:S(makeError("nodefine","No define call for "+e,null,[e]));T([e,r.deps||[],r.exportsFn])}M()},nameToUrl:function(e,t,n){var o,r,a,l,c,u,h=getOwn(s.pkgs,e);if(h&&(e=h),u=getOwn(p,e))return i.nameToUrl(u,t,n);if(req.jsExtRegExp.test(e))l=e+(t||"");else{for(o=s.paths,a=(r=e.split("/")).length;a>0;a-=1)if(c=getOwn(o,r.slice(0,a).join("/"))){isArray(c)&&(c=c[0]),r.splice(0,a,c);break}l=r.join("/"),l=("/"===(l+=t||(/^data\:|^blob\:|\?/.test(l)||n?"":".js")).charAt(0)||l.match(/^[\w\+\.\-]+:/)?"":s.baseUrl)+l}return s.urlArgs&&!/^blob\:/.test(l)?l+s.urlArgs(e,l):l},load:function(e,t){req.load(i,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=$(e);i.completeLoad(t.id)}},onScriptError:function(e){var t=$(e);if(!v(t.id)){var n=[];return eachProp(a,(function(e,i){0!==i.indexOf("_@r")&&each(e.depMaps,(function(e){if(e.id===t.id)return n.push(i),!0}))})),S(makeError("scripterror",'Script error for "'+t.id+(n.length?'", needed by: '+n.join(", "):'"'),e,[t.id]))}}},i.require=i.makeRequire(),i}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState||eachReverse(scripts(),(function(e){if("interactive"===e.readyState)return interactiveScript=e})),interactiveScript}}(this,"undefined"==typeof setTimeout?void 0:setTimeout),void 0===requirejs)var requirejs=function(e){requirejs=e};requirejs({baseUrl:"scripts",paths:{toxilibs:"../toxilibs",toxiworlds:"../toxiworlds",jquery:"../toxilibs/extlibs/jquery-3.6.4"},shim:{"toxilibs/embedded_extlibs/ace/ace":{exports:"ace"}},urlArgs:(e,t)=>"undefined"==typeof window||"file:"!==window.location.protocol&&!window.location.hostname.includes("localhost")||t.startsWith("data:")?"":`?bust=${Date.now()}`});var developmentEnvironment="undefined"!=typeof document&&!document.getElementById("build_version");function requireDevelopment(e,t){developmentEnvironment&&requirejs(e,t)}define("toxilibs/embedded_extlibs/alea",[],(function(){function e(e){let n={};function i(){let e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)}return i.state=function(){return{c:n.c,s0:n.s0,s1:n.s1,s2:n.s2}},i.setState=function({c:e,s0:t,s1:i,s2:o}){n.c=e,n.s0=t,n.s1=i,n.s2=o},i.setSeed=function(e){t(n,String(e))},"object"==typeof e&&"s0"in e?(i.setState(e),i):(t(n,String(e)),i)}function t(e,t){let n=function(){let e=3941471299;function t(t){for(let n=0;n<t.length;n++){e+=t.charCodeAt(n);let i=.02519603282416938*e;e=i>>>0,i=(i-e)*e,e=i>>>0,e+=4294967296*(i-e)}return 2.3283064365386963e-10*(e>>>0)}return t}();e.c=1,e.s0=.8633289230056107-n(t),e.s0<0&&(e.s0+=1),e.s1=.15019597788341343-n(t),e.s1<0&&(e.s1+=1),e.s2=.9176952994894236-n(t),e.s2<0&&(e.s2+=1)}return e.stateFromSeed=function(e){let n={};return t(n,e),n},e})),
/*! Toxilib random
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/random",["./embedded_extlibs/alea"],(function(e){const t="abcdefghijklmnopqrstuvwxyz",n="defghijkmnpqrtuvwxyz",i=`0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ${t}`,o=`${n}23456789`,r=i.length,{stateFromSeed:s}=e;function a(e=10){let t="";for(let n=0;n<e;n++)t+=i[Math.floor(Math.random()*r)];return t}function l(e,t){let n=.1031*e,i=.1031*t;n-=0|n,i-=0|i;let o=n*(i+33.33)+(n+i)*(n+33.33),r=(n+i+o+o)*(n+o);return r-(0|r)}return function c(u){let h=e(u),d=u,p={};function f(e=a()){return d=e,p={},h.setSeed(e),e}function g(){return h.state()}function m(e){h.setState(e)}function y(e,t){return Math.floor(e+(t-e+1)*h())}function v(){return t[y(0,25)]}function b(){return n[y(0,19)]}function x(...e){1===e.length&&(e=e[0]);let t=[],n=0;for(let i=0;i<e.length;i++){n+=e[i][1],t.push(n)}if(0===n)throw new Error("impossible choice !");let i=h()*n;for(let n=0;n<t.length;n++)if(i<t[n])return e[n][0]}let w={};function _(e,t={}){let n,{name:i="default"}=t,o=w[i];if(o){let t=function(e){let t=e.length,n={};for(let i=1;i<=t;i++){let o=e[t-i];n[o]=(n[o]||0)+Math.pow(i,S)}return n}(o),i=function(e,t){let n=[],i=0;for(let n=0;n<t.length;n++)i+=e[t[n]]||0;0===i&&(i=1);let o=i/t.length;for(let i=0;i<t.length;i++){let r=t[i],s=(e[r]||0)-o;n.push([r,Math.max(0,o-s)])}return n}(t,e);n=x(i),o.push(n)}else{n=e[y(0,e.length-1)],w[i]=[n]}return n}let S=-.3;function C(){return h()}return C.reset=f,C.setSeed=f,C.getSeed=function(){return d},C.set2DSeed=function(e,t){let n=Math.floor(e/100),i=Math.floor(t/100);e-=100*n,t-=100*i;let o=`${n}_${i}`;p[o]||(p[o]=s(d+o));let{c:r,s0:a,s1:c,s2:u}=p[o];m({c:r,s0:(a+l(e,t))%1,s1:(c+l(e+207,t))%1,s2:(u+l(e+1567,t))%1})},C.getState=g,C.setState=m,C.generateSeed=a,C.hash=function(e=10){let t="";for(let n=0;n<e;n++)t+=i[y(0,r-1)];return t},C.oneChanceIn=function(e){return h()<1/e},C.around=function(e,t){let n,i,o=2;for(;o>=1;)n=2*h()-1,i=2*h()-1,o=n*n+i*i;return o=Math.sqrt(-2*Math.log(o)/o),e+n*o*t},C.overrideAroundWithEqual=function(){C.around=e=>e},C.between=function(e,t){return e+(t-e)*h()},C.intBetween=y,C.letter=v,C.letters=function(e){let t="";for(let n=0;n<e;n++)t+=v();return t},C.unmistakableLetter=b,C.unmistakableLetters=function(e){let t="";for(let n=0;n<e;n++)t+=b();return t},C.unmistakableHash=function(e=10){let t="";for(let n=0;n<e;n++)t+=o[y(0,o.length-1)];return t},C.shuffleArray=function(e){for(let t=e.length-1;t>0;t--){let n=Math.floor(h()*(t+1)),i=e[t];e[t]=e[n],e[n]=i}},C.pick=function(...e){return 1===e.length&&(e=e[0]),e[y(0,e.length-1)]},C.weightedChoice=x,C.getFastWeightedChooser=function(e){let t=[],n=[],i=0;return e.forEach((([e,o])=>{t.push(e),i+=o,n.push(i)})),function(){let e=h()*i;for(let i=0;i<n.length;i++)if(e<n[i])return t[i]}},C.fairChoice=_,C.fairChoiceInt=function(e,t,n){let i=[];for(let n=e;n<=t;n++)i.push(n);return _(i,n)},C.resetFairChoice=function(e){delete w[e]},C.resetAllFairChoices=function(){w={}},C.createNew=function(e=a()){return c(e)},C.fork=function(){return c(g())},C}(a())})),
/*! Toxilib queue
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/queue",[],(function(){function e({onAdded:t,onRemoved:n,onFinished:o,noWaiting:r}={}){if(this.onAdded=t,this.onRemoved=n,this.onFinished=o,this.elements=[],!r){let t=this;this.waiting=new e({noWaiting:!0,onRemoved:function(e){t.onRemoved&&t.onRemoved(e)},onFinished:function(){i(t)}})}}function t(e,t){return!e.has(t)&&(e.elements.push(t),e.onAdded&&e.onAdded(t),!0)}function n(e,t){let n=e.removingNext();t(n,(function(){e.remove(n),e.handleInParallel(t)}))}function i(e){e.onFinished&&e.finished()&&e.onFinished()}return e.prototype.length=function(){return this.elements.length},e.prototype.empty=function(){return 0===this.elements.length},e.prototype.finished=function(){return this.empty()&&(!this.waiting||this.waiting.empty())},e.prototype.has=function(e){return this.elements.includes(e)||!!this.waiting&&this.waiting.has(e)},e.prototype.add=function(e){return e instanceof Array?void e.forEach((e=>t(this,e))):t(this,e)},e.prototype.remove=function(e){if(this.waiting&&this.waiting.remove(e))return!0;let t=this.elements.indexOf(e);return t>=0&&(this.elements.splice(t,1),this.onRemoved&&this.onRemoved(e),i(this),!0)},e.prototype.next=function(e){return this.empty()?null:e?this.elements.slice(0,e):this.elements[0]},e.prototype.removeNext=function(e){if(this.empty())return null;let t;return e?(t=this.elements.splice(0,e),this.onRemoved&&t.forEach((e=>this.onRemoved(e)))):(t=this.elements.shift(),this.onRemoved&&this.onRemoved(t)),i(this),t},e.prototype.removing=function(e){let t=this.elements.indexOf(e);t>=0&&(this.elements.splice(t,1),this.waiting.add(e))},e.prototype.removingNext=function(e){if(this.empty())return null;let t;if(e){t=this.elements.splice(0,e);for(let e=0;e<t.length;e++)this.waiting.add(t[e]);t.forEach((e=>this.waiting.add(e)))}else t=this.elements.shift(),this.waiting.add(t);return t},e.prototype.handleSync=function(e){for(;!this.empty();)e(this.removeNext())},e.prototype.handleInSerie=function(e){if(this.empty())return;let t=this.removingNext();e(t,(()=>{this.remove(t),this.handleInSerie(e)}))},e.prototype.handleInParallel=function(e){for(;!this.empty();)n(this,e)},e})),
/*! Toxilib event_capabilities_queued
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/event_capabilities_queued",["./random","./queue"],(function(e,t){function n(o,{parent:r,nameSpace:s,onError:a}={}){let l=r||o;r||(!function(e){let t={},i={};e.blockedNameSpaces=i,e.block=function({from:e,to:t}){i[e]=i[e]||[],i[e].push(t)},e.twoWayBlock=function(t,n){e.block({from:t,to:n}),e.block({from:n,to:t})},e.createOrFindEventNameSpace=function(i){return t[i]||(t[i]={},n(t[i],{parent:e,nameSpace:i})),t[i]}}(o),o.listenersFor={},o.emitQueue=[]),o.on=function(e,t){l.listenersFor[e]||(l.listenersFor[e]=[]);let n={origin:i(),nameSpace:s,callback:t};return l.listenersFor[e].push(n),n},o.when=o.on,o.once=function(e,t=()=>{}){return new Promise((n=>{o.on(e,(function i(...r){o.removeListener(e,i),t(...r),n(r)}))}))},o.onceAll=function(e,t=()=>{}){if(Array.isArray(e)){let t={};e.forEach((e=>{t[e]=null})),e=t}let n=Object.keys(e).length,i=0,r={};return new Promise((s=>{function a(){let n=[];for(let t in e)n.push(r[t]);t(...n),s(n)}for(let t in e){let s=e[t];o.once(t,((...e)=>{s&&s(...e),r[t]=e,i+=1,i===n&&a()}))}}))},o.removeListener=function(e,t){let n=l.listenersFor[e];if(n){let e;e="function"==typeof t?function(e,t){for(let n=0;n<e.length;n++)if(e[n]&&e[n].callback===t)return n;return-1}(n,t):function(e,t){for(let n=0;n<e.length;n++)if(e[n]===t)return n;return-1}(n,t),e>=0&&(n[e]=null)}},o.removeAllListenersFor=function(e){l.listenersFor[e]&&(l.listenersFor[e]=[])},o.removeAllListeners=function(){l.listenersFor={}};let{emitQueue:c}=l;function u(e,t,n,i){let o,r=l.blockedNameSpaces[s]||[],a=l.listenersFor[e]||[];for(let s=0;s<a.length;s++){let c=a[s];if(null!==c){if(-1===r.indexOf(c.nameSpace))try{c.callback.stackTraceRecord=n,c.callback.stackTraceRecordFromEmitter=i,c.callback.apply(l,t)}catch(t){h({eventName:e,error:t,listenerOrigin:c.origin,emitOrigin:n})}}else o=!0}if(o)for(let e=a.length-1;e>=0;e--)null===a[e]&&a.splice(e,1)}function h({eventName:e,error:t,listenerOrigin:n,emitOrigin:i}){var o;(function(e,t){let n=`The error displayed below is on event '${e}'.`;t&&(n+=`\n  The faulty listener for '${e}' was attached : \n${t}`),console.warn(n)})((o={eventName:e,error:t,listenerOrigin:n,emitOrigin:i}).eventName,o.listenerOrigin),function(e,t){if(!t||!t.stack)return;let n=t.stack.split("\n").splice(2).join("\n");console.warn(`The emit '${e}' that triggered the error below was called from : \n${n}`)}(o.eventName,o.emitOrigin),a?a(t):console.error(t)}o.emit=function(e,...t){let n=new Error;c.push({emitSync:u,eventName:e,arguments:t,stackTraceRecord:n,stackTraceRecordFromEmitter:o.lastStackTraceRecordFromEmitter}),delete o.lastStackTraceRecordFromEmitter,1===c.length&&function(){for(;c.length>0;){let e=c[0];e.emitSync(e.eventName,e.arguments,e.stackTraceRecord,e.stackTraceRecordFromEmitter),c.shift()}}()},o.enterTestMode=function({seed:n,minDelay:i=0,maxDelay:r=100,keepOrder:s}={}){const a=e.createNew(n);if(console.log("Event test mode with seed : ",a.getSeed()),s)!function({privateRandom:e,minDelay:n,maxDelay:i}){let r=o.emit,s=new t;function a(){s.handleInSerie((function({delay:e,args:t},n){setTimeout((function(){r(...t),n()}),e)}))}o.emit=function(...t){let o=e.intBetween(n,i),r=s.finished();s.add({args:t,delay:o}),r&&a()}}({privateRandom:a,minDelay:i,maxDelay:r});else{let e=o.emit;o.emit=function(...t){let n=a.intBetween(i,r);setTimeout((()=>e(...t)),n)}}},o.emitSync=function(e,...t){console.warn(`Please try to avoid calling emitSync. Here it was called for event '${e}'. Note that emitSync won't have the nice callstacks that classic emit has...`),u(e,t)},o.emitter=function(e,{sync:t,filter:n}={}){let i,r;return t?i=o.emitSync:(i=o.emit,r=new Error),function(...t){if(n)for(let e=0;e<t.length;e++)t[e]=n(t[e]);o.lastStackTraceRecordFromEmitter=r,i.call(o,e,...t)}}}function i(){let e=new Error("fake error");return e.stack?e.stack.split("\n")[3]:void 0}return n})),define("raw_event_bus",["toxilibs/event_capabilities_queued"],(function(e){function t(e){return t.createOrFindEventNameSpace(e)}return e(t,{onError(e){e.toxiTrace=e.toxiTrace||[],e.toxiTrace.unshift("Explorers - raw_event_bus.js - onError"),t.emit("error happened",e)}}),t})),define("draw_loop",[],(function(){return function(e){let t=performance.now();!function n(){let i=performance.now(),o=i-t;t=i,e.emit("time to trigger triggerAnimationFrame",o),e.emit("drawing frame reached",o),requestAnimationFrame(n)}()}})),
/*!
 * jQuery JavaScript Library v3.6.4
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-03-08T15:28Z
 */
function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,(function(e,t){var n=[],i=Object.getPrototypeOf,o=n.slice,r=n.flat?function(e){return n.flat.call(e)}:function(e){return n.concat.apply([],e)},s=n.push,a=n.indexOf,l={},c=l.toString,u=l.hasOwnProperty,h=u.toString,d=h.call(Object),p={},f=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},g=function(e){return null!=e&&e===e.window},m=e.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function v(e,t,n){var i,o,r=(n=n||m).createElement("script");if(r.text=e,t)for(i in y)(o=t[i]||t.getAttribute&&t.getAttribute(i))&&r.setAttribute(i,o);n.head.appendChild(r).parentNode.removeChild(r)}function b(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var x="3.6.4",w=function(e,t){return new w.fn.init(e,t)};function _(e){var t=!!e&&"length"in e&&e.length,n=b(e);return!f(e)&&!g(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}w.fn=w.prototype={jquery:x,constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(w.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,i,o,r,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||f(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)i=e[t],"__proto__"!==t&&s!==i&&(c&&i&&(w.isPlainObject(i)||(o=Array.isArray(i)))?(n=s[t],r=o&&!Array.isArray(n)?[]:o||w.isPlainObject(n)?n:{},o=!1,s[t]=w.extend(c,r,i)):void 0!==i&&(s[t]=i));return s},w.extend({expando:"jQuery"+(x+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==c.call(e))&&(!(t=i(e))||"function"==typeof(n=u.call(t,"constructor")&&t.constructor)&&h.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){v(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,i=0;if(_(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(_(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:a.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,o=e.length;i<n;i++)e[o++]=t[i];return e.length=o,e},grep:function(e,t,n){for(var i=[],o=0,r=e.length,s=!n;o<r;o++)!t(e[o],o)!==s&&i.push(e[o]);return i},map:function(e,t,n){var i,o,s=0,a=[];if(_(e))for(i=e.length;s<i;s++)null!=(o=t(e[s],s,n))&&a.push(o);else for(s in e)null!=(o=t(e[s],s,n))&&a.push(o);return r(a)},guid:1,support:p}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){l["[object "+t+"]"]=t.toLowerCase()}));var S=
/*!
 * Sizzle CSS Selector Engine v2.3.10
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2023-02-14
 */
function(e){var t,n,i,o,r,s,a,l,c,u,h,d,p,f,g,m,y,v,b,x="sizzle"+1*new Date,w=e.document,_=0,S=0,C=le(),k=le(),A=le(),M=le(),T=function(e,t){return e===t&&(h=!0),0},E={}.hasOwnProperty,$=[],L=$.pop,R=$.push,P=$.push,I=$.slice,O=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},D="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",N="(?:\\\\[\\da-fA-F]{1,6}"+F+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",B="\\["+F+"*("+N+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+F+"*\\]",j=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",H=new RegExp(F+"+","g"),W=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),z=new RegExp("^"+F+"*,"+F+"*"),V=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),G=new RegExp(F+"|>"),U=new RegExp(j),q=new RegExp("^"+N+"$"),K={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+j),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+D+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,X=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+F+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},ie=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,oe=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},re=function(){d()},se=xe((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{P.apply($=I.call(w.childNodes),w.childNodes),$[w.childNodes.length].nodeType}catch(e){P={apply:$.length?function(e,t){R.apply(e,I.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function ae(e,t,i,o){var r,a,c,u,h,f,y,v=t&&t.ownerDocument,w=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return i;if(!o&&(d(t),t=t||p,g)){if(11!==w&&(h=Z.exec(e)))if(r=h[1]){if(9===w){if(!(c=t.getElementById(r)))return i;if(c.id===r)return i.push(c),i}else if(v&&(c=v.getElementById(r))&&b(t,c)&&c.id===r)return i.push(c),i}else{if(h[2])return P.apply(i,t.getElementsByTagName(e)),i;if((r=h[3])&&n.getElementsByClassName&&t.getElementsByClassName)return P.apply(i,t.getElementsByClassName(r)),i}if(n.qsa&&!M[e+" "]&&(!m||!m.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(y=e,v=t,1===w&&(G.test(e)||V.test(e))){for((v=ee.test(e)&&ye(t.parentNode)||t)===t&&n.scope||((u=t.getAttribute("id"))?u=u.replace(ie,oe):t.setAttribute("id",u=x)),a=(f=s(e)).length;a--;)f[a]=(u?"#"+u:":scope")+" "+be(f[a]);y=f.join(",")}try{return P.apply(i,v.querySelectorAll(y)),i}catch(t){M(e,!0)}finally{u===x&&t.removeAttribute("id")}}}return l(e.replace(W,"$1"),t,i,o)}function le(){var e=[];return function t(n,o){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=o}}function ce(e){return e[x]=!0,e}function ue(e){var t=p.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function he(e,t){for(var n=e.split("|"),o=n.length;o--;)i.attrHandle[n[o]]=t}function de(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function pe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function fe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ce((function(t){return t=+t,ce((function(n,i){for(var o,r=e([],n.length,t),s=r.length;s--;)n[o=r[s]]&&(n[o]=!(i[o]=n[o]))}))}))}function ye(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=ae.support={},r=ae.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},d=ae.setDocument=function(e){var t,o,s=e?e.ownerDocument||e:w;return s!=p&&9===s.nodeType&&s.documentElement?(f=(p=s).documentElement,g=!r(p),w!=p&&(o=p.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",re,!1):o.attachEvent&&o.attachEvent("onunload",re)),n.scope=ue((function(e){return f.appendChild(e).appendChild(p.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),n.cssHas=ue((function(){try{return p.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),n.attributes=ue((function(e){return e.className="i",!e.getAttribute("className")})),n.getElementsByTagName=ue((function(e){return e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length})),n.getElementsByClassName=Q.test(p.getElementsByClassName),n.getById=ue((function(e){return f.appendChild(e).id=x,!p.getElementsByName||!p.getElementsByName(x).length})),n.getById?(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,i,o,r=t.getElementById(e);if(r){if((n=r.getAttributeNode("id"))&&n.value===e)return[r];for(o=t.getElementsByName(e),i=0;r=o[i++];)if((n=r.getAttributeNode("id"))&&n.value===e)return[r]}return[]}}),i.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},y=[],m=[],(n.qsa=Q.test(p.querySelectorAll))&&(ue((function(e){var t;f.appendChild(e).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+F+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+F+"*(?:value|"+D+")"),e.querySelectorAll("[id~="+x+"-]").length||m.push("~="),(t=p.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||m.push("\\["+F+"*name"+F+"*="+F+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+x+"+*").length||m.push(".#.+[+~]"),e.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ue((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+F+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Q.test(v=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ue((function(e){n.disconnectedMatch=v.call(e,"*"),v.call(e,"[s!='']:x"),y.push("!=",j)})),n.cssHas||m.push(":has"),m=m.length&&new RegExp(m.join("|")),y=y.length&&new RegExp(y.join("|")),t=Q.test(f.compareDocumentPosition),b=t||Q.test(f.contains)?function(e,t){var n=9===e.nodeType&&e.documentElement||e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},T=t?function(e,t){if(e===t)return h=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===i?e==p||e.ownerDocument==w&&b(w,e)?-1:t==p||t.ownerDocument==w&&b(w,t)?1:u?O(u,e)-O(u,t):0:4&i?-1:1)}:function(e,t){if(e===t)return h=!0,0;var n,i=0,o=e.parentNode,r=t.parentNode,s=[e],a=[t];if(!o||!r)return e==p?-1:t==p?1:o?-1:r?1:u?O(u,e)-O(u,t):0;if(o===r)return de(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?de(s[i],a[i]):s[i]==w?-1:a[i]==w?1:0},p):p},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if(d(e),n.matchesSelector&&g&&!M[t+" "]&&(!y||!y.test(t))&&(!m||!m.test(t)))try{var i=v.call(e,t);if(i||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){M(t,!0)}return ae(t,p,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!=p&&d(e),b(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!=p&&d(e);var o=i.attrHandle[t.toLowerCase()],r=o&&E.call(i.attrHandle,t.toLowerCase())?o(e,t,!g):void 0;return void 0!==r?r:n.attributes||!g?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},ae.escape=function(e){return(e+"").replace(ie,oe)},ae.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ae.uniqueSort=function(e){var t,i=[],o=0,r=0;if(h=!n.detectDuplicates,u=!n.sortStable&&e.slice(0),e.sort(T),h){for(;t=e[r++];)t===e[r]&&(o=i.push(r));for(;o--;)e.splice(i[o],1)}return u=null,e},o=ae.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i++];)n+=o(t);return n},i=ae.selectors={cacheLength:50,createPseudo:ce,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&U.test(n)&&(t=s(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=new RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&C(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(i){var o=ae.attr(i,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o.replace(H," ")+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,o){var r="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var c,u,h,d,p,f,g=r!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),v=!l&&!a,b=!1;if(m){if(r){for(;g;){for(d=t;d=d[g];)if(a?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&v){for(b=(p=(c=(u=(h=(d=m)[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]||[])[0]===_&&c[1])&&c[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(b=p=0)||f.pop();)if(1===d.nodeType&&++b&&d===t){u[e]=[_,p,b];break}}else if(v&&(b=p=(c=(u=(h=(d=t)[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]||[])[0]===_&&c[1]),!1===b)for(;(d=++p&&d&&d[g]||(b=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++b||(v&&((u=(h=d[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]=[_,b]),d!==t)););return(b-=o)===i||b%i==0&&b/i>=0}}},PSEUDO:function(e,t){var n,o=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ae.error("unsupported pseudo: "+e);return o[x]?o(t):o.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ce((function(e,n){for(var i,r=o(e,t),s=r.length;s--;)e[i=O(e,r[s])]=!(n[i]=r[s])})):function(e){return o(e,0,n)}):o}},pseudos:{not:ce((function(e){var t=[],n=[],i=a(e.replace(W,"$1"));return i[x]?ce((function(e,t,n,o){for(var r,s=i(e,null,o,[]),a=e.length;a--;)(r=s[a])&&(e[a]=!(t[a]=r))})):function(e,o,r){return t[0]=e,i(t,null,r,n),t[0]=null,!n.pop()}})),has:ce((function(e){return function(t){return ae(e,t).length>0}})),contains:ce((function(e){return e=e.replace(te,ne),function(t){return(t.textContent||o(t)).indexOf(e)>-1}})),lang:ce((function(e){return q.test(e||"")||ae.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return X.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me((function(){return[0]})),last:me((function(e,t){return[t-1]})),eq:me((function(e,t,n){return[n<0?n+t:n]})),even:me((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:me((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:me((function(e,t,n){for(var i=n<0?n+t:n>t?t:n;--i>=0;)e.push(i);return e})),gt:me((function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=pe(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=fe(t);function ve(){}function be(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function xe(e,t,n){var i=t.dir,o=t.next,r=o||i,s=n&&"parentNode"===r,a=S++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,o);return!1}:function(t,n,l){var c,u,h,d=[_,a];if(l){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||s)if(u=(h=t[x]||(t[x]={}))[t.uniqueID]||(h[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[i]||t;else{if((c=u[r])&&c[0]===_&&c[1]===a)return d[2]=c[2];if(u[r]=d,d[2]=e(t,n,l))return!0}return!1}}function we(e){return e.length>1?function(t,n,i){for(var o=e.length;o--;)if(!e[o](t,n,i))return!1;return!0}:e[0]}function _e(e,t,n,i,o){for(var r,s=[],a=0,l=e.length,c=null!=t;a<l;a++)(r=e[a])&&(n&&!n(r,i,o)||(s.push(r),c&&t.push(a)));return s}function Se(e,t,n,i,o,r){return i&&!i[x]&&(i=Se(i)),o&&!o[x]&&(o=Se(o,r)),ce((function(r,s,a,l){var c,u,h,d=[],p=[],f=s.length,g=r||function(e,t,n){for(var i=0,o=t.length;i<o;i++)ae(e,t[i],n);return n}(t||"*",a.nodeType?[a]:a,[]),m=!e||!r&&t?g:_e(g,d,e,a,l),y=n?o||(r?e:f||i)?[]:s:m;if(n&&n(m,y,a,l),i)for(c=_e(y,p),i(c,[],a,l),u=c.length;u--;)(h=c[u])&&(y[p[u]]=!(m[p[u]]=h));if(r){if(o||e){if(o){for(c=[],u=y.length;u--;)(h=y[u])&&c.push(m[u]=h);o(null,y=[],c,l)}for(u=y.length;u--;)(h=y[u])&&(c=o?O(r,h):d[u])>-1&&(r[c]=!(s[c]=h))}}else y=_e(y===s?y.splice(f,y.length):y),o?o(null,s,y,l):P.apply(s,y)}))}function Ce(e){for(var t,n,o,r=e.length,s=i.relative[e[0].type],a=s||i.relative[" "],l=s?1:0,u=xe((function(e){return e===t}),a,!0),h=xe((function(e){return O(t,e)>-1}),a,!0),d=[function(e,n,i){var o=!s&&(i||n!==c)||((t=n).nodeType?u(e,n,i):h(e,n,i));return t=null,o}];l<r;l++)if(n=i.relative[e[l].type])d=[xe(we(d),n)];else{if((n=i.filter[e[l].type].apply(null,e[l].matches))[x]){for(o=++l;o<r&&!i.relative[e[o].type];o++);return Se(l>1&&we(d),l>1&&be(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(W,"$1"),n,l<o&&Ce(e.slice(l,o)),o<r&&Ce(e=e.slice(o)),o<r&&be(e))}d.push(n)}return we(d)}return ve.prototype=i.filters=i.pseudos,i.setFilters=new ve,s=ae.tokenize=function(e,t){var n,o,r,s,a,l,c,u=k[e+" "];if(u)return t?0:u.slice(0);for(a=e,l=[],c=i.preFilter;a;){for(s in n&&!(o=z.exec(a))||(o&&(a=a.slice(o[0].length)||a),l.push(r=[])),n=!1,(o=V.exec(a))&&(n=o.shift(),r.push({value:n,type:o[0].replace(W," ")}),a=a.slice(n.length)),i.filter)!(o=K[s].exec(a))||c[s]&&!(o=c[s](o))||(n=o.shift(),r.push({value:n,type:s,matches:o}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ae.error(e):k(e,l).slice(0)},a=ae.compile=function(e,t){var n,o=[],r=[],a=A[e+" "];if(!a){for(t||(t=s(e)),n=t.length;n--;)(a=Ce(t[n]))[x]?o.push(a):r.push(a);a=A(e,function(e,t){var n=t.length>0,o=e.length>0,r=function(r,s,a,l,u){var h,f,m,y=0,v="0",b=r&&[],x=[],w=c,S=r||o&&i.find.TAG("*",u),C=_+=null==w?1:Math.random()||.1,k=S.length;for(u&&(c=s==p||s||u);v!==k&&null!=(h=S[v]);v++){if(o&&h){for(f=0,s||h.ownerDocument==p||(d(h),a=!g);m=e[f++];)if(m(h,s||p,a)){l.push(h);break}u&&(_=C)}n&&((h=!m&&h)&&y--,r&&b.push(h))}if(y+=v,n&&v!==y){for(f=0;m=t[f++];)m(b,x,s,a);if(r){if(y>0)for(;v--;)b[v]||x[v]||(x[v]=L.call(l));x=_e(x)}P.apply(l,x),u&&!r&&x.length>0&&y+t.length>1&&ae.uniqueSort(l)}return u&&(_=C,c=w),b};return n?ce(r):r}(r,o)),a.selector=e}return a},l=ae.select=function(e,t,n,o){var r,l,c,u,h,d="function"==typeof e&&e,p=!o&&s(e=d.selector||e);if(n=n||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===t.nodeType&&g&&i.relative[l[1].type]){if(!(t=(i.find.ID(c.matches[0].replace(te,ne),t)||[])[0]))return n;d&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(r=K.needsContext.test(e)?0:l.length;r--&&(c=l[r],!i.relative[u=c.type]);)if((h=i.find[u])&&(o=h(c.matches[0].replace(te,ne),ee.test(l[0].type)&&ye(t.parentNode)||t))){if(l.splice(r,1),!(e=o.length&&be(l)))return P.apply(n,o),n;break}}return(d||a(e,p))(o,t,!g,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},n.sortStable=x.split("").sort(T).join("")===x,n.detectDuplicates=!!h,d(),n.sortDetached=ue((function(e){return 1&e.compareDocumentPosition(p.createElement("fieldset"))})),ue((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||he("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),n.attributes&&ue((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||he("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),ue((function(e){return null==e.getAttribute("disabled")}))||he(D,(function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null})),ae}(e);w.find=S,w.expr=S.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=S.uniqueSort,w.text=S.getText,w.isXMLDoc=S.isXML,w.contains=S.contains,w.escapeSelector=S.escape;var C=function(e,t,n){for(var i=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&w(e).is(n))break;i.push(e)}return i},k=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},A=w.expr.match.needsContext;function M(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var T=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function E(e,t,n){return f(t)?w.grep(e,(function(e,i){return!!t.call(e,i,e)!==n})):t.nodeType?w.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?w.grep(e,(function(e){return a.call(t,e)>-1!==n})):w.filter(t,e,n)}w.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?w.find.matchesSelector(i,e)?[i]:[]:w.find.matches(e,w.grep(t,(function(e){return 1===e.nodeType})))},w.fn.extend({find:function(e){var t,n,i=this.length,o=this;if("string"!=typeof e)return this.pushStack(w(e).filter((function(){for(t=0;t<i;t++)if(w.contains(o[t],this))return!0})));for(n=this.pushStack([]),t=0;t<i;t++)w.find(e,o[t],n);return i>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(E(this,e||[],!1))},not:function(e){return this.pushStack(E(this,e||[],!0))},is:function(e){return!!E(this,"string"==typeof e&&A.test(e)?w(e):e||[],!1).length}});var $,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var i,o;if(!e)return this;if(n=n||$,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:L.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:m,!0)),T.test(i[1])&&w.isPlainObject(t))for(i in t)f(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(o=m.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):f(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,$=w(m);var R=/^(?:parents|prev(?:Until|All))/,P={children:!0,contents:!0,next:!0,prev:!0};function I(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0}))},closest:function(e,t){var n,i=0,o=this.length,r=[],s="string"!=typeof e&&w(e);if(!A.test(e))for(;i<o;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){r.push(n);break}return this.pushStack(r.length>1?w.uniqueSort(r):r)},index:function(e){return e?"string"==typeof e?a.call(w(e),this[0]):a.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return C(e,"parentNode")},parentsUntil:function(e,t,n){return C(e,"parentNode",n)},next:function(e){return I(e,"nextSibling")},prev:function(e){return I(e,"previousSibling")},nextAll:function(e){return C(e,"nextSibling")},prevAll:function(e){return C(e,"previousSibling")},nextUntil:function(e,t,n){return C(e,"nextSibling",n)},prevUntil:function(e,t,n){return C(e,"previousSibling",n)},siblings:function(e){return k((e.parentNode||{}).firstChild,e)},children:function(e){return k(e.firstChild)},contents:function(e){return null!=e.contentDocument&&i(e.contentDocument)?e.contentDocument:(M(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},(function(e,t){w.fn[e]=function(n,i){var o=w.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=w.filter(i,o)),this.length>1&&(P[e]||w.uniqueSort(o),R.test(e)&&o.reverse()),this.pushStack(o)}}));var O=/[^\x20\t\r\n\f]+/g;function D(e){return e}function F(e){throw e}function N(e,t,n,i){var o;try{e&&f(o=e.promise)?o.call(e).done(t).fail(n):e&&f(o=e.then)?o.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}w.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return w.each(e.match(O)||[],(function(e,n){t[n]=!0})),t}(e):w.extend({},e);var t,n,i,o,r=[],s=[],a=-1,l=function(){for(o=o||e.once,i=t=!0;s.length;a=-1)for(n=s.shift();++a<r.length;)!1===r[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=r.length,n=!1);e.memory||(n=!1),t=!1,o&&(r=n?[]:"")},c={add:function(){return r&&(n&&!t&&(a=r.length-1,s.push(n)),function t(n){w.each(n,(function(n,i){f(i)?e.unique&&c.has(i)||r.push(i):i&&i.length&&"string"!==b(i)&&t(i)}))}(arguments),n&&!t&&l()),this},remove:function(){return w.each(arguments,(function(e,t){for(var n;(n=w.inArray(t,r,n))>-1;)r.splice(n,1),n<=a&&a--})),this},has:function(e){return e?w.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=s=[],r=n="",this},disabled:function(){return!r},lock:function(){return o=s=[],n||t||(r=n=""),this},locked:function(){return!!o},fireWith:function(e,n){return o||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],i="pending",o={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},catch:function(e){return o.then(null,e)},pipe:function(){var e=arguments;return w.Deferred((function(t){w.each(n,(function(n,i){var o=f(e[i[4]])&&e[i[4]];r[i[1]]((function(){var e=o&&o.apply(this,arguments);e&&f(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[i[0]+"With"](this,o?[e]:arguments)}))})),e=null})).promise()},then:function(t,i,o){var r=0;function s(t,n,i,o){return function(){var a=this,l=arguments,c=function(){var e,c;if(!(t<r)){if((e=i.apply(a,l))===n.promise())throw new TypeError("Thenable self-resolution");c=e&&("object"==typeof e||"function"==typeof e)&&e.then,f(c)?o?c.call(e,s(r,n,D,o),s(r,n,F,o)):(r++,c.call(e,s(r,n,D,o),s(r,n,F,o),s(r,n,D,n.notifyWith))):(i!==D&&(a=void 0,l=[e]),(o||n.resolveWith)(a,l))}},u=o?c:function(){try{c()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,u.stackTrace),t+1>=r&&(i!==F&&(a=void 0,l=[e]),n.rejectWith(a,l))}};t?u():(w.Deferred.getStackHook&&(u.stackTrace=w.Deferred.getStackHook()),e.setTimeout(u))}}return w.Deferred((function(e){n[0][3].add(s(0,e,f(o)?o:D,e.notifyWith)),n[1][3].add(s(0,e,f(t)?t:D)),n[2][3].add(s(0,e,f(i)?i:F))})).promise()},promise:function(e){return null!=e?w.extend(e,o):o}},r={};return w.each(n,(function(e,t){var s=t[2],a=t[5];o[t[1]]=s.add,a&&s.add((function(){i=a}),n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),s.add(t[3].fire),r[t[0]]=function(){return r[t[0]+"With"](this===r?void 0:this,arguments),this},r[t[0]+"With"]=s.fireWith})),o.promise(r),t&&t.call(r,r),r},when:function(e){var t=arguments.length,n=t,i=Array(n),r=o.call(arguments),s=w.Deferred(),a=function(e){return function(n){i[e]=this,r[e]=arguments.length>1?o.call(arguments):n,--t||s.resolveWith(i,r)}};if(t<=1&&(N(e,s.done(a(n)).resolve,s.reject,!t),"pending"===s.state()||f(r[n]&&r[n].then)))return s.then();for(;n--;)N(r[n],a(n),s.reject);return s.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&B.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout((function(){throw t}))};var j=w.Deferred();function H(){m.removeEventListener("DOMContentLoaded",H),e.removeEventListener("load",H),w.ready()}w.fn.ready=function(e){return j.then(e).catch((function(e){w.readyException(e)})),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||j.resolveWith(m,[w]))}}),w.ready.then=j.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?e.setTimeout(w.ready):(m.addEventListener("DOMContentLoaded",H),e.addEventListener("load",H));var W=function(e,t,n,i,o,r,s){var a=0,l=e.length,c=null==n;if("object"===b(n))for(a in o=!0,n)W(e,t,a,n[a],!0,r,s);else if(void 0!==i&&(o=!0,f(i)||(s=!0),c&&(s?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(w(e),n)})),t))for(;a<l;a++)t(e[a],n,s?i:i.call(e[a],a,t(e[a],n)));return o?e:c?t.call(e):l?t(e[0],n):r},z=/^-ms-/,V=/-([a-z])/g;function G(e,t){return t.toUpperCase()}function U(e){return e.replace(z,"ms-").replace(V,G)}var q=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function K(){this.expando=w.expando+K.uid++}K.uid=1,K.prototype={cache:function(e){var t=e[this.expando];return t||(t={},q(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,o=this.cache(e);if("string"==typeof t)o[U(t)]=n;else for(i in t)o[U(i)]=t[i];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][U(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(U):(t=U(t))in i?[t]:t.match(O)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||w.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var Y=new K,X=new K,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function Z(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(Q,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:J.test(e)?JSON.parse(e):e)}(n)}catch(e){}X.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return X.hasData(e)||Y.hasData(e)},data:function(e,t,n){return X.access(e,t,n)},removeData:function(e,t){X.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,i,o,r=this[0],s=r&&r.attributes;if(void 0===e){if(this.length&&(o=X.get(r),1===r.nodeType&&!Y.get(r,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=U(i.slice(5)),Z(r,i,o[i]));Y.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each((function(){X.set(this,e)})):W(this,(function(t){var n;if(r&&void 0===t)return void 0!==(n=X.get(r,e))||void 0!==(n=Z(r,e))?n:void 0;this.each((function(){X.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){X.remove(this,e)}))}}),w.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=Y.get(e,t),n&&(!i||Array.isArray(n)?i=Y.access(e,t,w.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),i=n.length,o=n.shift(),r=w._queueHooks(e,t);"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete r.stop,o.call(e,(function(){w.dequeue(e,t)}),r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:w.Callbacks("once memory").add((function(){Y.remove(e,[t+"queue",n])}))})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each((function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){w.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,o=w.Deferred(),r=this,s=this.length,a=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=Y.get(r[s],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),o.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],ie=m.documentElement,oe=function(e){return w.contains(e.ownerDocument,e)},re={composed:!0};ie.getRootNode&&(oe=function(e){return w.contains(e.ownerDocument,e)||e.getRootNode(re)===e.ownerDocument});var se=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&oe(e)&&"none"===w.css(e,"display")};function ae(e,t,n,i){var o,r,s=20,a=i?function(){return i.cur()}:function(){return w.css(e,t,"")},l=a(),c=n&&n[3]||(w.cssNumber[t]?"":"px"),u=e.nodeType&&(w.cssNumber[t]||"px"!==c&&+l)&&te.exec(w.css(e,t));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)w.style(e,t,u+c),(1-r)*(1-(r=a()/l||.5))<=0&&(s=0),u/=r;u*=2,w.style(e,t,u+c),n=n||[]}return n&&(u=+u||+l||0,o=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=o)),o}var le={};function ce(e){var t,n=e.ownerDocument,i=e.nodeName,o=le[i];return o||(t=n.body.appendChild(n.createElement(i)),o=w.css(t,"display"),t.parentNode.removeChild(t),"none"===o&&(o="block"),le[i]=o,o)}function ue(e,t){for(var n,i,o=[],r=0,s=e.length;r<s;r++)(i=e[r]).style&&(n=i.style.display,t?("none"===n&&(o[r]=Y.get(i,"display")||null,o[r]||(i.style.display="")),""===i.style.display&&se(i)&&(o[r]=ce(i))):"none"!==n&&(o[r]="none",Y.set(i,"display",n)));for(r=0;r<s;r++)null!=o[r]&&(e[r].style.display=o[r]);return e}w.fn.extend({show:function(){return ue(this,!0)},hide:function(){return ue(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){se(this)?w(this).show():w(this).hide()}))}});var he,de,pe=/^(?:checkbox|radio)$/i,fe=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ge=/^$|^module$|\/(?:java|ecma)script/i;he=m.createDocumentFragment().appendChild(m.createElement("div")),(de=m.createElement("input")).setAttribute("type","radio"),de.setAttribute("checked","checked"),de.setAttribute("name","t"),he.appendChild(de),p.checkClone=he.cloneNode(!0).cloneNode(!0).lastChild.checked,he.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!he.cloneNode(!0).lastChild.defaultValue,he.innerHTML="<option></option>",p.option=!!he.lastChild;var me={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ye(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&M(e,t)?w.merge([e],n):n}function ve(e,t){for(var n=0,i=e.length;n<i;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}me.tbody=me.tfoot=me.colgroup=me.caption=me.thead,me.th=me.td,p.option||(me.optgroup=me.option=[1,"<select multiple='multiple'>","</select>"]);var be=/<|&#?\w+;/;function xe(e,t,n,i,o){for(var r,s,a,l,c,u,h=t.createDocumentFragment(),d=[],p=0,f=e.length;p<f;p++)if((r=e[p])||0===r)if("object"===b(r))w.merge(d,r.nodeType?[r]:r);else if(be.test(r)){for(s=s||h.appendChild(t.createElement("div")),a=(fe.exec(r)||["",""])[1].toLowerCase(),l=me[a]||me._default,s.innerHTML=l[1]+w.htmlPrefilter(r)+l[2],u=l[0];u--;)s=s.lastChild;w.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(t.createTextNode(r));for(h.textContent="",p=0;r=d[p++];)if(i&&w.inArray(r,i)>-1)o&&o.push(r);else if(c=oe(r),s=ye(h.appendChild(r),"script"),c&&ve(s),n)for(u=0;r=s[u++];)ge.test(r.type||"")&&n.push(r);return h}var we=/^([^.]*)(?:\.(.+)|)/;function _e(){return!0}function Se(){return!1}function Ce(e,t){return e===function(){try{return m.activeElement}catch(e){}}()==("focus"===t)}function ke(e,t,n,i,o,r){var s,a;if("object"==typeof t){for(a in"string"!=typeof n&&(i=i||n,n=void 0),t)ke(e,a,n,i,t[a],r);return e}if(null==i&&null==o?(o=n,i=n=void 0):null==o&&("string"==typeof n?(o=i,i=void 0):(o=i,i=n,n=void 0)),!1===o)o=Se;else if(!o)return e;return 1===r&&(s=o,o=function(e){return w().off(e),s.apply(this,arguments)},o.guid=s.guid||(s.guid=w.guid++)),e.each((function(){w.event.add(this,t,o,i,n)}))}function Ae(e,t,n){n?(Y.set(e,t,!1),w.event.add(e,t,{namespace:!1,handler:function(e){var i,r,s=Y.get(this,t);if(1&e.isTrigger&&this[t]){if(s.length)(w.event.special[t]||{}).delegateType&&e.stopPropagation();else if(s=o.call(arguments),Y.set(this,t,s),i=n(this,t),this[t](),s!==(r=Y.get(this,t))||i?Y.set(this,t,!1):r={},s!==r)return e.stopImmediatePropagation(),e.preventDefault(),r&&r.value}else s.length&&(Y.set(this,t,{value:w.event.trigger(w.extend(s[0],w.Event.prototype),s.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,t)&&w.event.add(e,t,_e)}w.event={global:{},add:function(e,t,n,i,o){var r,s,a,l,c,u,h,d,p,f,g,m=Y.get(e);if(q(e))for(n.handler&&(n=(r=n).handler,o=r.selector),o&&w.find.matchesSelector(ie,o),n.guid||(n.guid=w.guid++),(l=m.events)||(l=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(t){return void 0!==w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(O)||[""]).length;c--;)p=g=(a=we.exec(t[c])||[])[1],f=(a[2]||"").split(".").sort(),p&&(h=w.event.special[p]||{},p=(o?h.delegateType:h.bindType)||p,h=w.event.special[p]||{},u=w.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&w.expr.match.needsContext.test(o),namespace:f.join(".")},r),(d=l[p])||((d=l[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,i,f,s)||e.addEventListener&&e.addEventListener(p,s)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),o?d.splice(d.delegateCount++,0,u):d.push(u),w.event.global[p]=!0)},remove:function(e,t,n,i,o){var r,s,a,l,c,u,h,d,p,f,g,m=Y.hasData(e)&&Y.get(e);if(m&&(l=m.events)){for(c=(t=(t||"").match(O)||[""]).length;c--;)if(p=g=(a=we.exec(t[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(h=w.event.special[p]||{},d=l[p=(i?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=d.length;r--;)u=d[r],!o&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(r,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,f,m.handle)||w.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)w.event.remove(e,p+t[c],n,i,!0);w.isEmptyObject(l)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,i,o,r,s,a=new Array(arguments.length),l=w.event.fix(e),c=(Y.get(this,"events")||Object.create(null))[l.type]||[],u=w.event.special[l.type]||{};for(a[0]=l,t=1;t<arguments.length;t++)a[t]=arguments[t];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=w.event.handlers.call(this,l,c),t=0;(o=s[t++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==r.namespace&&!l.rnamespace.test(r.namespace)||(l.handleObj=r,l.data=r.data,void 0!==(i=((w.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,a))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(e,t){var n,i,o,r,s,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(r=[],s={},n=0;n<l;n++)void 0===s[o=(i=t[n]).selector+" "]&&(s[o]=i.needsContext?w(o,this).index(c)>-1:w.find(o,this,null,[c]).length),s[o]&&r.push(i);r.length&&a.push({elem:c,handlers:r})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:f(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&M(t,"input")&&Ae(t,"click",_e),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&M(t,"input")&&Ae(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&M(t,"input")&&Y.get(t,"click")||M(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?_e:Se,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:Se,isPropagationStopped:Se,isImmediatePropagationStopped:Se,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=_e,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=_e,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=_e,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},(function(e,t){w.event.special[e]={setup:function(){return Ae(this,e,Ce),!1},trigger:function(){return Ae(this,e),!0},_default:function(t){return Y.get(t.target,e)},delegateType:t}})),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=e.relatedTarget,o=e.handleObj;return i&&(i===this||w.contains(this,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}})),w.fn.extend({on:function(e,t,n,i){return ke(this,e,t,n,i)},one:function(e,t,n,i){return ke(this,e,t,n,i,1)},off:function(e,t,n){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,w(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Se),this.each((function(){w.event.remove(this,e,n,t)}))}});var Me=/<script|<style|<link/i,Te=/checked\s*(?:[^=]|=\s*.checked.)/i,Ee=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function $e(e,t){return M(e,"table")&&M(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function Le(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Re(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Pe(e,t){var n,i,o,r,s,a;if(1===t.nodeType){if(Y.hasData(e)&&(a=Y.get(e).events))for(o in Y.remove(t,"handle events"),a)for(n=0,i=a[o].length;n<i;n++)w.event.add(t,o,a[o][n]);X.hasData(e)&&(r=X.access(e),s=w.extend({},r),X.set(t,s))}}function Ie(e,t){var n=t.nodeName.toLowerCase();"input"===n&&pe.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Oe(e,t,n,i){t=r(t);var o,s,a,l,c,u,h=0,d=e.length,g=d-1,m=t[0],y=f(m);if(y||d>1&&"string"==typeof m&&!p.checkClone&&Te.test(m))return e.each((function(o){var r=e.eq(o);y&&(t[0]=m.call(this,o,r.html())),Oe(r,t,n,i)}));if(d&&(s=(o=xe(t,e[0].ownerDocument,!1,e,i)).firstChild,1===o.childNodes.length&&(o=s),s||i)){for(l=(a=w.map(ye(o,"script"),Le)).length;h<d;h++)c=o,h!==g&&(c=w.clone(c,!0,!0),l&&w.merge(a,ye(c,"script"))),n.call(e[h],c,h);if(l)for(u=a[a.length-1].ownerDocument,w.map(a,Re),h=0;h<l;h++)c=a[h],ge.test(c.type||"")&&!Y.access(c,"globalEval")&&w.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?w._evalUrl&&!c.noModule&&w._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):v(c.textContent.replace(Ee,""),c,u))}return e}function De(e,t,n){for(var i,o=t?w.filter(t,e):e,r=0;null!=(i=o[r]);r++)n||1!==i.nodeType||w.cleanData(ye(i)),i.parentNode&&(n&&oe(i)&&ve(ye(i,"script")),i.parentNode.removeChild(i));return e}w.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var i,o,r,s,a=e.cloneNode(!0),l=oe(e);if(!(p.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(s=ye(a),i=0,o=(r=ye(e)).length;i<o;i++)Ie(r[i],s[i]);if(t)if(n)for(r=r||ye(e),s=s||ye(a),i=0,o=r.length;i<o;i++)Pe(r[i],s[i]);else Pe(e,a);return(s=ye(a,"script")).length>0&&ve(s,!l&&ye(e,"script")),a},cleanData:function(e){for(var t,n,i,o=w.event.special,r=0;void 0!==(n=e[r]);r++)if(q(n)){if(t=n[Y.expando]){if(t.events)for(i in t.events)o[i]?w.event.remove(n,i):w.removeEvent(n,i,t.handle);n[Y.expando]=void 0}n[X.expando]&&(n[X.expando]=void 0)}}}),w.fn.extend({detach:function(e){return De(this,e,!0)},remove:function(e){return De(this,e)},text:function(e){return W(this,(function(e){return void 0===e?w.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Oe(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||$e(this,e).appendChild(e)}))},prepend:function(){return Oe(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=$e(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Oe(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Oe(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return w.clone(this,e,t)}))},html:function(e){return W(this,(function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Me.test(e)&&!me[(fe.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Oe(this,arguments,(function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(ye(this)),n&&n.replaceChild(t,this))}),e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){w.fn[e]=function(e){for(var n,i=[],o=w(e),r=o.length-1,a=0;a<=r;a++)n=a===r?this:this.clone(!0),w(o[a])[t](n),s.apply(i,n.get());return this.pushStack(i)}}));var Fe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Ne=/^--/,Be=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},je=function(e,t,n){var i,o,r={};for(o in t)r[o]=e.style[o],e.style[o]=t[o];for(o in i=n.call(e),t)e.style[o]=r[o];return i},He=new RegExp(ne.join("|"),"i"),We="[\\x20\\t\\r\\n\\f]",ze=new RegExp("^"+We+"+|((?:^|[^\\\\])(?:\\\\.)*)"+We+"+$","g");function Ve(e,t,n){var i,o,r,s,a=Ne.test(t),l=e.style;return(n=n||Be(e))&&(s=n.getPropertyValue(t)||n[t],a&&s&&(s=s.replace(ze,"$1")||void 0),""!==s||oe(e)||(s=w.style(e,t)),!p.pixelBoxStyles()&&Fe.test(s)&&He.test(t)&&(i=l.width,o=l.minWidth,r=l.maxWidth,l.minWidth=l.maxWidth=l.width=s,s=n.width,l.width=i,l.minWidth=o,l.maxWidth=r)),void 0!==s?s+"":s}function Ge(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ie.appendChild(c).appendChild(u);var t=e.getComputedStyle(u);i="1%"!==t.top,l=12===n(t.marginLeft),u.style.right="60%",s=36===n(t.right),o=36===n(t.width),u.style.position="absolute",r=12===n(u.offsetWidth/3),ie.removeChild(c),u=null}}function n(e){return Math.round(parseFloat(e))}var i,o,r,s,a,l,c=m.createElement("div"),u=m.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===u.style.backgroundClip,w.extend(p,{boxSizingReliable:function(){return t(),o},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),r},reliableTrDimensions:function(){var t,n,i,o;return null==a&&(t=m.createElement("table"),n=m.createElement("tr"),i=m.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",i.style.height="9px",i.style.display="block",ie.appendChild(t).appendChild(n).appendChild(i),o=e.getComputedStyle(n),a=parseInt(o.height,10)+parseInt(o.borderTopWidth,10)+parseInt(o.borderBottomWidth,10)===n.offsetHeight,ie.removeChild(t)),a}}))}();var Ue=["Webkit","Moz","ms"],qe=m.createElement("div").style,Ke={};function Ye(e){var t=w.cssProps[e]||Ke[e];return t||(e in qe?e:Ke[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Ue.length;n--;)if((e=Ue[n]+t)in qe)return e}(e)||e)}var Xe=/^(none|table(?!-c[ea]).+)/,Je={position:"absolute",visibility:"hidden",display:"block"},Qe={letterSpacing:"0",fontWeight:"400"};function Ze(e,t,n){var i=te.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function et(e,t,n,i,o,r){var s="width"===t?1:0,a=0,l=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=w.css(e,n+ne[s],!0,o)),i?("content"===n&&(l-=w.css(e,"padding"+ne[s],!0,o)),"margin"!==n&&(l-=w.css(e,"border"+ne[s]+"Width",!0,o))):(l+=w.css(e,"padding"+ne[s],!0,o),"padding"!==n?l+=w.css(e,"border"+ne[s]+"Width",!0,o):a+=w.css(e,"border"+ne[s]+"Width",!0,o));return!i&&r>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-r-l-a-.5))||0),l}function tt(e,t,n){var i=Be(e),o=(!p.boxSizingReliable()||n)&&"border-box"===w.css(e,"boxSizing",!1,i),r=o,s=Ve(e,t,i),a="offset"+t[0].toUpperCase()+t.slice(1);if(Fe.test(s)){if(!n)return s;s="auto"}return(!p.boxSizingReliable()&&o||!p.reliableTrDimensions()&&M(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===w.css(e,"display",!1,i))&&e.getClientRects().length&&(o="border-box"===w.css(e,"boxSizing",!1,i),(r=a in e)&&(s=e[a])),(s=parseFloat(s)||0)+et(e,t,n||(o?"border":"content"),r,i,s)+"px"}function nt(e,t,n,i,o){return new nt.prototype.init(e,t,n,i,o)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ve(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,s,a=U(t),l=Ne.test(t),c=e.style;if(l||(t=Ye(a)),s=w.cssHooks[t]||w.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(o=s.get(e,!1,i))?o:c[t];"string"===(r=typeof n)&&(o=te.exec(n))&&o[1]&&(n=ae(e,t,o),r="number"),null!=n&&n==n&&("number"!==r||l||(n+=o&&o[3]||(w.cssNumber[a]?"":"px")),p.clearCloneStyle||""!==n||0!==t.indexOf("background")||(c[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,i))||(l?c.setProperty(t,n):c[t]=n))}},css:function(e,t,n,i){var o,r,s,a=U(t);return Ne.test(t)||(t=Ye(a)),(s=w.cssHooks[t]||w.cssHooks[a])&&"get"in s&&(o=s.get(e,!0,n)),void 0===o&&(o=Ve(e,t,i)),"normal"===o&&t in Qe&&(o=Qe[t]),""===n||n?(r=parseFloat(o),!0===n||isFinite(r)?r||0:o):o}}),w.each(["height","width"],(function(e,t){w.cssHooks[t]={get:function(e,n,i){if(n)return!Xe.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?tt(e,t,i):je(e,Je,(function(){return tt(e,t,i)}))},set:function(e,n,i){var o,r=Be(e),s=!p.scrollboxSize()&&"absolute"===r.position,a=(s||i)&&"border-box"===w.css(e,"boxSizing",!1,r),l=i?et(e,t,i,a,r):0;return a&&s&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(r[t])-et(e,t,"border",!1,r)-.5)),l&&(o=te.exec(n))&&"px"!==(o[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ze(0,n,l)}}})),w.cssHooks.marginLeft=Ge(p.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Ve(e,"marginLeft"))||e.getBoundingClientRect().left-je(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),w.each({margin:"",padding:"",border:"Width"},(function(e,t){w.cssHooks[e+t]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];i<4;i++)o[e+ne[i]+t]=r[i]||r[i-2]||r[0];return o}},"margin"!==e&&(w.cssHooks[e+t].set=Ze)})),w.fn.extend({css:function(e,t){return W(this,(function(e,t,n){var i,o,r={},s=0;if(Array.isArray(t)){for(i=Be(e),o=t.length;s<o;s++)r[t[s]]=w.css(e,t[s],!1,i);return r}return void 0!==n?w.style(e,t,n):w.css(e,t)}),e,t,arguments.length>1)}}),w.Tween=nt,nt.prototype={constructor:nt,init:function(e,t,n,i,o,r){this.elem=e,this.prop=n,this.easing=o||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(w.cssNumber[n]?"":"px")},cur:function(){var e=nt.propHooks[this.prop];return e&&e.get?e.get(this):nt.propHooks._default.get(this)},run:function(e){var t,n=nt.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):nt.propHooks._default.set(this),this}},nt.prototype.init.prototype=nt.prototype,nt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||!w.cssHooks[e.prop]&&null==e.elem.style[Ye(e.prop)]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},nt.propHooks.scrollTop=nt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=nt.prototype.init,w.fx.step={};var it,ot,rt=/^(?:toggle|show|hide)$/,st=/queueHooks$/;function at(){ot&&(!1===m.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(at):e.setTimeout(at,w.fx.interval),w.fx.tick())}function lt(){return e.setTimeout((function(){it=void 0})),it=Date.now()}function ct(e,t){var n,i=0,o={height:e};for(t=t?1:0;i<4;i+=2-t)o["margin"+(n=ne[i])]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function ut(e,t,n){for(var i,o=(ht.tweeners[t]||[]).concat(ht.tweeners["*"]),r=0,s=o.length;r<s;r++)if(i=o[r].call(n,t,e))return i}function ht(e,t,n){var i,o,r=0,s=ht.prefilters.length,a=w.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var t=it||lt(),n=Math.max(0,c.startTime+c.duration-t),i=1-(n/c.duration||0),r=0,s=c.tweens.length;r<s;r++)c.tweens[r].run(i);return a.notifyWith(e,[c,i,n]),i<1&&s?n:(s||a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:it||lt(),duration:n.duration,tweens:[],createTween:function(t,n){var i=w.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(o)return this;for(o=!0;n<i;n++)c.tweens[n].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}}),u=c.props;for(!function(e,t){var n,i,o,r,s;for(n in e)if(o=t[i=U(n)],r=e[n],Array.isArray(r)&&(o=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),(s=w.cssHooks[i])&&"expand"in s)for(n in r=s.expand(r),delete e[i],r)n in e||(e[n]=r[n],t[n]=o);else t[i]=o}(u,c.opts.specialEasing);r<s;r++)if(i=ht.prefilters[r].call(c,e,u,c.opts))return f(i.stop)&&(w._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return w.map(u,ut,c),f(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),w.fx.timer(w.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}w.Animation=w.extend(ht,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ae(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){f(e)?(t=e,e=["*"]):e=e.match(O);for(var n,i=0,o=e.length;i<o;i++)n=e[i],ht.tweeners[n]=ht.tweeners[n]||[],ht.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,o,r,s,a,l,c,u,h="width"in t||"height"in t,d=this,p={},f=e.style,g=e.nodeType&&se(e),m=Y.get(e,"fxshow");for(i in n.queue||(null==(s=w._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,w.queue(e,"fx").length||s.empty.fire()}))}))),t)if(o=t[i],rt.test(o)){if(delete t[i],r=r||"toggle"===o,o===(g?"hide":"show")){if("show"!==o||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||w.style(e,i)}if((l=!w.isEmptyObject(t))||!w.isEmptyObject(p))for(i in h&&1===e.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=m&&m.display)&&(c=Y.get(e,"display")),"none"===(u=w.css(e,"display"))&&(c?u=c:(ue([e],!0),c=e.style.display||c,u=w.css(e,"display"),ue([e]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===w.css(e,"float")&&(l||(d.done((function(){f.display=c})),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",d.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),l=!1,p)l||(m?"hidden"in m&&(g=m.hidden):m=Y.access(e,"fxshow",{display:c}),r&&(m.hidden=!g),g&&ue([e],!0),d.done((function(){for(i in g||ue([e]),Y.remove(e,"fxshow"),p)w.style(e,i,p[i])}))),l=ut(g?m[i]:0,i,d),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?ht.prefilters.unshift(e):ht.prefilters.push(e)}}),w.speed=function(e,t,n){var i=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||f(e)&&e,duration:e,easing:n&&t||t&&!f(t)&&t};return w.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in w.fx.speeds?i.duration=w.fx.speeds[i.duration]:i.duration=w.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){f(i.old)&&i.old.call(this),i.queue&&w.dequeue(this,i.queue)},i},w.fn.extend({fadeTo:function(e,t,n,i){return this.filter(se).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=w.isEmptyObject(e),r=w.speed(t,n,i),s=function(){var t=ht(this,w.extend({},e),r);(o||Y.get(this,"finish"))&&t.stop(!0)};return s.finish=s,o||!1===r.queue?this.each(s):this.queue(r.queue,s)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,o=null!=e&&e+"queueHooks",r=w.timers,s=Y.get(this);if(o)s[o]&&s[o].stop&&i(s[o]);else for(o in s)s[o]&&s[o].stop&&st.test(o)&&i(s[o]);for(o=r.length;o--;)r[o].elem!==this||null!=e&&r[o].queue!==e||(r[o].anim.stop(n),t=!1,r.splice(o,1));!t&&n||w.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=Y.get(this),i=n[e+"queue"],o=n[e+"queueHooks"],r=w.timers,s=i?i.length:0;for(n.finish=!0,w.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<s;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish}))}}),w.each(["toggle","show","hide"],(function(e,t){var n=w.fn[t];w.fn[t]=function(e,i,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ct(t,!0),e,i,o)}})),w.each({slideDown:ct("show"),slideUp:ct("hide"),slideToggle:ct("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){w.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}})),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(it=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),it=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){ot||(ot=!0,at())},w.fx.stop=function(){ot=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx&&w.fx.speeds[t]||t,n=n||"fx",this.queue(n,(function(n,i){var o=e.setTimeout(n,t);i.stop=function(){e.clearTimeout(o)}}))},function(){var e=m.createElement("input"),t=m.createElement("select").appendChild(m.createElement("option"));e.type="checkbox",p.checkOn=""!==e.value,p.optSelected=t.selected,(e=m.createElement("input")).value="t",e.type="radio",p.radioValue="t"===e.value}();var dt,pt=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return W(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){w.removeAttr(this,e)}))}}),w.extend({attr:function(e,t,n){var i,o,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===e.getAttribute?w.prop(e,t,n):(1===r&&w.isXMLDoc(e)||(o=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?dt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:(e.setAttribute(t,n+""),n):o&&"get"in o&&null!==(i=o.get(e,t))?i:null==(i=w.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!p.radioValue&&"radio"===t&&M(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,o=t&&t.match(O);if(o&&1===e.nodeType)for(;n=o[i++];)e.removeAttribute(n)}}),dt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=pt[t]||w.find.attr;pt[t]=function(e,t,i){var o,r,s=t.toLowerCase();return i||(r=pt[s],pt[s]=o,o=null!=n(e,t,i)?s:null,pt[s]=r),o}}));var ft=/^(?:input|select|textarea|button)$/i,gt=/^(?:a|area)$/i;function mt(e){return(e.match(O)||[]).join(" ")}function yt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(O)||[]}w.fn.extend({prop:function(e,t){return W(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[w.propFix[e]||e]}))}}),w.extend({prop:function(e,t,n){var i,o,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&w.isXMLDoc(e)||(t=w.propFix[t]||t,o=w.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:e[t]=n:o&&"get"in o&&null!==(i=o.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):ft.test(e.nodeName)||gt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){w.propFix[this.toLowerCase()]=this})),w.fn.extend({addClass:function(e){var t,n,i,o,r,s;return f(e)?this.each((function(t){w(this).addClass(e.call(this,t,yt(this)))})):(t=vt(e)).length?this.each((function(){if(i=yt(this),n=1===this.nodeType&&" "+mt(i)+" "){for(r=0;r<t.length;r++)o=t[r],n.indexOf(" "+o+" ")<0&&(n+=o+" ");s=mt(n),i!==s&&this.setAttribute("class",s)}})):this},removeClass:function(e){var t,n,i,o,r,s;return f(e)?this.each((function(t){w(this).removeClass(e.call(this,t,yt(this)))})):arguments.length?(t=vt(e)).length?this.each((function(){if(i=yt(this),n=1===this.nodeType&&" "+mt(i)+" "){for(r=0;r<t.length;r++)for(o=t[r];n.indexOf(" "+o+" ")>-1;)n=n.replace(" "+o+" "," ");s=mt(n),i!==s&&this.setAttribute("class",s)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,i,o,r,s=typeof e,a="string"===s||Array.isArray(e);return f(e)?this.each((function(n){w(this).toggleClass(e.call(this,n,yt(this),t),t)})):"boolean"==typeof t&&a?t?this.addClass(e):this.removeClass(e):(n=vt(e),this.each((function(){if(a)for(r=w(this),o=0;o<n.length;o++)i=n[o],r.hasClass(i)?r.removeClass(i):r.addClass(i);else void 0!==e&&"boolean"!==s||((i=yt(this))&&Y.set(this,"__className__",i),this.setAttribute&&this.setAttribute("class",i||!1===e?"":Y.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+mt(yt(n))+" ").indexOf(t)>-1)return!0;return!1}});var bt=/\r/g;w.fn.extend({val:function(e){var t,n,i,o=this[0];return arguments.length?(i=f(e),this.each((function(n){var o;1===this.nodeType&&(null==(o=i?e.call(this,n,w(this).val()):e)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=w.map(o,(function(e){return null==e?"":e+""}))),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))}))):o?(t=w.valHooks[o.type]||w.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(o,"value"))?n:"string"==typeof(n=o.value)?n.replace(bt,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:mt(w.text(e))}},select:{get:function(e){var t,n,i,o=e.options,r=e.selectedIndex,s="select-one"===e.type,a=s?null:[],l=s?r+1:o.length;for(i=r<0?l:s?r:0;i<l;i++)if(((n=o[i]).selected||i===r)&&!n.disabled&&(!n.parentNode.disabled||!M(n.parentNode,"optgroup"))){if(t=w(n).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var n,i,o=e.options,r=w.makeArray(t),s=o.length;s--;)((i=o[s]).selected=w.inArray(w.valHooks.option.get(i),r)>-1)&&(n=!0);return n||(e.selectedIndex=-1),r}}}}),w.each(["radio","checkbox"],(function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},p.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),p.focusin="onfocusin"in e;var xt=/^(?:focusinfocus|focusoutblur)$/,wt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,i,o){var r,s,a,l,c,h,d,p,y=[i||m],v=u.call(t,"type")?t.type:t,b=u.call(t,"namespace")?t.namespace.split("."):[];if(s=p=a=i=i||m,3!==i.nodeType&&8!==i.nodeType&&!xt.test(v+w.event.triggered)&&(v.indexOf(".")>-1&&(b=v.split("."),v=b.shift(),b.sort()),c=v.indexOf(":")<0&&"on"+v,(t=t[w.expando]?t:new w.Event(v,"object"==typeof t&&t)).isTrigger=o?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:w.makeArray(n,[t]),d=w.event.special[v]||{},o||!d.trigger||!1!==d.trigger.apply(i,n))){if(!o&&!d.noBubble&&!g(i)){for(l=d.delegateType||v,xt.test(l+v)||(s=s.parentNode);s;s=s.parentNode)y.push(s),a=s;a===(i.ownerDocument||m)&&y.push(a.defaultView||a.parentWindow||e)}for(r=0;(s=y[r++])&&!t.isPropagationStopped();)p=s,t.type=r>1?l:d.bindType||v,(h=(Y.get(s,"events")||Object.create(null))[t.type]&&Y.get(s,"handle"))&&h.apply(s,n),(h=c&&s[c])&&h.apply&&q(s)&&(t.result=h.apply(s,n),!1===t.result&&t.preventDefault());return t.type=v,o||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(y.pop(),n)||!q(i)||c&&f(i[v])&&!g(i)&&((a=i[c])&&(i[c]=null),w.event.triggered=v,t.isPropagationStopped()&&p.addEventListener(v,wt),i[v](),t.isPropagationStopped()&&p.removeEventListener(v,wt),w.event.triggered=void 0,a&&(i[c]=a)),t.result}},simulate:function(e,t,n){var i=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(i,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each((function(){w.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),p.focusin||w.each({focus:"focusin",blur:"focusout"},(function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var i=this.ownerDocument||this.document||this,o=Y.access(i,t);o||i.addEventListener(e,n,!0),Y.access(i,t,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,o=Y.access(i,t)-1;o?Y.access(i,t,o):(i.removeEventListener(e,n,!0),Y.remove(i,t))}}}));var _t=e.location,St={guid:Date.now()},Ct=/\?/;w.parseXML=function(t){var n,i;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){}return i=n&&n.getElementsByTagName("parsererror")[0],n&&!i||w.error("Invalid XML: "+(i?w.map(i.childNodes,(function(e){return e.textContent})).join("\n"):t)),n};var kt=/\[\]$/,At=/\r?\n/g,Mt=/^(?:submit|button|image|reset|file)$/i,Tt=/^(?:input|select|textarea|keygen)/i;function Et(e,t,n,i){var o;if(Array.isArray(t))w.each(t,(function(t,o){n||kt.test(e)?i(e,o):Et(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,n,i)}));else if(n||"object"!==b(t))i(e,t);else for(o in t)Et(e+"["+o+"]",t[o],n,i)}w.param=function(e,t){var n,i=[],o=function(e,t){var n=f(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,(function(){o(this.name,this.value)}));else for(n in e)Et(n,e[n],t,o);return i.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&Tt.test(this.nodeName)&&!Mt.test(e)&&(this.checked||!pe.test(e))})).map((function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,(function(e){return{name:t.name,value:e.replace(At,"\r\n")}})):{name:t.name,value:n.replace(At,"\r\n")}})).get()}});var $t=/%20/g,Lt=/#.*$/,Rt=/([?&])_=[^&]*/,Pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,It=/^(?:GET|HEAD)$/,Ot=/^\/\//,Dt={},Ft={},Nt="*/".concat("*"),Bt=m.createElement("a");function jt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,o=0,r=t.toLowerCase().match(O)||[];if(f(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function Ht(e,t,n,i){var o={},r=e===Ft;function s(a){var l;return o[a]=!0,w.each(e[a]||[],(function(e,a){var c=a(t,n,i);return"string"!=typeof c||r||o[c]?r?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)})),l}return s(t.dataTypes[0])||!o["*"]&&s("*")}function Wt(e,t){var n,i,o=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:i||(i={}))[n]=t[n]);return i&&w.extend(!0,e,i),e}Bt.href=_t.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_t.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(_t.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Nt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Wt(Wt(e,w.ajaxSettings),t):Wt(w.ajaxSettings,e)},ajaxPrefilter:jt(Dt),ajaxTransport:jt(Ft),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,o,r,s,a,l,c,u,h,d,p=w.ajaxSetup({},n),f=p.context||p,g=p.context&&(f.nodeType||f.jquery)?w(f):w.event,y=w.Deferred(),v=w.Callbacks("once memory"),b=p.statusCode||{},x={},_={},S="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s)for(s={};t=Pt.exec(r);)s[t[1].toLowerCase()+" "]=(s[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=s[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?r:null},setRequestHeader:function(e,t){return null==c&&(e=_[e.toLowerCase()]=_[e.toLowerCase()]||e,x[e]=t),this},overrideMimeType:function(e){return null==c&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)C.always(e[C.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||S;return i&&i.abort(t),k(0,t),this}};if(y.promise(C),p.url=((t||p.url||_t.href)+"").replace(Ot,_t.protocol+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(O)||[""],null==p.crossDomain){l=m.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Bt.protocol+"//"+Bt.host!=l.protocol+"//"+l.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=w.param(p.data,p.traditional)),Ht(Dt,p,n,C),c)return C;for(h in(u=w.event&&p.global)&&0==w.active++&&w.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!It.test(p.type),o=p.url.replace(Lt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace($t,"+")):(d=p.url.slice(o.length),p.data&&(p.processData||"string"==typeof p.data)&&(o+=(Ct.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(o=o.replace(Rt,"$1"),d=(Ct.test(o)?"&":"?")+"_="+St.guid+++d),p.url=o+d),p.ifModified&&(w.lastModified[o]&&C.setRequestHeader("If-Modified-Since",w.lastModified[o]),w.etag[o]&&C.setRequestHeader("If-None-Match",w.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||n.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Nt+"; q=0.01":""):p.accepts["*"]),p.headers)C.setRequestHeader(h,p.headers[h]);if(p.beforeSend&&(!1===p.beforeSend.call(f,C,p)||c))return C.abort();if(S="abort",v.add(p.complete),C.done(p.success),C.fail(p.error),i=Ht(Ft,p,n,C)){if(C.readyState=1,u&&g.trigger("ajaxSend",[C,p]),c)return C;p.async&&p.timeout>0&&(a=e.setTimeout((function(){C.abort("timeout")}),p.timeout));try{c=!1,i.send(x,k)}catch(e){if(c)throw e;k(-1,e)}}else k(-1,"No Transport");function k(t,n,s,l){var h,d,m,x,_,S=n;c||(c=!0,a&&e.clearTimeout(a),i=void 0,r=l||"",C.readyState=t>0?4:0,h=t>=200&&t<300||304===t,s&&(x=function(e,t,n){for(var i,o,r,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in a)if(a[o]&&a[o].test(i)){l.unshift(o);break}if(l[0]in n)r=l[0];else{for(o in n){if(!l[0]||e.converters[o+" "+l[0]]){r=o;break}s||(s=o)}r=r||s}if(r)return r!==l[0]&&l.unshift(r),n[r]}(p,C,s)),!h&&w.inArray("script",p.dataTypes)>-1&&w.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),x=function(e,t,n,i){var o,r,s,a,l,c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(r=u.shift();r;)if(e.responseFields[r]&&(n[e.responseFields[r]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(s=c[l+" "+r]||c["* "+r]))for(o in c)if((a=o.split(" "))[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[o]:!0!==c[o]&&(r=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}(p,x,C,h),h?(p.ifModified&&((_=C.getResponseHeader("Last-Modified"))&&(w.lastModified[o]=_),(_=C.getResponseHeader("etag"))&&(w.etag[o]=_)),204===t||"HEAD"===p.type?S="nocontent":304===t?S="notmodified":(S=x.state,d=x.data,h=!(m=x.error))):(m=S,!t&&S||(S="error",t<0&&(t=0))),C.status=t,C.statusText=(n||S)+"",h?y.resolveWith(f,[d,S,C]):y.rejectWith(f,[C,S,m]),C.statusCode(b),b=void 0,u&&g.trigger(h?"ajaxSuccess":"ajaxError",[C,p,h?d:m]),v.fireWith(f,[C,S]),u&&(g.trigger("ajaxComplete",[C,p]),--w.active||w.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],(function(e,t){w[t]=function(e,n,i,o){return f(n)&&(o=o||i,i=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:o,data:n,success:i},w.isPlainObject(e)&&e))}})),w.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),w._evalUrl=function(e,t,n){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){w.globalEval(e,t,n)}})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(f(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return f(e)?this.each((function(t){w(this).wrapInner(e.call(this,t))})):this.each((function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=f(e);return this.each((function(n){w(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){w(this).replaceWith(this.childNodes)})),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var zt={0:200,1223:204},Vt=w.ajaxSettings.xhr();p.cors=!!Vt&&"withCredentials"in Vt,p.ajax=Vt=!!Vt,w.ajaxTransport((function(t){var n,i;if(p.cors||Vt&&!t.crossDomain)return{send:function(o,r){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)a.setRequestHeader(s,o[s]);n=function(e){return function(){n&&(n=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(zt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),i=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout((function(){n&&i()}))},n=n("abort");try{a.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}})),w.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),w.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(i,o){t=w("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),m.head.appendChild(t[0])},abort:function(){n&&n()}}}));var Gt,Ut=[],qt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ut.pop()||w.expando+"_"+St.guid++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",(function(t,n,i){var o,r,s,a=!1!==t.jsonp&&(qt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&qt.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=f(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(qt,"$1"+o):!1!==t.jsonp&&(t.url+=(Ct.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return s||w.error(o+" was not called"),s[0]},t.dataTypes[0]="json",r=e[o],e[o]=function(){s=arguments},i.always((function(){void 0===r?w(e).removeProp(o):e[o]=r,t[o]&&(t.jsonpCallback=n.jsonpCallback,Ut.push(o)),s&&f(r)&&r(s[0]),s=r=void 0})),"script"})),p.createHTMLDocument=((Gt=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Gt.childNodes.length),w.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(p.createHTMLDocument?((i=(t=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,t.head.appendChild(i)):t=m),r=!n&&[],(o=T.exec(e))?[t.createElement(o[1])]:(o=xe([e],t,r),r&&r.length&&w(r).remove(),w.merge([],o.childNodes)));var i,o,r},w.fn.load=function(e,t,n){var i,o,r,s=this,a=e.indexOf(" ");return a>-1&&(i=mt(e.slice(a)),e=e.slice(0,a)),f(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),s.length>0&&w.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done((function(e){r=arguments,s.html(i?w("<div>").append(w.parseHTML(e)).find(i):e)})).always(n&&function(e,t){s.each((function(){n.apply(this,r||[e.responseText,t,e])}))}),this},w.expr.pseudos.animated=function(e){return w.grep(w.timers,(function(t){return e===t.elem})).length},w.offset={setOffset:function(e,t,n){var i,o,r,s,a,l,c=w.css(e,"position"),u=w(e),h={};"static"===c&&(e.style.position="relative"),a=u.offset(),r=w.css(e,"top"),l=w.css(e,"left"),("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1?(s=(i=u.position()).top,o=i.left):(s=parseFloat(r)||0,o=parseFloat(l)||0),f(t)&&(t=t.call(e,n,w.extend({},a))),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+o),"using"in t?t.using.call(e,h):u.css(h)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){w.offset.setOffset(this,e,t)}));var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],o={top:0,left:0};if("fixed"===w.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((o=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),o.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-o.top-w.css(i,"marginTop",!0),left:t.left-o.left-w.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||ie}))}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;w.fn[e]=function(i){return W(this,(function(e,i,o){var r;if(g(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===o)return r?r[t]:e[i];r?r.scrollTo(n?r.pageXOffset:o,n?o:r.pageYOffset):e[i]=o}),e,i,arguments.length)}})),w.each(["top","left"],(function(e,t){w.cssHooks[t]=Ge(p.pixelPosition,(function(e,n){if(n)return n=Ve(e,t),Fe.test(n)?w(e).position()[t]+"px":n}))})),w.each({Height:"height",Width:"width"},(function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,i){w.fn[i]=function(o,r){var s=arguments.length&&(n||"boolean"!=typeof o),a=n||(!0===o||!0===r?"margin":"border");return W(this,(function(t,n,o){var r;return g(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===o?w.css(t,n,a):w.style(t,n,o,a)}),t,s?o:void 0,s)}}))})),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){w.fn[t]=function(e){return this.on(t,e)}})),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var Kt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;w.proxy=function(e,t){var n,i,r;if("string"==typeof t&&(n=e[t],t=e,e=n),f(e))return i=o.call(arguments,2),r=function(){return e.apply(t||this,i.concat(o.call(arguments)))},r.guid=e.guid=e.guid||w.guid++,r},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=M,w.isFunction=f,w.isWindow=g,w.camelCase=U,w.type=b,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},w.trim=function(e){return null==e?"":(e+"").replace(Kt,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return w}));var Yt=e.jQuery,Xt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Xt),t&&e.jQuery===w&&(e.jQuery=Yt),w},void 0===t&&(e.jQuery=e.$=w),w})),
/*! Toxilib css_injector
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/css_injector",[],(function(){return function(e){"file"in e&&(e.files=[e.file]);const{callback:t,files:n}=e;return new Promise((i=>{!function(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}((function(){void 0===n?(!function(e){let t=document.createElement("style");t.appendChild(document.createTextNode("")),document.head.appendChild(t);let n=t.sheet;for(let t in e){let i=e[t],o="";if("string"==typeof i)o=i;else for(let e in i)o+=`${e}: ${i[e]};`;n.insertRule(`${t} { ${o} }`,0)}}(e),i()):function(e,t){let n=function(e){let t={};return e.forEach((e=>{t[e]=!0})),t}(e);function i(e){delete n[e],t&&0===Object.keys(n).length&&t()}e.forEach((e=>function(e,t){let{head:n}=document,i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,t&&(i.onload=function(){t(e)});n.appendChild(i)}(e,i)))}(n,(()=>{t&&t(),i()}))}))}))}})),function(){function e(e,t){document.addEventListener?e.addEventListener("scroll",t,!1):e.attachEvent("scroll",t)}function t(e){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(e)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function n(e,t){e.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+t+";"}function i(e){var t=e.g.offsetWidth,n=t+100;return e.j.style.width=n+"px",e.i.scrollLeft=n,e.h.scrollLeft=e.h.scrollWidth+100,e.l!==t&&(e.l=t,!0)}function o(t,n){function o(){var e=r;i(e)&&null!==e.g.parentNode&&n(e.l)}var r=t;e(t.h,o),e(t.i,o),i(t)}function r(e,t,n){t=t||{},n=n||window,this.family=e,this.style=t.style||"normal",this.weight=t.weight||"normal",this.stretch=t.stretch||"normal",this.context=n}var s=null,a=null,l=null,c=null;function u(e){return null===c&&(c=!!e.document.fonts),c}function h(e,t){var n=e.style,i=e.weight;if(null===l){var o=document.createElement("div");try{o.style.font="condensed 100px sans-serif"}catch(e){}l=""!==o.style.font}return[n,i,l?e.stretch:"","100px",t].join(" ")}r.prototype.load=function(e,i){var r=this,l=e||"BESbswy",c=0,d=i||3e3,p=(new Date).getTime();return new Promise((function(e,i){if(u(r.context)&&!function(e){return null===a&&(u(e)&&/Apple/.test(window.navigator.vendor)?(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),a=!!e&&603>parseInt(e[1],10)):a=!1),a}(r.context)){var f=new Promise((function(e,t){!function n(){(new Date).getTime()-p>=d?t(Error(d+"ms timeout exceeded")):r.context.document.fonts.load(h(r,'"'+r.family+'"'),l).then((function(t){1<=t.length?e():setTimeout(n,25)}),t)}()})),g=new Promise((function(e,t){c=setTimeout((function(){t(Error(d+"ms timeout exceeded"))}),d)}));Promise.race([g,f]).then((function(){clearTimeout(c),e(r)}),i)}else!function(e){document.body?e():document.addEventListener?document.addEventListener("DOMContentLoaded",(function t(){document.removeEventListener("DOMContentLoaded",t),e()})):document.attachEvent("onreadystatechange",(function t(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",t),e())}))}((function(){function a(){var t;(t=-1!=m&&-1!=y||-1!=m&&-1!=v||-1!=y&&-1!=v)&&((t=m!=y&&m!=v&&y!=v)||(null===s&&(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),s=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))),t=s&&(m==b&&y==b&&v==b||m==x&&y==x&&v==x||m==w&&y==w&&v==w)),t=!t),t&&(null!==_.parentNode&&_.parentNode.removeChild(_),clearTimeout(c),e(r))}var u=new t(l),f=new t(l),g=new t(l),m=-1,y=-1,v=-1,b=-1,x=-1,w=-1,_=document.createElement("div");_.dir="ltr",n(u,h(r,"sans-serif")),n(f,h(r,"serif")),n(g,h(r,"monospace")),_.appendChild(u.g),_.appendChild(f.g),_.appendChild(g.g),r.context.document.body.appendChild(_),b=u.g.offsetWidth,x=f.g.offsetWidth,w=g.g.offsetWidth,function e(){if((new Date).getTime()-p>=d)null!==_.parentNode&&_.parentNode.removeChild(_),i(Error(d+"ms timeout exceeded"));else{var t=r.context.document.hidden;!0!==t&&void 0!==t||(m=u.g.offsetWidth,y=f.g.offsetWidth,v=g.g.offsetWidth,a()),c=setTimeout(e,50)}}(),o(u,(function(e){m=e,a()})),n(u,h(r,'"'+r.family+'",sans-serif')),o(f,(function(e){y=e,a()})),n(f,h(r,'"'+r.family+'",serif')),o(g,(function(e){v=e,a()})),n(g,h(r,'"'+r.family+'",monospace'))}))}))},"function"==typeof define&&define.amd?define("toxilibs/extlibs/fontfaceobserver-2.3.0.min",[],(function(){return r})):"undefined"!=typeof module&&module.exports?module.exports=r:(window.FontFaceObserver=r,window.FontFaceObserver.prototype.load=r.prototype.load)}(),define("render/font_loader",["toxilibs/css_injector","toxilibs/extlibs/fontfaceobserver-2.3.0.min"],(function(e,t){const n=new Set;function i({local:e,urls:t}){let n=[];return e&&n.push(`local(${e})`),t.forEach((e=>n.push(`url("${e}")`))),n.join(", ")}function o({name:e,url:t}){if(!n.has(e)){n.add(e);const i=window.document.createElement("link");i.rel="stylesheet",i.href=t,window.document.getElementsByTagName("head")[0].appendChild(i)}return r(e)}function r(e){return new t(e).load()}return async function({local:t,googleFont:n,url:s=[],urls:a=s,name:l=t,style:c="normal",weight:u=400}={}){if(n)return o({name:n,url:`https://fonts.googleapis.com/css2?family=${n.replace(" ","+")}`});if(!l)throw new Error('loadFont must have a "name" param');return"string"==typeof a&&(a=[a]),1===a.length&&a[0].includes("css")?o({name:l,url:a[0]}):(await e({"@font-face":{"font-family":`"${l}"`,"font-style":c,"font-weight":u,src:i({local:t,urls:a})}}),r(l))}})),define("render/load_default_fonts",["./font_loader"],(function(e){return function(){let t=window.discoveryAssetsPath||"./assets/",n=e({name:"FontAwesomeForScreen",urls:[`${t}webfonts/fa-solid-900.woff2?no-cache=${Math.random()}`,`${t}webfonts/fa-solid-900.woff?no-cache=${Math.random()}`]}),i=e({name:"Nasalization",urls:[`${t}webfonts/nasalization.ttf`]});return Promise.all([n,i])}})),
/*! Toxilib dom_resize_listener
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/dom_resize_listener",[],(function(){let e=new Map;const t=new ResizeObserver((t=>{for(let n of t){const{target:t}=n,{width:i,height:o}=n.contentRect,r=e.get(t);r&&r({width:i,height:o,element:t})}}));return function(n,i){t.observe(n),e.set(n,i)}})),define("libs/collection",[],(function(){let e=["create","find","update","destroy"];function t({name:t,indexedKey:i,uniqueness:o,Constructor:r=Object}){var s;this.name=t,this.indexedKey=i,this.uniqueness=o,this.Constructor=r,this.items={},this.validations={},s=this.validations,e.forEach((function(e){s[e]=[]})),this.uniqueness&&this.addValidation("create",n)}function n(e,t){let n=t[e.indexedKey];if(n in e.items)throw new Error(`${e.name} ${n} already exists`)}function i(e,t){if(void 0===e.validations[t])throw new Error(`Collection ${e.name} - Unknown validation type : ${t}`)}return t.prototype.create=function(e){this.runValidations("create",e);let t=new this.Constructor(e),n=t[this.indexedKey];return this.items[n]=t,t},t.prototype.find=function(e){return this.runValidations("find",e),this.items[e]},t.prototype.destroy=function(e){this.runValidations("destroy",e),this.find(e)&&delete this.items[e]},t.prototype.addValidation=function(e,t){i(this,e),this.validations[e].push(t)},t.prototype.runValidations=function(e,t){i(this,e),this.validations[e].forEach((function(e){e(this,t)}),this)},t})),define("libs/swap_view_capabilities",[],(function(){return function(e){e.currentView=null,e.openView=function(t){let n=e.find(t);return e.currentView===n||(e.currentView&&e.currentView.hide(),e.currentView=n,n.show()),n},e.closeView=function(t){let n=e.find(t);return n===e.currentView&&delete e.currentView,n.hide(),n}}})),
/*!
 * jQuery Mousewheel 3.1.13
 * Copyright OpenJS Foundation and other contributors
 */
function(e){"function"==typeof define&&define.amd?define("toxilibs/extlibs/jquery.mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}((function(e){var t,n,i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel"in window.document||window.document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],r=Array.prototype.slice;if(e.event.fixHooks)for(var s=i.length;s;)e.event.fixHooks[i[--s]]=e.event.mouseHooks;var a=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=o.length;t;)this.addEventListener(o[--t],l,!1);else this.onmousewheel=l;e.data(this,"mousewheel-line-height",a.getLineHeight(this)),e.data(this,"mousewheel-page-height",a.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=o.length;t;)this.removeEventListener(o[--t],l,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),i=n["offsetParent"in e.fn?"offsetParent":"parent"]();return i.length||(i=e("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function l(i){var o,s=i||window.event,l=r.call(arguments,1),h=0,d=0,p=0;if((i=e.event.fix(s)).type="mousewheel","detail"in s&&(p=-1*s.detail),"wheelDelta"in s&&(p=s.wheelDelta),"wheelDeltaY"in s&&(p=s.wheelDeltaY),"wheelDeltaX"in s&&(d=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(d=-1*p,p=0),h=0===p?d:p,"deltaY"in s&&(h=p=-1*s.deltaY),"deltaX"in s&&(d=s.deltaX,0===p&&(h=-1*d)),0!==p||0!==d){if(1===s.deltaMode){var f=e.data(this,"mousewheel-line-height");h*=f,p*=f,d*=f}else if(2===s.deltaMode){var g=e.data(this,"mousewheel-page-height");h*=g,p*=g,d*=g}if(o=Math.max(Math.abs(p),Math.abs(d)),(!n||o<n)&&(n=o,u(s,o)&&(n/=40)),u(s,o)&&(h/=40,d/=40,p/=40),h=Math[h>=1?"floor":"ceil"](h/n),d=Math[d>=1?"floor":"ceil"](d/n),p=Math[p>=1?"floor":"ceil"](p/n),a.settings.normalizeOffset&&this.getBoundingClientRect){var m=this.getBoundingClientRect();i.offsetX=i.clientX-m.left,i.offsetY=i.clientY-m.top}return i.deltaX=d,i.deltaY=p,i.deltaFactor=n,i.deltaMode=0,l.unshift(i,h,d,p),t&&window.clearTimeout(t),t=window.setTimeout(c,200),(e.event.dispatch||e.event.handle).apply(this,l)}}function c(){n=null}function u(e,t){return a.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}e.fn.extend({mousewheel:function(e){return e?this.on("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.off("mousewheel",e)}})})),
/*! Toxilib screen_mouse_control
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_mouse_control",["jquery","./extlibs/jquery.mousewheel"],(function(e){function t(t,{scaleVelocity:a=1,minScale:l=.001,maxScale:c=1e3,disableDrag:u,preHook:h,onMove:d=()=>{},onDragStart:p=()=>{},onDragEnd:f=()=>{}}={}){"mouseEventToCoords"in t?(this.screen=t,this.$container=e(this.screen.container||this.screen.canvas)):this.$container=t,this.preHook=h,this.onMove=d,this.onDragStart=p,this.onDragEnd=f,this.minScale=l,this.maxScale=c,Object.defineProperty(this,"scaleVelocity",{get:()=>a,set:e=>{a=e,this.mouseWheelScaleVelocity=.15*a},enumerable:!0}),this.scaleVelocity=a,this.$container.css("touch-action","none"),function(t){let r,a,l,c=0,{$container:u,preHook:h}=t;const d=e("body");let p={};function f(){if(n(t)||!t.screen)return;let e=Object.values(p)[0];c=0,r=t.screen.eventToCoords(e)}function g(e){!n(t)&&r&&(e.preventDefault(),c+=1,o(t.screen,e,r),i(t),4===c&&t.onDragStart())}function m(e){e&&e.preventDefault(),r=!1,c>4&&t.onDragEnd(),c=0}function y(e){if(t.zoomExternallyDisabled||!t.screen)return;e&&e.preventDefault();let[n,i]=Object.values(p);r=t.screen.eventToCoords(b(n,i)),a=s(n,i),l=t.screen.scale}function v(e){if(t.zoomExternallyDisabled||!t.screen)return;e.preventDefault();let[n,c]=Object.values(p),u=s(n,c);t.screen.setScale(l*u/a),o(t.screen,b(n,c),r),i(t)}function b(e,t){return{clientX:(e.clientX+t.clientX)/2,clientY:(e.clientY+t.clientY)/2}}u.on("pointerdown",(function(t){if(h&&!h(t))return;p[t.pointerId]=t;let n=Object.values(p).length;1===n&&(e(":focus").blur(),f()),2===n&&(m(t),y(t))})),d.on("pointermove",(function(e){if(h&&!h(e))return;p[e.pointerId]=e;let t=Object.keys(p).length;1===t&&g(e),2===t&&v(e)})),d.on("pointerup",(function(e){if(delete p[e.pointerId],h&&!h(e))return;let t=Object.keys(p).length;0===t&&m(),1===t&&f(),2===t&&y()}))}(this),function(e){let{$container:t}=e;t.on("mousewheel",(function(t){let{screen:n,mouseWheelScaleVelocity:s,zoomExternallyDisabled:a,preHook:l}=e;if(!n||a)return;if(l&&!l(t))return;t.preventDefault();const c=n.mouseEventToCoords(t),u=function({event:e,mouseWheelScaleVelocity:t}){let{deltaY:n}=e,i=1+t*Math.pow(Math.abs(n),.02);n<0&&(i=1/i);return i}({event:t,mouseWheelScaleVelocity:s});r(e,u),o(n,t,c),i(e)}))}(this),function(e){const{screen:t}=e;if(!t)return;t.internalEventBus.on("selection initiated",(()=>{e.dragInternallyDisabled=!0})),t.internalEventBus.on("selection created",(()=>{e.dragInternallyDisabled=!1})),t.internalEventBus.on("selection aborted",(()=>{e.dragInternallyDisabled=!1}))}(this),this.screen&&r(this,1),this.dragExternallyDisabled=u}function n({dragInternallyDisabled:e,dragExternallyDisabled:t,screen:n}){return e||t||!n}function i(e){e.onMove(),e.screen.internalEventBus.emit("camera moved")}function o(e,t,n){let{x:i,y:o}=e.eventToCoords(t);e.translateCenter({x:n.x-i,y:n.y-o})}function r(e,t){let{screen:n,minScale:i,maxScale:o}=e,r=(s=n.scale*t,a=i,l=o,Math.max(Math.min(s,l),a));var s,a,l;n.setScale(r)}function s(e,t){const n=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(n*n+i*i)}return t.prototype.enableDrag=function(){this.dragExternallyDisabled=!1},t.prototype.disableDrag=function(){this.dragExternallyDisabled=!0},t.prototype.enableZoom=function(){this.zoomExternallyDisabled=!1},t.prototype.disableZoom=function(){this.zoomExternallyDisabled=!0},t})),define("render/camera_control",["event_bus","toxilibs/screen_mouse_control"],(function(e,t){return function({$uiContainer:n,renderViews:i}){let o,r=new t(n,{preHook:e=>e.target.classList.contains("transmit_mouse_to_screen"),onMove:function(){const{currentView:e}=i;e&&(e.synchronizeCamera(),e.hybridScreen.onCameraMoved());clearTimeout(o),Date.now()-s>200?a():o=setTimeout(a,100)},onDragStart:()=>n.addClass("drag_mode"),onDragEnd:()=>n.removeClass("drag_mode")}),s=0;function a(){const{currentView:t}=i;t&&(s=Date.now(),e.emit("camera moved throttled",t.screenStateParams()))}return r.followScreenState=function({path:e,xMin:t,xMax:n,yMin:o,yMax:r}){let s=i.find(e);s&&s.setOptimalCamera([{x:t,y:o},{x:n,y:r}],{delay:300})},r}})),
/*! Toxilib alias
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/alias",[],(function(){function e({target:e,originalName:n,proxy:i=e,alias:o=n,writable:r,configurable:s,fastMode:a}){if(i===e&&o===n)return;const l={enumerable:!0,configurable:s};let c=t(i,e,e[n]);l.get=a?c?()=>c:()=>e[n]:()=>t(i,e,e[n])||e[n],!1!==r&&(l.set=function(t){e[n]=t}),Object.defineProperty(i,o,l)}function t(e,t,n){return"function"==typeof n&&e!==t&&n.bind(t)}return function(t){let{key:n,keys:i,proxy:o}=t;if("string"==typeof n)if(o){let{target:i,writable:r,fastMode:s,configurable:a}=t;e({proxy:o,target:i,writable:r,configurable:a,fastMode:s,originalName:n})}else console.warn('Alias : "key" param is a simple string -> "proxy" param should be specified !');else i instanceof Array?o?function({proxy:t,target:n,writable:i,configurable:o,fastMode:r},s){s.forEach((s=>{e({proxy:t,target:n,writable:i,configurable:o,fastMode:r,originalName:s})}))}(t,i):console.warn('Alias : "keys" param is a simple array -> "proxy" param should be specified !'):function({proxy:t,target:n,writable:i,configurable:o,fastMode:r},s){for(let a in s)("string"==typeof s[a]?[s[a]]:s[a]).forEach((s=>{e({proxy:t,target:n,writable:i,configurable:o,alias:s,fastMode:r,originalName:a})}))}(t,i||n)}})),
/*! Toxilib color_oklab
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/color_oklab",[],(function(){function e({red:e,green:t,blue:n}){e=p(e),t=p(t),n=p(n);const i=Math.cbrt(.4122214708*e+.5363325363*t+.0514459929*n),o=Math.cbrt(.2119034982*e+.6806995451*t+.1073969566*n),r=Math.cbrt(.0883024619*e+.2817188376*t+.6299787005*n),s=.2104542553*i+.793617785*o-.0040720468*r,a=1.9779984951*i-2.428592205*o+.4505937099*r,l=.0259040371*i+.7827717662*o-.808675766*r,c=Math.sqrt(a*a+l*l);let u=Math.atan2(l,a)/(2*Math.PI);return u<0&&(u+=1),{L:s,a:a,b:l,C:c,h:u}}function t(e){const{red:t,green:n,blue:o}=i(e),{opacity:r=1}=e;return{red:g(t),green:g(n),blue:g(o),opacity:r}}const n=.3125;function i({L:e,a:t,b:n,C:i,h:r=!1}){if(!1!==r){let e=2*r*Math.PI;t=i*Math.cos(e),n=i*Math.sin(e)}let s=e+.3963377774*t+.2158037573*n,a=e-.1055613458*t-.0638541728*n,l=e-.0894841775*t-1.291485548*n;return s*=s*s,a*=a*a,l*=l*l,o(s,a,l)}function o(e,t,n){return{red:4.0767416621*e-3.3077115913*t+.2309699292*n,green:-1.2684380046*e+2.6097574011*t-.3413193965*n,blue:-.0041960863*e-.7034186147*t+1.707614701*n}}function r(e,t,n){const i=s(t,n);let r=function(e,t,n,i,r,a=s(e,t)){const[l,c]=a;let u;if((n-r)*c-(l-r)*i<=0)u=c*r/(i*l+c*(r-n));else{u=c*(r-1)/(i*(l-1)+c*(r-n));{let s=n-r,a=.3963377774*e+.2158037573*t,l=-.1055613458*e-.0638541728*t,c=-.0894841775*e-1.291485548*t,h=s+i*a,d=s+i*l,p=s+i*c;{let e=r*(1-u)+u*n,t=u*i,s=e+t*a,f=e+t*l,g=e+t*c,m=s*s*s,y=f*f*f,v=g*g*g,b=3*h*s*s,x=3*d*f*f,w=3*p*g*g,_=6*h*h*s,S=6*d*d*f,C=6*p*p*g,{red:k,green:A,blue:M}=o(m,y,v);k-=1,A-=1,M-=1;let{red:T,green:E,blue:$}=o(b,x,w),{red:L,green:R,blue:P}=o(_,S,C),I=1/(T-.5*k*L/T),O=I<0?1e6:-k*I,D=1/(E-.5*A*R/E),F=D<0?1e6:-A*D,N=1/($-.5*M*P/$),B=N<0?1e6:-M*N;u+=Math.min(O,F,B)}}}return u}(t,n,e,1,e,i),a=d(t,n,i);let l=e*(.11516993+1/(7.4477897+4.1590124*n+t*(1.75198401*n-2.19557347+t*(-2.13704948-10.02301043*n+t*(5.38770819*n-4.24894561+4.69891013*t))))),c=(1-e)*(.11239642+1/(1.6132032-.68124379*n+t*(.40370612+.90148123*n+t*(.6122399*n-.27087943+t*(.00299215-.45399568*n-.14661872*t)))));const u=1/(1/(l*l*l*l)+1/(c*c*c*c));let h=.9*(r/Math.min(e*a[0],(1-e)*a[1]))*Math.sqrt(Math.sqrt(u));l=.4*e,c=.8*(1-e);const p=1/(l*l)+1/(c*c);return{C0:Math.sqrt(1/p),Cmid:h,Cmax:r}}function s(e,t){let n=function(e,t){let n,i,o,r,s,a,l,c;-1.88170328*e-.80936493*t>1?(n=1.19086277,i=1.76576728,o=.59662641,r=.75515197,s=.56771245,a=4.0767416621,l=-3.3077115913,c=.2309699292):1.81444104*e-1.19445276*t>1?(n=.73956515,i=-.45954404,o=.08285427,r=.1254107,s=.14503204,a=-1.2684380046,l=2.6097574011,c=-.3413193965):(n=1.35733652,i=-.00915799,o=-1.1513021,r=-.50559606,s=.00692167,a=-.0041960863,l=-.7034186147,c=1.707614701);let u=n+i*e+o*t+r*e*e+s*e*t,h=.3963377774*e+.2158037573*t,d=-.1055613458*e-.0638541728*t,p=-.0894841775*e-1.291485548*t;{let e=1+u*h,t=1+u*d,n=1+u*p,i=a*(e*e*e)+l*(t*t*t)+c*(n*n*n),o=a*(3*h*e*e)+l*(3*d*t*t)+c*(3*p*n*n);u-=i*o/(o*o-.5*i*(a*(6*h*h*e)+l*(6*d*d*t)+c*(6*p*p*n)))}return u}(e,t);const{red:o,green:r,blue:s}=i({L:1,a:n*e,b:n*t});let a=Math.cbrt(1/Math.max(o,r,s));return[a,a*n]}const a=.206,l=.03,c=1.1708737864;function u(e){let t=c*e-a;return.5*(t+Math.sqrt(t*t+4*l*c*e))}function h(e){return e*(e+a)/(c*(e+l))}function d(e,t,n=s(e,t)){const[i,o]=n;return[o/i,o/(1-i)]}function p(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}const f=1/2.4;function g(e){return e<0?0:e<=.0031308?12.92*e:Math.min(1,1.055*Math.pow(e,f)-.055)}return{convertRGBToOkLab:e,convertRGBToOkHSL:function(t){let{L:i,a:o,b:s,C:a,h:l}=e(t),c=o/a,h=s/a;const{C0:d,Cmid:p,Cmax:f}=r(i,c,h);let g;if(a<p){let e=.8*d;g=.8*(a/(e+(1-e/p)*a))}else{let e=p*p*n/d;g=.8+.2*((a-p)/(e+(1-e)/(f-p)*(a-p)))}return{hue:l,saturation:g,lightness:u(i)}},convertRGBToOkHSV:function(t){let{L:n,a:o,b:r,C:s,h:a}=e(t);if(0===n)return{hue:0,saturation:0,value:0};let l=o/s,c=r/s,[p,f]=d(l,c),g=1-.5/p,m=f/(s+n*f),y=m*n,v=m*s,b=h(y),x=v*b/y,{red:w,green:_,blue:S}=i({L:b,a:l*x,b:c*x}),C=Math.cbrt(1/Math.max(w,_,S,0));return n/=C,s/=C,s=s*u(n)/n,n=u(n),{hue:a,saturation:(.5+f)*v/(.5*f+f*g*v),value:n/y}},convertOkLabToRGB:t,convertOkHSVToRGB:function({hue:e,saturation:n,value:o,opacity:r=1}){if(o<.003)return{red:0,green:0,blue:0};const s=2*Math.PI*e,a=Math.cos(s),l=Math.sin(s);let c=d(a,l),u=c[0],p=.5,f=c[1],g=1-p/u,m=1-n*p/(p+f-f*g*n),y=n*f*p/(p+f-f*g*n),v=o*m,b=o*y,x=h(m),w=y*x/m,_=h(v);b=b*_/v,v=_;let{red:S,green:C,blue:k}=i({L:x,a:a*w,b:l*w}),A=Math.cbrt(1/Math.max(S,C,k,0));return v*=A,b*=A,t({L:v,a:b*a,b:b*l,opacity:r})},convertOkHSLToRGB:function({hue:e,saturation:i=.9,lightness:o=.7,opacity:s=1}){if(o>.997)return{red:1,green:1,blue:1};if(o<.003)return{red:0,green:0,blue:0};const a=2*Math.PI*e,l=Math.cos(a),c=Math.sin(a),u=h(o),{C0:d,Cmid:p,Cmax:f}=r(u,l,c);let g,m,y,v;i<.8?(g=1.25*i,m=0,y=.8*d,v=1-y/p):(g=5*(i-.8),m=p,y=n*p*p/d,v=1-y/(f-p));let b=m+g*y/(1-v*g);return t({L:u,a:b*l,b:b*c,opacity:s})},distance:function(e,t){const n=e.L-t.L,i=e.a-t.a,o=e.b-t.b;return Math.sqrt(n*n+i*i+o*o)},deltaE2000:function(e,t){let{L:n,a:i,b:o}=e,{L:r,a:s,b:a}=t,l=(Math.sqrt(i**2+o**2)+Math.sqrt(s**2+a**2))/2,c=Math.pow(l,7);const u=Math.pow(25,7);let h=.5*(1-Math.sqrt(c/(c+u))),d=(1+h)*i,p=(1+h)*s,f=Math.sqrt(d**2+o**2),g=Math.sqrt(p**2+a**2);const m=Math.PI,y=180/m,v=m/180;let b=0===d&&0===o?0:Math.atan2(o,d),x=0===p&&0===a?0:Math.atan2(a,p);b<0&&(b+=2*m),x<0&&(x+=2*m),b*=y,x*=y;let w,_=r-n,S=g-f,C=x-b,k=b+x,A=Math.abs(C);f*g==0?w=0:A<=180?w=C:C>180?w=C-360:C<-180?w=C+360:console.log("the unthinkable has happened");let M,T=2*Math.sqrt(g*f)*Math.sin(w*v/2),E=(n+r)/2,$=(f+g)/2,L=Math.pow($,7);M=0===f&&0===g?k:A<=180?k/2:k<360?(k+360)/2:(k-360)/2;let R=(E-50)**2,P=1+.015*R/Math.sqrt(20+R),I=1+.045*$,O=1;O-=.17*Math.cos((M-30)*v),O+=.24*Math.cos(2*M*v),O+=.32*Math.cos((3*M+6)*v),O-=.2*Math.cos((4*M-63)*v);let D=1+.015*$*O,F=30*Math.exp(-1*((M-275)/25)**2),N=2*Math.sqrt(L/(L+u)),B=(_/P)**2;return B+=(S/I)**2,B+=(T/D)**2,B+=-1*Math.sin(2*F*v)*N*(S/I)*(T/D),Math.sqrt(B)}}})),
/*! Toxilib color
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/color",["./color_oklab"],(function(e){const{convertRGBToOkLab:t,convertRGBToOkHSL:n,convertRGBToOkHSV:i,convertOkLabToRGB:o,convertOkHSLToRGB:r,convertOkHSVToRGB:s,distance:a,deltaE2000:l}=e;function c(e,t,n,i=1){const o=typeof e;"number"===o?(this.rgbValues={red:e,green:t,blue:n},this.opacity=i,this.perceptual=!0):"object"===o?function(e,t){const{opacity:n=1,perceptual:i=!0}=t;e.opacity=n,e.perceptual=i,"red"in t?e.rgbValues={red:t.red,green:t.green,blue:t.blue}:"hue"in t?function(e,t){if(e.perceptual){let{hue:n,saturation:i=.9,lightness:o=.7}=t;e.hslValues={hue:n,saturation:i,lightness:o}}else!function(e,{hue:t,saturation:n=1,lightness:i=.5}){(t>1||t<0)&&(t-=Math.floor(t));n=P(n),i=P(i),e.hslValues={hue:t,saturation:n,lightness:i}}(e,t)}(e,t):"light"in t?u(e,t.light):"red255"in t?function(e,{red255:t,green255:n,blue255:i}){e.rgbValues={red:t/255,green:n/255,blue:i/255}}(e,t):function(e,t){if("lightLinear"in t){u(e,S(t.lightLinear))}else{if(!("redLinear"in t))throw new Error("Invalid parameters used to create a color");e.rgbValues={red:S(t.redLinear),green:S(t.greenLinear),blue:S(t.blueLinear)}}}(e,t)}(this,e):function(e,t){const{red:n,green:i,blue:o,opacity:r}=E(t);e.rgbValues={red:n,green:i,blue:o},e.opacity=r,e.perceptual=!0}(this,e)}function u(e,t){e.rgbValues=f(t)}function h(e){return function({x:e,y:t,z:n}){return n/=1.08883,e=(e/=.95047)>.008856?Math.pow(e,1/3):(903.3*e+16)/116,t=t>.008856?Math.pow(t,1/3):(903.3*t+16)/116,n=n>.008856?Math.pow(n,1/3):(903.3*n+16)/116,{L:116*t-16,a:500*(e-t),b:200*(t-n)}}(A(e))}function d(e){return function({x:e,y:t,z:n}){return n/=.8249,e=(e/=.9642)>.008856?Math.pow(e,1/3):(903.3*e+16)/116,t=t>.008856?Math.pow(t,1/3):(903.3*t+16)/116,n=n>.008856?Math.pow(n,1/3):(903.3*n+16)/116,{L:116*t-16,a:500*(e-t),b:200*(t-n)}}(function({red:e,green:t,blue:n}){return e=w(e),t=w(t),n=w(n),{x:.4360747*e+.3850649*t+.1430804*n,y:.2225045*e+.7168786*t+.0606169*n,z:.0139322*e+.0971045*t+.7141733*n}}(e))}function p(e,t){return(e%t+t)%t}function f(e){return{red:e,green:e,blue:e}}function g(e){return{red:e=x(e),green:e,blue:e}}function m({red:e,green:t,blue:n}){const i=Math.max(e,t,n),o=Math.min(e,t,n),r=(i+o)/2,s=i-o;if(0===s)return{hue:0,saturation:0,lightness:r};{const a=function(e,t,n,i){return e>.5?t/(2-i-n):t/(i+n)}(r,s,o,i),l=function(e,t,n,i,o){if(e===i)return(4+(t-n)/o)/6;if(e===n)return(2+(i-t)/o)/6;if(n<i)return 1+(n-i)/(6*o);return(n-i)/(6*o)}(i,e,t,n,s);return{hue:l,saturation:a,lightness:r}}}function y({hue:e,saturation:t=1,lightness:n=.5}){(e>1||e<0)&&(e-=Math.floor(e)),t=P(t);const i=M(n=P(n),t),o=2*n-i;return{red:T(o,i,(e*=6)+2),green:T(o,i,e),blue:T(o,i,e-2)}}function v({hue:e,saturation:t,lightness:n}){const i=M(n,t),o=2*n-i;return{red:x(T(o,i,(e*=6)+2)),green:x(T(o,i,e)),blue:x(T(o,i,e-2))}}function b({red:e,green:t,blue:n}){return{red:x(e),green:x(t),blue:x(n)}}function x(e){return Math.floor(255.999*e)}function w(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}c.createFromOklab=function(e){return new c(o(e))},c.createFromOkHSL=function(e){return new c(r(e))},c.createFromOkHSV=function(e){return new c(s(e))},c.autoConvertToRGB=function(e,t,n){const i=typeof e;return"object"===i?function(e){if("red"in e)return e;if("hue"in e)return e.perceptual?r(e):y(e);if("red255"in e)return{red:e.red255/255,green:e.green255/255,blue:e.blue255/255};if("light"in e)return f(e.light);if("lightLinear"in e)return f(S(e.lightLinear));if("redLinear"in e)return{red:S((t=e).redLinear),green:S(t.greenLinear),blue:S(t.blueLinear)};var t;return null}(e):"string"===i?E(e):{red:e,green:t,blue:n}},c.convertHexToRGB=L,c.convertCSSToRGB=E,c.autoConvertToRGB255=function(e,t,n){const i=typeof e;if("object"===i){if("red"in e)return b(e);if("red255"in e)return{red:e.red255,green:e.green255,blue:e.blue255};if("hue"in e)return function({hue:e,saturation:t=1,lightness:n=.5,perceptual:i=!0}){(e>1||e<0)&&(e-=Math.floor(e));if(t=P(t),n=P(n),i)return b(r({hue:e,saturation:t,lightness:n}));{const i=M(n,t),o=2*n-i;return{red:x(T(o,i,(e*=6)+2)),green:x(T(o,i,e)),blue:x(T(o,i,e-2))}}}(e);if("light"in e)return g(e.light);if("lightLinear"in e)return g(S(e.lightLinear));if("redLinear"in e)return{red:C((o=e).redLinear),green:C(o.greenLinear),blue:C(o.blueLinear)}}else if("string"===i)return b(E(e));var o;return b({red:e,green:t,blue:n})},c.convertTo255=x,c.convertToSRGB=S,c.convertRGBToHSL=m,c.convertHSLToRGB=y,c.convertRGBToOkLab=t,c.convertOkLabToRGB=o,c.convertOkHSLToRGB=r,c.convertRGBToOkHSL=n,c.convertOkHSVToRGB=s,c.convertRGBToOkHSV=i,c.isCSSColor=function(e){try{E(e)}catch(e){return!1}return!0},c.modifyHSLOfRGB255=function(e,t,n,i={}){const o=(r=e,s=t,a=n,m({red:(r/=255)/255,green:(s/=255)/255,blue:(a/=255)/255}));var r,s,a;if("function"==typeof i){const e=i(o.hue,o.saturation,o.lightness);return v({hue:e[0],saturtion:e[1],lightness:e[2]})}return I(o,i),v(o)},Object.defineProperty(c.prototype,"hue",{enumerable:!0,get:function(){return this.getHSL().hue},set:function(e){this.getHSL(),(e>1||e<0)&&(e-=Math.floor(e)),this.hslValues.hue=e,delete this.rgbValues}}),Object.defineProperty(c.prototype,"saturation",{enumerable:!0,get:function(){return this.getHSL().saturation},set:function(e){this.getHSL(),this.hslValues.saturation=P(e),delete this.rgbValues}}),Object.defineProperty(c.prototype,"lightness",{enumerable:!0,get:function(){return this.getHSL().lightness},set:function(e){this.getHSL(),this.hslValues.lightness=P(e),delete this.rgbValues}}),Object.defineProperty(c.prototype,"luminance",{enumerable:!0,get:function(){return k(this)}}),Object.defineProperty(c.prototype,"perceptualLightness",{enumerable:!0,get:function(){const e=k(this);return e<=.008856?903.3*e:116*Math.pow(e,.333)-16}}),Object.defineProperty(c.prototype,"red",{enumerable:!0,get:function(){return this.getRGB().red},set:function(e){this.getRGB(),this.rgbValues.red=e,delete this.hslValues}}),Object.defineProperty(c.prototype,"green",{enumerable:!0,get:function(){return this.getRGB().green},set:function(e){this.getRGB(),this.rgbValues.green=e,delete this.hslValues}}),Object.defineProperty(c.prototype,"blue",{enumerable:!0,get:function(){return this.getRGB().blue},set:function(e){this.getRGB(),this.rgbValues.blue=e,delete this.hslValues}}),Object.defineProperty(c.prototype,"red255",{enumerable:!0,get:function(){return x(this.getRGB().red)}}),Object.defineProperty(c.prototype,"green255",{enumerable:!0,get:function(){return x(this.getRGB().green)}}),Object.defineProperty(c.prototype,"blue255",{enumerable:!0,get:function(){return x(this.getRGB().blue)}}),Object.defineProperty(c.prototype,"redLinear",{enumerable:!0,get:function(){return w(this.getRGB().red)}}),Object.defineProperty(c.prototype,"greenLinear",{enumerable:!0,get:function(){return w(this.getRGB().green)}}),Object.defineProperty(c.prototype,"blueLinear",{enumerable:!0,get:function(){return w(this.getRGB().blue)}}),c.prototype.toOkLab=function(){return t(this.getRGB())},c.prototype.toXyz=function(){return A(this.getRGB())},c.prototype.toString=function(){let{red:e,green:t,blue:n}=this.getRGB();return 1===this.opacity?`rgb(${x(e)} ${x(t)} ${x(n)})`:`rgb(${x(e)} ${x(t)} ${x(n)} / ${this.opacity})`},c.prototype.toCSSString=c.prototype.toString,c.prototype.getRGB=function(){if(!this.rgbValues)if(this.perceptual){let{red:e,green:t,blue:n}=r(this.hslValues);this.rgbValues={red:e,green:t,blue:n}}else this.rgbValues=function({hue:e,saturation:t,lightness:n}){const i=M(n,t),o=2*n-i;return{red:T(o,i,(e*=6)+2),green:T(o,i,e),blue:T(o,i,e-2)}}(this.hslValues);const{red:e,green:t,blue:n}=this.rgbValues;return{red:e,green:t,blue:n}},c.prototype.getHSL=function(){if(!this.hslValues)if(this.perceptual){let{hue:e,saturation:t,lightness:i}=n(this.rgbValues);this.hslValues={hue:e,saturation:t,lightness:i}}else this.hslValues=m(this.rgbValues);const{hue:e,saturation:t,lightness:i}=this.hslValues;return{hue:e,saturation:t,lightness:i}},c.prototype.darken=function(e){return this.lightness*=1-e,this},c.prototype.lighten=function(e){let{lightness:t}=this;return this.lightness=t+(1-t)*e,this},c.prototype.saturate=function(e){let{saturation:t}=this;return this.saturation=t+(1-t)*e,this},c.prototype.desaturate=function(e){return this.saturation*=1-e,this},c.prototype.fadeIn=function(e){return this.opacity=P(this.opacity+(1-this.opacity)*e),this},c.prototype.fadeOut=function(e){return this.opacity=P(this.opacity*(1-e)),this},c.prototype.modifyHSL=function(e={}){console.error("modifyHSL is deprecated. Modify color.hue, color.saturation, color.lightness directly or use darken, lighten, saturate, desaturate methods");const t=this.getHSL();return t.perceptual=this.perceptual,I(t,e),t.opacity=function(e,t){if("opacity"in t)return P(t.opacity);if("fadeOut"in t)return P(e*(1-t.fadeOut));if("fadeIn"in t)return P(e+(1-e)*t.fadeIn);return e}(this.opacity,e),new c(t)},c.prototype.modifyHSLA=c.prototype.modifyHSL,c.prototype.writeOnItWithDark=function(){return this.perceptualLightness>50},c.prototype.clone=function(){let e;if("rgbValues"in this)e=new c(this.getRGB()),e.perceptual=this.perceptual;else{let t=this.getHSL();t.perceptual=this.perceptual,e=new c(t)}return e.opacity=this.opacity,e},c.prototype.distanceTo=function(e){"string"==typeof e&&(e=new c(e));const t=c.convertRGBToOkLab(this.getRGB()),n=c.convertRGBToOkLab(e.getRGB());return a(t,n)},c.prototype.deltaE2000=function(e){"string"==typeof e&&(e=new c(e));const t=this.toCIElab(),n=e.toCIElab();return l(t,n)},c.prototype.toCIElab=function(){return h(this.getRGB())},c.prototype.toCIElabD50=function(){return d(this.getRGB())},c.prototype.isCloseTo=function(e){"string"==typeof e&&(e=new c(e));const t=c.convertRGBToOkHSV(this.getRGB()),n=c.convertRGBToOkHSV(e.getRGB());let i=t.value-n.value,o=(t.value+n.value)/2,r=Math.min(t.value,n.value);if(r>.2){if(Math.abs(i)>.2)return!1}else if(r>.1){if(Math.abs(i)>.1)return!1}else if(Math.abs(i)>.06)return!1;if(Math.min(t.value,n.value)<.1)return!0;let s=t.saturation-n.saturation;if(Math.abs(s)>.4)return!1;if(Math.min(t.value,n.value)<.15)return!0;if(Math.max(t.saturation,n.saturation)>.1+.15*o){let e=p(.5+t.hue-n.hue,1)-.5;if(Math.abs(e)>.1)return!1}return!0},c.prototype.equals=function(e){e instanceof c||(e=new c(e));let{red:t,green:n,blue:i}=this.getRGB();return t===e.red&&n===e.green&&i===e.blue&&this.opacity===e.opacity};const _=1/2.4;function S(e){return e<0?0:e<=.0031308?12.92*e:Math.min(1,1.055*Math.pow(e,_)-.055)}function C(e){return x(S(e))}function k(e){let{red:t,green:n,blue:i}=e.getRGB();return.2126*w(t)+.7152*w(n)+.0722*w(i)}function A({red:e,green:t,blue:n}){return{x:.4124108464885388*(e=w(e))+.3575845678529519*(t=w(t))+.18045380393360833*(n=w(n)),y:.21264934272065283*e+.7151691357059038*t+.07218152157344333*n,z:.019331758429150258*e+.11919485595098397*t+.9503900340503373*n}}function M(e,t){return e<.5?e*(1+t):e+t-e*t}function T(e,t,n){return n<0?n+=6:n>6&&(n-=6),n<1?e+(t-e)*n:n<3?t:n<4?e+(t-e)*(4-n):e}function E(e){if("#"===(e=e.trim())[0])return L(e);if(e.startsWith("rgb"))return function(e){const t=function(e){if(e.includes(","))return e.split(",");{let t=e.match(/(\d+)\s+(\d+)\s+(\d+)(?:\s*\/\s*([\d.]+%?))?$/);if(!t)return!1;let[,n,i,o,r]=t;return[n,i,o,r]}}(e.match(R)[1]);if(!t||t.length<3||t.length>4)throw new Error(`color "${e}" not recognized`);const[n,i,o,r="1"]=t;return{red:parseInt(n,10)/255,green:parseInt(i,10)/255,blue:parseInt(o,10)/255,opacity:r.endsWith("%")?parseFloat(r,10)/100:parseFloat(r,10)}}(e);const t=c.allCSSColors[e];if(t)return L(t);throw new Error(`color "${e}" not recognized`)}const $=16/17;function L(e){if(/^#[A-Fa-f0-9]{3}$/.test(e))return{red:F[e[1]],green:F[e[2]],blue:F[e[3]],opacity:1};if(/^#[A-Fa-f0-9]{6}$/.test(e))return{red:F[e[1]]*$+F[e[2]]/17,green:F[e[3]]*$+F[e[4]]/17,blue:F[e[5]]*$+F[e[6]]/17,opacity:1};throw new Error(`color "${e}" not recognized`)}const R=/^rgba?\((.*)\)$/;function P(e){return Math.max(Math.min(e,1),0)}function I(e,t){e.saturation=function(e,t){return"saturation"in t?P(t.saturation):"desaturate"in t?P(e*(1-t.desaturate)):"saturate"in t?P(e+(1-e)*t.saturate):e}(e.saturation,t),e.lightness=function(e,t){return"lightness"in t?P(t.lightness):"darken"in t?P(e*(1-t.darken)):"lighten"in t?P(e+(1-e)*t.lighten):e}(e.lightness,t)}const O={a:{phase:[0,.33,.67]},dark:{phase:[.55,.45,.45]},dark2:{frequency:[.7,.7,.7],phase:[.55,.45,.45]}},D=2*Math.PI;c.getColorMapper=function({colorCount:e=300,palette:t="dark2",cycle:n=!1,useIndexes:i=!1,outputAsRGB255:o=!0}={}){let r=[],{zero:s=[.5,.5,.5],amplitude:a=[.5,.5,.5],frequency:l=[1,1,1],phase:c}=O[t];function u(e,t){return s[t]+a[t]*Math.cos(D*(l[t]*e+c[t]))}function h(e,t){return x(u(e,t))}const d=e-1;for(let t=0;t<e;t++){let e=t/d;o?r.push({red255:h(e,0),green255:h(e,1),blue255:h(e,2)}):r.push({red:u(e,0),green:u(e,1),blue:u(e,2)})}return n?i?t=>r[0|p(t,e)]:t=>((t>=1||t<0)&&(t-=Math.floor(t)),r[e*t|0]):i?e=>r[Math.max(0,Math.min(0|e,d))]:t=>r[e*Math.max(0,Math.min(t,.99999))|0]},c.allCSSColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};const F={0:0,1:1/15,2:2/15,3:.2,4:4/15,5:5/15,6:.4,7:7/15,8:8/15,9:.6,a:10/15,b:11/15,c:.8,d:13/15,e:14/15,f:1,A:10/15,B:11/15,C:.8,D:13/15,E:14/15,F:1};return c})),
/*! Toxilib screen_canvas_style
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_canvas_style",["./color"],(function(e){let t=1;const n={};const i={normal:"source-over","new || old":"source-over","old || new":"destination-over","old && new":"source-in","new && old":"destination-in","!old && new":"source-out","!new && old":"destination-out","old && (new || old)":"source-atop","new && (old || new)":"destination-atop","old + new":"lighter","old * new":"multiply","min(old, new)":"darken",min:"darken","max(old, new)":"lighten",max:"lighten","abs(old - new)":"difference","abs(new - old)":"difference","old ^ new":"xor","old XOR new":"xor",new:"copy"};const o=.5,r=5;return function(s){const{cx:a}=s;a.id||(a.id=t++,n[a.id]={});const l=n[a.id];s.currentCxStyle=l,this.previousGlobalAlpha=a.globalAlpha,function(t,{currentCxStyle:n,cx:s,screen:a}){t.setDefaultStyles=function(){n.blendMode="source-over",n.filter="none",s.lineJoin="round",s.imageSmoothingQuality="high"},t.resetStyle=function(){for(let e in n)delete n[e];t.setDefaultStyles()},t.resyncWithCurrentStyle=function(){s.strokeStyle=n.stroke,s.fillStyle=n.fill,s.lineWidth=n.lineWidth,s.font=n.font},t.setStrokeStyle=function({color:e,strokeColor:t=e,lineWidth:i=2}){const o=t||"#000";n.lineWidth!==i&&(n.lineWidth=i,s.lineWidth=i),n.stroke!==o&&(n.stroke=o,s.strokeStyle=o)},t.setFillStyle=function(e){const{linearGradient:t,radialGradient:n,fillColor:i,color:o=i}=e;t||n?function(e,{linearGradient:t,radialGradient:n,fillColor:i,color:o}){let r,s;t?(r=t,s=function(e,{origin:t,end:n}){return e.cx.createLinearGradient(t.x,t.y,n.x,n.y)}(e,r)):(r=n||{x:0,y:0,radius:10},s=function(e,{innerCircle:t,outerCircle:n,center:i,radius:o}){let r,s,a,l;if(t){r=t,s=t.radius||0,a=n;const{radius:e=o}=n;l=e}else r=i,s=0,a=r,l=o;return e.cx.createRadialGradient(r.x,r.y,s,a.x,a.y,l)}(e,r));(function(e,t){t.length?function(e,t){const n=t.length;for(let i=0;i<n;i++)e.addColorStop(i/(n-1),t[i])}(e,t):function(e,t){for(let n in t)e.addColorStop(n,t[n])}(e,t)})(s,r.colors||function({color:e,fillColor:t=e}){return["#000",t||"#FFF"]}({fillColor:i,color:o})),e.cx.fillStyle=s,e.currentCxStyle.fill=s}(a,e):function(e,{color:t="#000"}={}){e.currentCxStyle.fill!==t&&(e.currentCxStyle.fill=t,e.cx.fillStyle=t)}(a,{color:o})};const l=/[0-9.]+px/;t.setFont=function({font:e="20px serif",width:t,height:i}){void 0===t&&void 0===i||e.match(l)||(e=`20px ${e}`),n.font!==e&&(n.font=e,s.font=e)},t.stroke=function({lineWidth:e,strokeColor:n,color:i}){0!==e&&(t.setStrokeStyle({strokeColor:n,color:i,lineWidth:e}),s.stroke())},t.fill=function(e={}){t.setFillStyle(e),s.fill()},t.setSpecialStyles=function({opacity:n,blendMode:a,filter:l="",shadow:c,blur:u}){if(1!==n&&(t.previousGlobalAlpha=s.globalAlpha,s.globalAlpha*=n),a){let e=i[a];e&&(a=e),s.globalCompositeOperation=a}c&&(l+=function({xOffset:t=0,yOffset:n=0,color:i="black",blur:s=r,opacity:a=o}){a<1&&("string"==typeof i&&(i=new e(i)),i.opacity=a);return` drop-shadow(${t}px ${n}px ${s}px ${i})`}(c)),u&&(l+=` blur(${u}px)`),l&&(s.filter=l)},t.resetSpecialStyles=function(){s.globalAlpha=t.previousGlobalAlpha,s.globalCompositeOperation=n.blendMode,s.filter=n.filter},t.setOpacity=function(e=1){t.previousGlobalAlpha=e,s.globalAlpha=e},t.setSmoothing=function(e){n.smoothing!==e&&(s.imageSmoothingEnabled=e,s.mozImageSmoothingEnabled=e,s.msImageSmoothingEnabled=e)},t.strokeAndFill=function(e={}){e.strokeColor&&t.stroke(e),(e.color||e.fillColor||e.linearGradient||e.radialGradient)&&t.fill(e)}}(this,{currentCxStyle:l,cx:a,screen:s}),this.setDefaultStyles()}})),
/*! Toxilib topleft_and_pivot
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/topleft_and_pivot",[],(function(){const e=Math.PI/180,t=["topLeft","center","topRight","bottomLeft","bottomRight","left","right","bottom","top","centerLeft","centerRight","bottomCenter","topCenter"];function n(e){return e._positionKey?"none"!==e._positionKey&&e._positionKey:t.find((t=>t in e))}function i(e,t,n){let{_positionKey:i}=e;if(i&&"topLeft"!==i)return function(e,t,n,i){if("none"===e)return null;"function"==typeof n&&(n=n());"function"==typeof i&&(i=i());const{x:o,y:r}=d(t[e]);return a[e]({x:o,y:r,width:-n,height:-i})}(i,e,t,n);if(e.topLeft){const{x:t,y:n}=d(e.topLeft);return{x:t,y:n}}if("function"==typeof t&&(t=t()),"function"==typeof n&&(n=n()),e.center){const{x:i,y:o}=d(e.center);return{x:i-t/2,y:o+n/2}}if(e.topRight){const{x:n,y:i}=d(e.topRight);return{x:n-t,y:i}}if(e.bottomLeft){const{x:t,y:i}=d(e.bottomLeft);return{x:t,y:i+n}}if(e.bottomRight){const{x:i,y:o}=d(e.bottomRight);return{x:i-t,y:o+n}}if(e.centerLeft){const{x:t,y:i}=d(e.centerLeft);return{x:t,y:i+n/2}}if(e.centerRight){const{x:i,y:o}=d(e.centerRight);return{x:i-t,y:o+n/2}}if(e.bottomCenter){const{x:i,y:o}=d(e.bottomCenter);return{x:i-t/2,y:o+n}}if(e.topCenter){const{x:n,y:i}=d(e.topCenter);return{x:n-t/2,y:i}}if(e.left){const{x:t,y:i}=d(e.left);return{x:t,y:i+n/2}}if(e.right){const{x:i,y:o}=d(e.right);return{x:i-t,y:o+n/2}}if(e.bottom){const{x:i,y:o}=d(e.bottom);return{x:i-t/2,y:o+n}}if(e.top){const{x:n,y:i}=d(e.top);return{x:n-t/2,y:i}}return null}function o(e,t,n){let{_positionKey:i}=e;if(i&&"center"!==i)return function(e,t,n,i){if("none"===e)return null;"function"==typeof n&&(n=n());"function"==typeof i&&(i=i());const{x:o,y:r}=d(t[e]),s=a[e]({x:o,y:r,width:-n,height:-i});return{x:s.x+n/2,y:s.y-i/2}}(i,e,t,n);if(e.center){const{x:t,y:n}=d(e.center);return{x:t,y:n}}if("function"==typeof t&&(t=t()),"function"==typeof n&&(n=n()),e.topLeft){const{x:i,y:o}=d(e.topLeft);return{x:i+t/2,y:o-n/2}}if(e.topRight){const{x:i,y:o}=d(e.topRight);return{x:i-t/2,y:o-n/2}}if(e.bottomLeft){const{x:i,y:o}=d(e.bottomLeft);return{x:i+t/2,y:o+n/2}}if(e.bottomRight){const{x:i,y:o}=d(e.bottomRight);return{x:i-t/2,y:o+n/2}}if(e.centerLeft){const{x:n,y:i}=d(e.centerLeft);return{x:n+t/2,y:i}}if(e.centerRight){const{x:n,y:i}=d(e.centerRight);return{x:n-t/2,y:i}}if(e.bottomCenter){const{x:t,y:i}=d(e.bottomCenter);return{x:t,y:i+n/2}}if(e.topCenter){const{x:t,y:i}=d(e.topCenter);return{x:t,y:i-n/2}}if(e.left){const{x:n,y:i}=d(e.left);return{x:n+t/2,y:i}}if(e.right){const{x:n,y:i}=d(e.right);return{x:n-t/2,y:i}}if(e.bottom){const{x:t,y:i}=d(e.bottom);return{x:t,y:i+n/2}}if(e.top){const{x:t,y:i}=d(e.top);return{x:t,y:i-n/2}}return null}function r(e,t,n){return e.pivot?d(e.pivot):!e.topLeft&&(e.topRight?{x:t,y:0}:e.bottomLeft?{x:0,y:-n}:e.bottomRight?{x:t,y:-n}:e.center?{x:t/2,y:-n/2}:e.centerLeft?{x:0,y:-n/2}:e.centerRight?{x:t,y:-n/2}:e.bottomCenter?{x:t/2,y:-n}:e.topCenter?{x:t/2,y:0}:e.centerLeft||e.left?{x:0,y:-n/2}:e.centerRight||e.right?{x:t,y:-n/2}:e.bottomCenter||e.bottom?{x:t/2,y:-n}:!(!e.topCenter&&!e.top)&&{x:t/2,y:0})}function s(e,t,n){let{pivot:i}=e;if(i){"function"==typeof i&&(i=i());const{x:e,y:o}=i;return{x:e-t/2,y:o+n/2}}return!e.center&&(e.topLeft?{x:-t/2,y:n/2}:e.topRight?{x:t/2,y:n/2}:e.bottomLeft?{x:-t/2,y:-n/2}:e.bottomRight?{x:t/2,y:-n/2}:e.centerLeft?{x:-t/2,y:0}:e.centerRight?{x:t/2,y:-0}:e.bottomCenter?{x:0,y:-n/2}:e.topCenter?{x:0,y:n/2}:e.centerLeft||e.left?{x:-t/2,y:0}:e.centerRight||e.right?{x:t/2,y:0}:e.bottomCenter||e.bottom?{x:0,y:-n/2}:!(!e.topCenter&&!e.top)&&{x:0,y:n/2})}const a={topLeft:({x:e,y:t})=>({x:e,y:t}),top:({x:e,y:t,width:n})=>({x:e+n/2,y:t}),topRight:({x:e,y:t,width:n})=>({x:e+n,y:t}),left:({x:e,y:t,height:n})=>({x:e,y:t-n/2}),center:({x:e,y:t,width:n,height:i})=>({x:e+n/2,y:t-i/2}),right:({x:e,y:t,width:n,height:i})=>({x:e+n,y:t-i/2}),bottomLeft:({x:e,y:t,height:n})=>({x:e,y:t-n}),bottom:({x:e,y:t,width:n,height:i})=>({x:e+n/2,y:t-i}),bottomRight:({x:e,y:t,width:n,height:i})=>({x:e+n,y:t-i})};function l(e,t,{whenChanged:n}={}){if(t in e){if(n){let i=r(e[t]);Object.defineProperty(e,t,{get:()=>i,set:e=>{i=r(e),n({positionName:t,value:i})},enumerable:!0})}return}function r(i){if(!n)return i;let{x:o,y:r}=i;const s={};return Object.defineProperty(s,"x",{get:()=>o,set:i=>{if(o!==i){o=i;let{_positionKey:a}=e;t===a?n({positionName:t,value:s}):e[t]={x:o,y:r}}},enumerable:!0}),Object.defineProperty(s,"y",{get:()=>r,set:i=>{if(r!==i){r=i;let{_positionKey:a}=e;t===a?n({positionName:t,value:s}):e[t]={x:o,y:r}}},enumerable:!0}),s}let s;if("topLeft"===t)s=()=>{const{width:t,height:n}=e;return r(i(e,t,n))};else if("center"===t)s=()=>{const{width:t,height:n}=e;return r(o(e,t,n))};else{if("none"===t)return void console.warn("No positionName found");{let n=a[t];s=()=>{const{width:t,height:o}=e,{x:s,y:a}=i(e,t,o);return r(n({x:s,y:a,width:t,height:o}))}}}Object.defineProperty(e,t,{get:s,set:i=>{let{_positionKey:o}=e;delete e[t],e[t]=i,o&&(delete e[o],l(e,o),n&&l(e,t,{whenChanged:n})),e._positionKey=t,n&&n({positionName:t,value:e[t]})},enumerable:!0,configurable:!0})}function c(e,t,n){let i=h(n,t);return{x:e.x+n.x-i.x,y:e.y+n.y-i.y}}function u(e,t=1){let{width:n,height:o,orientation:s=0}=e;if(void 0===n)throw new Error('"width" param is missing');if(void 0===o)throw new Error('"height" param is missing');"function"==typeof n&&(n=n()),"function"==typeof o&&(o=o()),"function"==typeof s&&(s=s());let a=i(e,n,o*t);if(!a)throw new Error('a position param is missing. Include one, for example "center", "topLeft"...');if(s){const t=r(e,n,o);t&&(a=c(a,s,t))}return{topLeftPoint:a,width:n,height:o,orientation:s}}function h({x:t,y:n},i){let o=i*e,r=Math.cos(o),s=Math.sin(o);return{x:t*r-n*s,y:t*s+n*r}}function d(e){return"function"==typeof e?e():e}return a.centerRight=a.right,a.centerLeft=a.left,a.bottomCenter=a.bottom,a.topCenter=a.top,{getTopLeftPoint:i,getCenterPoint:o,getCenterPointAfterPivot:function(e){let{width:t,height:n,orientation:i}=e,r=o(e,t,n);if("function"==typeof i&&(i=i()),i){let o=s(e,t,n);if(o){let e=h(o,i);return{x:r.x+o.x-e.x,y:r.y+o.y-e.y}}}return r},getPivot:r,getPivotRelativeToCenter:s,topLeftPointWithPivot:function(e,t,n){return"function"==typeof e&&(e=e()),"function"==typeof t&&(t=t()),"function"==typeof n&&(n=n()),c(e,t,n)},containsPositionParam:n,copyPositionParam:function(e,t,{replace:i}={}){const o=n(e);if(o){const{x:n,y:r}=d(e[o]);return o in t&&!i?(t[o].x=n,t[o].y=r):t[o]={x:n,y:r},!0}return!1},getCoordsFor:function(e,t){let{width:n,height:o}=t;"function"==typeof n&&(n=n()),"function"==typeof o&&(o=o());const{x:r,y:s}=i(t,n,o);return a[e]({x:r,y:s,width:n,height:o})},rotateVector:h,addPositionAccessors:function(e,{whenChanged:i}={}){let o=n(e);o||(o="none"),e._positionKey=o,t.forEach((t=>l(e,t,{whenChanged:i})))},normalizedParamsForRectangle:u,pointsForRectangle:function(e,t=1){let{topLeftPoint:n,width:i,height:o,orientation:r}=u(e,t);const{x:s,y:a}=n;if(r){const{x:e,y:n}=h({x:i,y:0},r),{x:l,y:c}=h({x:0,y:-t*o},r);return[{x:s,y:a},{x:s+e,y:a+n},{x:s+e+l,y:a+n+c},{x:s+l,y:a+c}]}{const e=a-t*o;return[{x:s,y:a},{x:s+i,y:a},{x:s+i,y:e},{x:s,y:e}]}}}})),
/*! Toxilib bezier
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/bezier",[],(function(){function e({origin:e,end:t,controlOrigin:n,controlEnd:i,interpolationSteps:o=50}){this.stepsCount=o,this.interpolationStep=1/o,this.origin=e,this.end=t,this.controlOrigin=n,this.controlEnd=i}e.pointsWithDefaultControlPoints=function({points:e,smooth:t=1,close:n}){t/=2.8;let i=function(e,t){const n=e.map(r);t&&e.length>0&&n.push(r(e[0]));return n}(e,n),a=i.length;if(a<1)return!1;for(let e=1;e<a-1;e++)o(i[e],i[e-1],i[e+1],t);return n&&(o(i[a-1],i[a-2],i[1],t),s(i[0],"controlNext",i[a-1].controlNext)),i},e.autoParamsFromPoints=function({points:t,smooth:n=0,close:i}){n&&(t=e.pointsWithDefaultControlPoints({points:t,smooth:n,close:i}));let o=[],r=t.length;for(let e=1;e<r;e++){const{x:n,y:i,controlNext:r}=t[e-1],{x:s,y:a,controlPrevious:l}=t[e];o.push({origin:{x:n,y:i},controlOrigin:r&&{x:n+r.x,y:i+r.y},end:{x:s,y:a},controlEnd:l&&{x:s+l.x,y:a+l.y}})}return o},e.prototype.length=function(){return"computedLength"in this||i(this),this.computedLength},e.prototype.boundingBox=function(){return"computedBoundingBox"in this||i(this),this.computedBoundingBox},e.prototype.coords=function(e,{withAngle:i=!1}={}){"distanceTable"in this||n(this);let o=t(this,e);return this.parametricCoords(o,{withAngle:i})};function t(e,t){const{computedLength:n,distanceTable:i,tDistributedDistanceTable:o,interpolationStep:r}=e;if(t>=n)return 1;let s=i[Math.floor(t/(r*n))],a=o[s],l=o[s+1];for(;l<t;)s+=1,a=l,l=o[s+1];return(s+(t-a)/(l-a))*r}function n(e){"tDistributedDistanceTable"in e||i(e);const{interpolationStep:t,computedLength:n,tDistributedDistanceTable:o,stepsCount:r}=e,s=n*t,a=[0];let l=s;for(let e=0;e<r;e++){let t=o[e+1];for(;t>=l;)a.push(e),l+=s}e.distanceTable=a}function i(e){let t=0;const n=[];let i,o=1/0,r=-1/0,s=1/0,l=-1/0;const{interpolationStep:c}=e,u=1+c/2;for(let h=0;h<=u;h+=c){const c=e.parametricCoords(h),{x:u,y:d}=c;o=Math.min(o,u),r=Math.max(r,u),s=Math.min(s,d),l=Math.max(l,d),i&&(t+=a(i,c)),n.push(t),i=c}e.computedLength=t,e.computedBoundingBox={xMin:o,yMin:s,xMax:r,yMax:l},e.tDistributedDistanceTable=n}function o(e,t,n,i){if(e.controlPrevious&&e.controlNext)return;const o=e.x-t.x,r=e.y-t.y,a=Math.sqrt(o*o+r*r),l=n.x-e.x,c=n.y-e.y,u=Math.sqrt(l*l+c*c);if(0===a||0===u)s(e,"controlPrevious",{x:0,y:0}),s(e,"controlNext",{x:0,y:0});else{const t=a/u;let n=l*t+o,s=c*t+r;const h=Math.sqrt(n*n+s*s);n/=h,s/=h,e.controlPrevious||(e.controlPrevious={x:-i*n*a,y:-i*s*a}),e.controlNext||(e.controlNext={x:i*n*u,y:i*s*u})}}function r({x:e,y:t,controlNext:n,controlPrevious:i}){return{x:e,y:t,controlNext:n,controlPrevious:i}}function s(e,t,n){e[t]=e[t]||n}function a({x:e,y:t},{x:n,y:i}){const o=n-e,r=i-t;return Math.sqrt(o*o+r*r)}return e.prototype.parametricCoords=function(e,{withAngle:t=!1}={}){const n=1-e,i=n*n*n,o=n*n*e*3,r=n*e*e*3,s=e*e*e;let a=i*this.origin.x+o*this.controlOrigin.x+r*this.controlEnd.x+s*this.end.x,l=i*this.origin.y+o*this.controlOrigin.y+r*this.controlEnd.y+s*this.end.y;if(t){let t=this.parametricCoords(e+1e-5);return{x:a,y:l,angle:Math.atan2(t.y-l,t.x-a)}}return{x:a,y:l}},e.prototype.path=function(e=this.stepsCount){const t=1/e,n=1+t/2,i=Math.ceil(n/t),o=new Array(i);for(let e=0;e<i;e+=1)o[e]=this.parametricCoords(e*t);return o},e.prototype.steppedPath=function({distanceStepsCount:e=this.stepsCount}={}){"tDistributedDistanceTable"in this||i(this);const{origin:t,interpolationStep:n,computedLength:o,tDistributedDistanceTable:r,stepsCount:s}=this,a=o/e;let l=a;const c=[{x:t.x,y:t.y}];let u=0;for(let e=0;e<s;e++){let t=r[e+1];for(;t>=l;){const i=(e+(l-u)/(t-u))*n;c.push(this.parametricCoords(i)),l=a*c.length}u=t}return c},e.prototype.derivative=function(e){const t=3*e*e,n=6*e-3-t,i=3*t-12*e+3,o=6*e-3*t;return{x:n*this.origin.x+i*this.controlOrigin.x+o*this.controlEnd.x+t*this.end.x,y:n*this.origin.y+i*this.controlOrigin.y+o*this.controlEnd.y+t*this.end.y}},e.prototype.secondDerivative=function(e){const t=6*e,n=6-t,i=3*t-12,o=6-3*t;return{x:n*this.origin.x+i*this.controlOrigin.x+o*this.controlEnd.x+t*this.end.x,y:n*this.origin.y+i*this.controlOrigin.y+o*this.controlEnd.y+t*this.end.y}},e.prototype.normal=function(e){const{x:t,y:n}=this.derivative(e),i=Math.sqrt(t*t+n*n);return{x:-n/i,y:t/i}},e.prototype.paramAtDistance=function(e){return"distanceTable"in this||n(this),t(this,e)},e})),
/*! Toxilib auto_dimensions
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/auto_dimensions",[],(function(){return function({width:e,height:t,sourceWidth:n,sourceHeight:i,preventConflict:o}){let r={sourceWidth:n,sourceHeight:i};if(void 0===e&&void 0===t)e=n,t=i;else if(void 0===e)e=function(e,{sourceWidth:t,sourceHeight:n}){return void 0===e?t:t*e/n}(t,r);else if(void 0===t)t=function(e,{sourceWidth:t,sourceHeight:n}){return void 0===e?n:n*e/t}(e,r);else if(o){const o=n/i,r=e/t;if(Math.abs(o-r)>1e-5)throw new Error("Mismatched dimensions")}return{width:e,height:t}}})),
/*! Toxilib screen_image_utils
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_image_utils",["./topleft_and_pivot","./auto_dimensions"],(function(e,t){const{getTopLeftPoint:n,containsPositionParam:i,copyPositionParam:o}=e;function r({width:e,height:t},n){if(!n)return{topLeftX:0,topLeftY:0,width:e,height:t,cropped:!1};let{topLeftX:i,topLeftY:o,width:r,height:s}=function(e,t){if(e.topLeft){let{fullWidth:n,fullHeight:i,width:o=Math.max(0,n-e.topLeft.x),height:r=Math.max(0,i-e.topLeft.y)}=t;return{topLeftX:e.topLeft.x,topLeftY:e.topLeft.y,width:o,height:r}}if(e.center){let{fullWidth:n,fullHeight:i,width:o=Math.max(0,2*Math.min(e.center.x,n-e.center.x)),height:r=Math.max(0,2*Math.min(e.center.y,i-e.center.y))}=t;return{topLeftX:e.center.x-o/2,topLeftY:e.center.y-r/2,width:o,height:r}}if(e.topRight){let{fullHeight:n,width:i=Math.max(0,e.topRight.x),height:o=Math.max(0,n-e.topRight.y)}=t;return{topLeftX:e.topRight.x-i,topLeftY:e.topRight.y,width:i,height:o}}if(e.bottomLeft){let{fullWidth:n,width:i=Math.max(0,n-e.bottomLeft.x),height:o=Math.max(0,e.bottomLeft.y)}=t;return{topLeftX:e.bottomLeft.x,topLeftY:e.bottomLeft.y-o,width:i,height:o}}if(e.bottomRight){let{width:n=Math.max(0,e.bottomRight.x),height:i=Math.max(0,e.bottomRight.y)}=t;return{topLeftX:e.bottomRight.x-n,topLeftY:e.bottomRight.y-i,width:n,height:i}}if(e.centerLeft||e.left){let{x:n,y:i}=e.centerLeft||e.left,{fullWidth:o,fullHeight:r,width:s=Math.max(0,o-n),height:a=Math.max(0,2*Math.min(i,r-i))}=t;return{topLeftX:n,topLeftY:i-a/2,width:s,height:a}}if(e.centerRight||e.right){let{x:n,y:i}=e.centerRight||e.right,{fullHeight:o,width:r=Math.max(0,n),height:s=Math.max(0,2*Math.min(i,o-i))}=t;return{topLeftX:n-r,topLeftY:i-s/2,width:r,height:s}}if(e.bottomCenter||e.bottom){let{x:n,y:i}=e.bottomCenter||e.bottom,{fullWidth:o,width:r=Math.max(0,2*Math.min(n,o-n)),height:s=Math.max(0,i)}=t;return{topLeftX:n-r/2,topLeftY:i-s,width:r,height:s}}if(e.topCenter||e.top){let{x:n,y:i}=e.topCenter||e.top,{fullWidth:o,fullHeight:r,width:s=Math.max(0,2*Math.min(n,o-n)),height:a=Math.max(0,r-i)}=t;return{topLeftX:n-s/2,topLeftY:i,width:s,height:a}}{let{fullWidth:e,fullHeight:n,width:i=e,height:o=n}=t;return{topLeftX:0,topLeftY:0,width:i,height:o}}}(n,{width:n.width,height:n.height,fullWidth:e,fullHeight:t});return{topLeftX:i,topLeftY:o,width:r,height:s,cropped:0!==i||0!==o||r!==e||s!==t}}const s={};function a(e,{errorHandler:t}={}){let n=new Image;n.crossOrigin="Anonymous",n.addEventListener("load",(()=>{s[e].forEach((e=>e(n))),s[e]=n})),n.addEventListener("error",(()=>{s[e]="error";const n=new Error(`Cannot load image ${e}`);if(n.toxiTrace=["Toxilibs - screen.js - fetchImage"],!t)throw n;t(n)})),n.src=e}return{fetchImage:a,getImageByUrl:function({url:e,errorHandler:t,callback:n}){const i=s[e];i?Array.isArray(i)?i.push(n):"error"!==i&&n(i):(s[e]=[n],a(e,{errorHandler:t}))},getCropParams:r,getUsableImageAndPositionParams:function(e,i,{reverseY:s,forceTopLeft:a}={}){let l,c=e,u=e;var h;if(e.screen?(c=e.screen,u=c,l=c.flip):(h=e,"[object Object]"===Object.prototype.toString.call(h)&&e.image?(l=e.flip,u=e=e.image):e.screenMode&&e._screen&&(e=e._screen)),!e)throw new Error("An image must be specified");const d=function({smartObject:e,source:i,params:s,reverseY:a,forceTopLeft:l,flip:c}){let u=e;e.getCamera&&(u=e.getCamera());let{width:h,height:d,cropSource:p,flip:f=c,orientation:g}=s;void 0===h&&void 0===d&&(h=u.width,d=u.height),p=e.imageData?r({width:e.widthInPixels,height:e.heightInPixels},p):r(i,p||e.cropSource);const{width:m,height:y}=t({width:h,height:d,sourceWidth:p.width,sourceHeight:p.height}),v={cropSource:p,width:m,height:y,orientation:g,flip:f};if(l){let e=y;a&&(e=-y),v.topLeft=n(s,m,e)||n(u,m,e)}else o(s,v)||o(u,v);return v}({smartObject:c,source:u,params:i,reverseY:s,forceTopLeft:a,flip:l});return{image:e,positionParams:d}},addImageDefaultPositionParams:function(e,t){let n=t;t.getCamera&&(n=t.getCamera()),i(e)||o(n,e),"width"in e||"height"in e||(e.width=n.width,e.height=n.height)}}})),
/*! Toxilib discretizer
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/discretizer",[],(function(){return function(e,{xMin:t,xMax:n,yMin:i,yMax:o,cellSize:r,xCellsCount:s=e.width,yCellsCount:a=e.height}){let l,c;if(r)l=1/r,c=l,s=Math.ceil((n-t)*l),a=Math.ceil((o-i)*c);else{if(!s)throw new Error("Discretizer needs a cellSize or a xCellsCount param or a width on the object");if(!a)throw new Error("Discretizer needs a cellSize or a yCellsCount param or a height on the object");l=s/(n-t),c=a/(o-i)}e.discretize=function({x:e,y:r}){return e<t||n<e||r<i||o<r?null:{x:(e-t)*l|0,y:(o-r)*c|0}},e.gridIndexToGridCoords=function(e){let t=Math.floor(e/s);return{x:e-t*s,y:t}};const u=t+.5/l,h=o-.5/c;return e.gridIndexToCoords=function(e){let t=Math.floor(e/s);return{x:u+(e-t*s)/l,y:h-t/c}},e.gridCoordsToCoords=function({x:e,y:t}){return{x:u+e/l,y:h-t/c}},{xCellsCount:s,yCellsCount:a}}})),
/*! Toxilib download
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/download",[],(function(){function e({name:e,fileName:t=e,url:n,mimeType:i}){let o=window.document.createElement("a");o.download=t,o.href=n,o.dataset.downloadurl=[i,t,n].join(":");let{body:r}=window.document;r.appendChild(o),o.click(),setTimeout((function(){r.removeChild(o),window.URL.revokeObjectURL(n)}),0)}function t(t,n){const i="image/png";e({fileName:n,mimeType:i,url:t.toDataURL(i)})}function n(t,n,o=.7){i(n)||(n+=".jpg");const r="image/jpeg";e({fileName:n,mimeType:r,url:t.toDataURL(r,o)})}function i(e){return e.slice((Math.max(0,e.lastIndexOf("."))||1/0)+1)}return{downloadAsFile:function({name:t,fileName:n=t,content:i}){let o,r="text/plain";n.endsWith(".json")&&(r="application/json"),i instanceof Blob?o=i:i instanceof ArrayBuffer||i instanceof Uint8Array?(r="application/octet-stream",o=new Blob([i],{type:r})):(i="object"==typeof i?JSON.stringify(i):i.toString(),o=new Blob([i],{type:`${r};charset=utf-8`})),e({url:URL.createObjectURL(o),fileName:n,mimeType:r})},downloadCanvasAsImage:function(e,{format:o,name:r="new_image",fileName:s=r,quality:a}){if(!o){let e=i(s);o="jpg"===e||"jpeg"===e?"jpg":"png"}if("png"===o)t(e,s);else{if("jpg"!==o&&"jpeg"!==o)throw new Error(`Format ${o} not supported`);n(e,s,a)}},downloadCanvasAsPNG:t,downloadCanvasAsJPG:n,blobToBase64:function(e){return new Promise(((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=n,i.readAsDataURL(e)}))}}})),
/*! Toxilib screen_image_import_export
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_image_import_export",["./topleft_and_pivot","./auto_dimensions","./screen_image_utils","./download"],(function(e,t,n,i){const{downloadCanvasAsImage:o,downloadAsFile:r,blobToBase64:s}=i,{containsPositionParam:a,copyPositionParam:l}=e,{getCropParams:c}=n;let u,h;const d={};function p(e,t,n){"string"==typeof t?function(e,t,n){if(t.endsWith(".mp4"))return void function(e,t,n){const i=document.createElement("video");let o;i.crossOrigin="Anonymous",i.src=t,e.queueForAfterLoad=[],i.addEventListener("canplay",(()=>{i.muted=!0,i.width=i.videoWidth,i.height=i.videoHeight,i.play()})),i.addEventListener("timeupdate",(function(){o||(o=!0,y(e,i,n))}),!1)}(e,t,n);const i=new Image;i.crossOrigin="Anonymous",i.src=t,g(e,i,n)}(e,t,n):t instanceof u?f(e,t,n):t instanceof HTMLImageElement?g(e,t,n):t instanceof HTMLVideoElement?function(e,t,n){t.readyState>=1?y(e,t,n):t.addEventListener("canplay",(()=>y(e,t,n)))}(e,t,n):t instanceof HTMLCanvasElement?function(e,t,n){let{cropSource:i,whenLoaded:o=()=>{}}=n;const r=S(t,n),{cropped:s,rescaled:a}=r;e.syncFromSource=function(){(s||a)&&(t=x(t,r),i={}),w(e,t,i),h(e,n)},e.syncFromSource(),o(e)}(e,t,n):t instanceof ImageData?m(e,t,n):t.toImageData&&function(e,t,n){const{whenLoaded:i=()=>{}}=n;n=Object.assign({},n),function(e){const{cropSource:t}=e;t&&(a(e)||l(t,e),_(e,t))}(n),function(e,t){if("getCamera"in t){const n=t.getCamera();a(e)||(e.center=n.center),_(e,n)}}(n,t),delete n.cropSource,delete n.whenLoaded,e.syncFromSource=function(){const i=t.toImageData(n.cropSource);m(e,i,n)},e.syncFromSource(),i(e)}(e,t,n)}function f(e,t,n){const{whenLoaded:i=()=>{}}=n,{queueForAfterLoad:o}=t;o?(e.queueForAfterLoad=[],o.push((()=>f(e,t,n)))):(function(e,t){a(e)||l(t,e);_(e,t)}(n=Object.assign({},n),t),delete n.whenLoaded,e.syncFromSource=function(){const{imageData:i}=t;m(e,i,n)},e.syncFromSource(),v(e),i(e))}function g(e,t,n){t.complete?y(e,t,n):(e.queueForAfterLoad=[],t.addEventListener("load",(()=>y(e,t,n))))}function m(e,t,n){const{whenLoaded:i=()=>{}}=n;let o=S(t,n);const{cropped:r,rescaled:s}=o;function a(){if(r||s){const{cropSource:n,widthInPixels:i,heightInPixels:r}=o;let s=b(t,n);o=S(s,{widthInPixels:i,heightInPixels:r}),o.rescaled&&(s=x(s,o)),w(e,s)}else e.imageData=t,e.imageDataData=t.data}a(),e.syncFromSource||(e.syncFromSource=a),h(e,n),i(e)}function y(e,t,n){const{whenLoaded:i=()=>{}}=n;e.syncFromSource=function(){t.originalBlob&&(e.originalBlob=t.originalBlob);const i=x(t,S(t,n));w(e,i),h(e,n)},e.syncFromSource(),v(e),i(e)}function v(e){const{queueForAfterLoad:t=[]}=e;delete e.queueForAfterLoad,t.forEach((t=>t(e)))}function b(e,t={}){const{width:n=e.width,height:i=e.height,topLeftX:o=0,topLeftY:r=0}=t,s=document.createElement("canvas");s.width=n,s.height=i;return s.getContext("2d").putImageData(e,-o,-r),s}function x(e,{cropSource:t,widthInPixels:n,heightInPixels:i}){const{width:o,height:r,topLeftX:s,topLeftY:a}=t,l=document.createElement("canvas");l.width=n,l.height=i;const c=l.getContext("2d");return function(e){e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1}(c),c.drawImage(e,s,a,o,r,0,0,n,i),l}function w(e,t,n={}){const i=t.getContext("2d"),{topLeft:o={},width:r=t.width,height:s=t.height}=n,{x:a=0,y:l=0}=o,c=i.getImageData(a,l,r,s);e.imageData=c,e.imageDataData=c.data}function _(e,{width:t,height:n}){void 0===e.width&&void 0===e.height&&(void 0!==t&&(e.width=t),void 0!==n&&(e.height=n))}function S(e,n){const i=c(e,n.cropSource);let{widthInPixels:o,heightInPixels:r,pixelSize:s}=n;if(s){let{width:e,height:a}=t(Object.assign({sourceWidth:i.width,sourceHeight:i.height},n));o=Math.ceil(e/s),r=Math.ceil(a/s)}let a=t({width:o,height:r,sourceWidth:i.width,sourceHeight:i.height});o=Math.round(a.width),r=Math.round(a.height);const l=o!==e.width||r!==e.height,{cropped:u}=i;return{cropSource:i,widthInPixels:o,heightInPixels:r,rescaled:l,cropped:u}}return d.toCanvas=function(e={}){let t=b(this.imageData);const n=S(t,e),{cropped:i,rescaled:o}=n;return(i||o)&&(t=x(t,n)),t},d.toScreenCanvas=function(e={}){const{ScreenCanvas:t}=u;if(!t)throw new Error("You should add the ScreenCanvas lib to your project to be able to export with toScreenCanvas()");return new t(this.toCanvas(e))},d.toScreen=function(e={}){const{Screen:t}=u;if(!t)throw new Error("You should add the Screen lib to your project to be able to export with toScreen()");const n=this.toCanvas(e),i=new t(n),{center:o,width:r}=this.getPosition();return i.setCamera({center:o,scale:n.width/r}),i},d.toImageData=function(e){return e?this.toCanvas(e).toImageData():this.imageData},d.toDataURL=function(e){return this.toCanvas(e).toDataURL()},d.toImageBitmap=function(e){const t=this.toCanvas(e);return createImageBitmap(t)},d.toBlob=function(e={}){const{type:t="image/png",quality:n}=e,i=this.toCanvas(e);return new Promise((e=>i.toBlob(e,t,n)))},d.toBase64=function(e={}){return new Promise(((t,n)=>{this.toBlob(e).then(s).catch(n)}))},d.toPNGImage=function(e={}){const t=this.toCanvas(e),n=new Image;return new Promise((i=>{n.addEventListener("load",(()=>{i(n),e.whenLoaded&&e.whenLoaded(n)})),n.src=t.toDataURL("image/png")}))},d.download=function(e={}){e=Object.assign({name:"screen_image"},e);let t=()=>{if(!this.touched&&this.originalBlob){let{name:t,fileName:n=t}=e;r({name:n,content:this.originalBlob})}else o(this.toCanvas(e),e)};this.queueForAfterLoad?this.queueForAfterLoad.push(t):t()},d.getCompanionScreen=function(){return this.companionScreen||(this.companionScreen=this.toScreen()),this.companionScreen},function(e,t){u=e,h=t;for(let e in d)u.prototype[e]=d[e];return{importFromSource:p}}})),
/*! Toxilib screen_image
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_image",["./topleft_and_pivot","./discretizer","./auto_dimensions","./color","./screen_image_import_export"],(function(e,t,n,i,o){const{getTopLeftPoint:r,copyPositionParam:s,addPositionAccessors:a}=e,{autoConvertToRGB255:l,convertTo255:c}=i;function u(e){"onLoad"in e&&(e.whenLoaded=e.onLoad,console.warn("Deprecation for screen images - onLoad has been replaced with whenLoaded"));const{source:t,whenLoaded:n=()=>{}}=e;!function(e){if("pixelSize"in e){if("widthInPixels"in e)throw new Error("You can not set widthInPixels when pixelSize is specified");if("heightInPixels"in e)throw new Error("You can not set heightInPixels when pixelSize is specified")}}(e),t?h(this,t,e):(d(this,e),n(this)),this.syncFromSource||(this.syncFromSource=()=>{})}u.instancePixelMethods=null,u.directPixelMethodsOnPrototype=["makeOpaque","fillWithColor"];const{importFromSource:h}=o(u,d);function d(e,t){let{widthInPixels:n,heightInPixels:o,useOpacity:r}=t;const{imageData:s}=e;s?(n=s.width,o=s.height,e.widthInPixels=n,e.heightInPixels=o):(n&&(n=Math.round(n)),o&&(o=Math.round(o))),function(e,t,{widthInPixels:n,heightInPixels:i}){p(e,t,{widthInPixels:n,heightInPixels:i}),void 0===n&&void 0!==i&&(n=Math.round(i*e.width/e.height));void 0!==n&&void 0===i&&(i=Math.round(n*e.height/e.width));const{pixelSize:o}=t,{xCellsCount:r,yCellsCount:s}=f(e,{widthInPixels:n,heightInPixels:i,pixelSize:o});e.widthInPixels=r,e.heightInPixels=s,e.pixelsCount=r*s,function(e){let{width:t,height:n}=e;Object.defineProperty(e,"width",{get:()=>t,set:n=>{t!==n&&(t=n,f(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"height",{get:()=>n,set:t=>{n!==t&&(n=t,f(e))},enumerable:!0,configurable:!0}),e.batchUpdatePosition=function(i){let{center:o}=e;t===i.width&&n===i.height&&o.x===i.center.x&&o.y===i.center.y||(t=i.width,n=i.height,e.center=i.center)}}(e)}(e,t,{widthInPixels:n,heightInPixels:o}),e.addOnePixelMethods=function(){let t;if(u.instancePixelMethods||(t=Object.keys(e)),function(e){let{widthInPixels:t,imageDataData:n}=e;e.getFastColorAtIndex=function(e){return{red:n[e*=4]/255,green:n[e+1]/255,blue:n[e+2]/255,opacity:n[e+3]/255}},e.getFastColorAtPixelCoords=function(n){return e.getFastColorAtIndex(n.x+n.y*t)},e.getFastColorAt=function(n){const i=this.discretize(n);return i?e.getFastColorAtIndex(i.x+i.y*t):null},e.getColorAtIndex=function(e){return new i(n[e*=4]/255,n[e+1]/255,n[e+2]/255,n[e+3]/255)},e.getColorAtPixelCoords=function(n){return e.getColorAtIndex(n.x+n.y*t)},e.getColorAt=function(n){const i=this.discretize(n);return i?e.getColorAtIndex(i.x+i.y*t):null}}(e),function(e,{useOpacity:t}){let{widthInPixels:n,imageDataData:i}=e,o=!0;e.setColorAtIndex=t?function(t,n){o&&(e.touched=!0,o=!1),t*=4;const r=l(n),{opacity:s=1}=n;i[t]=r.red,i[t+1]=r.green,i[t+2]=r.blue,i[t+3]=c(s)}:function(t,n){o&&(e.touched=!0,o=!1),t*=4;const r=l(n);i[t]=r.red,i[t+1]=r.green,i[t+2]=r.blue};const{setColorAtIndex:r}=e;e.setLight255AtIndex=function(t,n){o&&(e.touched=!0,o=!1),i[t*=4]=n,i[t+1]=n,i[t+2]=n},e.setColorAtPixelCoords=function(e,t){r(e.x+e.y*n,t)},e.setColorAt=function(t,i){const o=e.discretize(t);o&&r(o.x+o.y*n,i)}}(e,{useOpacity:r}),!u.instancePixelMethods){let n=Object.keys(e);u.instancePixelMethods=n.filter((e=>!t.includes(e)))}},t.bare||(s||function(e){const{widthInPixels:t,heightInPixels:n}=e;e.imageData=new ImageData(t,n),e.imageDataData=e.imageData.data,e.makeOpaque()}(e),e.addOnePixelMethods(),a(e,{whenChanged:()=>f(e)}))}function p(e,t,{widthInPixels:i,heightInPixels:o}){const{width:r=e.width,height:a=e.height,orientation:l}=t;if(l)throw new Error("orientation not yet implemented for ScreenImage");const c=n({width:r,height:a,sourceWidth:i,sourceHeight:o});e.width=c.width,e.height=c.height,s(t,e,{replace:!0})}function f(e,{pixelSize:n,widthInPixels:i=e.widthInPixels,heightInPixels:o=e.heightInPixels}={}){const r=e.getPosition();if(!r)return{xCellsCount:i,yCellsCount:o};const{width:s,height:a,topLeft:l}=r,{x:c,y:u}=l,h=t(e,{xMin:c,xMax:c+s,yMin:u-a,yMax:u,xCellsCount:i,yCellsCount:o,cellSize:n});return e.pixelCoordsToCoords=e.gridCoordsToCoords,e.coordsToPixelCoords=e.discretize,e.whenDiscretizationChanged&&e.whenDiscretizationChanged(),h}return u.prototype.setColorForEachPixel=function(e){const{pixelsCount:t,gridIndexToCoords:n,setColorAtIndex:i}=this;for(let o=0;o<t;o++){const{x:t,y:r}=n(o);i(o,e(t,r))}},u.prototype.setColorForEachPixelUsingPixelCoords=function(e){const{pixelsCount:t,gridIndexToGridCoords:n,setColorAtIndex:i}=this;for(let o=0;o<t;o++){const{x:t,y:r}=n(o);i(o,e(t,r))}},u.prototype.setColorForEachPixelUsingIndex=function(e){const{pixelsCount:t,setColorAtIndex:n}=this;for(let i=0;i<t;i++)n(i,e(i))},u.prototype.modifyColors=function(e){const{pixelsCount:t,getColorAtIndex:n,setColorAtIndex:i}=this;for(let o=0;o<t;o++)i(o,e(n(o)))},u.prototype.makeOpaque=function(){const{pixelsCount:e,imageDataData:t}=this,n=4*e;for(let e=0;e<n;e+=4)t[e+3]=255},u.prototype.fillWithColor=function(...e){this.touched=!0;const{red:t,green:n,blue:i}=l(...e),{pixelsCount:o,imageDataData:r}=this,s=4*o;for(let e=0;e<s;e+=4)r[e]=t,r[e+1]=n,r[e+2]=i},u.prototype.fillWithCheckers=function(){this.touched=!0;const{pixelsCount:e,imageDataData:t,gridIndexToGridCoords:n}=this;for(let i=0;i<e;i++){const e=4*i,{x:o,y:r}=n(i);let s=0;o%2+r%2==1&&(s=255),t[e]=s,t[e+1]=s,t[e+2]=s}},u.prototype.removeBackground=function(e){Array.isArray(e)||(e=[e]),e=e.map((e=>(e instanceof i||(e=new i(e)),e))),this.modifyColors((function(t){for(let n=0;n<e.length;n+=1)if(t.equals(e[n]))return{red:0,green:0,blue:0,opacity:0};return t}))},u.prototype.getPosition=function(){const{width:e,height:t}=this,n=r(this,e,t);return n?{topLeft:n,center:{x:n.x+e/2,y:n.y-t/2},width:e,height:t,orientation:0}:null},u.prototype.updatePosition=function(e){console.warn("ScreenImage.updatePosition is deprecated... Now you can just do screenImage.center = {x, y} or screenImage.width = 56"),p(this,e,this)},u})),
/*! Toxilib screen_canvas
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_canvas",["./screen_canvas_style","./topleft_and_pivot","./bezier","./auto_dimensions","./screen_image_utils","./screen_image","./color","./download"],(function(e,t,n,i,o,r,s,a){const{downloadCanvasAsImage:l,blobToBase64:c}=a,{getCropParams:u,getUsableImageAndPositionParams:h,getImageByUrl:d}=o,p=Math.PI/180;let f,g;function m(t){f||(f=O(),g=f.getContext("2d")),this.canvas=t,this.cx=t.getContext("2d"),this.canvasStyle=new e(this)}r.ScreenCanvas=m,m.prototype.updatedDimensions=function(){this.canvasStyle.resetStyle();let{width:e,height:t}=this.canvas;return{width:e,height:t}},m.prototype.clear=function(e={}){let{x:t=0,y:n=0,width:i=this.canvas.width,height:o=this.canvas.height,color:r}=e;t=Math.floor(t),n=Math.floor(n),i=Math.ceil(i),o=Math.ceil(o),r?function(e,{x:t,y:n,width:i,height:o},r){let{cx:s,canvasStyle:a}=e;a.setSpecialStyles(r),a.setFillStyle(r),"opacity"in r&&s.clearRect(t,n,i,o);e.cx.fillRect(t,n,i,o),a.resetSpecialStyles()}(this,{x:t,y:n,width:i,height:o},e):this.cx.clearRect(t,n,i,o)},m.prototype.resetStyle=function(){this.canvasStyle.resetStyle()},m.prototype.setOpacity=function(e){this.canvasStyle.setOpacity(e)},m.prototype.getOpacity=function(){return this.cx.globalAlpha},m.prototype.isInside=function({x:e,y:t}){return e>=0&&t>=0&&e<this.canvas.width&&t<this.canvas.height};function y(e,t={}){let{canvas:n}=e,{topLeftX:i,topLeftY:o,width:r,height:s,cropped:a}=u(n,t);return a?(f.width=r,f.height=s,g.drawImage(n,-i,-o),f):n}function v(e){if(!e)throw new Error('"points" param is missing');if(!Array.isArray(e))throw new Error('"points" must be an array')}m.prototype.getPixelColor=function(e){if(!this.isInside(e))return!1;let t=this.cx.getImageData(0|e.x,0|e.y,1,1).data;return new s({red255:t[0],green255:t[1],blue255:t[2],opacity:t[3]/255})},m.prototype.toImageData=function(e={}){const{topLeftX:t,topLeftY:n,width:i,height:o}=u(this.canvas,e);return this.cx.getImageData(t,n,i,o)},m.prototype.toDataURL=function(e={}){return y(this,e).toDataURL("image/png")},m.prototype.toBlob=function(e={}){const t=y(this,e),{type:n="image/png",quality:i}=e;return new Promise((e=>{t.toBlob(e,n,i)}))},m.prototype.toBase64=function(e={}){return new Promise(((t,n)=>{this.toBlob(e).then(c).catch(n)}))},m.prototype.toPNGImage=function(e={}){const t=new Image;return new Promise((n=>{t.addEventListener("load",(()=>n(t))),t.src=this.toDataURL(e)}))},m.prototype.downloadAsImage=function(e={}){const t=y(this,e);e=Object.assign({name:"screen"},e),l(t,e)},m.prototype.drawRectangle=function(e){let{width:n,height:i}=e,{cx:o,canvasStyle:r}=this,s=t.getTopLeftPoint(e,n,-i);r.setSpecialStyles(e),(e.color||e.fillColor||e.linearGradient||e.radialGradient)&&(r.setFillStyle(e),o.fillRect(s.x,s.y,n,i)),e.strokeColor&&(r.setStrokeStyle(e),o.strokeRect(s.x,s.y,n,i)),r.resetSpecialStyles()},m.prototype.drawLine=function(e){let{origin:t,end:n,vector:i}=e;if(!t)throw new Error('"origin" param is missing');let{cx:o,canvasStyle:r}=this;if(!n){if(!i)throw new Error('"end" or "vector" param is missing');n={x:t.x+i.x,y:t.y+i.y}}r.setSpecialStyles(e),o.beginPath(),o.moveTo(t.x,t.y),o.lineTo(n.x,n.y),o.closePath(),r.stroke(e),r.resetSpecialStyles()},m.prototype.drawArc=function(e){let{cx:t,canvasStyle:n}=this;n.setSpecialStyles(e),t.beginPath(),_(t,e),t.closePath(),n.strokeAndFill(e),n.resetSpecialStyles()},m.prototype.drawPie=function(e){let{center:t,radius:n,innerRadius:i,startAngle:o,endAngle:r}=e,{cx:s,canvasStyle:a}=this;if(!t)throw new Error('"center" param is missing');if(a.setSpecialStyles(e),s.beginPath(),!i&&(o||r&&360!==r)&&s.moveTo(t.x,t.y),_(s,{center:t,radius:n,startAngle:o,endAngle:r}),i){let e={center:t,radius:i,startAngle:r,endAngle:o,antiClockWise:!0};e.startAngle||e.endAngle||(e.endAngle=-360,s.moveTo(t.x+this.cosAngle*i,t.y-this.sinAngle*i)),_(s,e)}s.closePath(),a.strokeAndFill(e),a.resetSpecialStyles()},m.prototype.drawCircle=m.prototype.drawPie,m.prototype.drawCurve=function(e){let{points:t,smooth:i=0,close:o}=e;v(t),t.length<2||(t.length<3&&(o=!1),P(this,{params:e,beziersParams:n.autoParamsFromPoints({points:t,smooth:i,close:o}),close:o,colorIsFillColor:!1}))},m.prototype.drawFreeShape=function(e){let{points:t,smooth:i=0,close:o=!0}=e;v(t),t.length<2||(t.length<3&&(o=!1),P(this,{params:e,beziersParams:n.autoParamsFromPoints({points:t,smooth:i,close:o}),close:o,colorIsFillColor:!0}))},m.prototype.drawPolygon=m.prototype.drawFreeShape,m.prototype.drawLines=m.prototype.drawCurve,m.prototype.drawBezier=function(e){P(this,{params:e,beziersParams:[e],colorIsFillColor:!1})},m.prototype.drawBezierPath=function(e){P(this,{params:e,beziersParams:e.beziers,colorIsFillColor:!1})},m.prototype.drawText=function(e){let{text:t,orientation:n,flip:i}=e,{canvasStyle:o}=this;o.setFont(e),o.setSpecialStyles(e),"object"!=typeof t||Array.isArray(t)||(t=JSON.stringify(t));let r=function({topLeft:e,topRight:t,bottomLeft:n,bottomRight:i,center:o,bottom:r,bottomCenter:s=r,top:a,topCenter:l=a,right:c,centerRight:u=c,left:h,centerLeft:d=h}){if(e)return{origin:e,textAlign:"left",textBaseline:"top",multiLineDelta:0};if(t)return{origin:t,textAlign:"right",textBaseline:"top",multiLineDelta:0};if(n)return{origin:n,textAlign:"left",textBaseline:"alphabetic",multiLineDelta:-1};if(i)return{origin:i,textAlign:"right",textBaseline:"alphabetic",multiLineDelta:-1};if(o)return{origin:o,textAlign:"center",textBaseline:"middle",multiLineDelta:-.5};if(s)return{origin:s,textAlign:"center",textBaseline:"alphabetic",multiLineDelta:-1};if(l)return{origin:l,textAlign:"center",textBaseline:"top",multiLineDelta:0};if(u)return{origin:u,textAlign:"right",textBaseline:"middle",multiLineDelta:-.5};if(d)return{origin:d,textAlign:"left",textBaseline:"middle",multiLineDelta:-.5};return!1}(e);if(r.text=t,r.userParams=e,!r.origin)throw new Error('a position param is missing. Include one, for example "center", "topLeft"...');if(function(e,t){"horizontal"===e?"right"===t.textAlign?t.textAlign="left":"left"===t.textAlign&&(t.textAlign="right"):"vertical"===e&&("top"===t.textBaseline?t.textBaseline="alphabetic":"alphabetic"===t.textBaseline&&(t.textBaseline="top"))}(i,r),n||i){let e=this;I(this,{origin:r.origin,orientation:n,flip:i,execute:function(){r.origin={x:0,y:0},T(e,r)}})}else T(this,r);o.resetSpecialStyles()},m.prototype.drawImage=function(e){let{image:t}=e;if("string"==typeof t){const{errorHandler:n}=this;d({url:t,errorHandler:n,callback:t=>x(this,e,t)})}else x(this,e)},m.prototype.drawImageData=function(e){let{imageData:n,smoothing:o=!0,opacity:r=1}=e,{cx:s,canvasStyle:a}=this,{width:l,height:c,sourceWidth:u,sourceHeight:h,pixelSize:d}=function(e,{width:t,height:n,pixelSize:o=!1}){let{width:r,height:s}=e;if(o)t=r*o,n=s*o;else{o=1;let e=i({width:t,height:n,sourceWidth:r,sourceHeight:s});t=e.width,n=e.height}return{width:t,height:n,sourceWidth:r,sourceHeight:s,pixelSize:o}}(n,e),p=t.getTopLeftPoint(e,l,-c)||{x:0,y:0};l===u&&c===h&&1===r?s.putImageData(n,p.x,p.y):(a.setSpecialStyles(e),this.canvasStyle.setSmoothing(o),w(this,{pixelSize:d,width:u,height:h}),this.ghostUnscaledCx.putImageData(n,0,0),s.drawImage(this.ghostUnscaledCanvas,p.x,p.y,l,c)),a.resetSpecialStyles()};const b={forceTopLeft:!0,reverseY:!0};function x(e,n,i){let o=i||n.image;const{image:r,positionParams:s}=h(o,n,b),{scale:a,modifier:l,modifierPixelBox:c,smoothing:u=!0}=n;let{cx:d,canvasStyle:p}=e;if(p.setSmoothing(u),l&&(d=g),p.setSpecialStyles(n),s.orientation)!function(e,{image:n,positionParams:i,params:o}){let{cx:r}=e,{topLeft:s,width:a,height:l,orientation:c,flip:u,cropSource:h}=i;if(!s)throw new Error("Cannot display the image : position is missing");let d=t.getPivot(o,a,-l);d&&(s=t.topLeftPointWithPivot(s,-c,d));function p(){const t=n.imageData||n.toImageData&&n.toImageData();t?(w(e,{pixelSize:1,width:h.width,height:h.height}),e.ghostUnscaledCx.putImageData(t,-h.topLeftX,-h.topLeftY),r.drawImage(e.ghostUnscaledCanvas,0,0,a,l)):r.drawImage(n,h.topLeftX,h.topLeftY,h.width,h.height,0,0,a,l)}I(e,{origin:s,orientation:c,execute:p,flip:u,width:a,height:l})}(e,{image:r,params:n,positionParams:s});else{if(a)throw new Error("Do you really need a scale param ? Talk to Pierre L");!function(e,{image:t,positionParams:n}){let{cx:i}=e,{topLeft:o,width:r,height:s,cropSource:a,flip:l}=n;if(!o)throw new Error("Cannot display the image : position is missing");let c=o.x,u=o.y;const h=t.imageData||t.toImageData&&t.toImageData();"horizontal"===l?(i.save(),i.translate(r+2*c,0),i.scale(-1,1)):"vertical"===l&&(i.save(),i.translate(0,s+2*u),i.scale(1,-1));h?(w(e,{pixelSize:1,width:a.width,height:a.height}),e.ghostUnscaledCx.putImageData(h,-a.topLeftX,-a.topLeftY),i.drawImage(e.ghostUnscaledCanvas,c,u,Math.ceil(r),Math.ceil(s))):i.drawImage(t,a.topLeftX,a.topLeftY,a.width,a.height,c,u,Math.ceil(r),Math.ceil(s));"horizontal"!==l&&"vertical"!==l||i.restore()}(e,{image:r,positionParams:s})}p.resetSpecialStyles(),l&&(l(f),function(e,t){let n=new Image;n.crossOrigin="Anonymous",n.src=e.toDataURL(),n.complete?t(n):n.addEventListener("load",(function(){t(n)}),!1)}(f,(function(e){d.drawImage(e,c.x,c.y)})))}function w(e,{width:t,height:n}){e.ghostUnscaledCanvas||(e.ghostUnscaledCanvas=O(),e.ghostUnscaledCx=e.ghostUnscaledCanvas.getContext("2d")),e.ghostUnscaledCanvas.width=t,e.ghostUnscaledCanvas.height=n}function _(e,{center:t,radius:n,startAngle:i=0,endAngle:o=360,antiClockWise:r}){[i,o]=[-o,-i],n<0&&(n=0),e.arc(t.x,t.y,n,i*p,o*p,r)}function S(e,{text:t,origin:n,userParams:i}){if(i.color||i.fillColor||!i.strokeColor){let{cx:o,canvasStyle:r}=e;r.setFillStyle(i),o.fillText(t,n.x,n.y)}}function C(e,{text:t,origin:n,userParams:i}){if(i.strokeColor&&0!==i.lineWidth){let{cx:o,canvasStyle:r}=e;r.setStrokeStyle(i),o.strokeText(t,n.x,n.y)}}const k=/[0-9.]+(?=px)/,A=1.2,M={left:0,center:.5,right:1};function T(e,{text:t,textAlign:n,textBaseline:i,origin:o,multiLineDelta:r,userParams:s}){const{cx:a}=e;let l;if(a.textBaseline=i,"string"==typeof t){let e=t.split("\n");e.length>1&&(t=e)}let c,{align:u,lineHeight:h=A}=s,{font:d}=s;if(("width"in s||"height"in s)&&("height"in s&&!s.useFontMetrics&&(a.textBaseline="alphabetic"),l=a.font,d=l.replace(k,(function(e){e=parseFloat(e);let n=$(a,t);const{factor:r,width:l}=E({measure:n,pixLineHeight:e*h,origin:o,userParams:s,textBaseline:i});return c=l,""+e*r})),a.font=d),u&&Array.isArray(t)&&u!==n&&(c||(c=L($(a,t))),o.x+=(M[u]-M[n])*c,n=u),a.textAlign=n,Array.isArray(t)){h*=parseFloat(d.match(k)[0]);let n=o.y+r*h*(t.length-1);t.forEach(((t,i)=>{let r={text:t,origin:{x:o.x,y:n+h*i},userParams:s};S(e,r),C(e,r)}))}else{let n={text:t,origin:o,userParams:s};S(e,n),C(e,n)}l&&(a.font=l)}function E({measure:e,pixLineHeight:t,origin:n,userParams:i,textBaseline:o}){let r;const{useFontMetrics:s}=i;let a=L(e),l=R({measure:e,pixLineHeight:t,useFontMetrics:s});return r="width"in i?i.width/a:1/0,"height"in i&&(r=Math.min(r,i.height/l),!s&&n&&function({measure:e,origin:t,factor:n,textBaseline:i,height:o}){Array.isArray(e)?"top"===i?t.y+=R({measure:e[0],useFontMetrics:!1})*n:"middle"===i?t.y+=(e[0].actualBoundingBoxAscent-e[e.length-1].actualBoundingBoxDescent)*n/2:t.y-=e[e.length-1].actualBoundingBoxDescent*n:(t.y-=e.actualBoundingBoxDescent*n,"top"===i?t.y+=o*n:"middle"===i&&(t.y+=o*n/2))}({measure:e,origin:n,factor:r,textBaseline:o,height:l})),{factor:r,height:l*r,width:a*r}}function $(e,t){return Array.isArray(t)?t.map((t=>e.measureText(t))):e.measureText(t)}function L(e){return Array.isArray(e)?Math.max(...e.map((e=>e.width))):e.width}function R({measure:e,pixLineHeight:t,useFontMetrics:n}){return Array.isArray(e)?n?e[0].fontBoundingBoxAscent+e[e.length-1].fontBoundingBoxDescent+t*(e.length-1):e[0].actualBoundingBoxAscent+e[e.length-1].actualBoundingBoxDescent+t*(e.length-1):n?e.fontBoundingBoxAscent+e.fontBoundingBoxDescent:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent}function P(e,{params:t,beziersParams:n,close:i=t.close,colorIsFillColor:o}){let{cx:r,canvasStyle:s}=e;s.setSpecialStyles(t);let{origin:a}=n[0];r.beginPath(),r.moveTo(a.x,a.y),n.forEach((e=>{e.controlOrigin||e.controlEnd?function(e,{origin:t,end:n,controlOrigin:i=t,controlEnd:o=n}){e.bezierCurveTo(i.x,i.y,o.x,o.y,n.x,n.y)}(r,e):r.lineTo(e.end.x,e.end.y)})),i&&r.closePath(),o||t.fillColor?s.strokeAndFill(t):s.stroke(t),s.resetSpecialStyles()}function I(e,{origin:t,orientation:n=0,execute:i,flip:o,width:r=0,height:s=0}){const{cx:a,canvasStyle:l}=e,{x:c,y:u}=t;a.save(),a.translate(c,u),n&&a.rotate(-n*p),"horizontal"===o?(a.translate(r,0),a.scale(-1,1)):"vertical"===o&&(a.translate(0,s),a.scale(1,-1)),i(),a.restore(),l.resetStyle()}function O(){return"undefined"==typeof document?new OffscreenCanvas(10,10):document.createElement("canvas")}return m.prototype.getTextDimensions=function(e){const{cx:t,canvasStyle:n}=this;let{text:i,lineHeight:o=A}=e;const r=t.font;n.setFont(e);let{font:s}=t;if("string"==typeof i){let e=i.split("\n");e.length>1&&(i=e)}let a,l=$(t,i),c=1,u=L(l);return("width"in e||"height"in e)&&(s=s.replace(k,(function(t){t=parseFloat(t);let n=E({measure:l,pixLineHeight:t*o,userParams:e});return c=n.factor,u=n.width,a=n.height,""+Math.round(10*t*c)/10}))),n.setFont({font:r}),a||(a=R({measure:l,pixLineHeight:parseFloat(s.match(k)[0])*o,useFontMetrics:e.useFontMetrics})),{width:u,font:s,height:Math.round(a)}},m})),
/*! Toxilib local_2D
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/local_2D",[],(function(){const e={o:{x:0,y:0},i:{x:1,y:0},localLengthToGlobal:1},t=Math.PI/180,n=1/t;function i(e){this.initialize2D(e)}function o({relativeTo:t=e,x:n,y:o,orientation:r,scale:s=1,link:a}={}){"function"==typeof t&&(t=t()),"localLengthToGlobal"in t||(t=new i(t)),this.referenceFrame=t,this.xAsChild="function"==typeof n?n():n||0,this.yAsChild="function"==typeof o?o():o||0,this.orientationAsChild="function"==typeof r?r():r||0,this.scaleAsChild="function"==typeof s?s():s,C(this),a&&t&&("children"in t?t.children.push(this):t.children=[this])}function r({x:e=null,y:t=null,orientation:n=null,scale:i=null}={}){if(null!==e&&(this.xAsChild=e),null!==t&&(this.yAsChild=t),null!==n&&(this.orientationAsChild=n),null!==i&&(this.scaleAsChild=i),C(this),delete this._cachedFrameGlobalOrientation,delete this._inverseSquarelocalLengthToGlobal,this.children)for(let e of this.children)e.updateReference()}function s(){let{i:e}=this;return{x:-e.y,y:e.x}}function a(e,t){return t*e.localLengthToGlobal/this.localLengthToGlobal}function l(e){return this.localLengthToGlobal*e}function c(e){return e/this.localLengthToGlobal}function u(e,t){return k(e)+t-k(this)}function h(e=0){return k(this)+e}function d(e=0){return e-k(this)}function p(e,t,n){let{i:i}=e,o=i.x*t-i.y*n,r=i.y*t+i.x*n;return this.localVector(o,r)}function f(e,t){this._inverseSquareLocalLengthToGlobal||(this._inverseSquareLocalLengthToGlobal=1/(this.localLengthToGlobal*this.localLengthToGlobal));let{i:n}=this;return{x:(n.x*e+n.y*t)*this._inverseSquareLocalLengthToGlobal,y:(n.x*t-n.y*e)*this._inverseSquareLocalLengthToGlobal}}function g(e,t,n){let{i:i,o:o}=e,r=o.x+i.x*t-i.y*n,s=o.y+i.y*t+i.x*n;return this.localVector(r-this.o.x,s-this.o.y)}function m(e,t){return this.localVector(e-this.o.x,t-this.o.y)}function y(...e){let t=e.shift();return e.map((e=>this.pointFromFrame(t,e[0],e[1])))}function v(...e){return e.map((e=>S(this,e[0],e[1])))}function b(...e){return e.map((e=>this.localPoint(e[0],e[1])))}function x(e){if("localLengthToGlobal"in e){const{x:t,y:n}=e.o;return new i({x:t,y:n,orientation:k(e),scale:e.localLengthToGlobal,relativeTo:this})}{const{x:t,y:n,orientation:o,scale:r}=e;return new i({x:t,y:n,orientation:o,scale:r,relativeTo:this})}}function w(e){Object.assign(e,{initialize2D:o,updateReference:r,j:s,lengthFromFrame:a,globalLength:l,localLength:c,orientationFromFrame:u,globalOrientation:h,localOrientation:d,vectorFromFrame:p,globalVector:function(e,t){return _(this,e,t)},localVector:f,pointFromFrame:g,globalPoint:function(e,t){return S(this,e,t)},localPoint:m,pointsFromFrame:y,globalPoints:v,localPoints:b,globalBase:x})}function _(e,t,n){let{i:i}=e;return{x:i.x*t-i.y*n,y:i.y*t+i.x*n}}function S(e,t,n){let{o:i,i:o}=e;return{x:i.x+o.x*t-o.y*n,y:i.y+o.y*t+o.x*n}}function C(e){let{referenceFrame:n,orientationAsChild:i,scaleAsChild:o}=e,r=t*i;if(e.o=S(n,e.xAsChild,e.yAsChild),e.i=_(n,o*Math.cos(r),o*Math.sin(r)),"localLengthToGlobal"in n)e.localLengthToGlobal=n.localLengthToGlobal*o;else{let{x:t,y:n}=e.i;e.localLengthToGlobal=Math.sqrt(t*t+n*n)}}function k(e){if(!("_cachedFrameGlobalOrientation"in e)){let{i:t}=e;e._cachedFrameGlobalOrientation=Math.atan2(t.y,t.x)*n}return e._cachedFrameGlobalOrientation}return w(i.prototype),{ReferenceFrame:i,addLocal2DCapabilities:w,referenceFrameFromGroupParams:function(e){const{x:t,y:n,orientation:o,scale:r=1}=e;if(t||n||o||1!==r)return new i(e);let{relativeTo:s}=e;return"function"==typeof s&&(s=s()),s&&!("localLengthToGlobal"in s)?new i(s):s},referenceFrameFromScreenObject:function(e){let{x:t,y:n,orientation:o,scale:r}=e.viewPosition,{relativeTo:s}=e;return new i({x:t,y:n,orientation:o,scale:r,relativeTo:s})},globalPointFromReferenceFrame:function(e,n,i){if("globalPoint"in e)return e.globalPoint(n,i);let{scale:o=1,orientation:r=0,x:s=0,y:a=0}=e;if(0===r)return{x:s+o*n,y:a+o*i};{const e=r*t;let l=Math.cos(e),c=Math.sin(e);return{x:s+o*(n*l-i*c),y:a+o*(n*c+i*l)}}},localPointInReferenceFrame:function e(n,i,o){if("function"==typeof n&&(n=n()),"localPoint"in n)return n.localPoint(i,o);let{scale:r=1,orientation:s=0,x:a=0,y:l=0,relativeTo:c}=n;if(c&&({x:i,y:o}=e(c,i,o)),0===s)return{x:(i-a)/r,y:(o-l)/r};{const e=s*t;let n=Math.cos(e),c=Math.sin(e),u=(i-a)/r,h=(o-l)/r;return{x:u*n+h*c,y:-u*c+h*n}}}}})),
/*! Toxilib stroke
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/stroke",[],(function(){function e({leftPath:e,rightPath:t,point:n,delta:i,angle:o}){let r=i*Math.cos(o),s=i*Math.sin(o),{x:a,y:l}=n;e.push({x:a+r,y:l+s}),t.push({x:a-r,y:l-s})}function t({x:e,y:t},n,i){let o;if(n&&(o=Math.atan2(t-n.y,e-n.x)),!i)return o-Math.PI/2;let r=Math.atan2(t-i.y,e-i.x);if(!n)return r+Math.PI/2;let s=(o+r)/2;return s<r&&(s+=Math.PI),s}return function({points:n,width:i=.1,widthEnvelope:o=!1,pointyEnds:r=!1}){this.width=i,this.widthEnvelope=o,this.envelope=function({points:n,width:i,widthEnvelope:o,pointyEnds:r}){let s=n[0],a=n[n.length-1],l=i/2,c=[s],u=[s],h=r?1:0,d=n.length-h;for(let i=h;i<d;i++){let r=n[i],s=t(r,n[i-1],n[i+1]),a=l;if(o){a*=o({ratio:i/n.length,point:r})}e({leftPath:c,rightPath:u,point:r,delta:a,angle:s})}return r?[...c,a,...u.toReversed()]:[...c,...u.toReversed()]}({points:n,width:i,widthEnvelope:o,pointyEnds:r})}})),
/*! Toxilib screen_shapes
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_shapes",["./topleft_and_pivot","./local_2D","./stroke","./screen_image_utils"],(function(e,t,n,i){const{rotateVector:o,pointsForRectangle:r}=e,{referenceFrameFromGroupParams:s,referenceFrameFromScreenObject:a,localPointInReferenceFrame:l}=t,{addImageDefaultPositionParams:c}=i;const u={};let h=["drawLine","drawArc","drawPie","drawCircle","drawBezier","drawBezierPath","drawCurve","drawFreeShape","drawText","drawPolygon","drawLines"];u.drawRectangle=function(e){if(!(e.orientation||e.relativeTo||e.roundedCorners||this.orientation))return void function(e,t){t=I(e,t),e.drawAdapter.drawRectangle(t)}(this,e);const t=r(e,this.yDir);let{relativeTo:n,roundedCorners:i,lineWidth:o,opacity:s,blendMode:a,filter:l,shadow:c,blur:u,fillColor:h,color:d=h,strokeColor:p,linearGradient:f,radialGradient:g}=e;O(this,e={points:t,relativeTo:n,roundedCorners:i,lineWidth:o,opacity:s,blendMode:a,filter:l,shadow:c,blur:u,color:d,strokeColor:p,linearGradient:f,radialGradient:g}),e.roundedCorners&&(!function(e){const{points:t,roundedCorners:n}=e,i=[];t.forEach((function(e,o){let r=t[(o+1)%t.length],s=S(e,r,n),a=S(r,e,n);s.controlPrevious=C(s,e,w),s.controlNext=C(s,e,_),a.controlPrevious=C(a,r,_),a.controlNext=C(a,r,w),i.push(s,a)})),i.push(i[0]),e.points=i}(e),e.close=!1),this.drawAdapter.drawFreeShape(e)},u.drawStroke=function(e){let{relativeTo:t,opacity:i,blendMode:o,filter:r,shadow:s,blur:a,strokeColor:l,color:c=l,close:u=!1}=e,h=F(e.stroke);if(!h){const t=F(e.points),i=F(e.width),o=F(e.pointyEnds),{widthEnvelope:r}=e;h=new n({points:t,width:i,widthEnvelope:r,pointyEnds:o})}O(this,e={relativeTo:t,points:h.envelope,fillColor:c,opacity:i,blendMode:o,filter:r,shadow:s,blur:a,close:u}),this.drawAdapter.drawFreeShape(e)};const d=5,p=30;u.drawArrow=function(e){let{branchLengthRatio:t=d,branchAngle:n=p,relativeTo:i}=e;"function"==typeof n&&(n=n()),"function"==typeof t&&(t=t()),n+=180;const r=F(e.origin);if(!r)throw new Error('"origin" param is missing');let s,a,l=F(e.vector);if(!l){const t=F(e.end);if(!t)throw new Error('"end" or "vector" param is missing');l={x:t.x-r.x,y:t.y-r.y}}"lineWidth"in e?(s=e.lineWidth,"function"==typeof s&&(s=s()),a=s*t/D(l.x,l.y)):(s=.02*D(l.x,l.y),a=.02*t);const c=F(e.opacity),u=F(e.blendMode),h=F(e.filter),f=F(e.shadow),g=F(e.blur),m=F(e.color||e.strokeColor);let y={x:l.x*a,y:l.y*a},v=o(y,n),b=o(y,-n),x={origin:r,vector:l,lineWidth:s,color:m,opacity:c,blendMode:u,filter:h,shadow:f,blur:g,relativeTo:i};this.drawLine(x),x.origin={x:r.x+l.x,y:r.y+l.y},x.vector=v,this.drawLine(x),x.vector=b,this.drawLine(x)};u.drawAxes=function(e){const t=F(e.orientation),n=F(e.center)||{x:0,y:0};let{xMin:i,yMin:r,width:s,height:a}=v(this,{center:n,orientation:t});const l=F(e.color)||"#06F",c=F(e.opacity);!function(e,{height:t,width:n,localXMin:i,localYMin:r,center:s,orientation:a=0,lineWidth:l=.01*Math.min(n,t),opacity:c=1,color:u="#888"}){let h=o({x:1,y:0},a),d=o({x:0,y:1},a);e.drawLine({origin:{x:s.x+d.x*r,y:s.y+d.y*r},vector:{x:d.x*t,y:d.y*t},color:u,opacity:c,lineWidth:l}),e.drawLine({origin:{x:s.x+h.x*i,y:s.y+h.y*i},vector:{x:h.x*n,y:h.y*n},color:u,opacity:c,lineWidth:l})}(this,{width:s,height:a,localXMin:i,localYMin:r,center:n,orientation:t,lineWidth:F(e.lineWidth),color:l,opacity:c})},u.drawGrid=function(e={}){const t=F(e.orientation),n=F(e.center)||{x:0,y:0};let i,r=this;function s(){return i||(i=v(r,{center:n,orientation:t})),i}const a=F(e.step)||function({width:e,height:t}){let n=Math.min(e,t)/6;return Math.max(y(n,1),y(n,2),y(n,5))}(s());if(a*this.scale<1)return;const l=F(e.color),c=F(e.opacityLimit);let{axes:u=!0}=e;u=F(u);let h,d=F(e.localXMin),p=F(e.localXMax);void 0!==d&&void 0!==p?h=p-d:(h=F(e.width),void 0===h?(h=s().width,void 0===d&&(d=s().xMin)):void 0===d&&(d=-h/2));let f,g=F(e.localYMin),m=F(e.localYMax);void 0!==g&&void 0!==m?f=m-g:(f=F(e.height),void 0===f?(f=s().height,void 0===g&&(g=s().yMin)):void 0===g&&(g=-f/2)),function(e,{height:t,width:n,localXMin:i,localYMin:r,step:s,center:a,orientation:l=0,color:c,opacityLimit:u,axes:h}){let d=o({x:1,y:0},l),p=o({x:0,y:1},l);x(e,{axes:h,startIndex:Math.ceil(i/s),endIndex:Math.floor((i+n)/s),center:{x:a.x+p.x*r,y:a.y+p.y*r},lineVector:{x:p.x*t,y:p.y*t},stepVector:{x:d.x*s,y:d.y*s},color:c,opacityLimit:u}),x(e,{axes:h,startIndex:Math.ceil(r/s),endIndex:Math.floor((r+t)/s),center:{x:a.x+d.x*i,y:a.y+d.y*i},lineVector:{x:d.x*n,y:d.y*n},stepVector:{x:p.x*s,y:p.y*s},color:c,opacityLimit:u})}(this,{width:h,height:f,localXMin:d,localYMin:g,step:a,center:n,color:l,opacityLimit:c,axes:u,orientation:t})};u.drawPointsGrid=function(e){const t=F(e.step)||1,n=F(e.color)||"#EEE",i=F(e.boundingBox)||this.boundingBoxForWholeView();if(t*this.scale<8)return;const{xMin:o,yMin:r,width:s,height:a}=i,l=Math.floor(o/t),c=Math.floor(r/t),u=l+s/t+1,h=c+a/t+1;for(let e=c;e<h;e++)for(let i=l;i<u;i++){let o=t*(i%2==0||e%2==0?.06:.1);this.drawCircle({center:{x:i*t,y:e*t},radius:o,color:n})}};function f(e,t){t=N(t);const{image:n}=t;n&&c(t,n),O(e,t),e.drawAdapter.drawImage(t)}u.drawDebugReference=function(e={}){const t=F(e.o)||{x:0,y:0},n=F(e.i)||{x:1,y:0},i=F(e.j)||{x:0,y:1},o=F(e.color)||"#B20000",r=F(e.scale)||1;this.drawCircle({center:t,radius:.05*r,color:o}),this.drawArrow({origin:t,vector:{x:n.x*r,y:n.y*r},color:o}),this.drawArrow({origin:t,vector:{x:i.x*r,y:i.y*r},color:o})},u.drawDebugGrid=function({color:e,step:t}={}){this.drawGrid({color:e,step:t,opacityLimit:{max:.5,min:.1}})},u.drawVectorFrame=function({scale:e,color:t="#F00"}={}){this.drawDebugReference({color:t,scale:e})},u.drawCameraBox=function(e,t={}){"function"==typeof e&&(e=e());const{center:n,orientation:i,scale:o}=e,{strokeColor:r="#FA0",color:s=!1}=t;let a=this.width/o,l=this.height/o;this.drawRectangle({center:n,width:a,height:l,orientation:i,strokeColor:r,color:s,lineWidth:10/o})},u.drawImage=function(e){let t=e;e.image||(t={image:e});let{queueForAfterLoad:n}=t.image||{};n?n.push((()=>f(this,t))):f(this,t)},u.drawCustom=function(e){const{drawAdapter:t,adapterScale:n,adapterScaleY:i,center:o,centerPix:r}=this,{cx:s,canvasStyle:a}=t,l=r.x-o.x*n,c=r.y-o.y*i;e(s,{x:l,y:c,scale:n,useScreenCoords:function(){s.setTransform(n,0,0,i,l,c)}}),s.setTransform(1,0,0,1,0,0),a.resyncWithCurrentStyle(),a.resetSpecialStyles()};let g=0;function m(e,t){let n,i=e.relativeTo;return n=i?t.globalBase(i):t,Object.assign({},e,{relativeTo:n})}function y(e,t){return Math.pow(10,Math.floor(Math.log10(e/t)))*t}function v(e,{center:t,orientation:n=0}){let i=e.pixelCoordsToCoords({x:0,y:0}),o=l({x:t.x,y:t.y,orientation:n},i.x,i.y);return e.boundingBox({topLeft:o,width:e.width/e.scale,height:e.height/e.scale,orientation:-n-e.orientation})}u.drawGroup=function(e){let{maxDepth:t=this.groupMaxDepth}=e;if("function"==typeof t&&(t=t()),g>=Math.min(t,this.groupMaxDepth))return;const{view:n,group:i=n}=e;let o,{opacity:r=1}=e.viewPosition||e;r=F(r),1!==r&&(o=this.drawAdapter.getOpacity(),this.drawAdapter.setOpacity(o*r));let l,{elements:c,methods:u,rasterization:h}=F(i),d=e.viewPosition?a(e):s(e);if(h)return d&&(h=m(h,d)),void this.drawImage(h);g+=1;let p,f=this;p=d?function(e,t,n){l=n,f[e](m(t,d))}:function(e,t,n){l=n,f[e](t)};const{cx:y}=this.drawAdapter;let v=y.globalCompositeOperation;try{c.forEach(((e,t)=>p(u[t],e,t)))}catch(e){u.length=l,c.length=l,e.toxiTrace=e.toxiTrace||[],e.toxiTrace.unshift("Toxilibs - screen_group.js - render");const{errorHandler:t}=this;if(!t)throw g-=1,e;t(e)}1!==r&&this.drawAdapter.setOpacity(o),y.globalCompositeOperation!==v&&(y.globalCompositeOperation=v),g-=1};const b=.02;function x(e,{axes:t=!0,startIndex:n,endIndex:i,center:o,lineVector:r,stepVector:s,color:a="#888",opacityLimit:l={max:1,min:.4}}){let c=D(s.x,s.y)*b,u=2*c;"number"==typeof l&&(l={max:l,min:l});for(let h=n;h<=i;h+=1){let n={x:o.x+s.x*h,y:o.y+s.y*h},i=l.min,d=c;t&&0===h&&(i=l.max,d=u),e.drawLine({origin:n,vector:r,color:a,opacity:i,lineWidth:d})}}const w=.5,_=-.25;function S(e,t,n){let i=D(t.x-e.x,t.y-e.y);return r=t,s=0===i?0:n/i,{x:(o=e).x*(1-s)+r.x*s,y:o.y*(1-s)+r.y*s};var o,r,s}function C(e,t,n){return{x:(t.x-e.x)*n,y:(t.y-e.y)*n}}function k(e,t,n){if(n){if("globalLength"in n)return e.adapterScale*n.globalLength(t);{let{scale:i=1}=n;return e.adapterScale*t*i}}return e.adapterScale*t}function A(e,t,n){return n?"globalLength"in n?e.orientation+n.globalOrientation(t):e.orientation+(n.orientation||0)+t:e.orientation+t}function M(e,t,n){return(t=N(t)).relativeTo=n,O(e,t),t}const T=/((\d+\.\d+)|(\d+\.?)|(\.\d+))u\b/g;function E(e,t,n){return t.replace(T,(function(t,i){return`${Math.round(k(e,parseFloat(i,10),n))}px`}))}let $={relativeTo:"referenceFrame",origin:"coords",end:"coords",controlOrigin:"coords",controlEnd:"coords",topLeft:"coords",topRight:"coords",bottomLeft:"coords",bottomRight:"coords",center:"coords",topCenter:"coords",bottomCenter:"coords",centerRight:"coords",centerLeft:"coords",top:"coords",bottom:"coords",right:"coords",left:"coords",innerCircle:"coordsAndRadius",outerCircle:"coordsAndRadius",radius:"length",innerRadius:"length",lineWidth:"smartLength",vector:"vector",pivot:"vector",orientation:"angle",angle:"angle",startAngle:"angle",endAngle:"angle",branchAngle:"angle",points:"points",beziers:"beziers",linearGradient:"linearGradient",radialGradient:"radialGradient",font:"textWithUSyntax",lineHeight:"factor",align:"text",step:"length",offset:"length",width:"length",height:"length",roundedCorners:"length",x:"length",y:"length",localXMin:"length",localXMax:"length",localYMin:"length",localYMax:"length",stroke:"stroke",widthEnvelope:"function",smoothing:"boolean",close:"boolean",pointyEnds:"boolean",axes:"boolean",disableCollision:"boolean",useFontMetrics:"boolean",branchLengthRatio:"factor",smooth:"factor",opacity:"factor",scale:"factor",blendMode:"text",filter:"textWithUSyntax",shadow:"shadow",blur:"smartLength",flip:"text",color:"color",fillColor:"color",strokeColor:"color",image:"image",imageData:"imageData",group:"group",text:"text",url:"text",name:"text",format:"text",fileName:"text",type:"text",cropSource:"cropParams",quality:"number",layer:"number",maxDepth:"number"},L={coords:function(e,t,n){return e.coordsToAdapterCoords(t,n)},coordsAndRadius:function(e,t,n){let i=e.coordsToAdapterCoords(t,n);return i.radius=k(e,t.radius,n),i},length:k,vector:function(e,t,n){return e.vectorCoordsToAdapterCoords(t,n)},angle:A,orientation:A,points:function(e,t,n){return t.map((function({x:t,y:i,controlPrevious:o,controlNext:r}){let s=e.coordsToAdapterCoords({x:t,y:i},n);return o&&(s.controlPrevious=e.vectorCoordsToAdapterCoords(o,n)),r&&(s.controlNext=e.vectorCoordsToAdapterCoords(r,n)),s}))},beziers:function(e,t,n){return t.map((function({origin:t,end:i,controlOrigin:o,controlEnd:r}){return{origin:e.coordsToAdapterCoords(t,n),end:e.coordsToAdapterCoords(i,n),controlOrigin:e.coordsToAdapterCoords(o,n),controlEnd:e.coordsToAdapterCoords(r,n)}}))},linearGradient:M,radialGradient:M,shadow:function(e,t,n){const{blur:i,opacity:o,color:r,xOffset:s=0,yOffset:a=0}=t,{x:l,y:c}=e.vectorCoordsToAdapterCoords({x:s,y:a},n);return{xOffset:l,yOffset:c,blur:i&&k(e,i,n),opacity:o,color:r}},textWithUSyntax:E,smartLength:function(e,t,n){return"string"==typeof t&&t.endsWith("px")?parseFloat(t,10):k(e,t,n)}},R={};for(let e in $)R[e]=L[$[e]];function P(e,t){$[e]=t,R[e]=L[t]}function I(e,t){let n={};return O(e,t,n),n}function O(e,t,n){let i=!1;n||(n=t,i=!0);const o=F(t.relativeTo);for(let r in t){if(!(r in $))continue;let s=t[r];if(void 0===s)continue;let a=R[r];"function"==typeof s&&(s="relativeTo"===r?o:s(),i&&!a&&(n[r]=s)),a?n[r]=a(e,s,o):i||(n[r]=s)}"orientation"in t||!e.orientation&&!o||(n.orientation=A(e,0,o))}function D(e,t){return Math.sqrt(e*e+t*t)}function F(e){return"function"==typeof e?e():e}function N(e){let t={};for(let n in e)t[n]=e[n];return t}return function(e){e.drawingMethods=h.concat(Object.keys(u)),e.paramsTypes=$,e.addParamType=P,e.cloneAndConvert=I,function(e){h.forEach((function(t){var n;e.prototype[t]=(n=t,function(e){e=I(this,e),this.drawAdapter[n](e)})}))}(e);for(let t in u)e.prototype[t]=u[t];e.prototype.scaleUSyntax=function(e){return E(this,e)}}})),
/*! Toxilib deprecation
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/deprecation",[],(function(){function e({messagePrefix:e,object:t,deprecated:n,updated:i,handler:o,onlyWhenCalled:r}){let s;function a(){if(!s){!1!==o({messagePrefix:e,deprecated:n,updated:i})&&(s=!0)}}r&&"function"==typeof t[i]?t[n]=function(...e){return a(),t[i](...e)}:n in t?(a(),t[i]=t[n]):Object.defineProperty(t,n,{enumerable:!0,configurable:!0,set:function(e){a(),t[i]=e},get:function(){return a(),t[i]}})}function t({messagePrefix:e,deprecated:t,updated:n}){console.warn(`${e} : you are using deprecated property "${t}". Use "${n}" instead.`)}return{add:function(n,i,o,{handler:r=t,onlyWhenCalled:s}={}){for(let t in o){e({messagePrefix:n,object:i,deprecated:t,updated:o[t],handler:r,onlyWhenCalled:s})}}}})),
/*! Toxilib number_utils
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/number_utils",[],(function(){return{roundToSignificantDigits:function(e,t=3){if(0===e)return 0;const n=Math.pow(10,t-Math.ceil(Math.log10(Math.abs(e))));return Math.round(e*n)/n},significantDigits:function(e){if(0===(e=Math.abs(String(e).replace(".",""))))return 0;for(;0!==e&&e%10==0;)e/=10;return Math.floor(Math.log10(e))+1},clampInt255:function(e){return e&=(e<0)-1,255&(e|=-(e>255))}}})),
/*! Toxilib screen
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen",["./event_capabilities_queued","./screen_canvas","./screen_shapes","./local_2D","./topleft_and_pivot","./screen_image","./deprecation","./number_utils"],(function(e,t,n,i,o,r,s,a){const{normalizedParamsForRectangle:l}=o,{globalPointFromReferenceFrame:c}=i,{roundToSignificantDigits:u}=a;function h(n,{crispCanvas:i,errorHandler:o,adapter:r=t}={}){Object.getPrototypeOf(n).jquery&&(n=n[0]),this.canvas=n,this.crispCanvas=i,this.drawAdapter=new r(n,{screenParent:this}),o&&(this.errorHandler=o,this.drawAdapter.errorHandler=o),this.internalEventBus={},e(this.internalEventBus),this.groupMaxDepth=20,this.cameraVersion=0,this.updateCanvasSize(),this.yDir=1,this.setScale(1),this.center={x:0,y:0},this.setOrientation(0),this.attachedElements=new Map}r.Screen=h,n(h),h.prototype.updateCanvasSize=function(){let{width:e,height:t}=this.drawAdapter.updatedDimensions();const{width:n,height:i}=this.canvas.getBoundingClientRect();let o=n/e,r=i/t;return(e!==this.width||t!==this.height||o!==this.domScaleX||r!==this.domScaleY)&&(this.width=e,this.height=t,this.widthInPixels=e,this.heightInPixels=t,this.domScaleX=o,this.domScaleY=r,this.centerPix={x:e/2,y:t/2},this.drawAdapter.setCenterAdapterScreenParent?this.centerAdapter=this.drawAdapter.setCenterAdapterScreenParent():this.centerAdapter=this.centerPix,this.cameraVersion+=1,this.internalEventBus.emit("resized"),!0)},h.prototype.clear=function(e){e=Object.assign({},e);let{x:t,y:n,width:i,height:o}=function(e,t={}){let{topLeft:n,pixelZone:i}=t;if(n){let{xMin:n,yMax:i,width:o,height:r}=e.pixBoundingBox(t);return{x:n,y:i,width:o,height:r}}return i||{x:0,y:0,width:e.width,height:e.height}}(this,e);e.x=t,e.y=n,e.width=i,e.height=o,this.drawAdapter.clear(e)},h.prototype.isInside=function(e,t){return this.drawAdapter.isInside(this.coordsToPixelCoords(e,t))},h.prototype.isOutside=function(e,t){return!this.isInside(e,t)},h.prototype.getPixelColor=function(e,t){return this.drawAdapter.getPixelColor(this.coordsToPixelCoords(e,t))};const d=/((\d+\.\d+)|(\d+\.?)|(\.\d+))px\b/g;h.prototype.getTextDimensions=function(e){let{width:t,height:n,font:i}=this.drawAdapter.getTextDimensions(h.cloneAndConvert(this,e));const{scale:o}=this;return t=u(t/o,4),n=u(n/o,4),e.font.includes("px")||(i=i.replace(d,(function(e,t){return`${u(parseFloat(t,10)/o,4)}u`}))),{width:t,height:n,font:i}},h.prototype.toImageData=function(e={}){return e=h.cloneAndConvert(this,e),this.drawAdapter.toImageData(e)},h.prototype.toDataURL=function(e={}){return e=h.cloneAndConvert(this,e),this.drawAdapter.toDataURL(e)},h.prototype.toBlob=function(e={}){return e=h.cloneAndConvert(this,e),this.drawAdapter.toBlob(e)},h.prototype.toBase64=function(e={}){return e=h.cloneAndConvert(this,e),this.drawAdapter.toBase64(e)},h.prototype.toPNGImage=function(e={}){return e=h.cloneAndConvert(this,e),this.drawAdapter.toPNGImage(e)},h.prototype.downloadAsImage=function(e={}){e=h.cloneAndConvert(this,e),this.drawAdapter.downloadAsImage(e)},h.prototype.toScreenImage=function(e={}){return(e=Object.assign({},e)).source=this,e.cropSource=e,new r(e)};const p=Math.PI/180;function f(e,t){return t?c(t,e.x,e.y):e}function g(e){return e}function m(e,t){let{element:n}=t,{$element:i}=n;if(i){if(n.lastAttachedVersion===n.version&&n.lastAttachedCamera===e.cameraVersion)return;n.lastAttachedVersion=n.version,n.lastAttachedCamera=e.cameraVersion,n=i}let o="width"in t,r="height"in t;t=Object.assign({width:n.outerWidth()/e.scale,height:n.outerHeight()/e.scale},t);const{x:s,y:a,width:l,height:c}=e.boxToPixBox(t);o&&n.outerWidth(l),r&&n.outerHeight(c),n.css({position:"absolute",top:`${a}px`,left:`${s}px`,margin:0})}return h.prototype.coordsToPixelCoords=function({x:e,y:t},n){n&&({x:e,y:t}=c(n,e,t));let i=e-this.center.x,o=t-this.center.y;return{x:this.centerPix.x+this.scale*(i*this.cosOrientation-o*this.sinOrientation),y:this.centerPix.y-this.scale*(i*this.sinOrientation+o*this.cosOrientation)}},h.prototype.coordsToAdapterCoords=function({x:e,y:t},n){n&&({x:e,y:t}=c(n,e,t));let i=e-this.center.x,o=t-this.center.y;return{x:this.centerAdapter.x+this.adapterScale*(i*this.cosOrientation-o*this.sinOrientation),y:this.centerAdapter.y+this.adapterScaleY*(i*this.sinOrientation+o*this.cosOrientation)}},h.prototype.vectorCoordsToAdapterCoords=function({x:e,y:t},n){if(n){let i=c(n,0,0),o=c(n,e,t);e=o.x-i.x,t=o.y-i.y}return{x:this.adapterScale*(e*this.cosOrientation-t*this.sinOrientation),y:this.adapterScaleY*(e*this.sinOrientation+t*this.cosOrientation)}},h.prototype.pixelCoordsToCoords=function({x:e,y:t}){let n=(e-this.centerPix.x)/this.scale,i=(t-this.centerPix.y)/this.scale;return{x:this.center.x+(n*this.cosOrientation-i*this.sinOrientation),y:this.center.y-(n*this.sinOrientation+i*this.cosOrientation)}},h.prototype.coordsToDomPix=function({x:e,y:t},n){const{x:i,y:o}=this.coordsToPixelCoords({x:e,y:t},n),{canvas:r,width:s,height:a}=this,l=r.clientWidth/s,c=r.clientHeight/a,{left:u,top:h}=r.getBoundingClientRect();return{x:u+i*l,y:h+o*c}},h.prototype.domPixelCoordsToCoords=function({x:e,y:t}){const{canvas:n,width:i,height:o,domScaleX:r,domScaleY:s}=this,a=i/n.clientWidth,l=o/n.clientHeight,{left:c,top:u}=n.getBoundingClientRect();return this.pixelCoordsToCoords({x:(e+.5-c)*a/r,y:(t+.5-u)*l/s})},h.prototype.mouseEventToCoords=function(e){const{clientX:t,clientY:n}=e;return this.domPixelCoordsToCoords({x:t,y:n})},h.prototype.mouseEventToSmartTrimmedCoords=function(e){const{clientX:t,clientY:n}=e;return this.smartTrimCoords(this.domPixelCoordsToCoords({x:t,y:n}))},h.prototype.touchEventToCoords=function(e){const{clientX:t,clientY:n}=e.touches[0];return this.domPixelCoordsToCoords({x:t,y:n})},h.prototype.touchEventToSmartTrimmedCoords=function(e){const{clientX:t,clientY:n}=e.touches[0];return this.smartTrimCoords(this.domPixelCoordsToCoords({x:t,y:n}))},h.prototype.eventToCoords=function(e){return e.touches?this.touchEventToCoords(e):this.mouseEventToCoords(e)},h.prototype.eventToSmartTrimmedCoords=function(e){return e.touches?this.touchEventToSmartTrimmedCoords(e):this.mouseEventToSmartTrimmedCoords(e)},h.prototype.smartTrimCoords=function({x:e,y:t}){const{smartTrimRatio:n}=this;return{x:Math.round(e*n)/n,y:Math.round(t*n)/n}},s.add("Screen",h.prototype,{mouseEvent2Coords:"mouseEventToCoords",domPix2coords:"domPixelCoordsToCoords",domPixToCoords:"domPixelCoordsToCoords",coords2domPix:"coordsToDomPix",pix2coords:"pixelCoordsToCoords",pixToCoords:"pixelCoordsToCoords",coords2pix:"coordsToPixelCoords",coordsToPix:"coordsToPixelCoords",setOptimalView:"setOptimalCamera",optimalViewParamsFor:"optimalCameraParamsFor"}),h.prototype.boxToPixBox=function(e){let{topLeftPoint:t,width:n,height:i,orientation:o}=l(e,this.yDir);if(o)throw new Error("orientation not supported");const{x:r,y:s}=this.coordsToPixelCoords(t);return n*=this.scale,i*=this.scale,{x:r,y:s,width:n,height:i}},h.prototype.boxToDomStyle=function(e){let{x:t,y:n,width:i,height:o}=this.boxToPixBox(e);return{position:"absolute",top:`${n}px`,left:`${t}px`,width:`${i}px`,height:`${o}px`}},h.prototype.attachElement=function(e){let{element:t}=e;this.attachedElements.set(t,e),m(this,e)},h.prototype.updateAttachedElements=function(){this.attachedElements.forEach((e=>m(this,e)))},h.prototype.getCamera=function(){let{center:e,scale:t,orientation:n,width:i,height:o}=this,{x:r,y:s}=e;return{center:{x:r,y:s},scale:t,width:i/t,height:o/t,orientation:0===n?0:-n}},h.prototype.setCamera=function({center:e,scale:t,orientation:n=!1}){t&&this.setScale(t),e&&this.setCenter(e),!1!==n&&this.setOrientation(-n)},h.prototype.setScale=function(e){this.crispCanvas&&(e*=2),e!==this.scale&&(this.cameraVersion+=1,this.scale=e,this.drawAdapter.setScaleForScreenParent?this.drawAdapter.setScaleForScreenParent():(this.adapterScale=e,this.adapterScaleY=-e),this.smartTrimRatio=Math.pow(10,Math.ceil(Math.log10(e))))},h.prototype.invertY=function(e){this.yDir=e?-1:1,this.setScale(this.scale),this.sinOrientation=Math.sin(this.orientation*p)*this.yDir},h.prototype.multiplyScale=function(e){this.setScale(this.scale*e)},h.prototype.setCenter=function({x:e=this.center.x,y:t=this.center.y}){e===this.center.x&&t===this.center.y||(this.cameraVersion+=1,this.center={x:e,y:t})},h.prototype.translateCenter=function({x:e=0,y:t=0}){this.cameraVersion+=1,this.center.x+=e,this.center.y+=t},h.prototype.setOrientation=function(e){if(e===this.orientation)return;this.cameraVersion+=1,this.orientation=e;let t=e*p;this.cosOrientation=Math.cos(t),this.sinOrientation=Math.sin(t)*this.yDir},h.prototype.rotate=function(e){this.setOrientation(this.orientation+e)},h.prototype.usePixelCoordinates=function(){this.setCenter({x:0,y:0}),this.setOrientation(0),this.invertY(!0),this.coordsToPixelCoords=f,this.pixelCoordsToCoords=g},h.prototype.optimalCameraParamsFor=function(e,{minScale:t,maxScale:n,margin:i=0,marginRatio:o,snap:r}={}){let s={xMin:1/0,xMax:-1/0,yMin:1/0,yMax:-1/0};e.forEach((({x:e,y:t,margin:n=0})=>{let i=this.coordsToPixelCoords({x:e,y:t});i.margin=n*this.scale,function(e,{x:t,y:n,margin:i}){e.xMin=Math.min(t-i,e.xMin),e.xMax=Math.max(t+i,e.xMax),e.yMin=Math.min(n-i,e.yMin),e.yMax=Math.max(n+i,e.yMax)}(s,i)})),i&&(i*=this.scale,s.xMin-=i,s.xMax+=i,s.yMin-=i,s.yMax+=i);let a={x:(s.xMin+s.xMax)/2,y:(s.yMin+s.yMax)/2},l=function(e,{xMin:t,xMax:n,yMin:i,yMax:o},{minScale:r,maxScale:s,marginRatio:a=1}){let l=(n-t)/e.width,c=(o-i)/e.height,u=Math.max(l,c)*a;if(u>0){let t=e.scale/u;return void 0!==r&&(t=Math.max(r,t)),void 0!==s&&(t=Math.min(s,t)),t}return e.scale}(this,s,{minScale:t,maxScale:n,marginRatio:o});return r&&(l=Math.round(l)),{center:this.pixelCoordsToCoords(a),scale:l}},h.prototype.setOptimalCamera=function(e,t={}){let{center:n,scale:i}=this.optimalCameraParamsFor(e,t);if(t.intScale&&(i=Math.floor(i)),this.setCamera({center:n,scale:i}),t.snap){let{x:e,y:t}=this.coordsToPixelCoords({x:0,y:0});n.x-=e%1/i,n.y-=t%1/i,this.setCenter(n)}return{center:n,scale:i}},h.prototype.boundingBox=function({topLeft:e,width:t,height:n,orientation:i,yInversion:o}){let{x:r,y:s}=e,a=o?-1:1;if(!i){let e=s-a*n;return{x:r,y:s,topLeft:{x:r,y:s},center:{x:r+t/2,y:e+n/2},scale:this.scale,width:t,height:n,xMin:r,yMax:s,xMax:r+t,yMin:e}}let l=i*p,c=Math.cos(l),u=Math.sin(l),h=r+c*t,d=h+u*n,f=r+u*n,g=Math.min(r,h,d,f),m=Math.max(r,h,d,f),y=s+a*u*t,v=y-a*c*n,b=s-a*c*n,x=Math.min(s,y,v,b),w=Math.max(s,y,v,b),_=o?x:w;return{x:g,y:_,topLeft:{x:g,y:_},center:{x:g+(t=m-g)/2,y:x+(n=w-x)/2},scale:this.scale,width:t,height:n,xMin:g,yMin:x,xMax:m,yMax:w}},h.prototype.pixBoundingBox=function({topLeft:e,width:t,height:n,orientation:i,relativeTo:o}){if(e=this.coordsToPixelCoords(e,o),o)if("globalOrientation"in o)i=o.globalOrientation(i),t=o.globalLength(t),n=o.globalLength(n);else{let{orientation:e=0,scale:r=1}=o;i+=e,t*=r,n*=r}return i+=this.orientation,t*=this.scale,n*=this.scale,this.boundingBox({width:t,height:n,topLeft:e,orientation:i,yInversion:!0})},h.prototype.boundingBoxForPixelZone=function({topLeft:e,width:t,height:n}){return e=this.pixelCoordsToCoords(e),t/=this.scale,n/=this.scale,this.boundingBox({topLeft:e,width:t,height:n,orientation:-this.orientation,yInversion:-1===this.yDir})},h.prototype.boundingBoxForWholeView=function(){let{width:e,height:t}=this;return this.boundingBoxForPixelZone({topLeft:{x:0,y:0},width:e,height:t})},h})),
/*! Toxilib 2D_tools
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/2D_tools",[],(function(){const e=180/Math.PI;return{distanceAndDirection:function({x:t,y:n},{x:i,y:o}){const r=i-t,s=o-n;return{distance:Math.sqrt(r*r+s*s),direction:Math.atan2(s,r)*e}},squaredDistance:function({x:e,y:t},{x:n,y:i}){const o=n-e,r=i-t;return o*o+r*r},distance:function({x:e,y:t},{x:n,y:i}){const o=n-e,r=i-t;return Math.sqrt(o*o+r*r)},length:function({x:e,y:t}){return Math.sqrt(e*e+t*t)},fastLength:(e,t)=>Math.sqrt(e*e+t*t)}})),
/*! Toxilib collision_detector
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/collision_detector",["./2D_tools","./local_2D","./topleft_and_pivot","./screen_image_utils"],(function(e,t,n,i){const{getCenterPointAfterPivot:o,containsPositionParam:r,normalizedParamsForRectangle:s}=n,{localPointInReferenceFrame:a}=t,{distance:l,squaredDistance:c,fastLength:u}=e,{getUsableImageAndPositionParams:h}=i,d=.001;function p(e,t){for(let n of t)if(b(e,n))return!0;return!1}function f(e,t,n=1/0){return g(e,t,n).distance}function g(e,t,n=1/0){let i,o=n,r=!0;for(let n of t)if("subShapes"in n)r=!1;else{const t=C(e,n);t<o&&(o=t,i=n)}return r?{distance:o,closest:i}:function(e,t,n){let i;for(let o of t){let{subShapes:t}=o;if(t){if(C(e,o)<n){const t=f(e,o.subShapes,n);t<n&&(n=t,i=o)}}}return{distance:n,closest:i}}(e,t,o)}const m=Math.PI/180,y=180/Math.PI;function v(e,t){if(Array.isArray(t))for(let n=t.length-1;n>=0;n--){const i=x(e,t[n]);if(i)return i}else{let{elements:n,methods:i}=t;for(let t=n.length-1;t>=0;t--){const o=x(e,[i[t],n[t]]);if(o)return o}}return!1}function b(e,t){const n=function(e,t){const n=w[t.type];if(n)return n(e,t);throw new Error(`Shape type "${t.type}" not supported`)}(e,t),{subShapes:i}=t;return i&&n?p(e,i):n}function x(e,[t,n]){const i=S[t],o=i&&!n.disableCollision&&i(e,n);return!!o&&(!0===o?[n]:(o.push(n),o))}const w={circle:L,arc:P,rectangle:A,polygon:T,segment:()=>!1},_={circle:$,arc:R,rectangle:k,polygon:M,segment:E},S={drawCircle:L,drawImage:function(e,t){let n=function(e){const{positionParams:t}=h(e.image,e);if(!r(t))return!1;return t}(t);return n&&A(e,n)},drawIcon:function(e,t){"center"in t||(t=Object.assign({width:t.size,height:t.size},t));let{x:n,y:i}=F(e,t);return Math.max(Math.abs(n),Math.abs(i))<=t.size/2},drawRectangle:A,drawFreeShape:T,drawGroup:function(e,t){const{view:n,group:i=n,viewPosition:o,relativeTo:r}=t,{x:s,y:l,orientation:c,scale:u}=o||t;return v(e=a({x:D(s),y:D(l),orientation:D(c),scale:D(u),relativeTo:D(r)},e.x,e.y),i.collisionShapes||i)}};function C(e,t){const n=_[t.type];if(n)return n(e,t);throw new Error(`Shape type "${t.type}" not supported`)}function k(e,t){let{x:n,y:i}=F(e,t);return n=Math.abs(n)-D(t.width)/2,i=Math.abs(i)-D(t.height)/2,n>0&&i>0?u(n,i):Math.max(n,i)}function A(e,t){let{x:n,y:i}=F(e,t);return Math.abs(n)<=D(t.width)/2&&Math.abs(i)<=D(t.height)/2}function M({x:e,y:t},{points:n,relativeTo:i}){i&&({x:e,y:t}=a(i,e,t));let o=1/0,r=1,s=(n=D(n))[n.length-1];for(let i=0;i<n.length;i++){const a=n[i],l=s.x-a.x,c=s.y-a.y,u=e-a.x,h=t-a.y,d=N(u,h,l,c);d<o&&(o=d);const p=h>=0,f=h<c,g=l*h>c*u;(p&&f&&g||!p&&!f&&!g)&&(r*=-1),s=a}return r*Math.sqrt(o)}function T({x:e,y:t},{points:n,relativeTo:i}){i&&({x:e,y:t}=a(i,e,t));let o=!1,r=(n=D(n))[n.length-1];for(let i=0;i<n.length;i++){const s=n[i],a=r.x-s.x,l=r.y-s.y,c=e-s.x,u=t-s.y,h=u>=0,d=u<l,p=a*u>l*c;(h&&d&&p||!h&&!d&&!p)&&(o=!o),r=s}return o}function E({x:e,y:t},{origin:n,end:i,relativeTo:o}){o&&({x:e,y:t}=a(o,e,t));let r=i.x-n.x,s=i.y-n.y,l=e-n.x,c=t-n.y;return Math.sqrt(N(l,c,r,s))}function $(e,{center:t,radius:n,relativeTo:i}){return i&&(e=a(i,e.x,e.y)),l(D(t),e)-D(n)}function L(e,{center:t,radius:n,relativeTo:i}){return n=D(n),i&&(e=a(i,e.x,e.y)),c(D(t),e)<=n*n}function R(e,{center:t,radius:n,innerRadius:i=0,startAngle:o=0,endAngle:r=360,relativeTo:s}){n=D(n),s&&(e=a(s,e.x,e.y)),t=D(t);let{x:l,y:c}=e;l-=t.x,c-=t.y;let u=Math.atan2(c,l)*y;u-=360*Math.floor((u-o)/360)+r;let h,d=(n-i)/2;if(u<0){let e=Math.sqrt(l*l+c*c);return Math.abs(e-d-i)-d}h=u<180+(o-r)/2?r*m:o*m;let p=Math.cos(h),f=Math.sin(h);return E({x:l,y:c},{origin:{x:p*i,y:f*i},end:{x:p*n,y:f*n}})}function P(e,{center:t,radius:n,innerRadius:i=0,startAngle:o=0,endAngle:r=360,relativeTo:s}){n=D(n),s&&(e=a(s,e.x,e.y)),t=D(t);let l=c(t,e);if(l>n*n||l<i*i)return!1;let u=Math.atan2(e.y-t.y,e.x-t.x)*y;return u-=360*Math.floor((u-o)/360),u<r}function I({orientation:e,width:t,height:n,topLeftPoint:i}){const o=e*m,r={x:Math.cos(o),y:Math.sin(o)},s={x:r.y,y:-r.x},{x:a,y:l}=i,c={x:a+r.x*t,y:l+r.y*t};return{axes:[r,s],vertices:[i,c,{x:a+s.x*n,y:l+s.y*n},{x:c.x+s.x*n,y:c.y+s.y*n}]}}function O({x:e,y:t},n){let i=1/0,o=-1/0;for(let r=0;r<n.length;r++){let{x:s,y:a}=n[r],l=s*e+a*t;i=Math.min(l,i),o=Math.max(l,o)}return[i,o]}function D(e){return"function"==typeof e?e():e}function F(e,t){const{orientation:n,relativeTo:i}=t,{x:r,y:s}=o(t);return a({x:r,y:s,orientation:D(n),relativeTo:i},e.x,e.y)}function N(e,t,n,i){let o=function(e){if(e>1)return 1;if(e<0)return 0;return e}((e*n+t*i)/(n*n+i*i)),r=e-n*o,s=t-i*o;return r*r+s*s}return{distance:f,isInside:p,closestShape:function(e,t,n=1/0){let i,o=g(e,t,n);return Object.defineProperty(o,"normal",{enumerable:!0,get:function(){return i||(i=function({x:e,y:t},n,i,o){let r=g({x:e+d,y:t},n,o).distance,s=g({x:e,y:t+d},n,o).distance;return{x:(r-i)/d,y:(s-i)/d}}(e,t,o.distance,n)),i}}),o},isInsideForScreenGroup:v,isInsideRectangle:A,distanceToRectangle:k,isInsidePolygon:T,distanceToPolygon:M,isInsideCircle:L,distanceToCircle:$,isInsideArc:P,distanceToArc:R,isInsideShape:b,distanceToShape:function(e,t,{resolveIfUnder:n=!1,maxDistance:i=1/0}={}){const{subShapes:o}=t;if(o&&!1===n)return f(e,o,i);const r=C(e,t);return o&&r<=n?f(e,o,i):r},rectangleIntersectsWithRectangle:function(e,t){if("relativeTo"in e||"relativeTo"in t)throw new Error("relativeTo not supported yet");const n=s(e),i=s(t);if(n.orientation||i.orientation)return function(e,t){const n=I(e),i=I(t);return function(e,t,n){for(let i=0;i<e.length;i++){let o=e[i],[r,s]=O(o,t),[a,l]=O(o,n);if(a>s||r>l)return!1}return!0}([...n.axes,...i.axes],n.vertices,i.vertices)}(n,i);const{x:o,y:r}=n.topLeftPoint,{x:a,y:l}=i.topLeftPoint;return o+n.width>a&&a+i.width>o&&r-n.height<l&&l-i.height<r},pointInLocalShapeReference:function(e,{shape:t,parents:n}){return n.forEach((({x:t,y:n,orientation:i,scale:o,relativeTo:r})=>{e=a({x:D(t),y:D(n),orientation:D(i),scale:D(o),relativeTo:D(r)},e.x,e.y)})),t.relativeTo&&(e=a(t.relativeTo,e.x,e.y)),e},detect:function({origin:e,orientation:t,shapes:n}){let i,o=D(t)*m,{x:r,y:s}=e,a=Math.cos(o),l=Math.sin(o),c=0,u=1/0;for(;c<1e3;){i={x:r+c*a,y:s+c*l};let e=f(i,n,u);if(c+=e,e<d)break;u=2*e}return i}}})),
/*! Toxilib string_utils
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/string_utils",[],(function(){let e={camelToSeparator:function(e,t){return(e=e.replace(/([A-Z]+)([A-Z][a-z])/g,`$1${t}$2`)).replace(/([a-z\d])([A-Z])/g,`$1${t}$2`).toLowerCase()},camelToSnake:function(t){return e.camelToSeparator(t,"_")},camelToSpace:function(t){return e.camelToSeparator(t," ")},camelToDash:function(t){return e.camelToSeparator(t,"-")},camelToPascale:function(t){return e.upperFirstLetter(t)},pascaleToSnake:function(t){return t=e.pascaleToCamel(t),e.camelToSeparator(t,"_")},pascaleToSpace:function(t){return t=e.pascaleToCamel(t),e.camelToSeparator(t," ")},pascaleToDash:function(t){return t=e.pascaleToCamel(t),e.camelToSeparator(t,"-")},pascaleToCamel:function(t){return e.lowerFirstLetter(t)},spaceToSnake:function(t){return e.separatorToAnotherSeparator(t.toLowerCase(),"\\s+","_")},spaceToDash:function(t){return e.separatorToAnotherSeparator(t.toLowerCase(),"\\s+","-")},spaceToCamel:function(t){return e.separatorToCamel(t.toLowerCase(),"\\s")},spaceToPascale:function(t){return e.upperFirstLetter(e.spaceToCamel(t))},dashToSnake:function(t){return e.separatorToAnotherSeparator(t,"-","_")},dashToSpace:function(t){return e.separatorToAnotherSeparator(t,"-"," ")},dashToCamel:function(t){return e.separatorToCamel(t,"-")},dashToPascale:function(t){return e.upperFirstLetter(e.separatorToCamel(t,"-"))},snakeToDash:function(t){return e.separatorToAnotherSeparator(t,"_","-")},snakeToSpace:function(t){return e.separatorToAnotherSeparator(t,"_"," ")},snakeToCamel:function(t){return e.separatorToCamel(t,"_")},snakeToPascale:function(t){return e.upperFirstLetter(e.separatorToCamel(t,"_"))},separatorToCamel:function(e,t){let n=new RegExp(`${t}+([^${t}])`,"g");return e.replace(n,(function(e,t){return t.toUpperCase()})).replace(/\s/g,"")},separatorToAnotherSeparator:function(e,t,n){let i=new RegExp(t,"g");return e.replace(i,n)},upperFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},lowerFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},dasherize:function(e){return e.trim().replace(/([a-z\d])([A-Z]+)/g,"$1-$2").replace(/[_\s]+/g,"-").toLowerCase()},camelize:function(t){let n=t.trim().replace(/[-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return e.lowerFirstLetter(n)},pascalize:function(t){return e.upperFirstLetter(e.camelize(t))},snakerize:function(e){return e.trim().replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},removeAccents:function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")},normalizeFamilyName:function(t){const n=["an","auf","von","dem","den","der","zu","zur","de","del","las","los","y","a","d'","da","das","do","dos"];return t.trim().toLowerCase().split(/\s+/).map((t=>t.split("-").map((t=>n.includes(t)?t:e.upperFirstLetter(t))).join("-"))).join(" ")},regexp:{latin:/^([A-Za-z0-9\-_À-ÖØ-öø-ÿ\s]*)$/,classicVariableName:/^([a-zA-Z_$][0-9a-zA-Z_$]*)$/,latinVariableName:/^([A-Za-zÀ-ÖØ-öø-ÿ_$][0-9A-Za-zÀ-ÖØ-öø-ÿ_$]*)$/},regexpPortions:{latinVariableName:"[A-Za-zÀ-ÖØ-öø-ÿ_$][0-9A-Za-zÀ-ÖØ-öø-ÿ_$]*"},escapeForRegExp:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},replaceAll:function(e,t,n){return e.replace(new RegExp(t,"g"),n)},interpolate:function(t,n){n=n||{};for(let i in n)t=e.replaceAll(t,`{{${i}}}`,n[i]);return t},distance:function(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;let n,i,o=[];for(n=0;n<=t.length;n++)o[n]=[n];for(i=0;i<=e.length;i++)o[0][i]=i;for(n=1;n<=t.length;n++)for(i=1;i<=e.length;i++)t.charAt(n-1)===e.charAt(i-1)?o[n][i]=o[n-1][i-1]:o[n][i]=Math.min(o[n-1][i-1]+1,Math.min(o[n][i-1]+1,o[n-1][i]+1));return o[t.length][e.length]}};return e})),
/*! Toxilib screen_group
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_group",["./screen","./local_2D","./topleft_and_pivot","./collision_detector","./string_utils"],(function(e,t,n,i,o){const{escapeForRegExp:r}=o,{getCenterPoint:s}=n,{referenceFrameFromGroupParams:a,ReferenceFrame:l}=t;let c;function u({dynamic:t,failFast:n,watch:i,errorHandler:o}={}){this.parentsToWarn=[],this.methods=[],this.elements=[],this.dynamic=t,i||(this.collisionShapes=[]),this.lastChange=1,n&&(this.failFast=!0,function(t,n){let i=document.createElement("canvas");t.testScreen=new e(i,{errorHandler:n})}(this,o))}function h(e,t){let{collisionShapes:n}=e;if(!n)return{};let i=!1;for(let e=0;e<n.length;e++){let o=n[e];o[2]>t?o[2]-=1:o[2]===t&&(i=e)}return!1!==i&&n.splice(i,1),{removed:!1!==i}}u.prototype.reset=function(){this.methods.length=0,this.elements.length=0,this.collisionShapes&&(this.collisionShapes.length=0)},u.prototype.clear=u.prototype.reset,u.prototype.bringToFront=function(e){const{elements:t,methods:n}=this;let i=t.indexOf(e);if(i>=0){let[o]=n.splice(i,1);t.splice(i,1),n.push(o),t.push(e);let{removed:r}=h(this,i);r&&this.collisionShapes.push([o,e,t.length-1]),this.lastChange++}},u.prototype.remove=function(e){const{elements:t,methods:n}=this;if("string"==typeof e){let i=function(e){let t=new RegExp(`\\b${r(e)}\\b`);return({tag:e})=>e&&t.test(e)}(e),o=!1;for(let e=t.length-1;e>=0;e--)i(t[e])&&(n.splice(e,1),t.splice(e,1),h(e),o=!0);o&&this.lastChange++}else{let i=t.indexOf(e);i>=0&&(n.splice(i,1),t.splice(i,1),h(this,i),this.lastChange++)}};const d=500;u.prototype.toScreen=function(t){const{backgroundColor:n,width:i,height:o,orientation:r=0,canvas:a=document.createElement("canvas")}=t;let l;i&&o&&(l=s(t,i,o)),l||(l={x:0,y:0});const{widthInPixels:c,heightInPixels:u,scale:h}=function({widthInPixels:e,heightInPixels:t,width:n,height:i,scale:o}){if(!e&&!t&&!o&&(i||n))throw new Error('Can not use "width" or "height" params without specifying one of : "widthInPixels", "heightInPixels" or "scale"');let r;r=e&&t?e/t:n&&i?n/i:1;i?n=i*r:n&&(i=n/r);t?e=Math.round(t*r):e&&(t=Math.round(e/r));e&&n?o=e/n:t&&i?o=t/i:o||(o=1);t||(e=d,t=d);return{widthInPixels:e,heightInPixels:t,scale:o}}(t);a.width=c,a.height=u;const p=new e(a);return p.setCamera({center:l,scale:h,orientation:r}),n&&p.clear({color:n}),p.drawGroup({group:this}),p},u.prototype.toScreenCanvas=function(e){return this.toScreen(e).drawAdapter},u.prototype.toScreenImage=function(e){return this.toScreen(e).toScreenImage()},u.prototype.toCanvas=function(e){return this.toScreen(e).canvas},u.prototype.toBlob=function(e){return this.toScreen(e).toBlob()},u.prototype.toBase64=function(e){return this.toScreen(e).toBase64()},u.prototype.toPNGImage=function(e){return this.toScreen(e).toPNGImage()},u.prototype.downloadAsImage=function(e={}){const t=this.toScreen(e);e=Object.assign({name:"group"},e),t.downloadAsImage(e)},u.prototype.rasterize=function(e){return c||(c=document.createElement("canvas")),e=Object.assign({},e,{canvas:c}),this.rasterization=this.toScreenImage(e),this.rasterization},u.prototype.toJSON=function(){const{methods:e,elements:t}=this;return JSON.stringify(t.map(((t,n)=>[e[n],t])))},u.prototype.importJSON=function(e){JSON.parse(e).forEach((([e,t])=>{this.methods.push(e),this.elements.push(t)}))};const p=["drawCircle","drawRectangle","drawImage","drawFreeShape","drawGroup"];function f(e,{watchable:t}={}){const n=e.replace("draw","add");(t=t||p.includes(e))?u.prototype[n]=function(t={}){let{dynamic:n=this.dynamic,interactive:i}=t;this.failFast&&this.testScreen[e](t),"drawGroup"===e&&("x"in t||(t.x=0),"y"in t||(t.y=0),this.collisionShapes&&!i||g(t.group||t.view),t.view&&(n=!0));const o=this.collisionShapes&&(t.watch||i||t.whenClicked||t.whenMouseButtonPressed||t.whenMouseButtonReleased||t.whenMouseMoved||t.whenMouseMovedIn||t.whenMouseMovedOut);return n||i||(t=A(t)),this.lastChange++,this.methods.push(e),this.elements.push(t),o&&v(this,e,t),t}:"addCustom"===n?u.prototype.addCustom=function(t){return this.methods.push(e),this.elements.push(t),t}:u.prototype[n]=function(t={}){const{dynamic:n=this.dynamic}=t;return this.failFast&&this.testScreen[e](t),n||(t=A(t)),this.lastChange++,this.methods.push(e),this.elements.push(t),t}}function g(e){if(e.collisionShapes){let{methods:t,elements:n}=e;t.forEach(((e,t)=>{if("drawGroup"===e){let{view:e,group:i=e}=n[t];g(i)}})),delete e.collisionShapes}}e.drawingMethods.forEach(f),u.proxify=f;let{addGroup:m}=u.prototype;u.prototype.addGroup=function(e){const{view:t,group:n=t}=e;if(!n)throw new Error("'group' param missing");let i=m.call(this,e);if(!this.collisionShapes)return i;const o=this.collisionShapes[this.collisionShapes.length-1],r=this.elements.length-1;return(!o||o[2]!==r)&&function({parent:e,group:t,insertedIndex:n}){if("function"==typeof t)return;if(t.hasSomeWatches()){v(e,e.methods[n],e.elements[n])}else t.parentsToWarn.push({parent:e,index:n})}({parent:this,group:n,insertedIndex:r}),i},u.prototype.addObject=u.prototype.addGroup;let{addImage:y}=u.prototype;function v(e,t,n){const{collisionShapes:i,elements:o}=e;0===i.length&&e.warnParentsOfColliding(),i.push([t,n,o.length-1])}u.prototype.addImage=function(e){return e.image||(e={image:e}),y.call(this,e)},u.prototype.warnParentsOfColliding=function(){this.parentsToWarn.forEach((({parent:e,index:t})=>{const{collisionShapes:n,methods:i,elements:o}=e;let r=[i[t],o[t],t];if(0===n.length)n.push(r),e.warnParentsOfColliding();else{const e=n.findIndex((([,,e])=>e>t));-1===e?n.push(r):n.splice(e,0,r)}}))},u.prototype.isPointInside=function(e){return Boolean(i.isInsideForScreenGroup(e,this.collisionShapes||this))},u.prototype.shapesAt=function(e){return i.isInsideForScreenGroup(e,this.collisionShapes||this)||[]},u.prototype.hasSomeWatches=function(){return!this.collisionShapes||this.collisionShapes.length>0},u.prototype.scanForWatchableGroups=function(){const{collisionShapes:e}=this;this.methods.forEach(((t,n)=>{if("drawGroup"===t){let i=this.elements[n];i.group.hasSomeWatches()&&!e.includes(i)&&e.push([t,i,n])}}))};function b({group:e,referenceFrame:t,depth:n},{elementQueue:i,groupQueue:o,maxDepth:r}){const{methods:s,elements:l}=e;n+=1;for(let e=0;e<l.length;e++){const c=l[e],u=s[e];if("drawGroup"===u){if("maxDepth"in c&&(r=Math.min(r,c.maxDepth)),n>r)continue;let{group:e}=c;"function"==typeof e&&(e=e(n));let s=a(c);t&&(s=t.globalBase(s));const l={group:e,referenceFrame:s,depth:n};o?o.push(l):b(l,{elementQueue:i,maxDepth:r})}else t?i.push([u,x(t,c)]):i.push([u,c]);if(i.length>4e3)break}}function x(e,t){let n,i=t.relativeTo;return n=i?e.globalBase(i):e,Object.assign({},t,{relativeTo:n})}function w({x:e,y:t}){return{x:e,y:t}}function _({x:e,y:t,controlNext:n,controlPrevious:i}){const o={x:e,y:t};return n&&(o.controlNext=w(n)),i&&(o.controlPrevious=w(i)),o}u.prototype.flatten=function({maxDepth:e=20}={}){const t=[];b({group:this,depth:0},{elementQueue:t,maxDepth:e});const n=new u;return t.forEach((([e,t])=>{n.methods.push(e),n.elements.push(t)})),n},u.prototype.flattenReordered=function({maxDepth:e=20}={}){const t=[],n=[];let i={group:this,depth:0},o=0;for(;i&&o<1e3;)o+=1,b(i,{elementQueue:t,groupQueue:n,maxDepth:e}),i=n.shift();const r=new u;return t.forEach((([e,t])=>{r.methods.push(e),r.elements.push(t)})),r},u.prototype.triggerCoordMethodOnShapes=function(e,{x:t,y:n}){this.shapesAt({x:t,y:n}).forEach((i=>{e in i&&i[e](t,n,i)}))};let S={coords:w,coordsAndRadius:function({x:e,y:t,radius:n}){return{x:e,y:t,radius:n}},vector:w,points:function(e){return e.map(_)},referenceFrame:function(e){if("localLengthToGlobal"in e)return new l({relativeTo:e});{const{x:t,y:n,orientation:i,scale:o}=e;return{x:t,y:n,orientation:i,scale:o}}},function:"identity",length:"identity",angle:"identity",orientation:"identity",boolean:"identity",factor:"identity",text:"identity",textWithUSyntax:"identity",shadow:"identity",smartLength:"identity",color:"identity",number:"identity",imageData:"identity",image:"identity",stroke:"identity",group:"identity",cropParams:"identity",linearGradient:function({origin:e,end:t,colors:n}){return{origin:e,end:t,colors:n}},radialGradient:function({innerCircle:e,outerCircle:t,center:n,radius:i,colors:o}){return{innerCircle:e,outerCircle:t,center:n,radius:i,colors:o}}};const C={};for(let t in e.paramsTypes){let n=e.paramsTypes[t];C[t]=S[n]}C.interactive="identity",u.addParamType=function(e,t){C[e]=S[t]};const k=["whenClicked","whenMouseButtonPressed","whenMouseButtonReleased","whenMouseMoved","whenMouseMovedIn","whenMouseMovedOut"];function A(e){let t={};for(let n in e){let i=C[n];if(!i)continue;let o=e[n];o&&"identity"!==i&&"function"!=typeof o&&(o=i(e[n])),t[n]=o}return t}return u.mouseEvents=k,k.forEach((e=>{C[e]="identity"})),u})),define("render/font_awesome_codes",[],(function(){return{ad:"","address-book":"","address-card":"",adjust:"","air-freshener":"","align-center":"","align-justify":"","align-left":"","align-right":"",allergies:"",ambulance:"","american-sign-language-interpreting":"",anchor:"","angle-double-down":"","angle-double-left":"","angle-double-right":"","angle-double-up":"","angle-down":"","angle-left":"","angle-right":"","angle-up":"",angry:"",ankh:"","apple-alt":"",archive:"",archway:"","arrow-alt-circle-down":"","arrow-alt-circle-left":"","arrow-alt-circle-right":"","arrow-alt-circle-up":"","arrow-circle-down":"","arrow-circle-left":"","arrow-circle-right":"","arrow-circle-up":"","arrow-down":"","arrow-left":"","arrow-right":"","arrow-up":"","arrows-alt":"","arrows-alt-h":"","arrows-alt-v":"","assistive-listening-systems":"",asterisk:"",at:"",atlas:"",atom:"","audio-description":"",award:"",baby:"","baby-carriage":"",backspace:"",backward:"",bacon:"",bacteria:"",bacterium:"",bahai:"","balance-scale":"","balance-scale-left":"","balance-scale-right":"",ban:"","band-aid":"",barcode:"",bars:"","baseball-ball":"","basketball-ball":"",bath:"","battery-empty":"","battery-full":"","battery-half":"","battery-quarter":"","battery-three-quarters":"",bed:"",beer:"",bell:"","bell-slash":"","bezier-curve":"",bible:"",bicycle:"",biking:"",binoculars:"",biohazard:"","birthday-cake":"",blender:"","blender-phone":"",blind:"",blog:"",bold:"",bolt:"",bomb:"",bone:"",bong:"",book:"","book-dead":"","book-medical":"","book-open":"","book-reader":"",bookmark:"","border-all":"","border-none":"","border-style":"","bowling-ball":"",box:"","box-open":"","box-tissue":"",boxes:"",braille:"",brain:"","bread-slice":"",briefcase:"","briefcase-medical":"","broadcast-tower":"",broom:"",brush:"",bug:"",building:"",bullhorn:"",bullseye:"",burn:"",bus:"","bus-alt":"","business-time":"",calculator:"",calendar:"","calendar-alt":"","calendar-check":"","calendar-day":"","calendar-minus":"","calendar-plus":"","calendar-times":"","calendar-week":"",camera:"","camera-retro":"",campground:"","candy-cane":"",cannabis:"",capsules:"",car:"","car-alt":"","car-battery":"","car-crash":"","car-side":"",caravan:"","caret-down":"","caret-left":"","caret-right":"","caret-square-down":"","caret-square-left":"","caret-square-right":"","caret-square-up":"","caret-up":"",carrot:"","cart-arrow-down":"","cart-plus":"","cash-register":"",cat:"",certificate:"",chair:"",chalkboard:"","chalkboard-teacher":"","charging-station":"","chart-area":"","chart-bar":"","chart-line":"","chart-pie":"",check:"","check-circle":"","check-double":"","check-square":"",cheese:"",chess:"","chess-bishop":"","chess-board":"","chess-king":"","chess-knight":"","chess-pawn":"","chess-queen":"","chess-rook":"","chevron-circle-down":"","chevron-circle-left":"","chevron-circle-right":"","chevron-circle-up":"","chevron-down":"","chevron-left":"","chevron-right":"","chevron-up":"",child:"",church:"",circle:"","circle-notch":"",city:"","clinic-medical":"",clipboard:"","clipboard-check":"","clipboard-list":"",clock:"",clone:"","closed-captioning":"",cloud:"","cloud-download-alt":"","cloud-meatball":"","cloud-moon":"","cloud-moon-rain":"","cloud-rain":"","cloud-showers-heavy":"","cloud-sun":"","cloud-sun-rain":"","cloud-upload-alt":"",cocktail:"",code:"","code-branch":"",coffee:"",cog:"",cogs:"",coins:"",columns:"",comment:"","comment-alt":"","comment-dollar":"","comment-dots":"","comment-medical":"","comment-slash":"",comments:"","comments-dollar":"","compact-disc":"",compass:"",compress:"","compress-alt":"","compress-arrows-alt":"","concierge-bell":"",cookie:"","cookie-bite":"",copy:"",copyright:"",couch:"","credit-card":"",crop:"","crop-alt":"",cross:"",crosshairs:"",crow:"",crown:"",crutch:"",cube:"",cubes:"",cut:"",database:"",deaf:"",democrat:"",desktop:"",dharmachakra:"",diagnoses:"",dice:"","dice-d20":"","dice-d6":"","dice-five":"","dice-four":"","dice-one":"","dice-six":"","dice-three":"","dice-two":"","digital-tachograph":"",directions:"",disease:"",divide:"",dizzy:"",dna:"",dog:"","dollar-sign":"",dolly:"","dolly-flatbed":"",donate:"","door-closed":"","door-open":"","dot-circle":"",dove:"",download:"","drafting-compass":"",dragon:"","draw-polygon":"",drum:"","drum-steelpan":"","drumstick-bite":"",dumbbell:"",dumpster:"","dumpster-fire":"",dungeon:"",edit:"",egg:"",eject:"","ellipsis-h":"","ellipsis-v":"",envelope:"","envelope-open":"","envelope-open-text":"","envelope-square":"",equals:"",eraser:"",ethernet:"","euro-sign":"","exchange-alt":"",exclamation:"","exclamation-circle":"","exclamation-triangle":"",expand:"","expand-alt":"","expand-arrows-alt":"","external-link-alt":"","external-link-square-alt":"",eye:"","eye-dropper":"","eye-slash":"",fan:"","fast-backward":"","fast-forward":"",faucet:"",fax:"",feather:"","feather-alt":"",female:"","fighter-jet":"",file:"","file-alt":"","file-archive":"","file-audio":"","file-code":"","file-contract":"","file-csv":"","file-download":"","file-excel":"","file-export":"","file-image":"","file-import":"","file-invoice":"","file-invoice-dollar":"","file-medical":"","file-medical-alt":"","file-pdf":"","file-powerpoint":"","file-prescription":"","file-signature":"","file-upload":"","file-video":"","file-word":"",fill:"","fill-drip":"",film:"",filter:"",fingerprint:"",fire:"","fire-alt":"","fire-extinguisher":"","first-aid":"",fish:"","fist-raised":"",flag:"","flag-checkered":"","flag-usa":"",flask:"",flushed:"",folder:"","folder-minus":"","folder-open":"","folder-plus":"",font:"","football-ball":"",forward:"",frog:"",frown:"","frown-open":"","funnel-dollar":"",futbol:"",gamepad:"","gas-pump":"",gavel:"",gem:"",genderless:"",ghost:"",gift:"",gifts:"","glass-cheers":"","glass-martini":"","glass-martini-alt":"","glass-whiskey":"",glasses:"",globe:"","globe-africa":"","globe-americas":"","globe-asia":"","globe-europe":"","golf-ball":"",gopuram:"","graduation-cap":"","greater-than":"","greater-than-equal":"",grimace:"",grin:"","grin-alt":"","grin-beam":"","grin-beam-sweat":"","grin-hearts":"","grin-squint":"","grin-squint-tears":"","grin-stars":"","grin-tears":"","grin-tongue":"","grin-tongue-squint":"","grin-tongue-wink":"","grin-wink":"","grip-horizontal":"","grip-lines":"","grip-lines-vertical":"","grip-vertical":"",guitar:"","h-square":"",hamburger:"",hammer:"",hamsa:"","hand-holding":"","hand-holding-heart":"","hand-holding-medical":"","hand-holding-usd":"","hand-holding-water":"","hand-lizard":"","hand-middle-finger":"","hand-paper":"","hand-peace":"","hand-point-down":"","hand-point-left":"","hand-point-right":"","hand-point-up":"","hand-pointer":"","hand-rock":"","hand-scissors":"","hand-sparkles":"","hand-spock":"",hands:"","hands-helping":"","hands-wash":"",handshake:"","handshake-alt-slash":"","handshake-slash":"",hanukiah:"","hard-hat":"",hashtag:"","hat-cowboy":"","hat-cowboy-side":"","hat-wizard":"",hdd:"","head-side-cough":"","head-side-cough-slash":"","head-side-mask":"","head-side-virus":"",heading:"",headphones:"","headphones-alt":"",headset:"",heart:"","heart-broken":"",heartbeat:"",helicopter:"",highlighter:"",hiking:"",hippo:"",history:"","hockey-puck":"","holly-berry":"",home:"",horse:"","horse-head":"",hospital:"","hospital-alt":"","hospital-symbol":"","hospital-user":"","hot-tub":"",hotdog:"",hotel:"",hourglass:"","hourglass-end":"","hourglass-half":"","hourglass-start":"","house-damage":"","house-user":"",hryvnia:"","i-cursor":"","ice-cream":"",icicles:"",icons:"","id-badge":"","id-card":"","id-card-alt":"",igloo:"",image:"",images:"",inbox:"",indent:"",industry:"",infinity:"",info:"","info-circle":"",italic:"",jedi:"",joint:"","journal-whills":"",kaaba:"",key:"",keyboard:"",khanda:"",kiss:"","kiss-beam":"","kiss-wink-heart":"","kiwi-bird":"",landmark:"",language:"",laptop:"","laptop-code":"","laptop-house":"","laptop-medical":"",laugh:"","laugh-beam":"","laugh-squint":"","laugh-wink":"","layer-group":"",leaf:"",lemon:"","less-than":"","less-than-equal":"","level-down-alt":"","level-up-alt":"","life-ring":"",lightbulb:"",link:"","lira-sign":"",list:"","list-alt":"","list-ol":"","list-ul":"","location-arrow":"",lock:"","lock-open":"","long-arrow-alt-down":"","long-arrow-alt-left":"","long-arrow-alt-right":"","long-arrow-alt-up":"","low-vision":"","luggage-cart":"",lungs:"","lungs-virus":"",magic:"",magnet:"","mail-bulk":"",male:"",map:"","map-marked":"","map-marked-alt":"","map-marker":"","map-marker-alt":"","map-pin":"","map-signs":"",marker:"",mars:"","mars-double":"","mars-stroke":"","mars-stroke-h":"","mars-stroke-v":"",mask:"",medal:"",medkit:"",meh:"","meh-blank":"","meh-rolling-eyes":"",memory:"",menorah:"",mercury:"",meteor:"",microchip:"",microphone:"","microphone-alt":"","microphone-alt-slash":"","microphone-slash":"",microscope:"",minus:"","minus-circle":"","minus-square":"",mitten:"",mobile:"","mobile-alt":"","money-bill":"","money-bill-alt":"","money-bill-wave":"","money-bill-wave-alt":"","money-check":"","money-check-alt":"",monument:"",moon:"","mortar-pestle":"",mosque:"",motorcycle:"",mountain:"",mouse:"","mouse-pointer":"","mug-hot":"",music:"","network-wired":"",neuter:"",newspaper:"","not-equal":"","notes-medical":"","object-group":"","object-ungroup":"","oil-can":"",om:"",otter:"",outdent:"",pager:"","paint-brush":"","paint-roller":"",palette:"",pallet:"","paper-plane":"",paperclip:"","parachute-box":"",paragraph:"",parking:"",passport:"",pastafarianism:"",paste:"",pause:"","pause-circle":"",paw:"",peace:"",pen:"","pen-alt":"","pen-fancy":"","pen-nib":"","pen-square":"","pencil-alt":"","pencil-ruler":"","people-arrows":"","people-carry":"","pepper-hot":"",percent:"",percentage:"","person-booth":"",phone:"","phone-alt":"","phone-slash":"","phone-square":"","phone-square-alt":"","phone-volume":"","photo-video":"","piggy-bank":"",pills:"","pizza-slice":"","place-of-worship":"",plane:"","plane-arrival":"","plane-departure":"","plane-slash":"",play:"","play-circle":"",plug:"",plus:"","plus-circle":"","plus-square":"",podcast:"",poll:"","poll-h":"",poo:"","poo-storm":"",poop:"",portrait:"","pound-sign":"","power-off":"",pray:"","praying-hands":"",prescription:"","prescription-bottle":"","prescription-bottle-alt":"",print:"",procedures:"","project-diagram":"","pump-medical":"","pump-soap":"","puzzle-piece":"",qrcode:"",question:"","question-circle":"",quidditch:"","quote-left":"","quote-right":"",quran:"",radiation:"","radiation-alt":"",rainbow:"",random:"",receipt:"","record-vinyl":"",recycle:"",redo:"","redo-alt":"",registered:"","remove-format":"",reply:"","reply-all":"",republican:"",restroom:"",retweet:"",ribbon:"",ring:"",road:"",robot:"",rocket:"",route:"",rss:"","rss-square":"","ruble-sign":"",ruler:"","ruler-combined":"","ruler-horizontal":"","ruler-vertical":"",running:"","rupee-sign":"","sad-cry":"","sad-tear":"",satellite:"","satellite-dish":"",save:"",school:"",screwdriver:"",scroll:"","sd-card":"",search:"","search-dollar":"","search-location":"","search-minus":"","search-plus":"",seedling:"",server:"",shapes:"",share:"","share-alt":"","share-alt-square":"","share-square":"","shekel-sign":"","shield-alt":"","shield-virus":"",ship:"","shipping-fast":"","shoe-prints":"","shopping-bag":"","shopping-basket":"","shopping-cart":"",shower:"","shuttle-van":"",sign:"","sign-in-alt":"","sign-language":"","sign-out-alt":"",signal:"",signature:"","sim-card":"",sink:"",sitemap:"",skating:"",skiing:"","skiing-nordic":"",skull:"","skull-crossbones":"",slash:"",sleigh:"","sliders-h":"",smile:"","smile-beam":"","smile-wink":"",smog:"",smoking:"","smoking-ban":"",sms:"",snowboarding:"",snowflake:"",snowman:"",snowplow:"",soap:"",socks:"","solar-panel":"",sort:"","sort-alpha-down":"","sort-alpha-down-alt":"","sort-alpha-up":"","sort-alpha-up-alt":"","sort-amount-down":"","sort-amount-down-alt":"","sort-amount-up":"","sort-amount-up-alt":"","sort-down":"","sort-numeric-down":"","sort-numeric-down-alt":"","sort-numeric-up":"","sort-numeric-up-alt":"","sort-up":"",spa:"","space-shuttle":"","spell-check":"",spider:"",spinner:"",splotch:"","spray-can":"",square:"","square-full":"","square-root-alt":"",stamp:"",star:"","star-and-crescent":"","star-half":"","star-half-alt":"","star-of-david":"","star-of-life":"","step-backward":"","step-forward":"",stethoscope:"","sticky-note":"",stop:"","stop-circle":"",stopwatch:"","stopwatch-20":"",store:"","store-alt":"","store-alt-slash":"","store-slash":"",stream:"","street-view":"",strikethrough:"",stroopwafel:"",subscript:"",subway:"",suitcase:"","suitcase-rolling":"",sun:"",superscript:"",surprise:"",swatchbook:"",swimmer:"","swimming-pool":"",synagogue:"",sync:"","sync-alt":"",syringe:"",table:"","table-tennis":"",tablet:"","tablet-alt":"",tablets:"","tachometer-alt":"",tag:"",tags:"",tape:"",tasks:"",taxi:"",teeth:"","teeth-open":"","temperature-high":"","temperature-low":"",tenge:"",terminal:"","text-height":"","text-width":"",th:"","th-large":"","th-list":"","theater-masks":"",thermometer:"","thermometer-empty":"","thermometer-full":"","thermometer-half":"","thermometer-quarter":"","thermometer-three-quarters":"","thumbs-down":"","thumbs-up":"",thumbtack:"","ticket-alt":"",times:"","times-circle":"",tint:"","tint-slash":"",tired:"","toggle-off":"","toggle-on":"",toilet:"","toilet-paper":"","toilet-paper-slash":"",toolbox:"",tools:"",tooth:"",torah:"","torii-gate":"",tractor:"",trademark:"","traffic-light":"",trailer:"",train:"",tram:"",transgender:"","transgender-alt":"",trash:"","trash-alt":"","trash-restore":"","trash-restore-alt":"",tree:"",trophy:"",truck:"","truck-loading":"","truck-monster":"","truck-moving":"","truck-pickup":"",tshirt:"",tty:"",tv:"",umbrella:"","umbrella-beach":"",underline:"",undo:"","undo-alt":"","universal-access":"",university:"",unlink:"",unlock:"","unlock-alt":"",upload:"",user:"","user-alt":"","user-alt-slash":"","user-astronaut":"","user-check":"","user-circle":"","user-clock":"","user-cog":"","user-edit":"","user-friends":"","user-graduate":"","user-injured":"","user-lock":"","user-md":"","user-minus":"","user-ninja":"","user-nurse":"","user-plus":"","user-secret":"","user-shield":"","user-slash":"","user-tag":"","user-tie":"","user-times":"",users:"","users-cog":"","users-slash":"","utensil-spoon":"",utensils:"","vector-square":"",venus:"","venus-double":"","venus-mars":"",vest:"","vest-patches":"",vial:"",vials:"",video:"","video-slash":"",vihara:"",virus:"","virus-slash":"",viruses:"",voicemail:"","volleyball-ball":"","volume-down":"","volume-mute":"","volume-off":"","volume-up":"","vote-yea":"","vr-cardboard":"",walking:"",wallet:"",warehouse:"",water:"","wave-square":"",weight:"","weight-hanging":"",wheelchair:"",wifi:"",wind:"","window-close":"","window-maximize":"","window-minimize":"","window-restore":"","wine-bottle":"","wine-glass":"","wine-glass-alt":"","won-sign":"",wrench:"","x-ray":"","yen-sign":"","yin-yang":""}})),define("render/icon_for_screen",["./font_awesome_codes"],(function(e){const t=.8;return function(n){const{backgroundColor:i,name:o,size:r=1}=n;if((n=Object.assign({},n)).text=function(t){"function"==typeof t&&(t=t());let n=e[t];if(!n){if(!t)throw new Error('"name" param is missing');throw new Error(`Icon named "${t}" does not exist`)}return n}(o),n.font=function(e){return"function"==typeof e?()=>`${String(e()*t)}u FontAwesomeForScreen`:`${String(e*t)}u FontAwesomeForScreen`}(r),i){let e=Object.assign({},n);e.color=i,e.width=r,e.height=r,this.drawRectangle(e)}this.drawText(n)}})),define("render/screen",["toxilibs/screen","toxilibs/screen_group","./icon_for_screen"],(function(e,t,n){return e.prototype.drawIcon=n,e.drawingMethods.push("drawIcon"),e.addParamType("backgroundColor","color"),t.addParamType("backgroundColor","color"),e.addParamType("size","length"),t.addParamType("size","length"),t.proxify("drawIcon",{watchable:!0}),e})),
/*! Toxilib source_map
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/source_map",[],(function(){let e=/\/\/\*\* Source Map New Name : (.+)/;return{fileSeparation:function(e){return`\n//** Source Map New Name : ${e}\n`},getLineMapper:function(t){const n=[],i=t.split("\n"),o={};let r=0,s="anonymous";return i.forEach(((t,i)=>{let a=t.match(e);a&&(o[s]=i-r,s=a[1],r=i+1-(o[s]||0)),n[i]={lineDelta:r,name:s}})),function(e){let{name:t,lineDelta:i}=n[e-1];return{line:e-i,name:t}}}}})),
/*! Toxilib glsl_source
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/glsl_source",["./source_map"],(function(e){const{fileSeparation:t}=e,n="\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    precision highp int;\n#else\n    precision mediump float;\n    precision mediump int;\n#endif\n\nvarying vec2 coord;\n";function i({name:e="main",skipGeneralPrefix:o,prefix:s,suffix:a,source:l,moduleIncluder:c=i.requireJsIncluder()},u){l=function({name:e,prefix:i,source:o,suffix:r,skipGeneralPrefix:s}){o=t(e)+o,i&&(o=t("prefix")+i+o);s||(o=n+o);r&&(o+=t("suffix")+r);return o}({name:e,prefix:s,suffix:a,source:l,skipGeneralPrefix:o}),r({source:l,name:e,moduleIncluder:c},u)}i.requireJsIncluder=function({baseUrl:e=""}={}){return function(t,n){require([`text!${e}${t}.glsl`],(function(e){n(e)}))}},i.generalPrefix=n;let o=/[^/]include\('([^)]*)'\);/;function r({source:e,name:n,moduleIncluder:i},s){let a=e.match(o);if(a){let l=a[1];i(l,(function(a){a=t(l)+a+t(n),r({source:e=e.replace(o,a),name:l,moduleIncluder:i},s)}))}else s(e)}return i})),
/*! Toxilib webgl_manager
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/webgl_manager",["./glsl_source","./source_map"],(function(e,t){const n="\nattribute vec2 vertexPosition;\nvarying vec2 coord;\nvoid main(void) {\n    gl_Position = vec4(vertexPosition, 0, 1);\n    coord       = vertexPosition;\n}",i="\nattribute vec2 vertexPosition;\nattribute vec2 texturePosition;\nvarying vec2 coord;\nvoid main(void) {\n    gl_Position = vec4(vertexPosition, 0, 1);\n    coord       = texturePosition;\n}",{getLineMapper:o,fileSeparation:r}=t;function s({canvas:e,data:t,handleErrorsAndWarnings:n=w}){this.storedData={},this.dataMapper={},this.textures=new Map,this.frameIndex=0,this.handleErrorsAndWarnings=n,function(e,t){try{e.gl=t.getContext("webgl2")||t.getContext("webgl")||t.getContext("experimental-webgl"),e.gl.viewport(0,0,t.width,t.height)}catch(e){console.error("Canvas error")}e.gl||console.error("Could not initialize WebGL")}(this,e),t&&this.setData(t)}s.prototype.initSource=function(t){this.dataMapper={},this.textures=new Map;const o=this;function s(){!function(e,{spritesMode:t}){let{gl:o,fragmentSource:r,vertexSource:s}=e;s||(s=t?i:n);let a=g(e,{source:r,type:"fragment"}),l=g(e,{source:s,type:"vertex"});const c=o.createProgram();o.attachShader(c,l),o.attachShader(c,a),o.linkProgram(c),e.shaderProgram=c,o.getProgramParameter(c,o.LINK_STATUS)||console.error("Could not initialize shaders");o.useProgram(c)}(o,t),t.spritesMode&&(o.sprites=[]),function(e,{zones:t}={}){t&&b(e,t.length);y(e,{zones:t})}(o);const{callback:e}=t;e&&e()}!("source"in(t=Object.assign({skipGeneralPrefix:!0},t)))&&t.spritesMode&&(t.source="\nuniform sampler2D u_texture;\nvoid main() {\n    gl_FragColor = texture2D(u_texture, coord);\n}"),function(t,n,i){e(n,(n=>{let o=l(t.storedData,n);o+=l({pixToPlot:1,screenScaleX:1,screenScaleY:1},n),""!==o&&(n=r("autoDataPrefix")+o+n),n=e.generalPrefix+n,t.fragmentSource=n,i()}))}(this,t,(()=>{t.vertexSource?(t.source=t.vertexSource,function(t,n,i){e(n,(e=>{t.vertexSource=e,i()}))}(this,t,s)):s()}))},s.prototype.clearScreen=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},s.prototype.drawScene=function({data:e={}}={}){const{gl:t}=this;c(this,e);const n=Object.assign({},this.storedData,e),i=h(n.zoom||1),o=i*t.viewportWidth;if(this.setUniformValues(n),this.setUniformValues({pixToPlot:2/o,screenScaleX:1/i,screenScaleY:t.viewportHeight/o}),this.sprites){t.clear(t.COLOR_BUFFER_BIT);let e=0;this.sprites.forEach((n=>{t.bindTexture(t.TEXTURE_2D,n.texture),t.drawArrays(t.TRIANGLE_STRIP,e,4),e+=4}))}else t.drawArrays(t.TRIANGLE_STRIP,0,4);this.frameIndex+=1},s.prototype.setData=function(e){c(this,e),Object.assign(this.storedData,e)},s.prototype.setUniformValues=function(e){for(let t in e)this.setUniformValue(t,e[t])},s.prototype.setUniformValue=function(e,t){const{dataMapper:n}=this,i=n[e]||function(e,t){const{gl:n,dataMapper:i,shaderProgram:o,fragmentSource:r,frameIndex:s}=e,a=u(r,t)||"float",l=n.getUniformLocation(o,t);let c;if("float"===a)c=e=>n.uniform1f(l,e);else if("float[]"===a)c=e=>n.uniform1fv(l,e);else if("int"===a)c=e=>n.uniform1i(l,e);else if("vec2"===a||"vec3"===a||"vec4"===a)c=e=>n[`uniform${a[3]}f`](l,...e);else{if("sampler2D"!==a)throw new Error(`Unsupported type '${a}' when setting '${t}'`);c=n=>e.setTexture(t,n)}const h={setter:c,lastChanged:s};return i[t]=h,h}(this,e),{setter:o,lastChanged:r=1/0}=i;"function"==typeof t?o(t()):r>=this.frameIndex&&o(t)};const a=4;function l(e,t){let n="";for(let o in e)if(!u(t,o)){let t,r=h(e[o]);if("number"==typeof r)t="float";else if(Array.isArray(r)&&r.length<=a)t=`vec${r.length}`;else if(Array.isArray(r))t="float",o+=`[${r.length}]`;else{if(!(i=r)||!("imageData"in i||i instanceof ImageData||i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap||i instanceof Uint8Array)){if(void 0===r)continue;throw new Error(`Unsupported type for '${o}'`)}t="sampler2D"}n+=`uniform ${t} ${o};\n`}var i;return n}function c(e,t){const{dataMapper:n,frameIndex:i}=e;for(let e in t)e in n&&(n[e].lastChanged=i)}function u(e,t){const n=e.match(new RegExp(`uniform\\s+(.*)\\s+${t}(\\[\\d*\\])?;`));return n?n[2]?`${n[1]}[]`:n[1]:null}function h(e){return"function"==typeof e?e():e}function d(e){const{gl:t}=e;let n=0;e.sprites.forEach((e=>{t.bindTexture(t.TEXTURE_2D,e.texture),t.drawArrays(t.TRIANGLE_STRIP,n,4),n+=4}))}function p(e,t){const{textures:n}=e;return n.has(t)||n.set(t,{texture:e.createTexture(t),index:0}),e.textures.get(t).texture}function f(e){let t=e.sprites.length;t!==e.currentTexturesCoordsLength&&(e.currentTexturesCoordsLength=t,b(e,t))}function g(e,{source:t,type:n}){let i,{gl:r,handleErrorsAndWarnings:s}=e;if("fragment"===n)i=r.createShader(r.FRAGMENT_SHADER);else{if("vertex"!==n)return null;i=r.createShader(r.VERTEX_SHADER)}r.shaderSource(i,t),r.compileShader(i);const a=r.getShaderParameter(i,r.COMPILE_STATUS),l=function(e,t,n){const i=e.getShaderInfoLog(t),r=n.split("\n"),s=o(n),a={all:[],errors:[],warnings:[]};return i.replace(x,(function(e,t,n,i){n=parseInt(n,10);const o=r[n-1],{name:l,line:c}=s(n),u={sourceLine:o,line:c,sourceName:l,message:i};a.all.push(u),"WARNING"===t?(u.severity="warning",a.warnings.push(u)):(u.severity="error",a.errors.push(u))})),a}(r,i,t);return s(l),a?i:null}s.prototype.updateSprites=function(e){this.sprites=e,f(this);let t=[];e.forEach((e=>{let{center:n,width:i,height:o,image:r}=e;e.texture=p(this,r);const{x:s,y:a}=n;let l=[s-i/2,a-o/2,s+i/2,a-o/2,s-i/2,a+o/2,s+i/2,a+o/2];t.push(l)})),y(this,{zones:t})},s.prototype.prepareRawSprites=function(){f(this);let e=[];this.sprites.forEach((t=>{let{points:n,image:i}=t;t.texture=p(this,i),e.push(n)})),y(this,{zones:e})},s.prototype.drawSprite=function(e){this.updateSprites([e]);const{gl:t}=this;t.bindTexture(t.TEXTURE_2D,e.texture),t.drawArrays(t.TRIANGLE_STRIP,0,4)},s.prototype.drawSprites=function(e){this.updateSprites(e),d(this)},s.prototype.drawRawSprites=function(){this.prepareRawSprites(),d(this)},s.prototype.addSprite=function(e){this.sprites.push(e)},s.prototype.setTexture=function(e,t){const{gl:n,textures:i}=this;if(t.imageData&&(t=t.imageData),i.has(e)){const{index:o}=i.get(e);n.activeTexture(n[`TEXTURE${o}`]),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)}else!function(e,t,n){const{gl:i,shaderProgram:o,textures:r}=e,s=r.size;i.uniform1i(i.getUniformLocation(o,t),s),i.activeTexture(i[`TEXTURE${s}`]);const a=e.createTexture(n);r.set(t,{texture:a,index:s})}(this,e,t)},s.prototype.createTexture=function(e){const{gl:t}=this,n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),e&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),n};const m=[1,1,-1,1,1,-1,-1,-1];function y(e,{zones:t}={}){let n;t?(n=[],t.forEach((e=>n.push(...e)))):n=m,v(e,{vertices:n,variableName:"vertexPosition"})}function v(e,{variableName:t,vertices:n}){const{gl:i,shaderProgram:o}=e,r=e.gl.createBuffer(),s=i.getAttribLocation(o,t);return i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,new Float32Array(n),i.STATIC_DRAW),i.enableVertexAttribArray(s),i.vertexAttribPointer(s,2,i.FLOAT,!1,0,0),r}function b(e,t){const{gl:n,shaderProgram:i}=e;let o=[];for(let e=0;e<t;e++)o.push(1,1,0,1,1,0,0,0);e.texCoordBuffer=v(e,{vertices:o,variableName:"texturePosition"});let r=n.getUniformLocation(i,"u_texture");n.activeTexture(n.TEXTURE0),n.uniform1i(r,0)}const x=/(.*):\s0:(\d*):\s(.*)/g;function w({all:e,errors:t}){if(e.forEach(_),1===t.length)throw new Error("Shader compilation error");if(t.length>1)throw new Error("Shader compilation errors")}function _({line:e,sourceName:t,sourceLine:n,message:i,severity:o}){const r=`${`[${t}, line ${e}] ${n}`}\n ${i}`;"warning"===o?console.warn(r):console.error(r),console.log("\n")}return s})),
/*! Toxilib screen_glsl
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_glsl",["./webgl_manager","./screen_canvas","./topleft_and_pivot","./screen_image_utils"],(function(e,t,n,i){const{pointsForRectangle:o}=n,{getUsableImageAndPositionParams:r,getImageByUrl:s}=i;function a(t,{screenParent:n}={}){this.canvas=t,this.cx=t.getContext("webgl",{preserveDrawingBuffer:!0}),this.webGLManager=new e({canvas:t}),this.webGLManager.initSource({spritesMode:!0}),n&&(this.screenParent=n,n.render=()=>this.render())}a.prototype.setCenterAdapterScreenParent=function(){return{x:0,y:0}},a.prototype.setScaleForScreenParent=function(){const{screenParent:e,canvas:t}=this,{width:n}=t;e.adapterScale=2*e.scale/n,e.adapterScaleY=e.adapterScale};["isInside","toBlob","toPNGImage","downloadAsImage"].forEach((e=>{a.prototype[e]=t.prototype[e]})),a.prototype.clear=function(){this.webGLManager.sprites=[]},a.prototype.render=function(){const{webGLManager:e}=this;e.clearScreen(),e.drawRawSprites()},a.prototype.updatedDimensions=function(){let{width:e,height:t}=this.canvas;return this.ratio=e/t,{width:e,height:t}},a.prototype.drawImage=function(e){let{image:t,url:n}=e;if(n&&console.warn("'url' param in drawImage has been replaced with 'image'"),n||"string"==typeof t){const{errorHandler:i}=this;s({url:n||t,errorHandler:i,callback:t=>c(this,e,t)})}else c(this,e)};const l={forceTopLeft:!0,reverseY:!1};function c(e,t,i){let{webGLManager:s,ratio:a}=e,c=i||t.image;const{image:u,positionParams:h}=r(c,t,l);if(!("topLeft"in h))throw new Error("Cannot display the image : position is missing");let{orientation:d}=h;if(d){let e=n.getPivot(t,h.width,h.height);e&&(h.topLeft=n.topLeftPointWithPivot(h.topLeft,d,e))}let[p,f,g,m]=o(h);const y=[g.x,g.y*a,m.x,m.y*a,f.x,f.y*a,p.x,p.y*a];s.addSprite({points:y,image:u})}return a})),
/*! Toxilib interpolate
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/interpolate",[],(function(){function e(e,n,i){return t(e,n,i,-1)}function t(e,n,i,o){let r=typeof e;return r!==typeof n&&(r="different"),"number"===r?function(e,t,n){return e+(t-e)*n}(e,n,i):"object"===r&&o<8?Array.isArray(e)?function(e,n,i,o){let r=o+1,s=i<.5?e.length:n.length;const a=new Array(s);for(let o=0;o<s;o++)a[o]=t(e[o],n[o],i,r);return a}(e,n,i,o+1):function(e,n,i,o){let r={},s=o+1;for(let o in e)r[o]=t(e[o],n[o],i,s);for(let o in n)o in e||(r[o]=t(void 0,n[o],i,s));return r}(e,n,i,o+1):i<.5?e:n}return e.remap=function(e,{start:t=0,end:n=1,clamp:i=!0,easing:o}={}){let r=(e-t)/(n-t);return(o||i)&&(r=Math.max(Math.min(r,1),0)),"easeIn"===o?r*r:"easeOut"===o?r*(2-r):"easeInOut"===o?r*r*(3-2*r):r},e.closestEndValueWithModulo=function({start:e,end:t,modulo:n}){let i=(t-e)%n;return i=(i+n)%n,i>n/2&&(i-=n),e+i},e})),
/*! Toxilib smooth_state
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/smooth_state",["./interpolate"],(function(e){const{remap:t,closestEndValueWithModulo:n}=e,i=()=>{};function o(e,{hook:t=i,allowTypeChanges:n,allowNewValues:o}={}){this.current=a(e,e,{}),this.hook=t,this.allowNewValues=o,this.allowTypeChanges=n,this.transitionalStates=[]}function r(e){e.timer&&(clearTimeout(e.timer),delete e.timer)}function s(e,t){return"function"==typeof e?(void 0===t&&(t=Date.now()),e(t)):e}function a(e,t,{labelName:n,onTypeChange:i}){let o=typeof t;return o!==typeof e&&"undefined"!==o?function({a:e,b:t,labelName:n,onTypeChange:i}){return"allowBoth"===i||"allowTypeChanges"===i||"allowNewValues"===i&&void 0===e?t:(function({labelName:e,a:t,b:n}){let i=`old(${typeof t}) and new(${typeof n}) should have the same type`;e&&(i=`For ${e} : ${i}`);throw new Error(i)}({labelName:n,a:e,b:t}),!1)}({a:e,b:t,labelName:n,onTypeChange:i}):Array.isArray(e)?function(e,t,n){if(void 0===t)return e.slice();if(t.length>e.length&&"allowBoth"!==n&&"allowNewValues"!==n)throw new Error("arrays should have the same length");let i=Math.max(e.length,t.length);const o=new Array(i);for(let r=0;r<i;r++)o[r]=a(e[r],t[r],{labelName:r,onTypeChange:n});return o}(e,t,i):"object"===o&&t?function(e,t,n){let i={};for(let o in e)i[o]=a(e[o],t[o],{labelName:o,onTypeChange:n});if("allowBoth"===n||"allowNewValues"===n)for(let o in t)o in e||(i[o]=a(void 0,t[o],{labelName:o,onTypeChange:n}));return i}(e,t,i):"undefined"===o?e:t}return o.noHook=i,o.closestEndValueWithModulo=n,o.prototype.change=function(n,i=0){"number"==typeof i&&(i={delay:i});let{delay:o=0,easing:l="easeInOut",whenEnded:c,allowTypeChanges:u=this.allowTypeChanges,allowNewValues:h=this.allowNewValues}=i;r(this);let d=function({allowTypeChanges:e,allowNewValues:t}){if(e&&t)return"allowBoth";if(e)return"allowTypeChanges";if(t)return"allowNewValues";return!1}({allowTypeChanges:u,allowNewValues:h}),p=this.current,f=function(e,n){let i=Date.now();if(0===e){let e=()=>1;return e.end=i,e}let o=i+e;function r(e){return t(e,{start:i,end:o,easing:n})}return r.end=o,r}(o,l),{end:g}=f,m=this;function y(t=Date.now()){let i=s(p,t),o=a(i,s(n,t),{onTypeChange:d});return t>=g&&y===m.transitionalStates[0]?(p=i,m.current===y&&(n.isFrozenState||"function"!=typeof n?m.current=o:m.current=n),m.transitionalStates.shift(),y.ended=!0,o):(m.hook(i,o),e(i,o,f(t)))}return this.transitionalStates.push(y),c&&(this.timer=setTimeout(c,o)),this.current=y,y},o.prototype.freeze=function(e=0){if(r(this),0===e)return void this.change(s(this.current));let t=this;function n(){return t.lastEvaluatedValue}n.isFrozenState=!0,this.change(n,e)},o.prototype.currentValue=function(){return this.lastEvaluatedValue=s(this.current),this.lastEvaluatedValue},o.prototype.isChanging=function(){return"function"==typeof this.current&&(this.currentValue(),"function"==typeof this.current)},o})),
/*! Toxilib screen_camera
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_camera",["./smooth_state"],(function(e){const{closestEndValueWithModulo:t}=e;function n(t,n=t.getCamera()){this.screen=t;const{center:o,scale:r,orientation:s}=n;this.smoothState=new e({center:o,scale:r,orientation:s},{hook:i})}function i(e,n){n.orientation=t({start:e.orientation,end:n.orientation,modulo:360})}n.prototype.change=function(e,t=0){"delay"in e&&(t=e.delay);let{whenEnded:n}=e;e=function(e,t){let{center:n,scale:i,orientation:o}=t.getCamera();if("function"==typeof e)return function(){let{center:t=n,orientation:r=o,scale:s=i}=e(),{x:a,y:l}=t;return{center:{x:a,y:l},orientation:r,scale:s}};{let{center:t=n,orientation:r=o,scale:s=i}=e,{x:a,y:l}=t;return{center:{x:a,y:l},orientation:r,scale:s}}}(e,this.screen),this.smoothState.change(e,{delay:t,whenEnded:n}),0===t&&this.triggerScreenUpdate()},n.prototype.freeze=function(e=0){this.smoothState.freeze(e),0===e&&this.triggerScreenUpdate()},n.prototype.triggerScreenUpdate=function(){this.screen.setCamera(this.currentValue())},n.prototype.currentValue=function(){return this.smoothState.currentValue()},n.prototype.isMoving=function(){return this.smoothState.isChanging()};const o=1e-6;return n.putTargetInsideBox=function(e,{target:t,xLeft:n,xRight:i,yTop:r,yBottom:s}){i===n&&(i+=o),s===r&&(s+=o);let{width:a,height:l}=e,c=e.pixelCoordsToCoords({x:a*n,y:l*s}),u=e.pixelCoordsToCoords({x:a*i,y:l*s}),h=e.pixelCoordsToCoords({x:a*n,y:l*r}),d=u.x-c.x,p=u.y-c.y,f=h.x-c.x,g=h.y-c.y,m=t.x-c.x,y=t.y-c.y,v=(d*m+p*y)/(d*d+p*p),b=(f*m+g*y)/(f*f+g*g),{center:x,scale:w,orientation:_}=e.getCamera(),S=0,C=0;v>1?S=v-1:v<0&&(S=v),b>1?C=b-1:b<0&&(C=b);let k=!1;return 0===S&&0===C||(x={x:x.x+S*d+C*f,y:x.y+S*p+C*g},k=!0),{center:x,scale:w,orientation:_,changed:k}},n})),
/*! Toxilib smart_smooth_state
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/smart_smooth_state",["./smooth_state"],(function(e){const t=["isChanging","change","hook","freeze","setModularValue","timer","current","currentValue","lastEvaluatedValue","futureDelay","futureEasing"],n=["current","timer","lastEvaluatedValue","futureDelay","futureEasing"],i=8;function o(e,t){return(e%t+t)%t}return function(r,s){s=Object.assign({allowTypeChanges:!0,allowNewValues:!0},s);let a=new e(r,s);if("object"!=typeof r)return a;let l,{maxDepth:c=i}=s,u=Object.keys(r),h=-1/0,{currentHook:d=e=>e}=s;a.futureDelay=1e3,a.futureEasing="easeInOut";let p={};function f(t,n){for(let i in p)n[i]=e.closestEndValueWithModulo({start:t[i],end:n[i],modulo:p[i]})}function g(e){a.change(e,{delay:a.futureDelay,easing:a.futureEasing})}function m(e,t,n){let i=Array.isArray(t),r=new Proxy(t,{get:(t,i)=>{if("constructor"===i)return Reflect.get(t,i);y();let r=l;if(e.forEach((e=>{r=r[e]})),i in p)return o(r[i],p[i]);{let t=r[i];return"object"==typeof t&&t&&n<c?m([...e,i],t,n+1):t}},set:(n,o,r)=>{let s;return s=i?function(e,t,n,i){let o={},r=o,s=e.length-1;return e.forEach(((e,n)=>{let i=n===s?[...t]:{};r[e]=i,r=i})),r[n]=i,o}(e,t,o,r):function(e,t,n){let i={},o=i,r=l;return e.forEach((e=>{r=r[e];let t=Array.isArray(r)?[]:{};o[e]=t,o=t})),o[t]=n,i}(e,o,r),g(s),a.futureDelay<=0&&(h=-1/0),!0},deleteProperty(e,t){r[t]=null}});return r}function y(){let e=Date.now();e>h&&(h=e,l=d(a.currentValue()))}function v(e,t){Object.keys(e).forEach((e=>{u.includes(e)||u.push(e)}));let n=a.change(e,t);return a.futureDelay<=0&&(h=-1/0),n}return a.setModularValue=function(t,n){if(p[t]=n,1===Object.keys(p).length){if(a.hook!==e.noHook)throw new Error("modular hook not supported yet if another hook is present");a.hook=f}},new Proxy(a,{get:(e,n)=>{if(t.includes(n))return"change"===n?v:a[n];if(y(),n in p)return o(l[n],p[n]);{let e=l[n];return"object"==typeof e&&e?m([n],e,0):e}},set:(e,t,i)=>(n.includes(t)?a[t]=i:(u.includes(t)||u.push(t),g({[t]:i}),a.futureDelay<=0&&(h=-1/0)),!0),deleteProperty(e,t){let n=u.indexOf(t);n>=0&&u.splice(n,1),g({[t]:null})},ownKeys:()=>u,has:(e,t)=>u.includes(t),getOwnPropertyDescriptor:(e,t)=>u.includes(t)?{enumerable:!0,configurable:!0}:void 0})}})),define("user_code/handle_execution_error",["event_bus"],(function(e){let t;return e.on("executionError handler ready",(e=>{t=e})),function(e,{executable:n}={}){return function(i){i.toxiTrace=i.toxiTrace||[],i.toxiTrace.unshift(e);let o=n&&n.executionErrorHandler||t;if(!o)throw i;o(i)}}})),define("render/hybrid_screen",["event_bus","toxilibs/event_capabilities_queued","toxilibs/alias","./screen","toxilibs/screen_glsl","toxilibs/screen_group","toxilibs/screen_camera","toxilibs/topleft_and_pivot","toxilibs/color","toxilibs/smart_smooth_state","user_code/handle_execution_error"],(function(e,t,n,i,o,r,s,a,l,c,u){const{getCenterPoint:h}=a,d=u("Explorers - hybrid_screen.js - screen event error"),p=u("Explorers - hybrid_screen.js - screen error"),f=["isInside","isOutside","getTextDimensions","coordsToPixelCoords","pixelCoordsToCoords","eventToCoords","eventToSmartTrimmedCoords","mouseEventToCoords","mouseEventToSmartTrimmedCoords","touchEventToCoords","touchEventToSmartTrimmedCoords","smartTrimCoords","on","when","emit","boundingBox","pixBoundingBox","boundingBoxForPixelZone","boundingBoxForWholeView","attachElement","updateCanvasSize","toImageData","toBlob"],g=["remove","bringToFront","toJSON","importJSON","addObject","shapesAt"],m={};i.drawingMethods.forEach((e=>{let t=e.replace("draw","add");m[e]=t,g.push(t)})),e.emit("screenGroupMethods ready",g);let y=0;function v({name:e="screen",mode:a,canvas:l,directScreenMode:c,onCameraMoved:u=()=>{},setOptimalCamera:h,onBackgroundBrightnessChanged:g=()=>{}}){this.name=e,this.id=y++,this.mode=a;const m={errorHandler:p};var v;"glsl"===a&&(m.adapter=o),this.screen=new i(l,m),this.directScreen=this.screen,this.onCameraMoved=u,this.onBackgroundBrightnessChanged=g,t(this.screen,{onError:d}),this.screenGroup=new r({failFast:!0,errorHandler:p}),this.screenGroupLastChange=0,c?this.setDirectScreenMode():(this.directScreenMode=!1,_(this)),n({target:(v=this).screen,proxy:v,keys:f,fastMode:!0,writable:!1}),this.screenCamera=new s(this.screen),Object.defineProperty(this,"widthInPixels",{get:()=>this.screen.widthInPixels,enumerable:!0}),Object.defineProperty(this,"heightInPixels",{get:()=>this.screen.heightInPixels,enumerable:!0}),this.initialOptimalCamera=h,this.createdAt=Date.now()}function b(e,t,n){if(function(e){for(let t in e)if(!x.includes(t))return!1;return!0}(n))return e.render(),e.screen[t](n);{let i=function(e,t){let{width:n,height:i,orientation:o}=e.getCamera();const{canvas:r}=e;let{width:s=n,height:a=i,orientation:l=o,widthInPixels:c=r.width*s/n,heightInPixels:u}=t,d=s/a;if("widthInPixels"in t&&"heightInPixels"in t){let e=c/u;e>d?s=a*e:a=s/e}if(c>w||u>w)throw new Error("Image too big");let p=h(t,s,a)||e.center;return{center:p,width:s,height:a,orientation:l,widthInPixels:c,heightInPixels:u}}(e.screen,n);const{fillColor:o,color:r=o}=e.lastClearParams||{};return e.screenGroup[t](Object.assign({backgroundColor:r},n,i))}}v.prototype.reset=function(){this.screen.removeAllListeners(),this.clear(),this.screen.drawAdapter.resetStyle()},v.prototype.setDirectScreenMode=function(e=!0){var t,o;this.directScreenMode!==e&&(this.directScreenMode=e,e?(o=this.screen,i.drawingMethods.forEach((e=>{let t=e.replace("draw","add");t in o||(o[t]=o[e])})),n({target:(t=this).screen,proxy:t,keys:m,fastMode:!0,writable:!1,configurable:!0})):_(this))},v.prototype.clear=function(e={}){this.directScreenMode?this.screen.clear(e):(this.lastClearParams=e,this.screenGroup.reset(),this.screenGroupLastChange=0);let{color:t}=e;t&&new l(t).writeOnItWithDark()?this.onBackgroundBrightnessChanged("bright"):this.onBackgroundBrightnessChanged("dark")},v.prototype.render=function(e=!1){if(this.directScreenMode)return;let{lastChange:t}=this.screenGroup,n=this.screenCamera.isMoving();if(e||t!==this.screenGroupLastChange||n){this.initialOptimalCamera&&(this.setOptimalCamera(this.initialOptimalCamera,{intScale:!0,delay:0}),this.cameraAlreadyMoved=!1,delete this.initialOptimalCamera);const e=performance.now();this.emit("render started"),this.screen.clear(this.lastClearParams),this.screenCamera.triggerScreenUpdate(),n&&this.onCameraMoved(),this.screenGroupLastChange=t,this.screen.drawGroup({group:this.screenGroup}),this.screen.render&&this.screen.render(),this.screen.updateAttachedElements(),this.renderTime=Math.round(10*(performance.now()-e))/10,this.lastDisplayedBoundingBox=this.boundingBoxForWholeView()}},v.prototype.forceRender=function(){this.render(!0)},v.prototype.forceRefresh=function(){this.screenGroup.lastChange++},v.prototype.isEmpty=function(){return 0===this.screenGroup.length},v.prototype.getCamera=function(){const{center:e,scale:t,orientation:n}=this.screenCamera.currentValue(),{width:i,height:o}=this.screen;return{center:e,scale:t,width:i/t,height:o/t,orientation:0===n?0:-n}},v.prototype.setCamera=function(e){if(!("delay"in e)&&(this.cameraAlreadyMoved||Date.now()-this.createdAt>300)){if(!function(e,t){let{center:n,scale:i,orientation:o}=e.screen.getCamera();return"scale"in t&&t.scale!==i||"center"in t&&(t.center.x!==n.x||t.center.y!==n.y)||"orientation"in t&&t.orientation!==o}(this,e))return;e=Object.assign({delay:200},e)}else this.cameraAlreadyMoved=!0;this.screenCamera.change(e),this.onCameraMoved()},v.prototype.freezeCamera=function(e){this.screenCamera.freeze(e),this.onCameraMoved()},v.prototype.setOptimalCamera=function(e,t={}){const n=this.screen.setOptimalCamera(e,t);return n.delay=t.delay||0,this.setCamera(n),n},v.prototype.putTargetInsideCameraBox=function({target:e,xLeft:t,xRight:n,yTop:i,yBottom:o,delay:r}){let a=s.putTargetInsideBox(this.screen,{target:e,xLeft:t,xRight:n,yTop:i,yBottom:o});a.changed&&(a.delay=r,this.setCamera(a))},v.prototype.zoom=function(e){let{scale:t}=this.getCamera();t*=e,this.setCamera({scale:t,delay:200})},v.prototype.rotate=function(e){let{orientation:t}=this.getCamera();t=e-t,this.setCamera({orientation:t,delay:200})},v.prototype.translateCenter=function({x:e=0,y:t=0,delay:n=200}){let{center:i}=this.getCamera();this.setCamera({center:{x:i.x+e,y:i.y+t},delay:n})},v.prototype.getPixelColor=function(...e){return this.render(),this.screen.getPixelColor(...e)},v.prototype.toImage=function(e){return b(this,"toScreenImage",e)},v.prototype.toBlob=function(e){return b(this,"toBlob",e)},v.prototype.toBase64=function(e){return b(this,"toBase64",e)},v.prototype.toPNGImage=function(e){return b(this,"toPNGImage",e)},v.prototype.downloadAsImage=function(e){return b(this,"downloadAsImage",Object.assign({name:this.name},e))};let x=["name","fileName","quality","format"];const w=1e4;function _(e){n({target:e.screenGroup,proxy:e,keys:g,fastMode:!0,writable:!1,configurable:!0})}return v})),define("editor/autocomplete",["event_bus"],(function(e){let t,n,i=[];e.on("code editor ready",(e=>{t=e,i.forEach(l)})),e.on("general api updated",(e=>{n||(s(e),n=!0)})),e.on("miniModules names updated",(e=>{let t={};e.forEach((e=>{t[e]=!0})),s({m:t})}));let o={};e.onceAll(["screenGroupMethods ready","render api ready"],(function([e],[t]){o=e,s(t);let{screen:n}=t,i=[];for(let e in n)o.includes(e)&&(i[e]=n[e]);s({view:i})})),e.on("system wants to add properties to scope",s);const r=["random","geo","Color","terminal","dataSet","screen","view","spec","ui","m","editor","cassette","imagine","audio","all","allMine","allowed"];function s(e){let t={root:[]};for(let n in e){let i=e[n];if("function"==typeof i&&(i._autoComplete||i._snippet)){let{_autoComplete:e={},_snippet:o=`${n}(\${1})`}=i;!0===e&&(e={});const{caption:r=`${n}()`,snippet:s=o,firstPart:a=n.substr(0,3)}=e;t.root.push({caption:r,snippet:s,firstPart:a})}}r.forEach((n=>{if(!(n in e))return;const i=e[n];if(!i)return;const o=[];Object.keys(i).forEach((e=>{let t=a(i,e);t&&o.push(t)}));Object.keys(Object.getPrototypeOf(i)).forEach((e=>{let t=a(i,e);t&&o.push(t)})),t[n]=o})),l(t)}function a(e,t){if("terminalDisplay"===t)return null;const n=e[t],i=typeof n;return"function"!==i&&"object"!==i||!n._hidden?"function"===i?{caption:`${t}()`,snippet:n._snippet||`${t}(\${1})`}:t:null}function l(e){t?t.addAutoCompletions(e):i.push(e)}return l({root:[{caption:"onEveryFrame()",snippet:"onEveryFrame(${1})",firstPart:"onE"}]}),l})),define("editor/snippet_tools",["./autocomplete"],(function(e){function t(e,i={i:1,level:1}){let o=[];if(0===Object.keys(e).length)return"${1}";for(let r in e){let s=e[r];null===s&&(s=" "),"object"==typeof s?(i.level++,o.push(`${r}: {\n${"\t".repeat(i.level)}${t(s,i)}\n${"\t".repeat(i.level-1)}}`),i.level--):(o.push(`${r}: ${n(i.i,s)}`),i.i++)}let r=`,\n${"\t".repeat(i.level)}`;return o.join(r)}function n(e,t){return"string"==typeof t&&"'"===t[0]?`'\${${e}:${t.slice(1,-1)}}'`:`\${${e}:${t}}`}return{snippetizeParam:t,addMethodSnippet:function(e,n,i){"number"==typeof i||"string"==typeof i?e._snippet="simpleFunctionNoArg"===i?`${n}()`:"simpleFunction"===i?`${n}(\${1})`:`${n}(\${1:${i}})`:Array.isArray(i)?e._snippet=`${n}(${i.map(((e,t)=>`\${${t+1}:${e}}`)).join(", ")})`:e._snippet=`${n}({\n\t${t(i)}\n})`},addCompletions:e}})),define("user_code/api_manager",["event_bus","editor/snippet_tools"],(function(e,t){let n;const{addMethodSnippet:i}=t;let o={};e.on("system wants to add properties to scope",(function(e){for(let t in e)o[t]=e[t]})),e.on("worldApi tools added",(function(e){n=e}));const r=[];function s({namespace:t,include:s,snippetParams:l,onDestroy:c=()=>{}}){let u=s?Object.assign({},...s):{};if(a({api:u,namespace:t,properties:o}),n&&n.addScopeDependentMethods(u),function({api:t,namespace:n}){let i=e.on("system wants to add properties to scope",(e=>{a({api:t,namespace:n,properties:e})}));r.push(i)}({api:u,namespace:t}),l)for(let e in u){let t=l[e];t&&i(u[e],e,t)}return{api:u,destroy:function(){n&&n.destroyProxy(t),c()}}}function a({api:e,namespace:t,properties:n}){for(let i in n)i in e&&console.log(`${i} already in scope in ${t}`),e[i]=l(n[i],t)}function l(e,t){return e.createProxy?e.createProxy(`world_${t}`):e}return s.reset=function(){o={},r.forEach((t=>e.removeListener("system wants to add properties to scope",t)))},s})),define("user_code/executable_api",[],(function(){return function(e){const t=new Set;return{doOnce:function(n){const{name:i,executedAt:o}=e,r=`${i} ${o} ${n}`;t.has(r)||(n(),t.add(r))},currentTime:function(){let{executedAt:t=!1}=e;return t?(Date.now()-t)/1e3:null},runCount:function(){return e.executionStatus.runs},currentRunner:function(){return e.name}}}})),define("logger",["event_bus"],(function(e){let t=console,n=console;return e.on("terminal logger api ready",(e=>{t=e})),e.on("system wants to log",(function(...e){n===console&&t!==console&&(n=t.terminal.system);e.forEach((e=>n.log(e)))})),{log:(...e)=>t.log(...e),rawLog:(...e)=>{t===console?console.log(...e):t.rawLog(...e)},error:(...e)=>t.error(...e),success:(...e)=>{t===console?console.log(...e):t.success(...e)},clear:()=>t.clear()}})),define("user_code/deprecate",["toxilibs/deprecation","logger"],(function(e,t){const{add:n}=e;function i({messagePrefix:e,deprecated:n,updated:i}){e=e?`[${e}] `:"",t.error(`Warning : ${e}'${n}' has been replaced with '${i}'\n            <br>Please update your code accordingly`)}return function(e,t,o){n(o,e,t,{handler:i,onlyWhenCalled:!0});for(let n in t)e[n]._hidden=!0}})),
/*! Toxilib webgl_image
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/webgl_image",["./screen_image","./webgl_manager","./source_map","./topleft_and_pivot"],(function(e,t,n,i){const{getTopLeftPoint:o,copyPositionParam:r,addPositionAccessors:s}=i,{fileSeparation:a}=n,l="\n\nvec2 dimensionsInPixels     = vec2(widthInPixels, heightInPixels);\nvec2 semiDimensionsInPixels = 0.5 * vec2(widthInPixels, heightInPixels);\n\nvec2 dimensionsInScreenSpace = 2. * semiDimensionsInScreenSpace;\n\nvec2 dimensionsRatioFromScreenToPixel = dimensionsInPixels / dimensionsInScreenSpace;\n\n\n\nvec2 pixelCoordsToCoords (float x, float y) {\n    return centerInScreenSpace + vec2(x - semiDimensionsInPixels.x, semiDimensionsInPixels.y - y) / dimensionsRatioFromScreenToPixel;\n}\nvec2 pixelCoordsToCoords (vec2 pixelCoords) {\n    return centerInScreenSpace + vec2(pixelCoords.x - semiDimensionsInPixels.x, semiDimensionsInPixels.y - pixelCoords.y) / dimensionsRatioFromScreenToPixel;\n}\n\n\nvec2 coordsToPixelCoords (float x, float y) {\n    return floor(0.1 + (semiDimensionsInPixels + vec2(x - centerInScreenSpace.x, centerInScreenSpace.y - y) * dimensionsRatioFromScreenToPixel));\n}\nvec2 coordsToPixelCoords (vec2 coords) {\n    return floor(0.1 + (semiDimensionsInPixels + vec2(coords.x - centerInScreenSpace.x, centerInScreenSpace.y - coords.y) * dimensionsRatioFromScreenToPixel));\n}\n\n\nvec2 pixelCoordsToTextureCoords (float x, float y) {\n    return vec2(x, y) / dimensionsInPixels;\n}\nvec2 pixelCoordsToTextureCoords (vec2 pixelCoords) {\n    return pixelCoords / dimensionsInPixels;\n}\n\n\nvec2 textureCoordsToPixelCoords (float x, float y) {\n    return vec2(x, y) * dimensionsInPixels;\n}\nvec2 textureCoordsToPixelCoords (vec2 textureCoords) {\n    return textureCoords * dimensionsInPixels;\n}\n\n\nvec2 coordsToTextureCoords (float x, float y) {\n    return 0.5 + vec2(x - centerInScreenSpace.x, centerInScreenSpace.y - y) / dimensionsInScreenSpace;\n}\nvec2 coordsToTextureCoords (vec2 coords) {\n    return 0.5 + vec2(coords.x - centerInScreenSpace.x, centerInScreenSpace.y - coords.y) / dimensionsInScreenSpace;\n}\n\n\nvec2 textureCoordsToCoords (float x, float y) {\n    return centerInScreenSpace + vec2(x - 0.5, 0.5 - y) * dimensionsInScreenSpace;\n}\nvec2 textureCoordsToCoords (vec2 coords) {\n    return centerInScreenSpace + vec2(coords.x - 0.5, 0.5 - coords.y) * dimensionsInScreenSpace;\n}\n\n\n",c="\n\nvec4 colorAtPixel(vec2 pixelCoords) {\n    return texture2D(source, pixelCoords / dimensionsInPixels);\n}\nvec4 colorAtPixel(float x, float y) {\n    return texture2D(source, pixelCoordsToTextureCoords(x, y));\n}\n\n",u="\nvoid main(void) {\n\n    vec2 textureCoords = vec2(1. + coord.x, 1. - coord.y) * 0.5;\n    vec2 coords        = centerInScreenSpace + coord * semiDimensionsInScreenSpace;\n    vec2 pixelCoords   = floor(0.1 + textureCoords * dimensionsInPixels);\n",h="\n\n    gl_FragColor = vec4(pixelColor, 1.0);\n}\n\n";function d(n){const{whenLoaded:i}=n;n=Object.assign({bare:!0},n,{whenLoaded:e=>{n.whenLoaded=i,function(e,n,i){"source"in i&&(e.sourceScreenImage=n);let{widthInPixels:o,heightInPixels:r}=n;e.widthInPixels=o,e.heightInPixels=r,function(e){const t=document.createElement("canvas");t.width=e.widthInPixels,t.height=e.heightInPixels,e.canvas=t}(e),e.image=e.canvas,e.webGLManager=new t({canvas:e.canvas,handleErrorsAndWarnings:i.handleErrorsAndWarnings}),p(e,n),e.batchUpdatePosition=function(t){n.batchUpdatePosition(t),p(e,n),e.update()},e.launchedAt=Date.now(),e.update(i)}(this,e,n)}}),new e(n)}function p(e,t){let{widthInPixels:n,heightInPixels:i,width:a,height:l}=t;r(t,e,{replace:!0}),e.width=a,e.height=l,e.pixelCoordsToCoords=t.pixelCoordsToCoords,e.coordsToPixelCoords=t.coordsToPixelCoords,e.textureCoordsToCoords=function(e){return{x:c.x+e.x*a,y:c.y-e.y*l}},e.coordsToTextureCoords=function(e){return{x:(e.x-c.x)/a,y:(c.y-e.y)/l}},e.textureCoordsToPixelCoords=function(e){return{x:Math.floor(e.x*n),y:Math.floor(e.y*i)}},e.pixelCoordsToTextureCoords=function(e){return{x:e.x/n,y:e.y/i}},s(e);let c=o(e,a,l);c||(c={x:-a/2,y:l/2},e.topLeft=c);const u={time:()=>(Date.now()-e.launchedAt)/1e3,width:a,height:l,centerInScreenSpace:[c.x+a/2,c.y-l/2],semiDimensionsInScreenSpace:[a/2,l/2],widthInPixels:n,heightInPixels:i};e.webGLManager.setData(u)}return d.prototype.update=function(e={}){const{webGLManager:t,sourceScreenImage:n}=this,{data:i,syncFromSource:o=!1}=e;let r;!n||t.storedData.source&&!o||(n.syncFromSource(),t.storedData.source!==n.imageData&&t.setData({source:n.imageData})),i&&t.setData(i),"shader"in e&&(this.shader=e.shader,r=!0),"shaderPrefix"in e&&(this.shaderPrefix=e.shaderPrefix,r=!0),r||!this.shader?function(e,t){const{webGLManager:n,shader:i="",shaderPrefix:o="",sourceScreenImage:r}=e;let s=l,d=u;r?(s+=c,d+="\tvec3 pixelColor = texture2D(source, textureCoords).rgb;\n"):d+="\tvec3 pixelColor = vec3(0.);\n";n.initSource({source:i,prefix:s+a("shaderPrefix")+o+a("prefixForMainFunction")+d,suffix:h,callback:t})}(this,(()=>t.drawScene())):t.drawScene()},d})),define("user_code/webgl_errors_handler",[],(function(){function e({line:e,sourceLine:t,message:n}){return`${`[line ${e}] ${t}`}<br> ${n}`}return function({warnings:t,errors:n}){if(t.forEach((t=>{console.warn(e(t))})),n.length>0){let t;throw t=n.length>1?new Error("Several shader compilation errors !"):new Error("Shader compilation error !"),t.childrenErrors=n.map(e),t}}})),
/*! Toxilib object_utils
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/object_utils",[],(function(){function e(...e){return Object.assign?Object.assign(...e):function(e,...t){t.forEach((t=>{for(let n in t)e[n]=t[n]}))}(...e),e[0]}function t(e,t){let n={};return t.forEach((function(t){t in e&&(n[t]=e[t])})),n}function n(...t){let n={};return e(n,...t),n}function i(e,t){let n,i={};for(n in e)i[n]=e[n];for(n in t)i[n]=o(i,t[n],n);return i}function o(e,t,n){if(n in e)if(Array.isArray(e[n])){if(Array.isArray(t))return function(e,t){let n=e.slice();for(let e=0;e<t.length;e++)-1===n.indexOf(t[e])&&n.push(t[e]);return n}(e[n],t)}else if("object"==typeof e[n]&&"object"==typeof t&&!Array.isArray(t))return i(e[n],t);return t}return{extend:e,merge:e,compose:n,clone:n,deepClone:function e(t,{maxDepth:n=100,handleTooDeep:i,hook:o}={}){if("object"==typeof t){if(n<=0)return i?i(t):"tooDeep";let r={maxDepth:n-1,handleTooDeep:i,hook:o};if(Array.isArray(t)){let n=[];for(let i=0;i<t.length;i++)n.push(e(t[i],r));return o&&o(n),n}{let n={};for(let i in t)n[i]=e(t[i],r);return o&&o(n),n}}return o&&o(t),t},prepareForSerialize:function e(t,{maxDepth:n=100,handleTooDeep:i}={}){if("function"==typeof t)return t.toString();if("object"==typeof t){if(n<=0)return i?i(t):"tooDeep";let o={maxDepth:n-1,handleTooDeep:i};if(Array.isArray(t)){let n=[];for(let i=0;i<t.length;i++)n.push(e(t[i],o));return n}{let n={};return Object.getOwnPropertyNames(t).forEach((i=>{n[i]=e(t[i],o)})),n}}return t},filterKeys:t,filteredExtend:function(n,i,...o){return o.forEach((o=>{let r=t(o,i);e(n,r)})),n},deepMerge:i,isObject:function(e){return e===Object(e)},invoke:function(e,t,...n){for(let i=0;i<e.length;i++){e[i][t](...n)}},orderArray:function(){console.error('"orderArray" removed. Ask Pierre L')},setMethodsWithPrivateArgument:function(e){const{object:t,methods:n,privateMap:i}=e;for(let e in n)t[e]=o(n[e]);function o(e){return function(...t){const n=i.get(this);return e.call(this,n,...t)}}},xmlToJson:function e(t){let n={};if(1===t.nodeType){if(t.attributes.length>0){n["@attributes"]={};for(let e=0;e<t.attributes.length;e++){let i=t.attributes.item(e);n["@attributes"][i.nodeName]=i.nodeValue}}}else 3===t.nodeType&&(n=t.nodeValue);if(t.hasChildNodes())for(let i=0;i<t.childNodes.length;i++){let o=t.childNodes.item(i),{nodeName:r}=o;if(void 0===n[r])n[r]=e(o);else{if(void 0===n[r].push){let e=n[r];n[r]=[],n[r].push(e)}n[r].push(e(o))}}return n}}})),define("toxilibs/extlibs/parse_css",[],(function(){"use strict";var e=function(){this.cssImportStatements=[],this.cssKeyframeStatements=[],this.cssRegex=new RegExp("([\\s\\S]*?){([\\s\\S]*?)}","gi"),this.cssMediaQueryRegex="((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.cssKeyframeRegex="((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.combinedCSSRegex="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",this.cssCommentsRegex="(\\/\\*[\\s\\S]*?\\*\\/)",this.cssImportStatementRegex=new RegExp("@import .*?;","gi")};return e.prototype.stripComments=function(e){var t=new RegExp(this.cssCommentsRegex,"gi");return e.replace(t,"")},e.prototype.parseCSS=function(e){if(void 0===e)return[];for(var t=[];;){var n=this.cssImportStatementRegex.exec(e);if(null===n)break;this.cssImportStatements.push(n[0]),t.push({selector:"@imports",type:"imports",styles:n[0]})}e=e.replace(this.cssImportStatementRegex,"");for(var i,o=new RegExp(this.cssKeyframeRegex,"gi");null!==(i=o.exec(e));)t.push({selector:"@keyframes",type:"keyframes",styles:i[0]});e=e.replace(o,"");for(var r=new RegExp(this.combinedCSSRegex,"gi");null!==(i=r.exec(e));){var s="";s=void 0===i[2]?i[5].split("\r\n").join("\n").trim():i[2].split("\r\n").join("\n").trim();var a=new RegExp(this.cssCommentsRegex,"gi"),l=a.exec(s);if(null!==l&&(s=s.replace(a,"").trim()),-1!==(s=s.replace(/\n+/,"\n")).indexOf("@media")){var c={selector:s,type:"media",subStyles:this.parseCSS(i[3]+"\n}")};null!==l&&(c.comments=l[0]),t.push(c)}else{var u={selector:s,rules:this.parseRules(i[6])};"@font-face"===s&&(u.type="font-face"),null!==l&&(u.comments=l[0]),t.push(u)}}return t},e.prototype.parseRules=function(e){var t=[];e=(e=e.split("\r\n").join("\n")).split(";");for(var n=0;n<e.length;n++){var i=e[n];if(-1!==(i=i.trim()).indexOf(":")){var o=(i=i.split(":"))[0].trim(),r=i.slice(1).join(":").trim();if(o.length<1||r.length<1)continue;t.push({directive:o,value:r})}else"base64,"===i.trim().substr(0,7)?t[t.length-1].value+=i.trim():i.length>0&&t.push({directive:"",value:i,defective:!0})}return t},e.prototype.findCorrespondingRule=function(e,t,n){void 0===n&&(n=!1);for(var i=!1,o=0;o<e.length&&(e[o].directive!==t||(i=e[o],n!==e[o].value));o++);return i},e.prototype.findBySelector=function(e,t,n){void 0===n&&(n=!1);for(var i=[],o=0;o<e.length;o++)!1===n?e[o].selector===t&&i.push(e[o]):-1!==e[o].selector.indexOf(t)&&i.push(e[o]);if("@imports"===t||i.length<2)return i;var r=i[0];for(o=1;o<i.length;o++)this.intelligentCSSPush([r],i[o]);return[r]},e.prototype.deleteBySelector=function(e,t){for(var n=[],i=0;i<e.length;i++)e[i].selector!==t&&n.push(e[i]);return n},e.prototype.compressCSS=function(e){for(var t=[],n={},i=0;i<e.length;i++){var o=e[i];if(!0!==n[o.selector]){var r=this.findBySelector(e,o.selector);0!==r.length&&(t=t.concat(r),n[o.selector]=!0)}}return t},e.prototype.cssDiff=function(e,t){if(e.selector!==t.selector)return!1;if("media"===e.type||"media"===t.type)return!1;for(var n,i,o={selector:e.selector,rules:[]},r=0;r<e.rules.length;r++)n=e.rules[r],(!1===(i=this.findCorrespondingRule(t.rules,n.directive,n.value))||n.value!==i.value)&&o.rules.push(n);for(var s=0;s<t.rules.length;s++)i=t.rules[s],!1===(n=this.findCorrespondingRule(e.rules,i.directive))&&(i.type="DELETED",o.rules.push(i));return 0!==o.rules.length&&o},e.prototype.intelligentMerge=function(e,t,n){void 0===n&&(n=!1);for(var i=0;i<t.length;i++)this.intelligentCSSPush(e,t[i],n);for(i=0;i<e.length;i++){var o=e[i];"media"!==o.type&&"keyframes"!==o.type&&(o.rules=this.compactRules(o.rules))}},e.prototype.intelligentCSSPush=function(e,t,n){var i=t.selector,o=!1;if(void 0===n&&(n=!1),!1===n){for(var r=0;r<e.length;r++)if(e[r].selector===i){o=e[r];break}}else for(var s=e.length-1;s>-1;s--)if(e[s].selector===i){o=e[s];break}if(!1===o)e.push(t);else if("media"!==t.type)for(var a=0;a<t.rules.length;a++){var l=t.rules[a],c=this.findCorrespondingRule(o.rules,l.directive);!1===c?o.rules.push(l):"DELETED"===l.type?c.type="DELETED":c.value=l.value}else o.subStyles=o.subStyles.concat(t.subStyles)},e.prototype.compactRules=function(e){for(var t=[],n=0;n<e.length;n++)"DELETED"!==e[n].type&&t.push(e[n]);return t},e.prototype.getCSSForEditor=function(e,t){void 0===t&&(t=0);var n="";void 0===e&&(e=this.css);for(var i=0;i<e.length;i++)"imports"===e[i].type&&(n+=e[i].styles+"\n\n");for(i=0;i<e.length;i++){var o=e[i];if(void 0!==o.selector){var r="";void 0!==o.comments&&(r=o.comments+"\n"),"media"===o.type?(n+=r+o.selector+"{\n",n+=this.getCSSForEditor(o.subStyles,t+1),n+="}\n\n"):"keyframes"!==o.type&&"imports"!==o.type&&(n+=this.getSpaces(t)+r+o.selector+" {\n",n+=this.getCSSOfRules(o.rules,t+1),n+=this.getSpaces(t)+"}\n\n")}}for(i=0;i<e.length;i++)"keyframes"===e[i].type&&(n+=e[i].styles+"\n\n");return n},e.prototype.getImports=function(e){for(var t=[],n=0;n<e.length;n++)"imports"===e[n].type&&t.push(e[n].styles);return t},e.prototype.getCSSOfRules=function(e,t){for(var n="",i=0;i<e.length;i++)void 0!==e[i]&&(void 0===e[i].defective?n+=this.getSpaces(t)+e[i].directive+": "+e[i].value+";\n":n+=this.getSpaces(t)+e[i].value+";\n");return n||"\n"},e.prototype.getSpaces=function(e){for(var t="",n=0;n<4*e;n++)t+=" ";return t},e.prototype.applyNamespacing=function(e,t){var n=e,i="."+this.cssPreviewNamespace;void 0!==t&&(i=t),"string"==typeof e&&(n=this.parseCSS(e));for(var o=0;o<n.length;o++){var r=n[o];if(!(r.selector.indexOf("@font-face")>-1||r.selector.indexOf("keyframes")>-1||r.selector.indexOf("@import")>-1||r.selector.indexOf(".form-all")>-1||r.selector.indexOf("#stage")>-1))if("media"!==r.type){for(var s=r.selector.split(","),a=[],l=0;l<s.length;l++)-1===s[l].indexOf(".supernova")?a.push(i+" "+s[l]):a.push(s[l]);r.selector=a.join(",")}else r.subStyles=this.applyNamespacing(r.subStyles,t)}return n},e.prototype.clearNamespacing=function(e,t){void 0===t&&(t=!1);var n=e,i="."+this.cssPreviewNamespace;"string"==typeof e&&(n=this.parseCSS(e));for(var o=0;o<n.length;o++){var r=n[o];if("media"!==r.type){for(var s=r.selector.split(","),a=[],l=0;l<s.length;l++)a.push(s[l].split(i+" ").join(""));r.selector=a.join(",")}else r.subStyles=this.clearNamespacing(r.subStyles,!0)}return!1===t?this.getCSSForEditor(n):n},e.prototype.createStyleElement=function(e,t,n){if(void 0===n&&(n=!1),!1===this.testMode&&"nonamespace"!==n&&(t=this.applyNamespacing(t)),"string"!=typeof t&&(t=this.getCSSForEditor(t)),!0===n&&(t=this.getCSSForEditor(this.parseCSS(t))),!1!==this.testMode)return this.testMode("create style #"+e,t);var i=document.getElementById(e);i&&i.parentNode.removeChild(i);var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.id=e,r.type="text/css",o.appendChild(r),r.styleSheet&&!r.sheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))},e})),define("render/add_style",["event_bus","toxilibs/extlibs/parse_css"],(function(e,t){const n=new t;return e.on("camera moved",(e=>{e.rescaleStyles()})),function(e){const t=e.$ui,{directScreen:i}=e.hybridScreen;let o,r,s="",a="";return e.resetStyles=function(){o&&o.remove(),o=window.document.createElement("style"),o.innerHTML="",s="",t[0].appendChild(o)},e.disableStyles=function(){o.innerHTML=""},e.enableStyles=function(){o.innerHTML=a||s},e.rescaleStyles=function(){if(a){const{scale:e}=i;if(e===r)return;r=e,a=i.scaleUSyntax(s),o.innerHTML=a}},e.resetStyles(),function(t){t=function(t){let i="",o=e.uiContainer.parent(".discovery_render").attr("id");return n.parseCSS(t).forEach((e=>{let{selector:t,rules:n,type:r}=e;n&&(i+=t.split(",").map((e=>`#${o}.discovery_render ${e}`)).join(",")+"{\n",n.forEach((({directive:e,value:t})=>{i+="\t"+e+": "+t+";\n"})),i+="}\n"),"keyframes"===r&&(i+=e.styles)})),i}(t),s+=t+"\n";let r=i.scaleUSyntax(t);r!==t&&(a+=r+"\n"),o.innerHTML=a||s}}})),
/*! Toxilib element
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/element",["jquery","./object_utils"],(function(e,t){const{filteredExtend:n}=t,i=new WeakMap,o="<div>";class r{constructor(t){const{root:n,template:r=n||o,setup:s,$container:a,parent:l=a,errorHandler:c,class:u,earlyHook:h}=t,d=e(r);if(d.length>1)throw new Error(`Element must not have more than 1 root element. Root provided : ${r}`);u&&d.addClass(u),this.$element=d,this.version=0,h&&h(this,t),i.set(this,d),this.errorHandler=c,l&&l.append(d),function(e,t){t.data("toxiElement",e),t.on("click",(function(){e.tryWithCatcher(e.whenClicked||e.click)})),t.on("pointerenter",(function(){e.tryWithCatcher(e.whenMouseMovedIn||e.mouseOver)})),t.on("pointerleave",(function(){e.tryWithCatcher(e.whenMouseMovedOut||e.mouseLeave)})),t.on("pointerdown",(function(){e.tryWithCatcher(e.whenMouseButtonPressed)})),t.on("pointerup",(function(){e.tryWithCatcher(e.whenMouseButtonReleased)}))}(this,d),s&&s(this,d,t),this.update(t)}remove(){this.version+=1,this.$element.remove()}clear(){this.version+=1,this.$element.empty()}show(){this.$element.show()}hide(){this.$element.hide()}toggle(){const{$element:e}=this;e.is(":visible")?e.hide():e.show()}isVisible(){return this.$element.is(":visible")}append(e){this.version+=1,e instanceof r&&(e=i.get(e)),this.$element.append(e)}prepend(e){this.version+=1,e instanceof r&&(e=i.get(e)),this.$element.prepend(e)}add(e){this.version+=1,e instanceof r||(e=new r({content:e}));const t=i.get(e);return this.$element.append(t),e}setContent(e){this.version+=1,i.has(e)&&(e=i.get(e)),this.$element.html(e)}update(e){"content"in e?this.setContent(e.content):this.version+=1,e.class&&this.$element.addClass(e.class),e.style&&this.$element.css(e.style),n(this,this.constructor.attributes,e)}addClass(e){this.$element.addClass(e)}removeClass(e){this.$element.removeClass(e)}static permit(e=[]){this.attributes=new Set(this.attributes),e.forEach((e=>this.attributes.add(e)))}tryWithCatcher(e,...t){if(e)try{e(...t)}catch(e){!function(e,t){if(t.toxiTrace=t.toxiTrace||[],t.toxiTrace.unshift("Toxilibs - element.js - handleError"),!e.errorHandler)throw t;e.errorHandler(t)}(this,e)}}}return r.permit(["whenClicked","whenMouseMovedIn","whenMouseMovedOut","whenMouseButtonPressed","whenMouseButtonReleased","whenKeypressed","click","mouseOver","mouseLeave","class"]),r})),
/*! Toxilib element_input
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/element_input",["jquery","./object_utils","./element"],(function(e,t,n){const{clone:i}=t;class o extends n{constructor(e){super(i(e,{setup:r})),Object.defineProperty(this,"value",{get:()=>l(this.$input),set:e=>{a(this.$input,e)},enumerable:!0})}update(e){var t,i;"value"in e&&a(this.$input,e.value),"label"in e&&(t=this.$element,i=e.label,t.find("label").text(i).show()),n.prototype.update.call(this,e)}}function r(t,n,i){const{type:r="text",label:s,choices:a}=i;t.type=r,o.fetchPersistedInputValue(i);const u=(c+=1,`input_${c}`),h=e("<div>");let d,p;d="select"===r?function({choices:t,id:n}){let i="";if(Array.isArray(t))t.forEach((e=>{i+=`<option value="${e}">${e}</option>`}));else for(let e in t)i+=`<option value="${t[e]}">${e}</option>`;return e(`<select id="${n}">${i}</select>`)}({choices:a,id:u}):e("textarea"===r?`<textarea id="${u}">`:`<input type="${r}" id="${u}">`),t.$input=d,p=e(s?`<label for="${u}">${s}</label>`:`<label for="${u}" style="display: none;">`),function(e,t){const{whenKeypressed:n,submitWithEnter:i}=t,{$input:r}=e;e.onChanged&&(e.whenChanged=e.onChanged);(n||i)&&r.keydown((function(t){let{key:o}=t;" "===o&&(o="Space"),n&&e.tryWithCatcher(n,o,t),i&&"Enter"===o&&(e.submit(),t.preventDefault())}));r.on("input propertychange",(function(){let n=l(r);e.tryWithCatcher(e.whenChanged,n),o.setPersistedInputValue(t,n)}))}(t,i),function(e,t){const{whenSubmitted:n}=t,{$input:i}=e;e.submit=function(){let t=l(i);e.tryWithCatcher(n,t),i.val(""),e.tryWithCatcher(e.whenChanged,"")}}(t,i),h.append(d),n.append(p),n.append(h)}function s(e){return e.is('[type="checkbox"]')}function a(e,t){s(e)?e.attr("checked",t):e.val(t)}function l(e){return s(e)?e.is(":checked"):e.val()}o.permit(["onChanged","whenChanged","choices","submitWithEnter"]),o.fetchPersistedInputValue=function(e){const{label:t,persisting:n,storagePrefix:i}=e;if(!n||!i)return;if(!t)throw new Error("Can not persist values if no label is provided");let o=localStorage[`${i}_${t}`];void 0!==o&&(e.value=o)},o.setPersistedInputValue=function(e,t){const{label:n,persisting:i,storagePrefix:o}=e;i&&o&&n&&(localStorage[`${o}_${n}`]=t)};let c=0;return o})),
/*! Toxilib slider
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/slider",["jquery"],(function(e){function t({id:t,defaultValue:n=0,value:i,min:o=0,max:a,step:c=!1,constraintValues:u=!0,ticks:d,slots:p,readOnly:f=!1,showHandle:g=!f&&"auto",label:m,displayValue:y=!0,formatDisplayedValue:v,noProgressBar:b,progressBarColor:x,progressBarInitAt:w=0,delay:_=0,onChanged:S,whenChanged:C=S,onChangedByUser:k,whenChangedByUser:A=k,skipChangeCallbacksOnStart:M}){this.id=t,this.defaultValue=n,this.min=o,this.max=a,this.step=c,this.constraintValues=u,this.progressBarColor=x,this.progressBarInitAt=w,this.label=m,this.formatDisplayedValue=v,M||(this.whenChanged=C,this.whenChangedByUser=A),function(t,{noProgressBar:n,showHandle:i,ticks:o,slots:r,displayValue:s}){const{id:a}=t,c=e("<div>",{class:"discovery_slider",id:a}),u=e("<div>",{class:"discovery_slider_inner"}),d=e("<div>",{class:"discovery_slider_bar"}),p=e("<input>",{type:"hidden"});t.$container=c,t.$inner=u,t.$input=p,t.$bar=d,d.append(p),u.append(d),c.append(u),(n||!0===i)&&c.addClass("discovery_slider_permanent_handle");n||function(t){t.$progressBar=e("<div>",{class:"discovery_slider_progress_bar"}),t.$bar.append(t.$progressBar)}(t);!1!==i&&function(t){t.$handle=e("<div>",{class:"discovery_slider_handle"}),t.$bar.append(t.$handle)}(t);o&&function(t,n){const i=e("<div>",{class:"discovery_slider_ticks"});t.$inner.append(i),n.forEach((e=>l(t,e,{$container:i})))}(t,o);r&&function(t,n){let i;const o=e("<div>",{class:"discovery_slider_slots"});t.$inner.append(o),n.forEach((function(n){let{startValue:r,endValue:s,position:a,noStartTick:c,noEndTick:u}=n;if(!(c||i&&i===a)){let e=l(t,{label:!1,value:r,position:a},{$container:o});o.append(e)}if(!u){let e=l(t,{label:!1,value:s,position:a},{$container:o});o.append(e)}let d=function(t,{label:n,startValue:i,endValue:o}){let r=e(`<div class="discovery_slider_slot_label">${n}</div>`),s=(i+o)/2;return r.css("left",`${h(t,s)}%`),r}(t,n);o.append(d),i=a}))}(t,r);t.label&&function(t){t.$container.addClass("discovery_slider_with_label"),t.$label=e(`<div class="discovery_slider_label">${t.label}</div>`),t.$inner.append(t.$label)}(t);s&&function(t,n){!0===n&&(n=t.label?"facing_label":"right");t.$value=e("<div>",{class:`discovery_slider_value discovery_slider_value_${n}`}),t.$inner.append(t.$value)}(t,s)}(this,{noProgressBar:b,showHandle:g,ticks:d,slots:p,displayValue:y}),f?this.$container.addClass("discovery_slider_read_only"):function(e){let{$inner:t}=e;t.on("mousedown",(t=>{r(e),s(e,t)}))}(this),void 0===i?this.reset({skipEvents:M}):(this.setValue(i),this.initialValue=i),M&&(this.whenChanged=C,this.whenChangedByUser=A),_>0&&this.$container.find(".discovery_slider_progress_bar").css({transition:`width ${_}ms`})}function n(e,t,{skipEvents:n,userChange:r,forceAsync:s}={}){!1!==e.constraintValues&&(t=u(e,t)),e.value!==t&&(e.value=t,e.noDefinedValue=!1,e.$input.val(t),i(e),n||(s?setTimeout((()=>o(e,{userChange:r})),0):o(e,{userChange:r})))}function i(e){!function(e){if(!e.$value)return;let t=e.value;e.formatDisplayedValue&&(t=e.formatDisplayedValue(t));e.$value.text(t)}(e),function(e){if(!e.$handle)return;e.$handle.css({left:`${h(e,e.value)}%`})}(e),function(e){if(!e.$progressBar)return;(function(e){const{$progressBar:t,progressBarInitAt:n,value:i}=e,o=h(e,i),r=h(e,u(e,n));t.css({left:`${Math.min(o,r)}%`,width:`${Math.abs(o-r)}%`})})(e),function(e){let{$progressBar:t,progressBarColor:n,value:i}=e;"function"==typeof n&&(n=n(i));n&&t.css("background",n.toString())}(e)}(e),a(e)}function o(e,{userChange:t}){let{value:n}=e;e.whenChanged&&e.whenChanged(n),e.whenChangedByUser&&t&&e.whenChangedByUser(n)}function r(t){let{$inner:n}=t;function i(e){let{width:i}=n[0].getBoundingClientRect();0!==i&&(e.preventDefault(),s(t,e))}function o(){delete t.isDragging,n.removeClass("discovery_slider_inner_dragging").removeClass("discovery_slider_inner_forced_dragging"),e("body").off("mousemove",i)}t.isDragging=!0,n.addClass("discovery_slider_inner_dragging"),e("body").on("mousemove",i),e("body").one("mouseup",o),n.one("remove",o)}function s(e,t){let i=e.$inner.offset().left,o=function(e,t){let{min:n,max:i,$inner:o}=e,{width:r}=o[0].getBoundingClientRect();return n+t/r*(i-n)}(e,t.clientX-i);n(e,o,{userChange:!0})}function a({noDefinedValue:e,$container:t}){e?t.addClass("no_defined_value"):t.removeClass("no_defined_value")}function l(t,{label:n,value:i},{$container:o}){let r=e('<div class="discovery_slider_tick"></div>');!1!==n&&r.append(`<div>${n||i}</div>`),r.css("left",`${h(t,i)}%`),o.append(r)}t.prototype.setValue=function(e,t){n(this,e,{skipEvents:t})},t.prototype.reset=function({skipEvents:e}={}){n(this,this.defaultValue,{forceAsync:!0,skipEvents:e}),this.noDefinedValue=!0,a(this)},t.prototype.refreshView=function(){i(this)},t.prototype.listenToDrag=function(){this.$inner.addClass("discovery_slider_inner_forced_dragging"),r(this)};const c=1e7;function u(e,t){let{min:n,max:i,step:o}=e;return o&&(t=n+o*Math.round((t-n)/o),t=Math.round(t*c)/c),Math.min(Math.max(t,n),i)}function h({min:e,max:t},n){return 100*(n-e)/(t-e)}return t})),
/*! Toxilib element_slider
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/element_slider",["./object_utils","./element","./element_input","./slider","./number_utils"],(function(e,t,n,i,o){const{filteredExtend:r}=e,{fetchPersistedInputValue:s,setPersistedInputValue:a}=n,{significantDigits:l}=o;function c(e,t,n){const o=function(e){const t=(h+=1,`slider_${h}`),n=r({name:`slider_${t}`},u,e);return n.skipChangeCallbacksOnStart=!0,new i(n)}(n);e.setContent(o.$container),e.slider=o,o.whenChanged(o.value)}const u=["min","max","label","displayValue","value","defaultValue","constraintValues","onChanged","whenChanged","onChangedByUser","whenChangedByUser","progressBarColor","readOnly","showHandle","formatDisplayedValue","step","ticks","delay"];let h=0;return class extends t{constructor(e){"max"in(e=Object.assign({setup:c,min:0},e))||(e.max=function(e){return"value"in e&&e.value>0?2*e.value:e.min+1}(e)),"step"in e||(e.step=function({min:e,max:t,value:n=!1}){let i=Math.abs(t-e),o=i,r=95;if(!1!==n){let t=Math.abs(n-e);0!==t&&(r=Math.max(1,Math.round(100*t/i)-5),o=t)}let s=o/r,a=l(s);for(let e=r+1;e<=r+20;e+=1){let t=o/e;if(i/s<300){let e=l(t);(e===a&&i/t<150||e<a)&&(s=t,a=e)}}return s}(e)),s(e),function(e){const{errorHandler:t,onChanged:n,whenChanged:i=n,onChangedByUser:o,whenChangedByUser:r=o}=e;if(!t)throw new Error("no errorHandler !");e.whenChanged=function(n){if(a(e,n),i)try{i(n)}catch(e){e.toxiTrace=e.toxiTrace||[],e.toxiTrace.unshift("Toxilibs - element_slider.js - whenChanged"),t(e)}},r&&(e.whenChangedByUser=function(e){try{r(e)}catch(e){e.toxiTrace=e.toxiTrace||[],e.toxiTrace.unshift("Toxilibs - element_slider.js - whenChangedByUser"),t(e)}})}(e),super(e),Object.defineProperty(this,"value",{get:()=>this.slider.value,set:e=>{this.slider.setValue(e)},enumerable:!0})}reset(){this.slider.reset()}update(e){let n;"min"in e&&(this.slider.min=e.min,n=!0),"max"in e&&(this.slider.max=e.max,n=!0),"value"in e?this.slider.setValue(e.value):n&&this.slider.refreshView(),t.prototype.update.call(this,e)}}})),function(){var e=function(){return this}();e||"undefined"==typeof window||(e=window);var t=function(e,n,i){"string"==typeof e?(2==arguments.length&&(i=n),t.modules[e]||(t.payloads[e]=i,t.modules[e]=null)):t.original?t.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace())};t.modules={},t.payloads={};var n,i,o=function(e,t,n){if("string"==typeof t){var i=a(e,t);if(null!=i)return n&&n(),i}else if("[object Array]"===Object.prototype.toString.call(t)){for(var o=[],s=0,l=t.length;s<l;++s){var c=a(e,t[s]);if(null==c&&r.original)return;o.push(c)}return n&&n.apply(null,o)||!0}},r=function(e,t){var n=o("",e,t);return null==n&&r.original?r.original.apply(this,arguments):n},s=function(e,t){if(-1!==t.indexOf("!")){var n=t.split("!");return s(e,n[0])+"!"+s(e,n[1])}if("."==t.charAt(0))for(t=e.split("/").slice(0,-1).join("/")+"/"+t;-1!==t.indexOf(".")&&i!=t;){var i=t;t=t.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return t},a=function(e,n){n=s(e,n);var i=t.modules[n];if(!i){if("function"==typeof(i=t.payloads[n])){var r={},a={id:n,uri:"",exports:r,packaged:!0};r=i((function(e,t){return o(n,e,t)}),r,a)||a.exports,t.modules[n]=r,delete t.payloads[n]}i=t.modules[n]=r||i}return i};i=e,(n="ace")&&(e[n]||(e[n]={}),i=e[n]),i.define&&i.define.packaged||(t.original=i.define,i.define=t,i.define.packaged=!0),i.require&&i.require.packaged||(r.original=i.require,i.require=r,i.require.packaged=!0)}(),ace.define("ace/lib/es6-shim",[],(function(e,t,n){function i(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,writable:!0,configurable:!0})}String.prototype.startsWith||i(String.prototype,"startsWith",(function(e,t){return t=t||0,this.lastIndexOf(e,t)===t})),String.prototype.endsWith||i(String.prototype,"endsWith",(function(e,t){var n=this;(void 0===t||t>n.length)&&(t=n.length),t-=e.length;var i=n.indexOf(e,t);return-1!==i&&i===t})),String.prototype.repeat||i(String.prototype,"repeat",(function(e){for(var t="",n=this;e>0;)1&e&&(t+=n),(e>>=1)&&(n+=n);return t})),String.prototype.includes||i(String.prototype,"includes",(function(e,t){return-1!=this.indexOf(e,t)})),Object.assign||(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];null!=i&&Object.keys(i).forEach((function(e){t[e]=i[e]}))}return t}),Object.values||(Object.values=function(e){return Object.keys(e).map((function(t){return e[t]}))}),Array.prototype.find||i(Array.prototype,"find",(function(e){for(var t=this.length,n=arguments[1],i=0;i<t;i++){var o=this[i];if(e.call(n,o,i,this))return o}})),Array.prototype.findIndex||i(Array.prototype,"findIndex",(function(e){for(var t=this.length,n=arguments[1],i=0;i<t;i++){var o=this[i];if(e.call(n,o,i,this))return i}})),Array.prototype.includes||i(Array.prototype,"includes",(function(e,t){return-1!=this.indexOf(e,t)})),Array.prototype.fill||i(Array.prototype,"fill",(function(e){for(var t=this,n=t.length>>>0,i=arguments[1]|0,o=i<0?Math.max(n+i,0):Math.min(i,n),r=arguments[2],s=void 0===r?n:r|0,a=s<0?Math.max(n+s,0):Math.min(s,n);o<a;)t[o]=e,o++;return t})),Array.of||i(Array,"of",(function(){return Array.prototype.slice.call(arguments)}))})),ace.define("ace/lib/fixoldbrowsers",[],(function(e,t,n){e("./es6-shim")})),ace.define("ace/lib/deep_copy",[],(function(e,t,n){t.deepCopy=function e(t){if("object"!=typeof t||!t)return t;var n;if(Array.isArray(t)){n=[];for(var i=0;i<t.length;i++)n[i]=e(t[i]);return n}if("[object Object]"!==Object.prototype.toString.call(t))return t;for(var i in n={},t)n[i]=e(t[i]);return n}})),ace.define("ace/lib/lang",[],(function(e,t,n){"use strict";t.last=function(e){return e[e.length-1]},t.stringReverse=function(e){return e.split("").reverse().join("")},t.stringRepeat=function(e,t){for(var n="";t>0;)1&t&&(n+=e),(t>>=1)&&(e+=e);return n};var i=/^\s\s*/,o=/\s\s*$/;t.stringTrimLeft=function(e){return e.replace(i,"")},t.stringTrimRight=function(e){return e.replace(o,"")},t.copyObject=function(e){var t={};for(var n in e)t[n]=e[n];return t},t.copyArray=function(e){for(var t=[],n=0,i=e.length;n<i;n++)e[n]&&"object"==typeof e[n]?t[n]=this.copyObject(e[n]):t[n]=e[n];return t},t.deepCopy=e("./deep_copy").deepCopy,t.arrayToMap=function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var n in e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return(""+e).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,(function(e){n.push({offset:arguments[arguments.length-2],length:e.length})})),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},i=function(e){return i.cancel(),t=setTimeout(n,e||0),i};return i.schedule=i,i.call=function(){return this.cancel(),e(),i},i.cancel=function(){return clearTimeout(t),t=null,i},i.isPending=function(){return t},i},t.delayedCall=function(e,t){var n=null,i=function(){n=null,e()},o=function(e){null==n&&(n=setTimeout(i,e||t))};return o.delay=function(e){n&&clearTimeout(n),n=setTimeout(i,e||t)},o.schedule=o,o.call=function(){this.cancel(),e()},o.cancel=function(){n&&clearTimeout(n),n=null},o.isPending=function(){return n},o},t.supportsLookbehind=function(){try{new RegExp("(?<=.)")}catch(e){return!1}return!0},t.skipEmptyMatch=function(e,t,n){return n&&e.codePointAt(t)>65535?2:1}})),ace.define("ace/lib/useragent",[],(function(e,t,n){"use strict";t.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},t.getOS=function(){return t.isMac?t.OS.MAC:t.isLinux?t.OS.LINUX:t.OS.WINDOWS};var i="object"==typeof navigator?navigator:{},o=(/mac|win|linux/i.exec(i.platform)||["other"])[0].toLowerCase(),r=i.userAgent||"",s=i.appName||"";t.isWin="win"==o,t.isMac="mac"==o,t.isLinux="linux"==o,t.isIE="Microsoft Internet Explorer"==s||s.indexOf("MSAppHost")>=0?parseFloat((r.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((r.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),t.isOldIE=t.isIE&&t.isIE<9,t.isGecko=t.isMozilla=r.match(/ Gecko\/\d+/),t.isOpera="object"==typeof opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),t.isWebKit=parseFloat(r.split("WebKit/")[1])||void 0,t.isChrome=parseFloat(r.split(" Chrome/")[1])||void 0,t.isSafari=parseFloat(r.split(" Safari/")[1])&&!t.isChrome||void 0,t.isEdge=parseFloat(r.split(" Edge/")[1])||void 0,t.isAIR=r.indexOf("AdobeAIR")>=0,t.isAndroid=r.indexOf("Android")>=0,t.isChromeOS=r.indexOf(" CrOS ")>=0,t.isIOS=/iPad|iPhone|iPod/.test(r)&&!window.MSStream,t.isIOS&&(t.isMac=!0),t.isMobile=t.isIOS||t.isAndroid})),ace.define("ace/lib/dom",[],(function(e,t,n){"use strict";var i,o=e("./useragent");t.buildDom=function e(t,n,i){if("string"==typeof t&&t){var o=document.createTextNode(t);return n&&n.appendChild(o),o}if(!Array.isArray(t))return t&&t.appendChild&&n&&n.appendChild(t),t;if("string"!=typeof t[0]||!t[0]){for(var r=[],s=0;s<t.length;s++){var a=e(t[s],n,i);a&&r.push(a)}return r}var l=document.createElement(t[0]),c=t[1],u=1;c&&"object"==typeof c&&!Array.isArray(c)&&(u=2);for(s=u;s<t.length;s++)e(t[s],l,i);return 2==u&&Object.keys(c).forEach((function(e){var t=c[e];"class"===e?l.className=Array.isArray(t)?t.join(" "):t:"function"==typeof t||"value"==e||"$"==e[0]?l[e]=t:"ref"===e?i&&(i[t]=l):"style"===e?"string"==typeof t&&(l.style.cssText=t):null!=t&&l.setAttribute(e,t)})),n&&n.appendChild(l),l},t.getDocumentHead=function(e){return e||(e=document),e.head||e.getElementsByTagName("head")[0]||e.documentElement},t.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||"http://www.w3.org/1999/xhtml",e):document.createElement(e)},t.removeChildren=function(e){e.innerHTML=""},t.createTextNode=function(e,t){return(t?t.ownerDocument:document).createTextNode(e)},t.createFragment=function(e){return(e?e.ownerDocument:document).createDocumentFragment()},t.hasCssClass=function(e,t){return-1!==(e.className+"").split(/\s+/g).indexOf(t)},t.addCssClass=function(e,n){t.hasCssClass(e,n)||(e.className+=" "+n)},t.removeCssClass=function(e,t){for(var n=e.className.split(/\s+/g);;){var i=n.indexOf(t);if(-1==i)break;n.splice(i,1)}e.className=n.join(" ")},t.toggleCssClass=function(e,t){for(var n=e.className.split(/\s+/g),i=!0;;){var o=n.indexOf(t);if(-1==o)break;i=!1,n.splice(o,1)}return i&&n.push(t),e.className=n.join(" "),i},t.setCssClass=function(e,n,i){i?t.addCssClass(e,n):t.removeCssClass(e,n)},t.hasCssString=function(e,t){var n,i=0;if(n=(t=t||document).querySelectorAll("style"))for(;i<n.length;)if(n[i++].id===e)return!0},t.removeElementById=function(e,t){(t=t||document).getElementById(e)&&t.getElementById(e).remove()};var r=[];function s(){var e=r;r=null,e&&e.forEach((function(e){a(e[0],e[1])}))}function a(e,n,o){if("undefined"!=typeof document){if(r)if(o)s();else if(!1===o)return r.push([e,n]);if(!i){var a=o;o&&o.getRootNode&&(a=o.getRootNode())&&a!=o||(a=document);var l=a.ownerDocument||a;if(n&&t.hasCssString(n,a))return null;n&&(e+="\n/*# sourceURL=ace/css/"+n+" */");var c=t.createElement("style");c.appendChild(l.createTextNode(e)),n&&(c.id=n),a==l&&(a=t.getDocumentHead(l)),a.insertBefore(c,a.firstChild)}}}if(t.useStrictCSP=function(e){i=e,0==e?s():r||(r=[])},t.importCssString=a,t.importCssStylsheet=function(e,n){t.buildDom(["link",{rel:"stylesheet",href:e}],t.getDocumentHead(n))},t.scrollbarWidth=function(e){var n=t.createElement("ace_inner");n.style.width="100%",n.style.minWidth="0px",n.style.height="200px",n.style.display="block";var i=t.createElement("ace_outer"),o=i.style;o.position="absolute",o.left="-10000px",o.overflow="hidden",o.width="200px",o.minWidth="0px",o.height="150px",o.display="block",i.appendChild(n);var r=e&&e.documentElement||document&&document.documentElement;if(!r)return 0;r.appendChild(i);var s=n.offsetWidth;o.overflow="scroll";var a=n.offsetWidth;return s===a&&(a=i.clientWidth),r.removeChild(i),s-a},t.computedStyle=function(e,t){return window.getComputedStyle(e,"")||{}},t.setStyle=function(e,t,n){e[t]!==n&&(e[t]=n)},t.HAS_CSS_ANIMATION=!1,t.HAS_CSS_TRANSFORMS=!1,t.HI_DPI=!o.isWin||"undefined"!=typeof window&&window.devicePixelRatio>=1.5,o.isChromeOS&&(t.HI_DPI=!1),"undefined"!=typeof document){var l=document.createElement("div");t.HI_DPI&&void 0!==l.style.transform&&(t.HAS_CSS_TRANSFORMS=!0),o.isEdge||void 0===l.style.animationName||(t.HAS_CSS_ANIMATION=!0),l=null}t.HAS_CSS_TRANSFORMS?t.translate=function(e,t,n){e.style.transform="translate("+Math.round(t)+"px, "+Math.round(n)+"px)"}:t.translate=function(e,t,n){e.style.top=Math.round(n)+"px",e.style.left=Math.round(t)+"px"}})),ace.define("ace/lib/net",[],(function(e,t,n){
/*
 * based on code from:
 *
 * @license RequireJS text 0.25.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
var i=e("./dom");t.get=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&t(n.responseText)},n.send(null)},t.loadScript=function(e,t){var n=i.getDocumentHead(),o=document.createElement("script");o.src=e,n.appendChild(o),o.onload=o.onreadystatechange=function(e,n){!n&&o.readyState&&"loaded"!=o.readyState&&"complete"!=o.readyState||(o=o.onload=o.onreadystatechange=null,n||t())}},t.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href}})),ace.define("ace/lib/oop",[],(function(e,t,n){"use strict";t.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},t.mixin=function(e,t){for(var n in t)e[n]=t[n];return e},t.implement=function(e,n){t.mixin(e,n)}})),ace.define("ace/lib/event_emitter",[],(function(e,t,n){"use strict";var i={},o=function(){this.propagationStopped=!0},r=function(){this.defaultPrevented=!0};i._emit=i._dispatchEvent=function(e,t){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var n=this._eventRegistry[e]||[],i=this._defaultHandlers[e];if(n.length||i){"object"==typeof t&&t||(t={}),t.type||(t.type=e),t.stopPropagation||(t.stopPropagation=o),t.preventDefault||(t.preventDefault=r),n=n.slice();for(var s=0;s<n.length&&(n[s](t,this),!t.propagationStopped);s++);return i&&!t.defaultPrevented?i(t,this):void 0}},i._signal=function(e,t){var n=(this._eventRegistry||{})[e];if(n){n=n.slice();for(var i=0;i<n.length;i++)n[i](t,this)}},i.once=function(e,t){var n=this;if(this.on(e,(function i(){n.off(e,i),t.apply(null,arguments)})),!t)return new Promise((function(e){t=e}))},i.setDefaultHandler=function(e,t){var n=this._defaultHandlers;if(n||(n=this._defaultHandlers={_disabled_:{}}),n[e]){var i=n[e],o=n._disabled_[e];o||(n._disabled_[e]=o=[]),o.push(i);var r=o.indexOf(t);-1!=r&&o.splice(r,1)}n[e]=t},i.removeDefaultHandler=function(e,t){var n=this._defaultHandlers;if(n){var i=n._disabled_[e];if(n[e]==t)i&&this.setDefaultHandler(e,i.pop());else if(i){var o=i.indexOf(t);-1!=o&&i.splice(o,1)}}},i.on=i.addEventListener=function(e,t,n){this._eventRegistry=this._eventRegistry||{};var i=this._eventRegistry[e];return i||(i=this._eventRegistry[e]=[]),-1==i.indexOf(t)&&i[n?"unshift":"push"](t),t},i.off=i.removeListener=i.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];if(n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}},i.removeAllListeners=function(e){e||(this._eventRegistry=this._defaultHandlers=void 0),this._eventRegistry&&(this._eventRegistry[e]=void 0),this._defaultHandlers&&(this._defaultHandlers[e]=void 0)},t.EventEmitter=i})),ace.define("ace/lib/report_error",[],(function(e,t,n){t.reportError=function(e,t){var n=new Error(e);n.data=t,"object"==typeof console&&console.error&&console.error(n),setTimeout((function(){throw n}))}})),ace.define("ace/lib/app_config",[],(function(e,t,n){var i,o=e("./oop"),r=e("./event_emitter").EventEmitter,s=e("./report_error").reportError,a={setOptions:function(e){Object.keys(e).forEach((function(t){this.setOption(t,e[t])}),this)},getOptions:function(e){var t={};if(e)Array.isArray(e)||(t=e,e=Object.keys(t));else{var n=this.$options;e=Object.keys(n).filter((function(e){return!n[e].hidden}))}return e.forEach((function(e){t[e]=this.getOption(e)}),this),t},setOption:function(e,t){if(this["$"+e]!==t){var n=this.$options[e];if(!n)return l('misspelled option "'+e+'"');if(n.forwardTo)return this[n.forwardTo]&&this[n.forwardTo].setOption(e,t);n.handlesSet||(this["$"+e]=t),n&&n.set&&n.set.call(this,t)}},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:l('misspelled option "'+e+'"')}};function l(e){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}var c=function(){function e(){this.$defaultOptions={}}return e.prototype.defineOptions=function(e,t,n){return e.$options||(this.$defaultOptions[t]=e.$options={}),Object.keys(n).forEach((function(t){var i=n[t];"string"==typeof i&&(i={forwardTo:i}),i.name||(i.name=t),e.$options[i.name]=i,"initialValue"in i&&(e["$"+i.name]=i.initialValue)})),o.implement(e,a),this},e.prototype.resetOptions=function(e){Object.keys(e.$options).forEach((function(t){var n=e.$options[t];"value"in n&&e.setOption(t,n.value)}))},e.prototype.setDefaultValue=function(e,t,n){if(!e){for(e in this.$defaultOptions)if(this.$defaultOptions[e][t])break;if(!this.$defaultOptions[e][t])return!1}var i=this.$defaultOptions[e]||(this.$defaultOptions[e]={});i[t]&&(i.forwardTo?this.setDefaultValue(i.forwardTo,t,n):i[t].value=n)},e.prototype.setDefaultValues=function(e,t){Object.keys(t).forEach((function(n){this.setDefaultValue(e,n,t[n])}),this)},e.prototype.setMessages=function(e){i=e},e.prototype.nls=function(e,t){i&&!i[e]&&l("No message found for '"+e+"' in the provided messages, falling back to default English message.");var n=i&&i[e]||e;return t&&(n=n.replace(/\$(\$|[\d]+)/g,(function(e,n){return"$"==n?"$":t[n]}))),n},e}();c.prototype.warn=l,c.prototype.reportError=s,o.implement(c.prototype,r),t.AppConfig=c})),ace.define("ace/theme/textmate-css",[],(function(e,t,n){n.exports='.ace-tm .ace_gutter {\n  background: #f0f0f0;\n  color: #333;\n}\n\n.ace-tm .ace_print-margin {\n  width: 1px;\n  background: #e8e8e8;\n}\n\n.ace-tm .ace_fold {\n    background-color: #6B72E6;\n}\n\n.ace-tm {\n  background-color: #FFFFFF;\n  color: black;\n}\n\n.ace-tm .ace_cursor {\n  color: black;\n}\n        \n.ace-tm .ace_invisible {\n  color: rgb(191, 191, 191);\n}\n\n.ace-tm .ace_storage,\n.ace-tm .ace_keyword {\n  color: blue;\n}\n\n.ace-tm .ace_constant {\n  color: rgb(197, 6, 11);\n}\n\n.ace-tm .ace_constant.ace_buildin {\n  color: rgb(88, 72, 246);\n}\n\n.ace-tm .ace_constant.ace_language {\n  color: rgb(88, 92, 246);\n}\n\n.ace-tm .ace_constant.ace_library {\n  color: rgb(6, 150, 14);\n}\n\n.ace-tm .ace_invalid {\n  background-color: rgba(255, 0, 0, 0.1);\n  color: red;\n}\n\n.ace-tm .ace_support.ace_function {\n  color: rgb(60, 76, 114);\n}\n\n.ace-tm .ace_support.ace_constant {\n  color: rgb(6, 150, 14);\n}\n\n.ace-tm .ace_support.ace_type,\n.ace-tm .ace_support.ace_class {\n  color: rgb(109, 121, 222);\n}\n\n.ace-tm .ace_keyword.ace_operator {\n  color: rgb(104, 118, 135);\n}\n\n.ace-tm .ace_string {\n  color: rgb(3, 106, 7);\n}\n\n.ace-tm .ace_comment {\n  color: rgb(76, 136, 107);\n}\n\n.ace-tm .ace_comment.ace_doc {\n  color: rgb(0, 102, 255);\n}\n\n.ace-tm .ace_comment.ace_doc.ace_tag {\n  color: rgb(128, 159, 191);\n}\n\n.ace-tm .ace_constant.ace_numeric {\n  color: rgb(0, 0, 205);\n}\n\n.ace-tm .ace_variable {\n  color: rgb(49, 132, 149);\n}\n\n.ace-tm .ace_xml-pe {\n  color: rgb(104, 104, 91);\n}\n\n.ace-tm .ace_entity.ace_name.ace_function {\n  color: #0000A2;\n}\n\n\n.ace-tm .ace_heading {\n  color: rgb(12, 7, 255);\n}\n\n.ace-tm .ace_list {\n  color:rgb(185, 6, 144);\n}\n\n.ace-tm .ace_meta.ace_tag {\n  color:rgb(0, 22, 142);\n}\n\n.ace-tm .ace_string.ace_regex {\n  color: rgb(255, 0, 0)\n}\n\n.ace-tm .ace_marker-layer .ace_selection {\n  background: rgb(181, 213, 255);\n}\n.ace-tm.ace_multiselect .ace_selection.ace_start {\n  box-shadow: 0 0 3px 0px white;\n}\n.ace-tm .ace_marker-layer .ace_step {\n  background: rgb(252, 255, 0);\n}\n\n.ace-tm .ace_marker-layer .ace_stack {\n  background: rgb(164, 229, 101);\n}\n\n.ace-tm .ace_marker-layer .ace_bracket {\n  margin: -1px 0 0 -1px;\n  border: 1px solid rgb(192, 192, 192);\n}\n\n.ace-tm .ace_marker-layer .ace_active-line {\n  background: rgba(0, 0, 0, 0.07);\n}\n\n.ace-tm .ace_gutter-active-line {\n    background-color : #dcdcdc;\n}\n\n.ace-tm .ace_marker-layer .ace_selected-word {\n  background: rgb(250, 250, 255);\n  border: 1px solid rgb(200, 200, 250);\n}\n\n.ace-tm .ace_indent-guide {\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;\n}\n\n.ace-tm .ace_indent-guide-active {\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAZSURBVHjaYvj///9/hivKyv8BAAAA//8DACLqBhbvk+/eAAAAAElFTkSuQmCC") right repeat-y;\n}\n'})),ace.define("ace/theme/textmate",[],(function(e,t,n){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText=e("./textmate-css"),t.$id="ace/theme/textmate",e("../lib/dom").importCssString(t.cssText,t.cssClass,!1)})),ace.define("ace/config",[],(function(e,t,n){var i=e("./lib/lang"),o=e("./lib/net"),r=e("./lib/dom"),s=e("./lib/app_config").AppConfig;n.exports=t=new s;var a={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{},loadWorkerFromBlob:!0,sharedPopups:!1,useStrictCSP:null};t.get=function(e){if(!a.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return a[e]},t.set=function(e,t){if(a.hasOwnProperty(e))a[e]=t;else if(0==this.setDefaultValue("",e,t))throw new Error("Unknown config key: "+e);"useStrictCSP"==e&&r.useStrictCSP(t)},t.all=function(){return i.copyObject(a)},t.$modes={},t.moduleUrl=function(e,t){if(a.$moduleUrls[e])return a.$moduleUrls[e];var n=e.split("/"),i="snippets"==(t=t||n[n.length-2]||"")?"/":"-",o=n[n.length-1];if("worker"==t&&"-"==i){var r=new RegExp("^"+t+"[\\-_]|[\\-_]"+t+"$","g");o=o.replace(r,"")}(!o||o==t)&&n.length>1&&(o=n[n.length-2]);var s=a[t+"Path"];return null==s?s=a.basePath:"/"==i&&(t=i=""),s&&"/"!=s.slice(-1)&&(s+="/"),s+t+i+o+this.get("suffix")},t.setModuleUrl=function(e,t){return a.$moduleUrls[e]=t};var l;t.setLoader=function(e){l=e},t.dynamicModules=Object.create(null),t.$loading={},t.$loaded={},t.loadModule=function(n,i){var r;if(Array.isArray(n))var s=n[0],a=n[1];else if("string"==typeof n)a=n;var u=function(n){if(n&&!t.$loading[a])return i&&i(n);if(t.$loading[a]||(t.$loading[a]=[]),t.$loading[a].push(i),!(t.$loading[a].length>1)){var r=function(){!function(t,n){"ace/theme/textmate"===t||"./theme/textmate"===t?n(null,e("./theme/textmate")):l?l(t,n):console.error("loader is not configured")}(a,(function(e,n){n&&(t.$loaded[a]=n),t._emit("load.module",{name:a,module:n});var i=t.$loading[a];t.$loading[a]=null,i.forEach((function(e){e&&e(n)}))}))};if(!t.get("packaged"))return r();o.loadScript(t.moduleUrl(a,s),r),c()}};if(t.dynamicModules[a])t.dynamicModules[a]().then((function(e){e.default?u(e.default):u(e)}));else{try{r=this.$require(a)}catch(e){}u(r||t.$loaded[a])}},t.$require=function(e){if("function"==typeof n.require){return n.require(e)}},t.setModuleLoader=function(e,n){t.dynamicModules[e]=n};var c=function(){a.basePath||a.workerPath||a.modePath||a.themePath||Object.keys(a.$moduleUrls).length||(console.error("Unable to infer path to ace from script src,","use ace.config.set('basePath', 'path') to enable dynamic loading of modes and themes","or with webpack use ace/webpack-resolver"),c=function(){})};t.version="1.32.6"})),ace.define("ace/loader_build",[],(function(e,t,n){"use strict";e("./lib/fixoldbrowsers");var i=e("./config");i.setLoader((function(t,n){e([t],(function(e){n(null,e)}))}));var o=function(){return this||"undefined"!=typeof window&&window}();function r(t){if(o&&o.document){i.set("packaged",t||e.packaged||n.packaged||o.define&&define.packaged);var r={},s="",a=document.currentScript||document._currentScript,l=a&&a.ownerDocument||document;a&&a.src&&(s=a.src.split(/[?#]/)[0].split("/").slice(0,-1).join("/")||"");for(var c,u=l.getElementsByTagName("script"),h=0;h<u.length;h++){var d=u[h],p=d.src||d.getAttribute("src");if(p){for(var f=d.attributes,g=0,m=f.length;g<m;g++){var y=f[g];0===y.name.indexOf("data-ace-")&&(r[(c=y.name.replace(/^data-ace-/,""),c.replace(/-(.)/g,(function(e,t){return t.toUpperCase()})))]=y.value)}var v=p.match(/^(.*)\/ace([\-.]\w+)?\.js(\?|$)/);v&&(s=v[1])}}for(var b in s&&(r.base=r.base||s,r.packaged=!0),r.basePath=r.base,r.workerPath=r.workerPath||r.base,r.modePath=r.modePath||r.base,r.themePath=r.themePath||r.base,delete r.base,r)void 0!==r[b]&&i.set(b,r[b])}}n.exports=function(t){i.init=r,i.$require=e,t.require=e,"function"==typeof define&&(t.define=define)},r(!0)})),ace.define("ace/range",[],(function(e,t,n){"use strict";var i=function(){function e(e,t,n,i){this.start={row:e,column:t},this.end={row:n,column:i}}return e.prototype.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},e.prototype.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},e.prototype.contains=function(e,t){return 0==this.compare(e,t)},e.prototype.compareRange=function(e){var t,n=e.end,i=e.start;return 1==(t=this.compare(n.row,n.column))?1==(t=this.compare(i.row,i.column))?2:0==t?1:0:-1==t?-2:-1==(t=this.compare(i.row,i.column))?-1:1==t?42:0},e.prototype.comparePoint=function(e){return this.compare(e.row,e.column)},e.prototype.containsRange=function(e){return 0==this.comparePoint(e.start)&&0==this.comparePoint(e.end)},e.prototype.intersects=function(e){var t=this.compareRange(e);return-1==t||0==t||1==t},e.prototype.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},e.prototype.isStart=function(e,t){return this.start.row==e&&this.start.column==t},e.prototype.setStart=function(e,t){"object"==typeof e?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},e.prototype.setEnd=function(e,t){"object"==typeof e?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},e.prototype.inside=function(e,t){return 0==this.compare(e,t)&&(!this.isEnd(e,t)&&!this.isStart(e,t))},e.prototype.insideStart=function(e,t){return 0==this.compare(e,t)&&!this.isEnd(e,t)},e.prototype.insideEnd=function(e,t){return 0==this.compare(e,t)&&!this.isStart(e,t)},e.prototype.compare=function(e,t){return this.isMultiLine()||e!==this.start.row?e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0:t<this.start.column?-1:t>this.end.column?1:0},e.prototype.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},e.prototype.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},e.prototype.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},e.prototype.clipRows=function(t,n){if(this.end.row>n)var i={row:n+1,column:0};else if(this.end.row<t)i={row:t,column:0};if(this.start.row>n)var o={row:n+1,column:0};else if(this.start.row<t)o={row:t,column:0};return e.fromPoints(o||this.start,i||this.end)},e.prototype.extend=function(t,n){var i=this.compare(t,n);if(0==i)return this;if(-1==i)var o={row:t,column:n};else var r={row:t,column:n};return e.fromPoints(o||this.start,r||this.end)},e.prototype.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},e.prototype.isMultiLine=function(){return this.start.row!==this.end.row},e.prototype.clone=function(){return e.fromPoints(this.start,this.end)},e.prototype.collapseRows=function(){return 0==this.end.column?new e(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new e(this.start.row,0,this.end.row,0)},e.prototype.toScreenRange=function(t){var n=t.documentToScreenPosition(this.start),i=t.documentToScreenPosition(this.end);return new e(n.row,n.column,i.row,i.column)},e.prototype.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t},e}();i.fromPoints=function(e,t){return new i(e.row,e.column,t.row,t.column)},i.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},t.Range=i})),ace.define("ace/lib/keys",[],(function(e,t,n){
/*! @license
==========================================================================
SproutCore -- JavaScript Application Framework
copyright 2006-2009, Sprout Systems Inc., Apple Inc. and contributors.

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the "Software"),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.

SproutCore and the SproutCore logo are trademarks of Sprout Systems, Inc.

For more information about SproutCore, visit http://www.sproutcore.com


==========================================================================
@license */
var i=e("./oop"),o=function(){var e,t,n={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta",91:"MetaLeft",92:"MetaRight",93:"ContextMenu"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8,control:1},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}};for(t in n.PRINTABLE_KEYS[173]="-",n.FUNCTION_KEYS)e=n.FUNCTION_KEYS[t].toLowerCase(),n[e]=parseInt(t,10);for(t in n.PRINTABLE_KEYS)e=n.PRINTABLE_KEYS[t].toLowerCase(),n[e]=parseInt(t,10);return i.mixin(n,n.MODIFIER_KEYS),i.mixin(n,n.PRINTABLE_KEYS),i.mixin(n,n.FUNCTION_KEYS),n.enter=n.return,n.escape=n.esc,n.del=n.delete,function(){for(var e=["cmd","ctrl","alt","shift"],t=Math.pow(2,e.length);t--;)n.KEY_MODS[t]=e.filter((function(e){return t&n.KEY_MODS[e]})).join("-")+"-"}(),n.KEY_MODS[0]="",n.KEY_MODS[-1]="input-",n}();i.mixin(t,o),t.default=t,t.keyCodeToString=function(e){var t=o[e];return"string"!=typeof t&&(t=String.fromCharCode(e)),t.toLowerCase()}})),ace.define("ace/lib/event",[],(function(e,t,n){"use strict";var i,o=e("./keys"),r=e("./useragent"),s=null,a=0;function l(){return null==i&&function(){i=!1;try{document.createComment("").addEventListener("test",(function(){}),{get passive(){return i={passive:!1},!0}})}catch(e){}}(),i}function c(e,t,n){this.elem=e,this.type=t,this.callback=n}c.prototype.destroy=function(){h(this.elem,this.type,this.callback),this.elem=this.type=this.callback=void 0};var u=t.addListener=function(e,t,n,i){e.addEventListener(t,n,l()),i&&i.$toDestroy.push(new c(e,t,n))},h=t.removeListener=function(e,t,n){e.removeEventListener(t,n,l())};function d(e){return(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}function p(){s=Object.create(null)}if(t.stopEvent=function(e){return t.stopPropagation(e),t.preventDefault(e),!1},t.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()},t.preventDefault=function(e){e.preventDefault&&e.preventDefault()},t.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||r.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.button},t.capture=function(e,t,n){var i=e&&e.ownerDocument||document;function o(e){t&&t(e),n&&n(e),h(i,"mousemove",t),h(i,"mouseup",o),h(i,"dragstart",o)}return u(i,"mousemove",t),u(i,"mouseup",o),u(i,"dragstart",o),o},t.addMouseWheelListener=function(e,t,n){u(e,"wheel",(function(e){var n=e.deltaX||0,i=e.deltaY||0;switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.15*n,e.wheelY=.15*i;break;case e.DOM_DELTA_LINE:e.wheelX=15*n,e.wheelY=15*i;break;case e.DOM_DELTA_PAGE:e.wheelX=150*n,e.wheelY=150*i}t(e)}),n)},t.addMultiMouseDownListener=function(e,n,i,o,s){var a,l,c,h=0,d={2:"dblclick",3:"tripleclick",4:"quadclick"};function p(e){if(0!==t.getButton(e)?h=0:e.detail>1?++h>4&&(h=1):h=1,r.isIE){var s=Math.abs(e.clientX-a)>5||Math.abs(e.clientY-l)>5;c&&!s||(h=1),c&&clearTimeout(c),c=setTimeout((function(){c=null}),n[h-1]||600),1==h&&(a=e.clientX,l=e.clientY)}if(e._clicks=h,i[o]("mousedown",e),h>4)h=0;else if(h>1)return i[o](d[h],e)}Array.isArray(e)||(e=[e]),e.forEach((function(e){u(e,"mousedown",p,s)}))},t.getModifierString=function(e){return o.KEY_MODS[d(e)]},t.addCommandKeyListener=function(e,n,i){var l=null;u(e,"keydown",(function(e){s[e.keyCode]=(s[e.keyCode]||0)+1;var t=function(e,t,n){var i=d(t);if(!r.isMac&&s){if(t.getModifierState&&(t.getModifierState("OS")||t.getModifierState("Win"))&&(i|=8),s.altGr){if(!(3&~i))return;s.altGr=0}if(18===n||17===n){var l=t.location;17===n&&1===l?1==s[n]&&(a=t.timeStamp):18===n&&3===i&&2===l&&t.timeStamp-a<50&&(s.altGr=!0)}}if(n in o.MODIFIER_KEYS&&(n=-1),i||13!==n||3!==t.location||(e(t,i,-n),!t.defaultPrevented)){if(r.isChromeOS&&8&i){if(e(t,i,n),t.defaultPrevented)return;i&=-9}return!!(i||n in o.FUNCTION_KEYS||n in o.PRINTABLE_KEYS)&&e(t,i,n)}}(n,e,e.keyCode);return l=e.defaultPrevented,t}),i),u(e,"keypress",(function(e){l&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),l=null)}),i),u(e,"keyup",(function(e){s[e.keyCode]=null}),i),s||(p(),u(window,"focus",p))},"object"==typeof window&&window.postMessage&&!r.isOldIE){var f=1;t.nextTick=function(e,n){n=n||window;var i="zero-timeout-message-"+f++,o=function(r){r.data==i&&(t.stopPropagation(r),h(n,"message",o),e())};u(n,"message",o),n.postMessage(i,"*")}}t.$idleBlocked=!1,t.onIdle=function(e,n){return setTimeout((function n(){t.$idleBlocked?setTimeout(n,100):e()}),n)},t.$idleBlockId=null,t.blockIdle=function(e){t.$idleBlockId&&clearTimeout(t.$idleBlockId),t.$idleBlocked=!0,t.$idleBlockId=setTimeout((function(){t.$idleBlocked=!1}),e||100)},t.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}})),ace.define("ace/clipboard",[],(function(e,t,n){"use strict";var i;n.exports={lineMode:!1,pasteCancelled:function(){return!!(i&&i>Date.now()-50)||(i=!1)},cancel:function(){i=Date.now()}}})),ace.define("ace/keyboard/textinput",[],(function(e,t,n){"use strict";var i,o=e("../lib/event"),r=e("../config").nls,s=e("../lib/useragent"),a=e("../lib/dom"),l=e("../lib/lang"),c=e("../clipboard"),u=s.isChrome<18,h=s.isIE,d=s.isChrome>63,p=400,f=e("../lib/keys"),g=f.KEY_MODS,m=s.isIOS,y=m?/\s/:/\n/,v=s.isMobile;i=function(e,t){var n=a.createElement("textarea");n.className="ace_text-input",n.setAttribute("wrap","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false"),n.style.opacity="0",e.insertBefore(n,e.firstChild);var i=!1,b=!1,x=!1,w=!1,_="";v||(n.style.fontSize="1px");var S=!1,C=!1,k="",A=0,M=0,T=0,E=Number.MAX_SAFE_INTEGER,$=Number.MIN_SAFE_INTEGER,L=0;try{var R=document.activeElement===n}catch(e){}this.setNumberOfExtraLines=function(e){E=Number.MAX_SAFE_INTEGER,$=Number.MIN_SAFE_INTEGER,L=e<0?0:e},this.setAriaOptions=function(e){if(e.activeDescendant?(n.setAttribute("aria-haspopup","true"),n.setAttribute("aria-autocomplete",e.inline?"both":"list"),n.setAttribute("aria-activedescendant",e.activeDescendant)):(n.setAttribute("aria-haspopup","false"),n.setAttribute("aria-autocomplete","both"),n.removeAttribute("aria-activedescendant")),e.role&&n.setAttribute("role",e.role),e.setLabel&&(n.setAttribute("aria-roledescription",r("editor")),t.session)){var i=t.session.selection.cursor.row;n.setAttribute("aria-label",r("Cursor at row $0",[i+1]))}},this.setAriaOptions({role:"textbox"}),o.addListener(n,"blur",(function(e){C||(t.onBlur(e),R=!1)}),t),o.addListener(n,"focus",(function(e){if(!C){if(R=!0,s.isEdge)try{if(!document.hasFocus())return}catch(e){}t.onFocus(e),s.isEdge?setTimeout(I):I()}}),t),this.$focusScroll=!1,this.focus=function(){if(this.setAriaOptions({setLabel:t.renderer.enableKeyboardAccessibility}),_||d||"browser"==this.$focusScroll)return n.focus({preventScroll:!0});var e=n.style.top;n.style.position="fixed",n.style.top="0px";try{var i=0!=n.getBoundingClientRect().top}catch(e){return}var o=[];if(i)for(var r=n.parentElement;r&&1==r.nodeType;)o.push(r),r.setAttribute("ace_nocontext","true"),r=!r.parentElement&&r.getRootNode?r.getRootNode().host:r.parentElement;n.focus({preventScroll:!0}),i&&o.forEach((function(e){e.removeAttribute("ace_nocontext")})),setTimeout((function(){n.style.position="","0px"==n.style.top&&(n.style.top=e)}),0)},this.blur=function(){n.blur()},this.isFocused=function(){return R},t.on("beforeEndOperation",(function(){var e=t.curOp,i=e&&e.command&&e.command.name;if("insertstring"!=i){var o=i&&(e.docChanged||e.selectionChanged);x&&o&&(k=n.value="",G()),I()}}));var P=function(e,n){for(var i=n,o=1;o<=e-E&&o<2*L+1;o++)i+=t.session.getLine(e-o).length+1;return i},I=m?function(e){if(R&&(!i||e)&&!w){e||(e="");var o="\n ab"+e+"cde fg\n";o!=n.value&&(n.value=k=o);var r=4+(e.length||(t.selection.isEmpty()?0:1));4==A&&M==r||n.setSelectionRange(4,r),A=4,M=r}}:function(){if(!x&&!w&&(R||D)){x=!0;var e=0,i=0,o="";if(t.session){var r=t.selection,s=r.getRange(),a=r.cursor.row;a===$+1?$=(E=$+1)+2*L:a===E-1?E=($=E-1)-2*L:(a<E-1||a>$+1)&&(E=a>L?a-L:0,$=a>L?a+L:2*L);for(var l=[],c=E;c<=$;c++)l.push(t.session.getLine(c));if(o=l.join("\n"),e=P(s.start.row,s.start.column),i=P(s.end.row,s.end.column),s.start.row<E){var u=t.session.getLine(E-1);e=s.start.row<E-1?0:e,i+=u.length+1,o=u+"\n"+o}else if(s.end.row>$){var h=t.session.getLine($+1);i=s.end.row>$+1?h.length:s.end.column,i+=o.length+1,o=o+"\n"+h}else v&&a>0&&(o="\n"+o,i+=1,e+=1);o.length>p&&(e<p&&i<p?o=o.slice(0,p):(o="\n",e==i?e=i=0:(e=0,i=1)));var d=o+"\n\n";d!=k&&(n.value=k=d,A=M=d.length)}if(D&&(A=n.selectionStart,M=n.selectionEnd),M!=i||A!=e||n.selectionEnd!=M)try{n.setSelectionRange(e,i),A=e,M=i}catch(e){}x=!1}};this.resetSelection=I,R&&t.onFocus();var O=null;this.setInputHandler=function(e){O=e},this.getInputHandler=function(){return O};var D=!1,F=function(e,i){if(D&&(D=!1),b)return I(),e&&t.onPaste(e),b=!1,"";for(var o=n.selectionStart,r=n.selectionEnd,a=A,l=k.length-M,c=e,u=e.length-o,h=e.length-r,d=0;a>0&&k[d]==e[d];)d++,a--;for(c=c.slice(d),d=1;l>0&&k.length-d>A-1&&k[k.length-d]==e[e.length-d];)d++,l--;u-=d-1,h-=d-1;var p=c.length-d+1;if(p<0&&(a=-p,p=0),c=c.slice(0,p),!(i||c||u||a||l||h))return"";w=!0;var f=!1;return s.isAndroid&&". "==c&&(c="  ",f=!0),c&&!a&&!l&&!u&&!h||S?t.onTextInput(c):t.onTextInput(c,{extendLeft:a,extendRight:l,restoreStart:u,restoreEnd:h}),w=!1,k=e,A=o,M=r,T=h,f?"\n":c},N=function(e){if(x)return V();if(e&&e.inputType){if("historyUndo"==e.inputType)return t.execCommand("undo");if("historyRedo"==e.inputType)return t.execCommand("redo")}var i=n.value,o=F(i,!0);(i.length>500||y.test(o)||v&&A<1&&A==M)&&I()},B=function(e,t,n){var i=e.clipboardData||window.clipboardData;if(i&&!u){var o=h||n?"Text":"text/plain";try{return t?!1!==i.setData(o,t):i.getData(o)}catch(e){if(!n)return B(e,t,!0)}}},j=function(e,r){var s=t.getCopyText();if(!s)return o.preventDefault(e);B(e,s)?(m&&(I(s),i=s,setTimeout((function(){i=!1}),10)),r?t.onCut():t.onCopy(),o.preventDefault(e)):(i=!0,n.value=s,n.select(),setTimeout((function(){i=!1,I(),r?t.onCut():t.onCopy()})))},H=function(e){j(e,!0)},W=function(e){j(e,!1)},z=function(e){var i=B(e);c.pasteCancelled()||("string"==typeof i?(i&&t.onPaste(i,e),s.isIE&&setTimeout(I),o.preventDefault(e)):(n.value="",b=!0))};o.addCommandKeyListener(n,(function(e,n,i){if(!x)return t.onCommandKey(e,n,i)}),t),o.addListener(n,"select",(function(e){x||(i?i=!1:!function(e){return 0===e.selectionStart&&e.selectionEnd>=k.length&&e.value===k&&k&&e.selectionEnd!==M}(n)?v&&n.selectionStart!=A&&I():(t.selectAll(),I()))}),t),o.addListener(n,"input",N,t),o.addListener(n,"cut",H,t),o.addListener(n,"copy",W,t),o.addListener(n,"paste",z,t),"oncut"in n&&"oncopy"in n&&"onpaste"in n||o.addListener(e,"keydown",(function(e){if((!s.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:W(e);break;case 86:z(e);break;case 88:H(e)}}),t);var V=function(){if(x&&t.onCompositionUpdate&&!t.$readOnly){if(S)return U();if(x.useTextareaForIME)t.onCompositionUpdate(n.value);else{var e=n.value;F(e),x.markerRange&&(x.context&&(x.markerRange.start.column=x.selectionStart=x.context.compositionStartOffset),x.markerRange.end.column=x.markerRange.start.column+M-x.selectionStart+T)}}},G=function(e){t.onCompositionEnd&&!t.$readOnly&&(x=!1,t.onCompositionEnd(),t.off("mousedown",U),e&&N())};function U(){C=!0,n.blur(),n.focus(),C=!1}var q,K=l.delayedCall(V,50).schedule.bind(null,null);function Y(){clearTimeout(q),q=setTimeout((function(){_&&(n.style.cssText=_,_=""),t.renderer.$isMousePressed=!1,t.renderer.$keepTextAreaAtCursor&&t.renderer.$moveTextAreaToCursor()}),0)}o.addListener(n,"compositionstart",(function(e){if(!x&&t.onCompositionStart&&!t.$readOnly&&(x={},!S)){e.data&&(x.useTextareaForIME=!1),setTimeout(V,0),t._signal("compositionStart"),t.on("mousedown",U);var i=t.getSelectionRange();i.end.row=i.start.row,i.end.column=i.start.column,x.markerRange=i,x.selectionStart=A,t.onCompositionStart(x),x.useTextareaForIME?(k=n.value="",A=0,M=0):(n.msGetInputContext&&(x.context=n.msGetInputContext()),n.getInputContext&&(x.context=n.getInputContext()))}}),t),o.addListener(n,"compositionupdate",V,t),o.addListener(n,"keyup",(function(e){27==e.keyCode&&n.value.length<n.selectionStart&&(x||(k=n.value),A=M=-1,I()),K()}),t),o.addListener(n,"keydown",K,t),o.addListener(n,"compositionend",G,t),this.getElement=function(){return n},this.setCommandMode=function(e){S=e,n.readOnly=!1},this.setReadOnly=function(e){S||(n.readOnly=e)},this.setCopyWithEmptySelection=function(e){},this.onContextMenu=function(e){D=!0,I(),t._emit("nativecontextmenu",{target:t,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,i){_||(_=n.style.cssText),n.style.cssText=(i?"z-index:100000;":"")+(s.isIE?"opacity:0.1;":"")+"text-indent: -"+(A+M)*t.renderer.characterWidth*.5+"px;";var r=t.container.getBoundingClientRect(),l=a.computedStyle(t.container),c=r.top+(parseInt(l.borderTopWidth)||0),u=r.left+(parseInt(r.borderLeftWidth)||0),h=r.bottom-c-n.clientHeight-2,d=function(e){a.translate(n,e.clientX-u-2,Math.min(e.clientY-c-2,h))};d(e),"mousedown"==e.type&&(t.renderer.$isMousePressed=!0,clearTimeout(q),s.isWin&&o.capture(t.container,d,Y))},this.onContextMenuClose=Y;var X=function(e){t.textInput.onContextMenu(e),Y()};o.addListener(n,"mouseup",X,t),o.addListener(n,"mousedown",(function(e){e.preventDefault(),Y()}),t),o.addListener(t.renderer.scroller,"contextmenu",X,t),o.addListener(n,"contextmenu",X,t),m&&function(e,t,n){var o=null,r=!1;n.addEventListener("keydown",(function(e){o&&clearTimeout(o),r=!0}),!0),n.addEventListener("keyup",(function(e){o=setTimeout((function(){r=!1}),100)}),!0);var s=function(e){if(document.activeElement===n&&!(r||x||t.$mouseHandler.isMousePressed||i)){var o=n.selectionStart,s=n.selectionEnd,a=null,l=0;if(0==o?a=f.up:1==o?a=f.home:s>M&&"\n"==k[s]?a=f.end:o<A&&" "==k[o-1]?(a=f.left,l=g.option):o<A||o==A&&M!=A&&o==s?a=f.left:s>M&&k.slice(0,s).split("\n").length>2?a=f.down:s>M&&" "==k[s-1]?(a=f.right,l=g.option):(s>M||s==M&&M!=A&&o==s)&&(a=f.right),o!==s&&(l|=g.shift),a){if(!t.onCommandKey({},l,a)&&t.commands){a=f.keyCodeToString(a);var c=t.commands.findKeyCommand(l,a);c&&t.execCommand(c)}A=o,M=s,I("")}}};document.addEventListener("selectionchange",s),t.on("destroy",(function(){document.removeEventListener("selectionchange",s)}))}(0,t,n),this.destroy=function(){n.parentElement&&n.parentElement.removeChild(n)}},t.TextInput=i,t.$setUserAgentForTests=function(e,t){v=e,m=t}})),ace.define("ace/mouse/default_handlers",[],(function(e,t,n){"use strict";var i=e("../lib/useragent"),o=function(){function e(e){e.$clickSelection=null;var t=e.editor;t.setDefaultHandler("mousedown",this.onMouseDown.bind(e)),t.setDefaultHandler("dblclick",this.onDoubleClick.bind(e)),t.setDefaultHandler("tripleclick",this.onTripleClick.bind(e)),t.setDefaultHandler("quadclick",this.onQuadClick.bind(e)),t.setDefaultHandler("mousewheel",this.onMouseWheel.bind(e));["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach((function(t){e[t]=this[t]}),this),e.selectByLines=this.extendSelectionBy.bind(e,"getLineRange"),e.selectByWords=this.extendSelectionBy.bind(e,"getWordRange")}return e.prototype.onMouseDown=function(e){var t=e.inSelection(),n=e.getDocumentPosition();this.mousedownEvent=e;var o=this.editor,r=e.getButton();return 0!==r?((o.getSelectionRange().isEmpty()||1==r)&&o.selection.moveToPosition(n),void(2==r&&(o.textInput.onContextMenu(e.domEvent),i.isMozilla||e.preventDefault()))):(this.mousedownEvent.time=Date.now(),!t||o.isFocused()||(o.focus(),!this.$focusTimeout||this.$clickSelection||o.inMultiSelectMode)?(this.captureMouse(e),this.startSelect(n,e.domEvent._clicks>1),e.preventDefault()):(this.setState("focusWait"),void this.captureMouse(e)))},e.prototype.startSelect=function(e,t){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var n=this.editor;this.mousedownEvent&&(this.mousedownEvent.getShiftKey()?n.selection.selectToPosition(e):t||n.selection.moveToPosition(e),t||this.select(),n.setStyle("ace_selecting"),this.setState("select"))},e.prototype.select=function(){var e,t=this.editor,n=t.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var i=this.$clickSelection.comparePoint(n);if(-1==i)e=this.$clickSelection.end;else if(1==i)e=this.$clickSelection.start;else{var o=r(this.$clickSelection,n);n=o.cursor,e=o.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(n),t.renderer.scrollCursorIntoView()},e.prototype.extendSelectionBy=function(e){var t,n=this.editor,i=n.renderer.screenToTextCoordinates(this.x,this.y),o=n.selection[e](i.row,i.column);if(this.$clickSelection){var s=this.$clickSelection.comparePoint(o.start),a=this.$clickSelection.comparePoint(o.end);if(-1==s&&a<=0)t=this.$clickSelection.end,o.end.row==i.row&&o.end.column==i.column||(i=o.start);else if(1==a&&s>=0)t=this.$clickSelection.start,o.start.row==i.row&&o.start.column==i.column||(i=o.end);else if(-1==s&&1==a)i=o.end,t=o.start;else{var l=r(this.$clickSelection,i);i=l.cursor,t=l.anchor}n.selection.setSelectionAnchor(t.row,t.column)}n.selection.selectToPosition(i),n.renderer.scrollCursorIntoView()},e.prototype.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting")},e.prototype.focusWait=function(){var e,t,n,i,o=(e=this.mousedownEvent.x,t=this.mousedownEvent.y,n=this.x,i=this.y,Math.sqrt(Math.pow(n-e,2)+Math.pow(i-t,2))),r=Date.now();(o>0||r-this.mousedownEvent.time>this.$focusTimeout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},e.prototype.onDoubleClick=function(e){var t=e.getDocumentPosition(),n=this.editor,i=n.session.getBracketRange(t);i?(i.isEmpty()&&(i.start.column--,i.end.column++),this.setState("select")):(i=n.selection.getWordRange(t.row,t.column),this.setState("selectByWords")),this.$clickSelection=i,this.select()},e.prototype.onTripleClick=function(e){var t=e.getDocumentPosition(),n=this.editor;this.setState("selectByLines");var i=n.getSelectionRange();i.isMultiLine()&&i.contains(t.row,t.column)?(this.$clickSelection=n.selection.getLineRange(i.start.row),this.$clickSelection.end=n.selection.getLineRange(i.end.row).end):this.$clickSelection=n.selection.getLineRange(t.row),this.select()},e.prototype.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},e.prototype.onMouseWheel=function(e){if(!e.getAccelKey()){e.getShiftKey()&&e.wheelY&&!e.wheelX&&(e.wheelX=e.wheelY,e.wheelY=0);var t=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var n=this.$lastScroll,i=e.domEvent.timeStamp,o=i-n.t,r=o?e.wheelX/o:n.vx,s=o?e.wheelY/o:n.vy;o<550&&(r=(r+n.vx)/2,s=(s+n.vy)/2);var a=Math.abs(r/s),l=!1;if(a>=1&&t.renderer.isScrollableBy(e.wheelX*e.speed,0)&&(l=!0),a<=1&&t.renderer.isScrollableBy(0,e.wheelY*e.speed)&&(l=!0),l)n.allowed=i;else if(i-n.allowed<550){Math.abs(r)<=1.5*Math.abs(n.vx)&&Math.abs(s)<=1.5*Math.abs(n.vy)?(l=!0,n.allowed=i):n.allowed=0}return n.t=i,n.vx=r,n.vy=s,l?(t.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()):void 0}},e}();function r(e,t){if(e.start.row==e.end.row)var n=2*t.column-e.start.column-e.end.column;else if(e.start.row!=e.end.row-1||e.start.column||e.end.column)n=2*t.row-e.start.row-e.end.row;else var n=t.column-4;return n<0?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}o.prototype.selectEnd=o.prototype.selectByLinesEnd,o.prototype.selectAllEnd=o.prototype.selectByLinesEnd,o.prototype.selectByWordsEnd=o.prototype.selectByLinesEnd,t.DefaultHandlers=o})),ace.define("ace/lib/scroll",[],(function(e,t,n){t.preventParentScroll=function(e){e.stopPropagation();var t=e.currentTarget;t.scrollHeight>t.clientHeight||e.preventDefault()}})),ace.define("ace/tooltip",[],(function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=e("./lib/dom"),a=(e("./lib/event"),e("./range").Range),l=e("./lib/scroll").preventParentScroll,c="ace_tooltip",u=function(){function e(e){this.isOpen=!1,this.$element=null,this.$parentNode=e}return e.prototype.$init=function(){return this.$element=s.createElement("div"),this.$element.className=c,this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},e.prototype.getElement=function(){return this.$element||this.$init()},e.prototype.setText=function(e){this.getElement().textContent=e},e.prototype.setHtml=function(e){this.getElement().innerHTML=e},e.prototype.setPosition=function(e,t){this.getElement().style.left=e+"px",this.getElement().style.top=t+"px"},e.prototype.setClassName=function(e){s.addCssClass(this.getElement(),e)},e.prototype.setTheme=function(e){this.$element.className=c+" "+(e.isDark?"ace_dark ":"")+(e.cssClass||"")},e.prototype.show=function(e,t,n){null!=e&&this.setText(e),null!=t&&null!=n&&this.setPosition(t,n),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},e.prototype.hide=function(e){this.isOpen&&(this.getElement().style.display="none",this.getElement().className=c,this.isOpen=!1)},e.prototype.getHeight=function(){return this.getElement().offsetHeight},e.prototype.getWidth=function(){return this.getElement().offsetWidth},e.prototype.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)},e}(),h=new(function(){function e(){this.popups=[]}return e.prototype.addPopup=function(e){this.popups.push(e),this.updatePopups()},e.prototype.removePopup=function(e){var t=this.popups.indexOf(e);-1!==t&&(this.popups.splice(t,1),this.updatePopups())},e.prototype.updatePopups=function(){var e,t,n,i;this.popups.sort((function(e,t){return t.priority-e.priority}));var o=[];try{for(var s=r(this.popups),a=s.next();!a.done;a=s.next()){var l=a.value,c=!0;try{for(var u=(n=void 0,r(o)),h=u.next();!h.done;h=u.next()){var d=h.value;if(this.doPopupsOverlap(d,l)){c=!1;break}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}c?o.push(l):l.hide()}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}},e.prototype.doPopupsOverlap=function(e,t){var n=e.getElement().getBoundingClientRect(),i=t.getElement().getBoundingClientRect();return n.left<i.right&&n.right>i.left&&n.top<i.bottom&&n.bottom>i.top},e}());t.popupManager=h,t.Tooltip=u;var d=function(e){function t(t){void 0===t&&(t=document.body);var n=e.call(this,t)||this;n.timeout=void 0,n.lastT=0,n.idleTime=350,n.lastEvent=void 0,n.onMouseOut=n.onMouseOut.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.waitForHover=n.waitForHover.bind(n),n.hide=n.hide.bind(n);var i=n.getElement();return i.style.whiteSpace="pre-wrap",i.style.pointerEvents="auto",i.addEventListener("mouseout",n.onMouseOut),i.tabIndex=-1,i.addEventListener("blur",function(){i.contains(document.activeElement)||this.hide()}.bind(n)),i.addEventListener("wheel",l),n}return o(t,e),t.prototype.addToEditor=function(e){e.on("mousemove",this.onMouseMove),e.on("mousedown",this.hide),e.renderer.getMouseEventTarget().addEventListener("mouseout",this.onMouseOut,!0)},t.prototype.removeFromEditor=function(e){e.off("mousemove",this.onMouseMove),e.off("mousedown",this.hide),e.renderer.getMouseEventTarget().removeEventListener("mouseout",this.onMouseOut,!0),this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t.prototype.onMouseMove=function(e,t){this.lastEvent=e,this.lastT=Date.now();var n=t.$mouseHandler.isMousePressed;if(this.isOpen){var i=this.lastEvent&&this.lastEvent.getDocumentPosition();this.range&&this.range.contains(i.row,i.column)&&!n&&!this.isOutsideOfText(this.lastEvent)||this.hide()}this.timeout||n||(this.lastEvent=e,this.timeout=setTimeout(this.waitForHover,this.idleTime))},t.prototype.waitForHover=function(){this.timeout&&clearTimeout(this.timeout);var e=Date.now()-this.lastT;this.idleTime-e>10?this.timeout=setTimeout(this.waitForHover,this.idleTime-e):(this.timeout=null,this.lastEvent&&!this.isOutsideOfText(this.lastEvent)&&this.$gatherData(this.lastEvent,this.lastEvent.editor))},t.prototype.isOutsideOfText=function(e){var t=e.editor,n=e.getDocumentPosition(),i=t.session.getLine(n.row);if(n.column==i.length){var o=t.renderer.pixelToScreenCoordinates(e.clientX,e.clientY),r=t.session.documentToScreenPosition(n.row,n.column);if(r.column!=o.column||r.row!=o.row)return!0}return!1},t.prototype.setDataProvider=function(e){this.$gatherData=e},t.prototype.showForRange=function(e,t,n,i){if(!(i&&i!=this.lastEvent||this.isOpen&&document.activeElement==this.getElement())){var o=e.renderer;this.isOpen||(h.addPopup(this),this.$registerCloseEvents(),this.setTheme(o.theme)),this.isOpen=!0,this.addMarker(t,e.session),this.range=a.fromPoints(t.start,t.end);var r=o.textToScreenCoordinates(t.start.row,t.start.column),s=o.scroller.getBoundingClientRect();r.pageX<s.left&&(r.pageX=s.left);var l=this.getElement();l.innerHTML="",l.appendChild(n),l.style.maxHeight="",l.style.display="block";var c=l.clientHeight,u=l.clientWidth,d=window.innerHeight-r.pageY-o.lineHeight,p=!0;r.pageY-c<0&&r.pageY<d&&(p=!1),l.style.maxHeight=(p?r.pageY:d)-10+"px",l.style.top=p?"":r.pageY+o.lineHeight+"px",l.style.bottom=p?window.innerHeight-r.pageY+"px":"",l.style.left=Math.min(r.pageX,window.innerWidth-u-10)+"px"}},t.prototype.addMarker=function(e,t){this.marker&&this.$markerSession.removeMarker(this.marker),this.$markerSession=t,this.marker=t&&t.addMarker(e,"ace_highlight-marker","text")},t.prototype.hide=function(e){(e||document.activeElement!=this.getElement())&&(e&&e.target&&("keydown"!=e.type||e.ctrlKey||e.metaKey)&&this.$element.contains(e.target)||(this.lastEvent=null,this.timeout&&clearTimeout(this.timeout),this.timeout=null,this.addMarker(null),this.isOpen&&(this.$removeCloseEvents(),this.getElement().style.display="none",this.isOpen=!1,h.removePopup(this))))},t.prototype.$registerCloseEvents=function(){window.addEventListener("keydown",this.hide,!0),window.addEventListener("wheel",this.hide,!0),window.addEventListener("mousedown",this.hide,!0)},t.prototype.$removeCloseEvents=function(){window.removeEventListener("keydown",this.hide,!0),window.removeEventListener("wheel",this.hide,!0),window.removeEventListener("mousedown",this.hide,!0)},t.prototype.onMouseOut=function(e){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.lastEvent=null,this.isOpen&&e.relatedTarget&&!this.getElement().contains(e.relatedTarget)&&(e&&e.currentTarget.contains(e.relatedTarget)||e.relatedTarget.classList.contains("ace_content")||this.hide())},t}(u);t.HoverTooltip=d})),ace.define("ace/mouse/default_gutter_handler",[],(function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=e("../lib/dom"),a=e("../lib/event"),l=e("../tooltip").Tooltip,c=e("../config").nls;t.GutterHandler=function(e){var t,n,i=e.editor,o=i.renderer.$gutterLayer,r=new u(i);function l(){t&&(t=clearTimeout(t)),r.isOpen&&(r.hideTooltip(),i.off("mousewheel",l))}function c(e){r.setPosition(e.x,e.y)}e.editor.setDefaultHandler("guttermousedown",(function(t){if(i.isFocused()&&0==t.getButton()&&"foldWidgets"!=o.getRegion(t)){var n=t.getDocumentPosition().row,r=i.session.selection;if(t.getShiftKey())r.selectTo(n,0);else{if(2==t.domEvent.detail)return i.selectAll(),t.preventDefault();e.$clickSelection=i.selection.getLineRange(n)}return e.setState("selectByLines"),e.captureMouse(t),t.preventDefault()}})),e.editor.setDefaultHandler("guttermousemove",(function(a){var u=a.domEvent.target||a.domEvent.srcElement;if(s.hasCssClass(u,"ace_fold-widget"))return l();r.isOpen&&e.$tooltipFollowsMouse&&c(a),n=a,t||(t=setTimeout((function(){t=null,n&&!e.isMousePressed?function(){var t=n.getDocumentPosition().row;if(t==i.session.getLength()){var s=i.renderer.pixelToScreenCoordinates(0,n.y).row,a=n.$pos;if(s>i.session.documentToScreenRow(a.row,a.column))return l()}if(r.showTooltip(t),r.isOpen)if(i.on("mousewheel",l),e.$tooltipFollowsMouse)c(n);else{var u=n.getGutterRow(),h=o.$lines.get(u);if(h){var d=h.element.querySelector(".ace_gutter_annotation").getBoundingClientRect(),p=r.getElement().style;p.left=d.right+"px",p.top=d.bottom+"px"}else c(n)}}():l()}),50))})),a.addListener(i.renderer.$gutter,"mouseout",(function(e){n=null,r.isOpen&&!t&&(t=setTimeout((function(){t=null,l()}),50))}),i),i.on("changeSession",l),i.on("input",l)};var u=function(e){function t(t){var n=e.call(this,t.container)||this;return n.editor=t,n}return o(t,e),t.prototype.setPosition=function(e,t){var n=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,o=this.getWidth(),r=this.getHeight();(e+=15)+o>n&&(e-=e+o-n),(t+=15)+r>i&&(t-=20+r),l.prototype.setPosition.call(this,e,t)},Object.defineProperty(t,"annotationLabels",{get:function(){return{error:{singular:c("error"),plural:c("errors")},warning:{singular:c("warning"),plural:c("warnings")},info:{singular:c("information message"),plural:c("information messages")}}},enumerable:!1,configurable:!0}),t.prototype.showTooltip=function(e){var n,i=this.editor.renderer.$gutterLayer,o=i.$annotations[e];n=o?{text:Array.from(o.text),type:Array.from(o.type)}:{text:[],type:[]};var r=i.session.getFoldLine(e);if(r&&i.$showFoldedAnnotations){for(var s,a={error:[],warning:[],info:[]},l=e+1;l<=r.end.row;l++)if(i.$annotations[l])for(var c=0;c<i.$annotations[l].text.length;c++){var u=i.$annotations[l].type[c];a[u].push(i.$annotations[l].text[c]),"error"!==u?"warning"!==u||(s="warning_fold"):s="error_fold"}if("error_fold"===s||"warning_fold"===s){var h="".concat(t.annotationsToSummaryString(a)," in folded code.");n.text.push(h),n.type.push(s)}}if(0===n.text.length)return this.hide();var d={error:[],warning:[],info:[]},p=i.$useSvgGutterIcons?"ace_icon_svg":"ace_icon";for(l=0;l<n.text.length;l++){var f="<span class='ace_".concat(n.type[l]," ").concat(p,"' aria-label='").concat(t.annotationLabels[n.type[l].replace("_fold","")].singular,"' role=img> </span> ").concat(n.text[l]);d[n.type[l].replace("_fold","")].push(f)}var g=[].concat(d.error,d.warning,d.info).join("<br>");this.setHtml(g),this.$element.setAttribute("aria-live","polite"),this.isOpen||(this.setTheme(this.editor.renderer.theme),this.setClassName("ace_gutter-tooltip")),this.show(),this.editor._signal("showGutterTooltip",this)},t.prototype.hideTooltip=function(){this.$element.removeAttribute("aria-live"),this.hide(),this.editor._signal("hideGutterTooltip",this)},t.annotationsToSummaryString=function(e){var n,i,o=[];try{for(var s=r(["error","warning","info"]),a=s.next();!a.done;a=s.next()){var l=a.value;if(e[l].length){var c=1===e[l].length?t.annotationLabels[l].singular:t.annotationLabels[l].plural;o.push("".concat(e[l].length," ").concat(c))}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o.join(", ")},t}(l);t.GutterTooltip=u})),ace.define("ace/mouse/mouse_event",[],(function(e,t,n){"use strict";var i=e("../lib/event"),o=e("../lib/useragent"),r=function(){function e(e,t){this.speed,this.wheelX,this.wheelY,this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1}return e.prototype.stopPropagation=function(){i.stopPropagation(this.domEvent),this.propagationStopped=!0},e.prototype.preventDefault=function(){i.preventDefault(this.domEvent),this.defaultPrevented=!0},e.prototype.stop=function(){this.stopPropagation(),this.preventDefault()},e.prototype.getDocumentPosition=function(){return this.$pos||(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY)),this.$pos},e.prototype.getGutterRow=function(){var e=this.getDocumentPosition().row;return this.editor.session.documentToScreenRow(e,0)-this.editor.session.documentToScreenRow(this.editor.renderer.$gutterLayer.$lines.get(0).row,0)},e.prototype.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var e=this.editor.getSelectionRange();if(e.isEmpty())this.$inSelection=!1;else{var t=this.getDocumentPosition();this.$inSelection=e.contains(t.row,t.column)}return this.$inSelection},e.prototype.getButton=function(){return i.getButton(this.domEvent)},e.prototype.getShiftKey=function(){return this.domEvent.shiftKey},e.prototype.getAccelKey=function(){return o.isMac?this.domEvent.metaKey:this.domEvent.ctrlKey},e}();t.MouseEvent=r})),ace.define("ace/mouse/dragdrop_handler",[],(function(e,t,n){"use strict";var i=e("../lib/dom"),o=e("../lib/event"),r=e("../lib/useragent");function s(e){var t=e.editor,n=i.createElement("div");n.style.cssText="top:-100px;position:absolute;z-index:2147483647;opacity:0.5",n.textContent=" ";["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach((function(t){e[t]=this[t]}),this),t.on("mousedown",this.onMouseDown.bind(e));var s,l,c,u,h,d,p,f,g,m,y,v=t.container,b=0;function x(){var e=d;(function(e,n){var i=Date.now(),o=!n||e.row!=n.row,r=!n||e.column!=n.column;!m||o||r?(t.moveCursorToPosition(e),m=i,y={x:l,y:c}):a(y.x,y.y,l,c)>5?m=null:i-m>=200&&(t.renderer.scrollCursorIntoView(),m=null)})(d=t.renderer.screenToTextCoordinates(l,c),e),function(e,n){var i=Date.now(),o=t.renderer.layerConfig.lineHeight,r=t.renderer.layerConfig.characterWidth,s=t.renderer.scroller.getBoundingClientRect(),a={x:{left:l-s.left,right:s.right-l},y:{top:c-s.top,bottom:s.bottom-c}},u=Math.min(a.x.left,a.x.right),h=Math.min(a.y.top,a.y.bottom),d={row:e.row,column:e.column};u/r<=2&&(d.column+=a.x.left<a.x.right?-3:2),h/o<=1&&(d.row+=a.y.top<a.y.bottom?-1:1);var p=e.row!=d.row,f=e.column!=d.column,m=!n||e.row!=n.row;p||f&&!m?g?i-g>=200&&t.renderer.scrollCursorIntoView(d):g=i:g=null}(d,e)}function w(){h=t.selection.toOrientedRange(),s=t.session.addMarker(h,"ace_selection",t.getSelectionStyle()),t.clearSelection(),t.isFocused()&&t.renderer.$cursorLayer.setBlinking(!1),clearInterval(u),x(),u=setInterval(x,20),b=0,o.addListener(document,"mousemove",C)}function _(){clearInterval(u),t.session.removeMarker(s),s=null,t.selection.fromOrientedRange(h),t.isFocused()&&!f&&t.$resetCursorStyle(),h=null,d=null,b=0,g=null,m=null,o.removeListener(document,"mousemove",C)}this.onDragStart=function(e){if(this.cancelDrag||!v.draggable){var i=this;return setTimeout((function(){i.startSelect(),i.captureMouse(e)}),0),e.preventDefault()}h=t.getSelectionRange();var o=e.dataTransfer;o.effectAllowed=t.getReadOnly()?"copy":"copyMove",t.container.appendChild(n),o.setDragImage&&o.setDragImage(n,0,0),setTimeout((function(){t.container.removeChild(n)})),o.clearData(),o.setData("Text",t.session.getTextRange()),f=!0,this.setState("drag")},this.onDragEnd=function(e){if(v.draggable=!1,f=!1,this.setState(null),!t.getReadOnly()){var n=e.dataTransfer.dropEffect;p||"move"!=n||t.session.remove(t.getSelectionRange()),t.$resetCursorStyle()}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(!t.getReadOnly()&&k(e.dataTransfer))return l=e.clientX,c=e.clientY,s||w(),b++,e.dataTransfer.dropEffect=p=A(e),o.preventDefault(e)},this.onDragOver=function(e){if(!t.getReadOnly()&&k(e.dataTransfer))return l=e.clientX,c=e.clientY,s||(w(),b++),null!==S&&(S=null),e.dataTransfer.dropEffect=p=A(e),o.preventDefault(e)},this.onDragLeave=function(e){if(--b<=0&&s)return _(),p=null,o.preventDefault(e)},this.onDrop=function(e){if(d){var n=e.dataTransfer;if(f)switch(p){case"move":h=h.contains(d.row,d.column)?{start:d,end:d}:t.moveText(h,d);break;case"copy":h=t.moveText(h,d,!0)}else{var i=n.getData("Text");h={start:d,end:t.session.insert(d,i)},t.focus(),p=null}return _(),o.preventDefault(e)}},o.addListener(v,"dragstart",this.onDragStart.bind(e),t),o.addListener(v,"dragend",this.onDragEnd.bind(e),t),o.addListener(v,"dragenter",this.onDragEnter.bind(e),t),o.addListener(v,"dragover",this.onDragOver.bind(e),t),o.addListener(v,"dragleave",this.onDragLeave.bind(e),t),o.addListener(v,"drop",this.onDrop.bind(e),t);var S=null;function C(){null==S&&(S=setTimeout((function(){null!=S&&s&&_()}),20))}function k(e){var t=e.types;return!t||Array.prototype.some.call(t,(function(e){return"text/plain"==e||"Text"==e}))}function A(e){var t=["copy","copymove","all","uninitialized"],n=r.isMac?e.altKey:e.ctrlKey,i="uninitialized";try{i=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var o="none";return n&&t.indexOf(i)>=0?o="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(i)>=0?o="move":t.indexOf(i)>=0&&(o="copy"),o}}function a(e,t,n,i){return Math.sqrt(Math.pow(n-e,2)+Math.pow(i-t,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.$resetCursorStyle(),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var e=this.editor;e.container.draggable=!0,e.renderer.$cursorLayer.setBlinking(!1),e.setStyle("ace_dragging");var t=r.isWin?"default":"move";e.renderer.setCursorStyle(t),this.setState("dragReady")},this.onMouseDrag=function(e){var t=this.editor.container;r.isIE&&"dragReady"==this.state&&(a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>3&&t.dragDrop());"dragWait"===this.state&&(a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>0&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition())))},this.onMouseDown=function(e){if(this.$dragEnabled){this.mousedownEvent=e;var t=this.editor,n=e.inSelection(),i=e.getButton();if(1===(e.domEvent.detail||1)&&0===i&&n){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var o=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in o&&(o.unselectable="on"),t.getDragDelay()){if(r.isWebKit)this.cancelDrag=!0,t.container.draggable=!0;this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}}).call(s.prototype),t.DragdropHandler=s})),ace.define("ace/mouse/touch_handler",[],(function(e,t,n){"use strict";var i=e("./mouse_event").MouseEvent,o=e("../lib/event"),r=e("../lib/dom");t.addTouchListeners=function(e,t){var n,s,a,l,c,u,h,d,p,f="scroll",g=0,m=0,y=0,v=0;function b(){var e=window.navigator&&window.navigator.clipboard,n=!1,i=function(i){var o,s,a=i.target.getAttribute("action");if("more"==a||!n)return n=!n,o=t.getCopyText(),s=t.session.getUndoManager().hasUndo(),void p.replaceChild(r.buildDom(n?["span",!o&&["span",{class:"ace_mobile-button",action:"selectall"},"Select All"],o&&["span",{class:"ace_mobile-button",action:"copy"},"Copy"],o&&["span",{class:"ace_mobile-button",action:"cut"},"Cut"],e&&["span",{class:"ace_mobile-button",action:"paste"},"Paste"],s&&["span",{class:"ace_mobile-button",action:"undo"},"Undo"],["span",{class:"ace_mobile-button",action:"find"},"Find"],["span",{class:"ace_mobile-button",action:"openCommandPalette"},"Palette"]]:["span"]),p.firstChild);"paste"==a?e.readText().then((function(e){t.execCommand(a,e)})):a&&("cut"!=a&&"copy"!=a||(e?e.writeText(t.getCopyText()):document.execCommand("copy")),t.execCommand(a)),p.firstChild.style.display="none",n=!1,"openCommandPalette"!=a&&t.focus()};p=r.buildDom(["div",{class:"ace_mobile-menu",ontouchstart:function(e){f="menu",e.stopPropagation(),e.preventDefault(),t.textInput.focus()},ontouchend:function(e){e.stopPropagation(),e.preventDefault(),i(e)},onclick:i},["span"],["span",{class:"ace_mobile-button",action:"more"},"..."]],t.container)}function x(){p||b();var e=t.selection.cursor,n=t.renderer.textToScreenCoordinates(e.row,e.column),i=t.renderer.textToScreenCoordinates(0,0).pageX,o=t.renderer.scrollLeft,r=t.container.getBoundingClientRect();p.style.top=n.pageY-r.top-3+"px",n.pageX-r.left<r.width-70?(p.style.left="",p.style.right="10px"):(p.style.right="",p.style.left=i+o-r.left+"px"),p.style.display="",p.firstChild.style.display="none",t.on("input",w)}function w(e){p&&(p.style.display="none"),t.off("input",w)}function _(){c=null,clearTimeout(c);var e=t.selection.getRange(),n=e.contains(h.row,h.column);!e.isEmpty()&&n||(t.selection.moveToPosition(h),t.selection.selectWord()),f="wait",x()}o.addListener(e,"contextmenu",(function(e){d&&t.textInput.getElement().focus()}),t),o.addListener(e,"touchstart",(function(e){var o=e.touches;if(c||o.length>1)return clearTimeout(c),c=null,a=-1,void(f="zoom");d=t.$mouseHandler.isMousePressed=!0;var r=t.renderer.layerConfig.lineHeight,u=t.renderer.layerConfig.lineHeight,p=e.timeStamp;l=p;var b=o[0],x=b.clientX,w=b.clientY;Math.abs(n-x)+Math.abs(s-w)>r&&(a=-1),n=e.clientX=x,s=e.clientY=w,y=v=0;var S=new i(e,t);if(h=S.getDocumentPosition(),p-a<500&&1==o.length&&!g)m++,e.preventDefault(),e.button=0,function(){c=null,clearTimeout(c),t.selection.moveToPosition(h);var e=m>=2?t.selection.getLineRange(h.row):t.session.getBracketRange(h);e&&!e.isEmpty()?t.selection.setRange(e):t.selection.selectWord(),f="wait"}();else{m=0;var C=t.selection.cursor,k=t.selection.isEmpty()?C:t.selection.anchor,A=t.renderer.$cursorLayer.getPixelPosition(C,!0),M=t.renderer.$cursorLayer.getPixelPosition(k,!0),T=t.renderer.scroller.getBoundingClientRect(),E=t.renderer.layerConfig.offset,$=t.renderer.scrollLeft,L=function(e,t){return(e/=u)*e+(t=t/r-.75)*t};if(e.clientX<T.left)return void(f="zoom");var R=L(e.clientX-T.left-A.left+$,e.clientY-T.top-A.top+E),P=L(e.clientX-T.left-M.left+$,e.clientY-T.top-M.top+E);R<3.5&&P<3.5&&(f=R>P?"cursor":"anchor"),f=P<3.5?"anchor":R<3.5?"cursor":"scroll",c=setTimeout(_,450)}a=p}),t),o.addListener(e,"touchend",(function(e){d=t.$mouseHandler.isMousePressed=!1,u&&clearInterval(u),"zoom"==f?(f="",g=0):c?(t.selection.moveToPosition(h),g=0,x()):"scroll"==f?(g+=60,u=setInterval((function(){g--<=0&&(clearInterval(u),u=null),Math.abs(y)<.01&&(y=0),Math.abs(v)<.01&&(v=0),g<20&&(y*=.9),g<20&&(v*=.9);var e=t.session.getScrollTop();t.renderer.scrollBy(10*y,10*v),e==t.session.getScrollTop()&&(g=0)}),10),w()):x(),clearTimeout(c),c=null}),t),o.addListener(e,"touchmove",(function(e){c&&(clearTimeout(c),c=null);var o=e.touches;if(!(o.length>1||"zoom"==f)){var r=o[0],a=n-r.clientX,u=s-r.clientY;if("wait"==f){if(!(a*a+u*u>4))return e.preventDefault();f="cursor"}n=r.clientX,s=r.clientY,e.clientX=r.clientX,e.clientY=r.clientY;var h=e.timeStamp,d=h-l;if(l=h,"scroll"==f){var p=new i(e,t);p.speed=1,p.wheelX=a,p.wheelY=u,10*Math.abs(a)<Math.abs(u)&&(a=0),10*Math.abs(u)<Math.abs(a)&&(u=0),0!=d&&(y=a/d,v=u/d),t._emit("mousewheel",p),p.propagationStopped||(y=v=0)}else{var g=new i(e,t).getDocumentPosition();"cursor"==f?t.selection.moveCursorToPosition(g):"anchor"==f&&t.selection.setSelectionAnchor(g.row,g.column),t.renderer.scrollCursorIntoView(g),e.preventDefault()}}}),t)}})),ace.define("ace/mouse/mouse_handler",[],(function(e,t,n){"use strict";var i=e("../lib/event"),o=e("../lib/useragent"),r=e("./default_handlers").DefaultHandlers,s=e("./default_gutter_handler").GutterHandler,a=e("./mouse_event").MouseEvent,l=e("./dragdrop_handler").DragdropHandler,c=e("./touch_handler").addTouchListeners,u=e("../config"),h=function(){function e(e){this.$dragDelay,this.$dragEnabled,this.$mouseMoved,this.mouseEvent,this.$focusTimeout;var t=this;this.editor=e,new r(this),new s(this),new l(this);var n=function(t){(!document.hasFocus||!document.hasFocus()||!e.isFocused()&&document.activeElement==(e.textInput&&e.textInput.getElement()))&&window.focus(),e.focus(),setTimeout((function(){e.isFocused()||e.focus()}))},a=e.renderer.getMouseEventTarget();i.addListener(a,"click",this.onMouseEvent.bind(this,"click"),e),i.addListener(a,"mousemove",this.onMouseMove.bind(this,"mousemove"),e),i.addMultiMouseDownListener([a,e.renderer.scrollBarV&&e.renderer.scrollBarV.inner,e.renderer.scrollBarH&&e.renderer.scrollBarH.inner,e.textInput&&e.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent",e),i.addMouseWheelListener(e.container,this.onMouseWheel.bind(this,"mousewheel"),e),c(e.container,e);var u=e.renderer.$gutter;i.addListener(u,"mousedown",this.onMouseEvent.bind(this,"guttermousedown"),e),i.addListener(u,"click",this.onMouseEvent.bind(this,"gutterclick"),e),i.addListener(u,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick"),e),i.addListener(u,"mousemove",this.onMouseEvent.bind(this,"guttermousemove"),e),i.addListener(a,"mousedown",n,e),i.addListener(u,"mousedown",n,e),o.isIE&&e.renderer.scrollBarV&&(i.addListener(e.renderer.scrollBarV.element,"mousedown",n,e),i.addListener(e.renderer.scrollBarH.element,"mousedown",n,e)),e.on("mousemove",(function(n){if(!t.state&&!t.$dragDelay&&t.$dragEnabled){var i=e.renderer.screenToTextCoordinates(n.x,n.y),o=e.session.selection.getRange(),r=e.renderer;!o.isEmpty()&&o.insideStart(i.row,i.column)?r.setCursorStyle("default"):r.setCursorStyle("")}}),e)}return e.prototype.onMouseEvent=function(e,t){this.editor.session&&this.editor._emit(e,new a(t,this.editor))},e.prototype.onMouseMove=function(e,t){var n=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;n&&n.length&&this.editor._emit(e,new a(t,this.editor))},e.prototype.onMouseWheel=function(e,t){var n=new a(t,this.editor);n.speed=2*this.$scrollSpeed,n.wheelX=t.wheelX,n.wheelY=t.wheelY,this.editor._emit(e,n)},e.prototype.setState=function(e){this.state=e},e.prototype.captureMouse=function(e,t){this.x=e.x,this.y=e.y,this.isMousePressed=!0;var n=this.editor,r=this.editor.renderer;r.$isMousePressed=!0;var s=this,l=function(e){if(e){if(o.isWebKit&&!e.which&&s.releaseMouse)return s.releaseMouse();s.x=e.clientX,s.y=e.clientY,t&&t(e),s.mouseEvent=new a(e,s.editor),s.$mouseMoved=!0}},c=function(e){n.off("beforeEndOperation",h),clearInterval(d),n.session&&u(),s[s.state+"End"]&&s[s.state+"End"](e),s.state="",s.isMousePressed=r.$isMousePressed=!1,r.$keepTextAreaAtCursor&&r.$moveTextAreaToCursor(),s.$onCaptureMouseMove=s.releaseMouse=null,e&&s.onMouseEvent("mouseup",e),n.endOperation()},u=function(){s[s.state]&&s[s.state](),s.$mouseMoved=!1};if(o.isOldIE&&"dblclick"==e.domEvent.type)return setTimeout((function(){c(e)}));var h=function(e){s.releaseMouse&&n.curOp.command.name&&n.curOp.selectionChanged&&(s[s.state+"End"]&&s[s.state+"End"](),s.state="",s.releaseMouse())};n.on("beforeEndOperation",h),n.startOperation({command:{name:"mouse"}}),s.$onCaptureMouseMove=l,s.releaseMouse=i.capture(this.editor.container,l,c);var d=setInterval(u,20)},e.prototype.cancelContextMenu=function(){var e=function(t){t&&t.domEvent&&"contextmenu"!=t.domEvent.type||(this.editor.off("nativecontextmenu",e),t&&t.domEvent&&i.stopEvent(t.domEvent))}.bind(this);setTimeout(e,10),this.editor.on("nativecontextmenu",e)},e.prototype.destroy=function(){this.releaseMouse&&this.releaseMouse()},e}();h.prototype.releaseMouse=null,u.defineOptions(h.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:o.isMac?150:0},dragEnabled:{initialValue:!0},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),t.MouseHandler=h})),ace.define("ace/mouse/fold_handler",[],(function(e,t,n){"use strict";var i=e("../lib/dom"),o=function(e){e.on("click",(function(t){var n=t.getDocumentPosition(),o=e.session,r=o.getFoldAt(n.row,n.column,1);r&&(t.getAccelKey()?o.removeFold(r):o.expandFold(r),t.stop());var s=t.domEvent&&t.domEvent.target;s&&i.hasCssClass(s,"ace_inline_button")&&i.hasCssClass(s,"ace_toggle_wrap")&&(o.setOption("wrap",!o.getUseWrapMode()),e.renderer.scrollCursorIntoView())})),e.on("gutterclick",(function(t){if("foldWidgets"==e.renderer.$gutterLayer.getRegion(t)){var n=t.getDocumentPosition().row,i=e.session;i.foldWidgets&&i.foldWidgets[n]&&e.session.onFoldWidgetClick(n,t),e.isFocused()||e.focus(),t.stop()}})),e.on("gutterdblclick",(function(t){if("foldWidgets"==e.renderer.$gutterLayer.getRegion(t)){var n=t.getDocumentPosition().row,i=e.session,o=i.getParentFoldRangeData(n,!0),r=o.range||o.firstRange;if(r){n=r.start.row;var s=i.getFoldAt(n,i.getLine(n).length,1);s?i.removeFold(s):(i.addFold("...",r),e.renderer.scrollCursorIntoView({row:r.start.row,column:0}))}t.stop()}}))};t.FoldHandler=o})),ace.define("ace/keyboard/keybinding",[],(function(e,t,n){"use strict";var i=e("../lib/keys"),o=e("../lib/event"),r=function(){function e(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)}return e.prototype.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},e.prototype.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]!=e){for(;t[t.length-1]&&t[t.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)}},e.prototype.addKeyboardHandler=function(e,t){if(e){"function"!=typeof e||e.handleKeyboard||(e.handleKeyboard=e);var n=this.$handlers.indexOf(e);-1!=n&&this.$handlers.splice(n,1),null==t?this.$handlers.push(e):this.$handlers.splice(t,0,e),-1==n&&e.attach&&e.attach(this.$editor)}},e.prototype.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return-1!=t&&(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},e.prototype.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},e.prototype.getStatusText=function(){var e=this.$data,t=e.editor;return this.$handlers.map((function(n){return n.getStatusText&&n.getStatusText(t,e)||""})).filter(Boolean).join(" ")},e.prototype.$callKeyboardHandlers=function(e,t,n,i){for(var r,s=!1,a=this.$editor.commands,l=this.$handlers.length;l--&&!((r=this.$handlers[l].handleKeyboard(this.$data,e,t,n,i))&&r.command&&((s="null"==r.command||a.exec(r.command,this.$editor,r.args,i))&&i&&-1!=e&&1!=r.passEvent&&1!=r.command.passEvent&&o.stopEvent(i),s)););return s||-1!=e||(r={command:"insertstring"},s=a.exec("insertstring",this.$editor,t)),s&&this.$editor._signal&&this.$editor._signal("keyboardActivity",r),s},e.prototype.onCommandKey=function(e,t,n){var o=i.keyCodeToString(n);return this.$callKeyboardHandlers(t,o,n,e)},e.prototype.onTextInput=function(e){return this.$callKeyboardHandlers(-1,e)},e}();t.KeyBinding=r})),ace.define("ace/lib/bidiutil",[],(function(e,t,n){"use strict";var i=0,o=0,r=!1,s=!1,a=!1,l=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],c=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],u=11,h=18,d=[h,h,h,h,h,h,h,h,h,6,5,6,8,5,h,h,h,h,h,h,h,h,h,h,h,h,h,h,5,5,5,6,8,4,4,u,u,u,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,h,h,h,h,h,h,5,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,9,4,u,u,u,u,4,4,4,4,0,4,4,h,4,4,u,u,2,2,4,0,4,4,4,2,0,4,4,4,4,4],p=[8,8,8,8,8,8,8,8,8,8,8,h,h,h,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,u,u,u,u,u,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8];function f(e,t,n){if(!(o<e))if(1!=e||1!=i||s)for(var r,a,l,c,u=n.length,h=0;h<u;){if(t[h]>=e){for(r=h+1;r<u&&t[r]>=e;)r++;for(a=h,l=r-1;a<l;a++,l--)c=n[a],n[a]=n[l],n[l]=c;h=r}h++}else n.reverse()}function g(e,t,n,o){var l,c,d,p,f=t[o];switch(f){case 0:case 1:r=!1;case 4:case 3:return f;case 2:return r?3:2;case 7:return r=!0,1;case 8:return 4;case 9:return o<1||o+1>=t.length||2!=(l=n[o-1])&&3!=l||2!=(c=t[o+1])&&3!=c?4:(r&&(c=3),c==l?c:4);case 10:return 2==(l=o>0?n[o-1]:5)&&o+1<t.length&&2==t[o+1]?2:4;case u:if(o>0&&2==n[o-1])return 2;if(r)return 4;for(p=o+1,d=t.length;p<d&&t[p]==u;)p++;return p<d&&2==t[p]?2:4;case 12:for(d=t.length,p=o+1;p<d&&12==t[p];)p++;if(p<d){var g=e[o],m=g>=1425&&g<=2303||64286==g;if(l=t[p],m&&(1==l||7==l))return 1}return o<1||5==(l=t[o-1])?4:n[o-1];case 5:return r=!1,s=!0,i;case 6:return a=!0,4;case 13:case 14:case 16:case 17:case 15:r=!1;case h:return 4}}function m(e){var t=e.charCodeAt(0),n=t>>8;return 0==n?t>191?0:d[t]:5==n?/[\u0591-\u05f4]/.test(e)?1:0:6==n?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(e)?12:/[\u0660-\u0669\u066b-\u066c]/.test(e)?3:1642==t?u:/[\u06f0-\u06f9]/.test(e)?2:7:32==n&&t<=8287?p[255&t]:254==n&&t>=65136?7:4}t.L=0,t.R=1,t.EN=2,t.ON_R=3,t.AN=4,t.R_H=5,t.B=6,t.RLE=7,t.DOT="·",t.doBidiReorder=function(e,n,u){if(e.length<2)return{};var d=e.split(""),p=new Array(d.length),y=new Array(d.length),v=[];i=u?1:0,function(e,t,n,u){var h=i?c:l,d=null,p=null,f=null,y=0,v=null,b=-1,x=null,w=null,_=[];if(!u)for(x=0,u=[];x<n;x++)u[x]=m(e[x]);for(o=i,r=!1,s=!1,a=!1,w=0;w<n;w++){if(d=y,_[w]=p=g(e,u,_,w),v=240&(y=h[d][p]),y&=15,t[w]=f=h[y][5],v>0)if(16==v){for(x=b;x<w;x++)t[x]=1;b=-1}else b=-1;if(h[y][6])-1==b&&(b=w);else if(b>-1){for(x=b;x<w;x++)t[x]=f;b=-1}5==u[w]&&(t[w]=0),o|=f}if(a)for(x=0;x<n;x++)if(6==u[x]){t[x]=i;for(var S=x-1;S>=0&&8==u[S];S--)t[S]=i}}(d,v,d.length,n);for(var b=0;b<p.length;p[b]=b,b++);f(2,v,p),f(1,v,p);for(b=0;b<p.length-1;b++)3===n[b]?v[b]=t.AN:1===v[b]&&(n[b]>7&&n[b]<13||4===n[b]||n[b]===h)?v[b]=t.ON_R:b>0&&"ل"===d[b-1]&&/\u0622|\u0623|\u0625|\u0627/.test(d[b])&&(v[b-1]=v[b]=t.R_H,b++);d[d.length-1]===t.DOT&&(v[d.length-1]=t.B),"‫"===d[0]&&(v[0]=t.RLE);for(b=0;b<p.length;b++)y[b]=v[p[b]];return{logicalFromVisual:p,bidiLevels:y}},t.hasBidiCharacters=function(e,t){for(var n=!1,i=0;i<e.length;i++)t[i]=m(e.charAt(i)),n||1!=t[i]&&7!=t[i]&&3!=t[i]||(n=!0);return n},t.getVisualFromLogicalIdx=function(e,t){for(var n=0;n<t.logicalFromVisual.length;n++)if(t.logicalFromVisual[n]==e)return n;return 0}})),ace.define("ace/bidihandler",[],(function(e,t,n){"use strict";var i=e("./lib/bidiutil"),o=e("./lib/lang"),r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\u202B]/,s=function(){function e(e){this.session=e,this.bidiMap={},this.currentRow=null,this.bidiUtil=i,this.charWidths=[],this.EOL="¬",this.showInvisibles=!0,this.isRtlDir=!1,this.$isRtl=!1,this.line="",this.wrapIndent=0,this.EOF="¶",this.RLE="‫",this.contentWidth=0,this.fontMetrics=null,this.rtlLineOffset=0,this.wrapOffset=0,this.isMoveLeftOperation=!1,this.seenBidi=r.test(e.getValue())}return e.prototype.isBidiRow=function(e,t,n){return!!this.seenBidi&&(e!==this.currentRow&&(this.currentRow=e,this.updateRowLine(t,n),this.updateBidiMap()),this.bidiMap.bidiLevels)},e.prototype.onChange=function(e){this.seenBidi?this.currentRow=null:"insert"==e.action&&r.test(e.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},e.prototype.getDocumentRow=function(){var e=0,t=this.session.$screenRowCache;if(t.length){var n=this.session.$getRowCacheIndex(t,this.currentRow);n>=0&&(e=this.session.$docRowCache[n])}return e},e.prototype.getSplitIndex=function(){var e=0,t=this.session.$screenRowCache;if(t.length)for(var n,i=this.session.$getRowCacheIndex(t,this.currentRow);this.currentRow-e>0&&(n=this.session.$getRowCacheIndex(t,this.currentRow-e-1))===i;)i=n,e++;else e=this.currentRow;return e},e.prototype.updateRowLine=function(e,t){void 0===e&&(e=this.getDocumentRow());var n=e===this.session.getLength()-1?this.EOF:this.EOL;if(this.wrapIndent=0,this.line=this.session.getLine(e),this.isRtlDir=this.$isRtl||this.line.charAt(0)===this.RLE,this.session.$useWrapMode){var r=this.session.$wrapData[e];r&&(void 0===t&&(t=this.getSplitIndex()),t>0&&r.length?(this.wrapIndent=r.indent,this.wrapOffset=this.wrapIndent*this.charWidths[i.L],this.line=t<r.length?this.line.substring(r[t-1],r[t]):this.line.substring(r[r.length-1])):this.line=this.line.substring(0,r[t]),t==r.length&&(this.line+=this.showInvisibles?n:i.DOT))}else this.line+=this.showInvisibles?n:i.DOT;var s,a=this.session,l=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,(function(e,t){return"\t"===e||a.isFullWidth(e.charCodeAt(0))?(s="\t"===e?a.getScreenTabSize(t+l):2,l+=s-1,o.stringRepeat(i.DOT,s)):e})),this.isRtlDir&&(this.fontMetrics.$main.textContent=this.line.charAt(this.line.length-1)==i.DOT?this.line.substr(0,this.line.length-1):this.line,this.rtlLineOffset=this.contentWidth-this.fontMetrics.$main.getBoundingClientRect().width)},e.prototype.updateBidiMap=function(){var e=[];i.hasBidiCharacters(this.line,e)||this.isRtlDir?this.bidiMap=i.doBidiReorder(this.line,e,this.isRtlDir):this.bidiMap={}},e.prototype.markAsDirty=function(){this.currentRow=null},e.prototype.updateCharacterWidths=function(e){if(this.characterWidth!==e.$characterSize.width){this.fontMetrics=e;var t=this.characterWidth=e.$characterSize.width,n=e.$measureCharWidth("ה");this.charWidths[i.L]=this.charWidths[i.EN]=this.charWidths[i.ON_R]=t,this.charWidths[i.R]=this.charWidths[i.AN]=n,this.charWidths[i.R_H]=.45*n,this.charWidths[i.B]=this.charWidths[i.RLE]=0,this.currentRow=null}},e.prototype.setShowInvisibles=function(e){this.showInvisibles=e,this.currentRow=null},e.prototype.setEolChar=function(e){this.EOL=e},e.prototype.setContentWidth=function(e){this.contentWidth=e},e.prototype.isRtlLine=function(e){return!!this.$isRtl||(null!=e?this.session.getLine(e).charAt(0)==this.RLE:this.isRtlDir)},e.prototype.setRtlDirection=function(e,t){for(var n=e.getCursorPosition(),i=e.selection.getSelectionAnchor().row;i<=n.row;i++)t||e.session.getLine(i).charAt(0)!==e.session.$bidiHandler.RLE?t&&e.session.getLine(i).charAt(0)!==e.session.$bidiHandler.RLE&&e.session.doc.insert({column:0,row:i},e.session.$bidiHandler.RLE):e.session.doc.removeInLine(i,0,1)},e.prototype.getPosLeft=function(e){e-=this.wrapIndent;var t=this.line.charAt(0)===this.RLE?1:0,n=e>t?this.session.getOverwrite()?e:e-1:t,o=i.getVisualFromLogicalIdx(n,this.bidiMap),r=this.bidiMap.bidiLevels,s=0;!this.session.getOverwrite()&&e<=t&&r[o]%2!=0&&o++;for(var a=0;a<o;a++)s+=this.charWidths[r[a]];return!this.session.getOverwrite()&&e>t&&r[o]%2==0&&(s+=this.charWidths[r[o]]),this.wrapIndent&&(s+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset),this.isRtlDir&&(s+=this.rtlLineOffset),s},e.prototype.getSelections=function(e,t){var n,i=this.bidiMap,o=i.bidiLevels,r=[],s=0,a=Math.min(e,t)-this.wrapIndent,l=Math.max(e,t)-this.wrapIndent,c=!1,u=!1,h=0;this.wrapIndent&&(s+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);for(var d,p=0;p<o.length;p++)d=i.logicalFromVisual[p],n=o[p],(c=d>=a&&d<l)&&!u?h=s:!c&&u&&r.push({left:h,width:s-h}),s+=this.charWidths[n],u=c;if(c&&p===o.length&&r.push({left:h,width:s-h}),this.isRtlDir)for(var f=0;f<r.length;f++)r[f].left+=this.rtlLineOffset;return r},e.prototype.offsetToCol=function(e){this.isRtlDir&&(e-=this.rtlLineOffset);var t=0,n=(e=Math.max(e,0),0),i=0,o=this.bidiMap.bidiLevels,r=this.charWidths[o[i]];for(this.wrapIndent&&(e-=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);e>n+r/2;){if(n+=r,i===o.length-1){r=0;break}r=this.charWidths[o[++i]]}return i>0&&o[i-1]%2!=0&&o[i]%2==0?(e<n&&i--,t=this.bidiMap.logicalFromVisual[i]):i>0&&o[i-1]%2==0&&o[i]%2!=0?t=1+(e>n?this.bidiMap.logicalFromVisual[i]:this.bidiMap.logicalFromVisual[i-1]):this.isRtlDir&&i===o.length-1&&0===r&&o[i-1]%2==0||!this.isRtlDir&&0===i&&o[i]%2!=0?t=1+this.bidiMap.logicalFromVisual[i]:(i>0&&o[i-1]%2!=0&&0!==r&&i--,t=this.bidiMap.logicalFromVisual[i]),0===t&&this.isRtlDir&&t++,t+this.wrapIndent},e}();t.BidiHandler=s})),ace.define("ace/selection",[],(function(e,t,n){"use strict";var i=e("./lib/oop"),o=e("./lib/lang"),r=e("./lib/event_emitter").EventEmitter,s=e("./range").Range,a=function(){function e(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.cursor=this.lead=this.doc.createAnchor(0,0),this.anchor=this.doc.createAnchor(0,0),this.$silent=!1;var t=this;this.cursor.on("change",(function(e){t.$cursorChanged=!0,t.$silent||t._emit("changeCursor"),t.$isEmpty||t.$silent||t._emit("changeSelection"),t.$keepDesiredColumnOnChange||e.old.column==e.value.column||(t.$desiredColumn=null)})),this.anchor.on("change",(function(){t.$anchorChanged=!0,t.$isEmpty||t.$silent||t._emit("changeSelection")}))}return e.prototype.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},e.prototype.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row},e.prototype.getCursor=function(){return this.lead.getPosition()},e.prototype.setAnchor=function(e,t){this.$isEmpty=!1,this.anchor.setPosition(e,t)},e.prototype.getAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},e.prototype.getSelectionLead=function(){return this.lead.getPosition()},e.prototype.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},e.prototype.getRange=function(){var e=this.anchor,t=this.lead;return this.$isEmpty?s.fromPoints(t,t):this.isBackwards()?s.fromPoints(t,e):s.fromPoints(e,t)},e.prototype.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},e.prototype.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE)},e.prototype.setRange=function(e,t){var n=t?e.end:e.start,i=t?e.start:e.end;this.$setSelection(n.row,n.column,i.row,i.column)},e.prototype.$setSelection=function(e,t,n,i){if(!this.$silent){var o=this.$isEmpty,r=this.inMultiSelectMode;this.$silent=!0,this.$cursorChanged=this.$anchorChanged=!1,this.anchor.setPosition(e,t),this.cursor.setPosition(n,i),this.$isEmpty=!s.comparePoints(this.anchor,this.cursor),this.$silent=!1,this.$cursorChanged&&this._emit("changeCursor"),(this.$cursorChanged||this.$anchorChanged||o!=this.$isEmpty||r)&&this._emit("changeSelection")}},e.prototype.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},e.prototype.selectTo=function(e,t){this.$moveSelection((function(){this.moveCursorTo(e,t)}))},e.prototype.selectToPosition=function(e){this.$moveSelection((function(){this.moveCursorToPosition(e)}))},e.prototype.moveTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},e.prototype.moveToPosition=function(e){this.clearSelection(),this.moveCursorToPosition(e)},e.prototype.selectUp=function(){this.$moveSelection(this.moveCursorUp)},e.prototype.selectDown=function(){this.$moveSelection(this.moveCursorDown)},e.prototype.selectRight=function(){this.$moveSelection(this.moveCursorRight)},e.prototype.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},e.prototype.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},e.prototype.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},e.prototype.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},e.prototype.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},e.prototype.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},e.prototype.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},e.prototype.getWordRange=function(e,t){if(void 0===t){var n=e||this.lead;e=n.row,t=n.column}return this.session.getWordRange(e,t)},e.prototype.selectWord=function(){this.setSelectionRange(this.getWordRange())},e.prototype.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},e.prototype.getLineRange=function(e,t){var n,i="number"==typeof e?e:this.lead.row,o=this.session.getFoldLine(i);return o?(i=o.start.row,n=o.end.row):n=i,!0===t?new s(i,0,n,this.session.getLine(n).length):new s(i,0,n+1,0)},e.prototype.selectLine=function(){this.setSelectionRange(this.getLineRange())},e.prototype.moveCursorUp=function(){this.moveCursorBy(-1,0)},e.prototype.moveCursorDown=function(){this.moveCursorBy(1,0)},e.prototype.wouldMoveIntoSoftTab=function(e,t,n){var i=e.column,o=e.column+t;return n<0&&(i=e.column-t,o=e.column),this.session.isTabStop(e)&&this.doc.getLine(e.row).slice(i,o).split(" ").length-1==t},e.prototype.moveCursorLeft=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,-1))this.moveCursorTo(e.start.row,e.start.column);else if(0===t.column)t.row>0&&this.moveCursorTo(t.row-1,this.doc.getLine(t.row-1).length);else{var n=this.session.getTabSize();this.wouldMoveIntoSoftTab(t,n,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-n):this.moveCursorBy(0,-1)}},e.prototype.moveCursorRight=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,1))this.moveCursorTo(e.end.row,e.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var n=this.session.getTabSize();t=this.lead;this.wouldMoveIntoSoftTab(t,n,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,n):this.moveCursorBy(0,1)}},e.prototype.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,n=this.session.documentToScreenRow(e,t),i=this.session.screenToDocumentPosition(n,0),o=this.session.getDisplayLine(e,null,i.row,i.column).match(/^\s*/);o[0].length==t||this.session.$useEmacsStyleLineStart||(i.column+=o[0].length),this.moveCursorToPosition(i)},e.prototype.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var n=this.session.getLine(t.row);if(t.column==n.length){var i=n.search(/\s+$/);i>0&&(t.column=i)}}this.moveCursorTo(t.row,t.column)},e.prototype.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},e.prototype.moveCursorFileStart=function(){this.moveCursorTo(0,0)},e.prototype.moveCursorLongWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),i=n.substring(t);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var o=this.session.getFoldAt(e,t,1);if(o)this.moveCursorTo(o.end.row,o.end.column);else{if(this.session.nonTokenRe.exec(i)&&(t+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,i=n.substring(t)),t>=n.length)return this.moveCursorTo(e,n.length),this.moveCursorRight(),void(e<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(i)&&(t+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,t)}},e.prototype.moveCursorLongWordLeft=function(){var e,t=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(t,n,-1))this.moveCursorTo(e.start.row,e.start.column);else{var i=this.session.getFoldStringAt(t,n,-1);null==i&&(i=this.doc.getLine(t).substring(0,n));var r=o.stringReverse(i);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(r)&&(n-=this.session.nonTokenRe.lastIndex,r=r.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),n<=0)return this.moveCursorTo(t,0),this.moveCursorLeft(),void(t>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(r)&&(n-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(t,n)}},e.prototype.$shortWordEndIndex=function(e){var t,n=0,i=/\s/,o=this.session.tokenRe;if(o.lastIndex=0,this.session.tokenRe.exec(e))n=this.session.tokenRe.lastIndex;else{for(;(t=e[n])&&i.test(t);)n++;if(n<1)for(o.lastIndex=0;(t=e[n])&&!o.test(t);)if(o.lastIndex=0,n++,i.test(t)){if(n>2){n--;break}for(;(t=e[n])&&i.test(t);)n++;if(n>2)break}}return o.lastIndex=0,n},e.prototype.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),i=n.substring(t),o=this.session.getFoldAt(e,t,1);if(o)return this.moveCursorTo(o.end.row,o.end.column);if(t==n.length){var r=this.doc.getLength();do{e++,i=this.doc.getLine(e)}while(e<r&&/^\s*$/.test(i));/^\s+/.test(i)||(i=""),t=0}var s=this.$shortWordEndIndex(i);this.moveCursorTo(e,t+s)},e.prototype.moveCursorShortWordLeft=function(){var e,t=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(t,n,-1))return this.moveCursorTo(e.start.row,e.start.column);var i=this.session.getLine(t).substring(0,n);if(0===n){do{t--,i=this.doc.getLine(t)}while(t>0&&/^\s*$/.test(i));n=i.length,/\s+$/.test(i)||(i="")}var r=o.stringReverse(i),s=this.$shortWordEndIndex(r);return this.moveCursorTo(t,n-s)},e.prototype.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},e.prototype.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},e.prototype.moveCursorBy=function(e,t){var n,i=this.session.documentToScreenPosition(this.lead.row,this.lead.column);if(0===t&&(0!==e&&(this.session.$bidiHandler.isBidiRow(i.row,this.lead.row)?(n=this.session.$bidiHandler.getPosLeft(i.column),i.column=Math.round(n/this.session.$bidiHandler.charWidths[0])):n=i.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?i.column=this.$desiredColumn:this.$desiredColumn=i.column),0!=e&&this.session.lineWidgets&&this.session.lineWidgets[this.lead.row]){var o=this.session.lineWidgets[this.lead.row];e<0?e-=o.rowsAbove||0:e>0&&(e+=o.rowCount-(o.rowsAbove||0))}var r=this.session.screenToDocumentPosition(i.row+e,i.column,n);0!==e&&0===t&&r.row===this.lead.row&&(r.column,this.lead.column),this.moveCursorTo(r.row,r.column+t,0===t)},e.prototype.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},e.prototype.moveCursorTo=function(e,t,n){var i=this.session.getFoldAt(e,t,1);i&&(e=i.start.row,t=i.start.column),this.$keepDesiredColumnOnChange=!0;var o=this.session.getLine(e);/[\uDC00-\uDFFF]/.test(o.charAt(t))&&o.charAt(t-1)&&(this.lead.row==e&&this.lead.column==t+1?t-=1:t+=1),this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,n||(this.$desiredColumn=null)},e.prototype.moveCursorToScreen=function(e,t,n){var i=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(i.row,i.column,n)},e.prototype.detach=function(){this.lead.detach(),this.anchor.detach()},e.prototype.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},e.prototype.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e},e.prototype.getRangeOfMovements=function(e){var t=this.getCursor();try{e(this);var n=this.getCursor();return s.fromPoints(t,n)}catch(e){return s.fromPoints(t,t)}finally{this.moveCursorToPosition(t)}},e.prototype.toJSON=function(){if(this.rangeCount)var e=this.ranges.map((function(e){var t=e.clone();return t.isBackwards=e.cursor==e.start,t}));else(e=this.getRange()).isBackwards=this.isBackwards();return e},e.prototype.fromJSON=function(e){if(null==e.start){if(this.rangeList&&e.length>1){this.toSingleRange(e[0]);for(var t=e.length;t--;){var n=s.fromPoints(e[t].start,e[t].end);e[t].isBackwards&&(n.cursor=n.start),this.addRange(n,!0)}return}e=e[0]}this.rangeList&&this.toSingleRange(e),this.setSelectionRange(e,e.isBackwards)},e.prototype.isEqual=function(e){if((e.length||this.rangeCount)&&e.length!=this.rangeCount)return!1;if(!e.length||!this.ranges)return this.getRange().isEqual(e);for(var t=this.ranges.length;t--;)if(!this.ranges[t].isEqual(e[t]))return!1;return!0},e}();a.prototype.setSelectionAnchor=a.prototype.setAnchor,a.prototype.getSelectionAnchor=a.prototype.getAnchor,a.prototype.setSelectionRange=a.prototype.setRange,i.implement(a.prototype,r),t.Selection=a})),ace.define("ace/tokenizer",[],(function(e,t,n){"use strict";var i=e("./lib/report_error").reportError,o=2e3,r=function(){function e(e){for(var t in this.splitRegex,this.states=e,this.regExps={},this.matchMappings={},this.states){for(var n=this.states[t],i=[],o=0,r=this.matchMappings[t]={defaultToken:"text"},s="g",a=[],l=0;l<n.length;l++){var c=n[l];if(c.defaultToken&&(r.defaultToken=c.defaultToken),c.caseInsensitive&&-1===s.indexOf("i")&&(s+="i"),c.unicode&&-1===s.indexOf("u")&&(s+="u"),null!=c.regex){c.regex instanceof RegExp&&(c.regex=c.regex.toString().slice(1,-1));var u=c.regex,h=new RegExp("(?:("+u+")|(.))").exec("a").length-2;Array.isArray(c.token)?1==c.token.length||1==h?c.token=c.token[0]:h-1!=c.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:c,groupCount:h-1}),c.token=c.token[0]):(c.tokenArray=c.token,c.token=null,c.onMatch=this.$arrayTokens):"function"!=typeof c.token||c.onMatch||(c.onMatch=h>1?this.$applyToken:c.token),h>1&&(/\\\d/.test(c.regex)?u=c.regex.replace(/\\([0-9]+)/g,(function(e,t){return"\\"+(parseInt(t,10)+o+1)})):(h=1,u=this.removeCapturingGroups(c.regex)),c.splitRegex||"string"==typeof c.token||a.push(c)),r[o]=l,o+=h,i.push(u),c.onMatch||(c.onMatch=null)}}i.length||(r[0]=0,i.push("$")),a.forEach((function(e){e.splitRegex=this.createSplitterRegexp(e.regex,s)}),this),this.regExps[t]=new RegExp("("+i.join(")|(")+")|($)",s)}}return e.prototype.$setMaxTokenCount=function(e){o=0|e},e.prototype.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),n=this.token.apply(this,t);if("string"==typeof n)return[{type:n,value:e}];for(var i=[],o=0,r=n.length;o<r;o++)t[o]&&(i[i.length]={type:n[o],value:t[o]});return i},e.prototype.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";for(var n=[],i=this.tokenArray,o=0,r=i.length;o<r;o++)t[o+1]&&(n[n.length]={type:i[o],value:t[o+1]});return n},e.prototype.removeCapturingGroups=function(e){return e.replace(/\\.|\[(?:\\.|[^\\\]])*|\(\?[:=!<]|(\()/g,(function(e,t){return t?"(?:":e}))},e.prototype.createSplitterRegexp=function(e,t){if(-1!=e.indexOf("(?=")){var n=0,i=!1,o={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,(function(e,t,r,s,a,l){return i?i="]"!=a:a?i=!0:s?(n==o.stack&&(o.end=l+1,o.stack=-1),n--):r&&(n++,1!=r.length&&(o.stack=n,o.start=l)),e})),null!=o.end&&/^\)*$/.test(e.substr(o.end))&&(e=e.substring(0,o.start)+e.substr(o.end))}return"^"!=e.charAt(0)&&(e="^"+e),"$"!=e.charAt(e.length-1)&&(e+="$"),new RegExp(e,(t||"").replace("g",""))},e.prototype.getLineTokens=function(e,t){if(t&&"string"!=typeof t){var n=t.slice(0);"#tmp"===(t=n[0])&&(n.shift(),t=n.shift())}else n=[];var i=t||"start",r=this.states[i];r||(i="start",r=this.states[i]);var s=this.matchMappings[i],a=this.regExps[i];a.lastIndex=0;for(var l,c=[],u=0,h=0,d={type:null,value:""};l=a.exec(e);){var p=s.defaultToken,f=null,g=l[0],m=a.lastIndex;if(m-g.length>u){var y=e.substring(u,m-g.length);d.type==p?d.value+=y:(d.type&&c.push(d),d={type:p,value:y})}for(var v=0;v<l.length-2;v++)if(void 0!==l[v+1]){p=(f=r[s[v]]).onMatch?f.onMatch(g,i,n,e):f.token,f.next&&(i="string"==typeof f.next?f.next:f.next(i,n),(r=this.states[i])||(this.reportError("state doesn't exist",i),i="start",r=this.states[i]),s=this.matchMappings[i],u=m,(a=this.regExps[i]).lastIndex=m),f.consumeLineEnd&&(u=m);break}if(g)if("string"==typeof p)f&&!1===f.merge||d.type!==p?(d.type&&c.push(d),d={type:p,value:g}):d.value+=g;else if(p){d.type&&c.push(d),d={type:null,value:""};for(v=0;v<p.length;v++)c.push(p[v])}if(u==e.length)break;if(u=m,h++>o){for(h>2*e.length&&this.reportError("infinite loop with in ace tokenizer",{startState:t,line:e});u<e.length;)d.type&&c.push(d),d={value:e.substring(u,u+=500),type:"overflow"};i="start",n=[];break}}return d.type&&c.push(d),n.length>1&&n[0]!==i&&n.unshift("#tmp",i),{tokens:c,state:n.length?n:i}},e}();r.prototype.reportError=i,t.Tokenizer=r})),ace.define("ace/mode/text_highlight_rules",[],(function(e,t,n){"use strict";var i,o=e("../lib/deep_copy").deepCopy;(function(){this.addRules=function(e,t){if(t)for(var n in e){for(var i=e[n],o=0;o<i.length;o++){var r=i[o];(r.next||r.onMatch)&&("string"==typeof r.next&&0!==r.next.indexOf(t)&&(r.next=t+r.next),r.nextState&&0!==r.nextState.indexOf(t)&&(r.nextState=t+r.nextState))}this.$rules[t+n]=i}else for(var n in e)this.$rules[n]=e[n]},this.getRules=function(){return this.$rules},this.embedRules=function(e,t,n,i,r){var s="function"==typeof e?(new e).getRules():e;if(i)for(var a=0;a<i.length;a++)i[a]=t+i[a];else for(var l in i=[],s)i.push(t+l);if(this.addRules(s,t),n){var c=Array.prototype[r?"push":"unshift"];for(a=0;a<i.length;a++)c.apply(this.$rules[i[a]],o(n))}this.$embeds||(this.$embeds=[]),this.$embeds.push(t)},this.getEmbeds=function(){return this.$embeds};var e=function(e,t){return("start"!=e||t.length)&&t.unshift(this.nextState,e),this.nextState},t=function(e,t){return t.shift(),t.shift()||"start"};this.normalizeRules=function(){var n=0,i=this.$rules;Object.keys(i).forEach((function o(r){var s=i[r];s.processed=!0;for(var a=0;a<s.length;a++){var l=s[a],c=null;Array.isArray(l)&&(c=l,l={}),!l.regex&&l.start&&(l.regex=l.start,l.next||(l.next=[]),l.next.push({defaultToken:l.token},{token:l.token+".end",regex:l.end||l.start,next:"pop"}),l.token=l.token+".start",l.push=!0);var u=l.next||l.push;if(u&&Array.isArray(u)){var h=l.stateName;h||("string"!=typeof(h=l.token)&&(h=h[0]||""),i[h]&&(h+=n++)),i[h]=u,l.next=h,o(h)}else"pop"==u&&(l.next=t);if(l.push&&(l.nextState=l.next||l.push,l.next=e,delete l.push),l.rules)for(var d in l.rules)i[d]?i[d].push&&i[d].push.apply(i[d],l.rules[d]):i[d]=l.rules[d];var p="string"==typeof l?l:l.include;if(p&&("$self"===p&&(p="start"),c=Array.isArray(p)?p.map((function(e){return i[e]})):i[p]),c){var f=[a,1].concat(c);l.noEscape&&(f=f.filter((function(e){return!e.next}))),s.splice.apply(s,f),a--}l.keywordMap&&(l.token=this.createKeywordMapper(l.keywordMap,l.defaultToken||"text",l.caseInsensitive),delete l.defaultToken)}}),this)},this.createKeywordMapper=function(e,t,n,i){var o=Object.create(null);return this.$keywordList=[],Object.keys(e).forEach((function(t){for(var r=e[t].split(i||"|"),s=r.length;s--;){var a=r[s];this.$keywordList.push(a),n&&(a=a.toLowerCase()),o[a]=t}}),this),e=null,n?function(e){return o[e.toLowerCase()]||t}:function(e){return o[e]||t}},this.getKeywords=function(){return this.$keywords}}).call((i=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}}).prototype),t.TextHighlightRules=i})),ace.define("ace/mode/behaviour",[],(function(e,t,n){"use strict";var i;(function(){this.add=function(e,t,n){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=n},this.addBehaviours=function(e){for(var t in e)for(var n in e[t])this.add(t,n,e[t][n])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if("function"==typeof e)var n=(new e).getBehaviours(t);else n=e.getBehaviours(t);this.addBehaviours(n)},this.getBehaviours=function(e){if(e){for(var t={},n=0;n<e.length;n++)this.$behaviours[e[n]]&&(t[e[n]]=this.$behaviours[e[n]]);return t}return this.$behaviours}}).call((i=function(){this.$behaviours={}}).prototype),t.Behaviour=i})),ace.define("ace/token_iterator",[],(function(e,t,n){"use strict";var i=e("./range").Range,o=function(){function e(e,t,n){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var i=e.getTokenAt(t,n);this.$tokenIndex=i?i.index:-1}return e.prototype.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},e.prototype.stepForward=function(){var e;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,e||(e=this.$session.getLength()),this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},e.prototype.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},e.prototype.getCurrentTokenRow=function(){return this.$row},e.prototype.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,n=e[t].start;if(void 0!==n)return n;for(n=0;t>0;)n+=e[t-=1].value.length;return n},e.prototype.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},e.prototype.getCurrentTokenRange=function(){var e=this.$rowTokens[this.$tokenIndex],t=this.getCurrentTokenColumn();return new i(this.$row,t,this.$row,t+e.value.length)},e}();t.TokenIterator=o})),ace.define("ace/mode/behaviour/cstyle",[],(function(e,t,n){"use strict";var i,o,r=e("../../lib/oop"),s=e("../behaviour").Behaviour,a=e("../../token_iterator").TokenIterator,l=e("../../lib/lang"),c=["text","paren.rparen","rparen","paren","punctuation.operator"],u=["text","paren.rparen","rparen","paren","punctuation.operator","comment"],h={},d={'"':'"',"'":"'"},p=function(e){var t=-1;if(e.multiSelect&&(t=e.selection.index,h.rangeCount!=e.multiSelect.rangeCount&&(h={rangeCount:e.multiSelect.rangeCount})),h[t])return i=h[t];i=h[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},f=function(e,t,n,i){var o=e.end.row-e.start.row;return{text:n+t+i,selection:[0,e.start.column+1,o,e.end.column+(o?0:1)]}};(o=function(e){e=e||{},this.add("braces","insertion",(function(t,n,r,s,a){var c=r.getCursorPosition(),u=s.doc.getLine(c.row);if("{"==a){p(r);var h=r.getSelectionRange(),d=s.doc.getTextRange(h);if(""!==d&&"{"!==d&&r.getWrapBehavioursEnabled())return f(h,d,"{","}");if(o.isSaneInsertion(r,s))return/[\]\}\)]/.test(u[c.column])||r.inMultiSelectMode||e.braces?(o.recordAutoInsert(r,s,"}"),{text:"{}",selection:[1,1]}):(o.recordMaybeInsert(r,s,"{"),{text:"{",selection:[1,1]})}else if("}"==a){if(p(r),"}"==u.substring(c.column,c.column+1))if(null!==s.$findOpeningBracket("}",{column:c.column+1,row:c.row})&&o.isAutoInsertedClosing(c,u,a))return o.popAutoInsertedClosing(),{text:"",selection:[1,1]}}else{if("\n"==a||"\r\n"==a){p(r);var g="";if(o.isMaybeInsertedClosing(c,u)&&(g=l.stringRepeat("}",i.maybeInsertedBrackets),o.clearMaybeInsertedClosing()),"}"===u.substring(c.column,c.column+1)){var m=s.findMatchingBracket({row:c.row,column:c.column+1},"}");if(!m)return null;var y=this.$getIndent(s.getLine(m.row))}else{if(!g)return void o.clearMaybeInsertedClosing();y=this.$getIndent(u)}var v=y+s.getTabString();return{text:"\n"+v+"\n"+y+g,selection:[1,v.length,1,v.length]}}o.clearMaybeInsertedClosing()}})),this.add("braces","deletion",(function(e,t,n,o,r){var s=o.doc.getTextRange(r);if(!r.isMultiLine()&&"{"==s){if(p(n),"}"==o.doc.getLine(r.start.row).substring(r.end.column,r.end.column+1))return r.end.column++,r;i.maybeInsertedBrackets--}})),this.add("parens","insertion",(function(e,t,n,i,r){if("("==r){p(n);var s=n.getSelectionRange(),a=i.doc.getTextRange(s);if(""!==a&&n.getWrapBehavioursEnabled())return f(s,a,"(",")");if(o.isSaneInsertion(n,i))return o.recordAutoInsert(n,i,")"),{text:"()",selection:[1,1]}}else if(")"==r){p(n);var l=n.getCursorPosition(),c=i.doc.getLine(l.row);if(")"==c.substring(l.column,l.column+1))if(null!==i.$findOpeningBracket(")",{column:l.column+1,row:l.row})&&o.isAutoInsertedClosing(l,c,r))return o.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("parens","deletion",(function(e,t,n,i,o){var r=i.doc.getTextRange(o);if(!o.isMultiLine()&&"("==r&&(p(n),")"==i.doc.getLine(o.start.row).substring(o.start.column+1,o.start.column+2)))return o.end.column++,o})),this.add("brackets","insertion",(function(e,t,n,i,r){if("["==r){p(n);var s=n.getSelectionRange(),a=i.doc.getTextRange(s);if(""!==a&&n.getWrapBehavioursEnabled())return f(s,a,"[","]");if(o.isSaneInsertion(n,i))return o.recordAutoInsert(n,i,"]"),{text:"[]",selection:[1,1]}}else if("]"==r){p(n);var l=n.getCursorPosition(),c=i.doc.getLine(l.row);if("]"==c.substring(l.column,l.column+1))if(null!==i.$findOpeningBracket("]",{column:l.column+1,row:l.row})&&o.isAutoInsertedClosing(l,c,r))return o.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("brackets","deletion",(function(e,t,n,i,o){var r=i.doc.getTextRange(o);if(!o.isMultiLine()&&"["==r&&(p(n),"]"==i.doc.getLine(o.start.row).substring(o.start.column+1,o.start.column+2)))return o.end.column++,o})),this.add("string_dquotes","insertion",(function(e,t,n,i,o){var r=i.$mode.$quotes||d;if(1==o.length&&r[o]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(o))return;p(n);var s=o,a=n.getSelectionRange(),l=i.doc.getTextRange(a);if(!(""===l||1==l.length&&r[l])&&n.getWrapBehavioursEnabled())return f(a,l,s,s);if(!l){var c=n.getCursorPosition(),u=i.doc.getLine(c.row),h=u.substring(c.column-1,c.column),g=u.substring(c.column,c.column+1),m=i.getTokenAt(c.row,c.column),y=i.getTokenAt(c.row,c.column+1);if("\\"==h&&m&&/escape/.test(m.type))return null;var v,b=m&&/string|escape/.test(m.type),x=!y||/string|escape/.test(y.type);if(g==s)(v=b!==x)&&/string\.end/.test(y.type)&&(v=!1);else{if(b&&!x)return null;if(b&&x)return null;var w=i.$mode.tokenRe;w.lastIndex=0;var _=w.test(h);w.lastIndex=0;var S=w.test(g),C=i.$mode.$pairQuotesAfter;if(!(C&&C[s]&&C[s].test(h))&&_||S)return null;if(g&&!/[\s;,.})\]\\]/.test(g))return null;var k=u[c.column-2];if(h==s&&(k==s||w.test(k)))return null;v=!0}return{text:v?s+s:"",selection:[1,1]}}}})),this.add("string_dquotes","deletion",(function(e,t,n,i,o){var r=i.$mode.$quotes||d,s=i.doc.getTextRange(o);if(!o.isMultiLine()&&r.hasOwnProperty(s)&&(p(n),i.doc.getLine(o.start.row).substring(o.start.column+1,o.start.column+2)==s))return o.end.column++,o})),!1!==e.closeDocComment&&this.add("doc comment end","insertion",(function(e,t,n,i,o){if("doc-start"===e&&("\n"===o||"\r\n"===o)&&n.selection.isEmpty()){var r=n.getCursorPosition(),s=i.doc.getLine(r.row),a=i.doc.getLine(r.row+1),l=this.$getIndent(s);if(/\s*\*/.test(a))return/^\s*\*/.test(s)?{text:o+l+"* ",selection:[1,3+l.length,1,3+l.length]}:{text:o+l+" * ",selection:[1,3+l.length,1,3+l.length]};if(/\/\*\*/.test(s.substring(0,r.column)))return{text:o+l+" * "+o+" "+l+"*/",selection:[1,4+l.length,1,4+l.length]}}}))}).isSaneInsertion=function(e,t){var n=e.getCursorPosition(),i=new a(t,n.row,n.column);if(!this.$matchTokenType(i.getCurrentToken()||"text",c)){if(/[)}\]]/.test(e.session.getLine(n.row)[n.column]))return!0;var o=new a(t,n.row,n.column+1);if(!this.$matchTokenType(o.getCurrentToken()||"text",c))return!1}return i.stepForward(),i.getCurrentTokenRow()!==n.row||this.$matchTokenType(i.getCurrentToken()||"text",u)},o.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},o.recordAutoInsert=function(e,t,n){var o=e.getCursorPosition(),r=t.doc.getLine(o.row);this.isAutoInsertedClosing(o,r,i.autoInsertedLineEnd[0])||(i.autoInsertedBrackets=0),i.autoInsertedRow=o.row,i.autoInsertedLineEnd=n+r.substr(o.column),i.autoInsertedBrackets++},o.recordMaybeInsert=function(e,t,n){var o=e.getCursorPosition(),r=t.doc.getLine(o.row);this.isMaybeInsertedClosing(o,r)||(i.maybeInsertedBrackets=0),i.maybeInsertedRow=o.row,i.maybeInsertedLineStart=r.substr(0,o.column)+n,i.maybeInsertedLineEnd=r.substr(o.column),i.maybeInsertedBrackets++},o.isAutoInsertedClosing=function(e,t,n){return i.autoInsertedBrackets>0&&e.row===i.autoInsertedRow&&n===i.autoInsertedLineEnd[0]&&t.substr(e.column)===i.autoInsertedLineEnd},o.isMaybeInsertedClosing=function(e,t){return i.maybeInsertedBrackets>0&&e.row===i.maybeInsertedRow&&t.substr(e.column)===i.maybeInsertedLineEnd&&t.substr(0,e.column)==i.maybeInsertedLineStart},o.popAutoInsertedClosing=function(){i.autoInsertedLineEnd=i.autoInsertedLineEnd.substr(1),i.autoInsertedBrackets--},o.clearMaybeInsertedClosing=function(){i&&(i.maybeInsertedBrackets=0,i.maybeInsertedRow=-1)},r.inherits(o,s),t.CstyleBehaviour=o})),ace.define("ace/unicode",[],(function(e,t,n){"use strict";for(var i=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2],o=0,r=[],s=0;s<i.length;s+=2)r.push(o+=i[s]),i[s+1]&&r.push(45,o+=i[s+1]);t.wordChars=String.fromCharCode.apply(null,r)})),ace.define("ace/mode/text",[],(function(e,t,n){"use strict";var i,o=e("../config"),r=e("../tokenizer").Tokenizer,s=e("./text_highlight_rules").TextHighlightRules,a=e("./behaviour/cstyle").CstyleBehaviour,l=e("../unicode"),c=e("../lib/lang"),u=e("../token_iterator").TokenIterator,h=e("../range").Range;(function(){this.$defaultBehaviour=new a,this.tokenRe=new RegExp("^["+l.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+l.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new r(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,t,n,i){var o=t.doc,r=!0,s=!0,a=1/0,l=t.getTabSize(),u=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))g=this.lineCommentStart.map(c.escapeRegExp).join("|"),p=this.lineCommentStart[0];else g=c.escapeRegExp(this.lineCommentStart),p=this.lineCommentStart;g=new RegExp("^(\\s*)(?:"+g+") ?"),u=t.getUseSoftTabs();v=function(e,t){var n=e.match(g);if(n){var i=n[1].length,r=n[0].length;d(e,i,r)||" "!=n[0][r-1]||r--,o.removeInLine(t,i,r)}};var h=p+" ",d=(y=function(e,t){r&&!/\S/.test(e)||(d(e,a,a)?o.insertInLine({row:t,column:a},h):o.insertInLine({row:t,column:a},p))},b=function(e,t){return g.test(e)},function(e,t,n){for(var i=0;t--&&" "==e.charAt(t);)i++;if(i%l!=0)return!1;for(i=0;" "==e.charAt(n++);)i++;return l>2?i%l!=l-1:i%l==0})}else{if(!this.blockComment)return!1;var p=this.blockComment.start,f=this.blockComment.end,g=new RegExp("^(\\s*)(?:"+c.escapeRegExp(p)+")"),m=new RegExp("(?:"+c.escapeRegExp(f)+")\\s*$"),y=function(e,t){b(e,t)||r&&!/\S/.test(e)||(o.insertInLine({row:t,column:e.length},f),o.insertInLine({row:t,column:a},p))},v=function(e,t){var n;(n=e.match(m))&&o.removeInLine(t,e.length-n[0].length,e.length),(n=e.match(g))&&o.removeInLine(t,n[1].length,n[0].length)},b=function(e,n){if(g.test(e))return!0;for(var i=t.getTokens(n),o=0;o<i.length;o++)if("comment"===i[o].type)return!0}}function x(e){for(var t=n;t<=i;t++)e(o.getLine(t),t)}var w=1/0;x((function(e,t){var n=e.search(/\S/);-1!==n?(n<a&&(a=n),s&&!b(e,t)&&(s=!1)):w>e.length&&(w=e.length)})),a==1/0&&(a=w,r=!1,s=!1),u&&a%l!=0&&(a=Math.floor(a/l)*l),x(s?v:y)},this.toggleBlockComment=function(e,t,n,i){var o=this.blockComment;if(o){!o.start&&o[0]&&(o=o[0]);var r,s,a=(g=new u(t,i.row,i.column)).getCurrentToken(),l=(t.selection,t.selection.toOrientedRange());if(a&&/comment/.test(a.type)){for(var c,d;a&&/comment/.test(a.type);){if(-1!=(m=a.value.indexOf(o.start))){var p=g.getCurrentTokenRow(),f=g.getCurrentTokenColumn()+m;c=new h(p,f,p,f+o.start.length);break}a=g.stepBackward()}var g;for(a=(g=new u(t,i.row,i.column)).getCurrentToken();a&&/comment/.test(a.type);){var m;if(-1!=(m=a.value.indexOf(o.end))){p=g.getCurrentTokenRow(),f=g.getCurrentTokenColumn()+m;d=new h(p,f,p,f+o.end.length);break}a=g.stepForward()}d&&t.remove(d),c&&(t.remove(c),r=c.start.row,s=-o.start.length)}else s=o.start.length,r=n.start.row,t.insert(n.end,o.end),t.insert(n.start,o.start);l.start.row==r&&(l.start.column+=s),l.end.row==r&&(l.end.column+=s),t.selection.fromOrientedRange(l)}},this.getNextLineIndent=function(e,t,n){return this.$getIndent(t)},this.checkOutdent=function(e,t,n){return!1},this.autoOutdent=function(e,t,n){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(e){for(var t in this.$embeds=[],this.$modes={},e)if(e[t]){var n=e[t],i=n.prototype.$id,r=o.$modes[i];r||(o.$modes[i]=r=new n),o.$modes[t]||(o.$modes[t]=r),this.$embeds.push(t),this.$modes[t]=r}var s=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"],a=function(e){var t,n,i;i=(t=l)[n=s[e]],t[s[e]]=function(){return this.$delegator(n,arguments,i)}},l=this;for(t=0;t<s.length;t++)a(t)},this.$delegator=function(e,t,n){var i=t[0]||"start";if("string"!=typeof i){if(Array.isArray(i[2])){var o=i[2][i[2].length-1];if(s=this.$modes[o])return s[e].apply(s,[i[1]].concat([].slice.call(t,1)))}i=i[0]||"start"}for(var r=0;r<this.$embeds.length;r++)if(this.$modes[this.$embeds[r]]){var s,a=i.split(this.$embeds[r]);if(!a[0]&&a[1])return t[0]=a[1],(s=this.$modes[this.$embeds[r]])[e].apply(s,t)}var l=n.apply(this,t);return n?l:void 0},this.transformAction=function(e,t,n,i,o){if(this.$behaviour){var r=this.$behaviour.getBehaviours();for(var s in r)if(r[s][t]){var a=r[s][t].apply(this,arguments);if(a)return a}}},this.getKeywords=function(e){if(!this.completionKeywords){var t=this.$tokenizer.rules,n=[];for(var i in t)for(var o=t[i],r=0,s=o.length;r<s;r++)if("string"==typeof o[r].token)/keyword|support|storage/.test(o[r].token)&&n.push(o[r].regex);else if("object"==typeof o[r].token)for(var a=0,l=o[r].token.length;a<l;a++)if(/keyword|support|storage/.test(o[r].token[a])){i=o[r].regex.match(/\(.+?\)/g)[a];n.push(i.substr(1,i.length-2))}this.completionKeywords=n}return e?n.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(e,t,n,i){return(this.$keywordList||this.$createKeywordList()).map((function(e){return{name:e,value:e,score:0,meta:"keyword"}}))},this.$id="ace/mode/text"}).call((i=function(){this.HighlightRules=s}).prototype),t.Mode=i})),ace.define("ace/apply_delta",[],(function(e,t,n){"use strict";t.applyDelta=function(e,t,n){var i=t.start.row,o=t.start.column,r=e[i]||"";switch(t.action){case"insert":if(1===t.lines.length)e[i]=r.substring(0,o)+t.lines[0]+r.substring(o);else{var s=[i,1].concat(t.lines);e.splice.apply(e,s),e[i]=r.substring(0,o)+e[i],e[i+t.lines.length-1]+=r.substring(o)}break;case"remove":var a=t.end.column,l=t.end.row;i===l?e[i]=r.substring(0,o)+r.substring(a):e.splice(i,l-i+1,r.substring(0,o)+e[l].substring(a))}}})),ace.define("ace/anchor",[],(function(e,t,n){"use strict";var i=e("./lib/oop"),o=e("./lib/event_emitter").EventEmitter,r=function(){function e(e,t,n){this.$onChange=this.onChange.bind(this),this.attach(e),"number"!=typeof t?this.setPosition(t.row,t.column):this.setPosition(t,n)}return e.prototype.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},e.prototype.getDocument=function(){return this.document},e.prototype.onChange=function(e){if(!(e.start.row==e.end.row&&e.start.row!=this.row||e.start.row>this.row)){var t=function(e,t,n){var i="insert"==e.action,o=(i?1:-1)*(e.end.row-e.start.row),r=(i?1:-1)*(e.end.column-e.start.column),a=e.start,l=i?a:e.end;if(s(t,a,n))return{row:t.row,column:t.column};if(s(l,t,!n))return{row:t.row+o,column:t.column+(t.row==l.row?r:0)};return{row:a.row,column:a.column}}(e,{row:this.row,column:this.column},this.$insertRight);this.setPosition(t.row,t.column,!0)}},e.prototype.setPosition=function(e,t,n){var i;if(i=n?{row:e,column:t}:this.$clipPositionToDocument(e,t),this.row!=i.row||this.column!=i.column){var o={row:this.row,column:this.column};this.row=i.row,this.column=i.column,this._signal("change",{old:o,value:i})}},e.prototype.detach=function(){this.document.off("change",this.$onChange)},e.prototype.attach=function(e){this.document=e||this.document,this.document.on("change",this.$onChange)},e.prototype.$clipPositionToDocument=function(e,t){var n={};return e>=this.document.getLength()?(n.row=Math.max(0,this.document.getLength()-1),n.column=this.document.getLine(n.row).length):e<0?(n.row=0,n.column=0):(n.row=e,n.column=Math.min(this.document.getLine(n.row).length,Math.max(0,t))),t<0&&(n.column=0),n},e}();function s(e,t,n){var i=n?e.column<=t.column:e.column<t.column;return e.row<t.row||e.row==t.row&&i}r.prototype.$insertRight=!1,i.implement(r.prototype,o),t.Anchor=r})),ace.define("ace/document",[],(function(e,t,n){"use strict";var i=e("./lib/oop"),o=e("./apply_delta").applyDelta,r=e("./lib/event_emitter").EventEmitter,s=e("./range").Range,a=e("./anchor").Anchor,l=function(){function e(e){this.$lines=[""],0===e.length?this.$lines=[""]:Array.isArray(e)?this.insertMergedLines({row:0,column:0},e):this.insert({row:0,column:0},e)}return e.prototype.setValue=function(e){var t=this.getLength()-1;this.remove(new s(0,0,t,this.getLine(t).length)),this.insert({row:0,column:0},e||"")},e.prototype.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},e.prototype.createAnchor=function(e,t){return new a(this,e,t)},e.prototype.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n",this._signal("changeNewLineMode")},e.prototype.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},e.prototype.setNewLineMode=function(e){this.$newLineMode!==e&&(this.$newLineMode=e,this._signal("changeNewLineMode"))},e.prototype.getNewLineMode=function(){return this.$newLineMode},e.prototype.isNewLine=function(e){return"\r\n"==e||"\r"==e||"\n"==e},e.prototype.getLine=function(e){return this.$lines[e]||""},e.prototype.getLines=function(e,t){return this.$lines.slice(e,t+1)},e.prototype.getAllLines=function(){return this.getLines(0,this.getLength())},e.prototype.getLength=function(){return this.$lines.length},e.prototype.getTextRange=function(e){return this.getLinesForRange(e).join(this.getNewLineCharacter())},e.prototype.getLinesForRange=function(e){var t;if(e.start.row===e.end.row)t=[this.getLine(e.start.row).substring(e.start.column,e.end.column)];else{(t=this.getLines(e.start.row,e.end.row))[0]=(t[0]||"").substring(e.start.column);var n=t.length-1;e.end.row-e.start.row==n&&(t[n]=t[n].substring(0,e.end.column))}return t},e.prototype.insertLines=function(e,t){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(e,t)},e.prototype.removeLines=function(e,t){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(e,t)},e.prototype.insertNewLine=function(e){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(e,["",""])},e.prototype.insert=function(e,t){return this.getLength()<=1&&this.$detectNewLine(t),this.insertMergedLines(e,this.$split(t))},e.prototype.insertInLine=function(e,t){var n=this.clippedPos(e.row,e.column),i=this.pos(e.row,e.column+t.length);return this.applyDelta({start:n,end:i,action:"insert",lines:[t]},!0),this.clonePos(i)},e.prototype.clippedPos=function(e,t){var n=this.getLength();void 0===e?e=n:e<0?e=0:e>=n&&(e=n-1,t=void 0);var i=this.getLine(e);return null==t&&(t=i.length),{row:e,column:t=Math.min(Math.max(t,0),i.length)}},e.prototype.clonePos=function(e){return{row:e.row,column:e.column}},e.prototype.pos=function(e,t){return{row:e,column:t}},e.prototype.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):(e.row=Math.max(0,e.row),e.column=Math.min(Math.max(e.column,0),this.getLine(e.row).length)),e},e.prototype.insertFullLines=function(e,t){var n=0;(e=Math.min(Math.max(e,0),this.getLength()))<this.getLength()?(t=t.concat([""]),n=0):(t=[""].concat(t),e--,n=this.$lines[e].length),this.insertMergedLines({row:e,column:n},t)},e.prototype.insertMergedLines=function(e,t){var n=this.clippedPos(e.row,e.column),i={row:n.row+t.length-1,column:(1==t.length?n.column:0)+t[t.length-1].length};return this.applyDelta({start:n,end:i,action:"insert",lines:t}),this.clonePos(i)},e.prototype.remove=function(e){var t=this.clippedPos(e.start.row,e.start.column),n=this.clippedPos(e.end.row,e.end.column);return this.applyDelta({start:t,end:n,action:"remove",lines:this.getLinesForRange({start:t,end:n})}),this.clonePos(t)},e.prototype.removeInLine=function(e,t,n){var i=this.clippedPos(e,t),o=this.clippedPos(e,n);return this.applyDelta({start:i,end:o,action:"remove",lines:this.getLinesForRange({start:i,end:o})},!0),this.clonePos(i)},e.prototype.removeFullLines=function(e,t){e=Math.min(Math.max(0,e),this.getLength()-1);var n=(t=Math.min(Math.max(0,t),this.getLength()-1))==this.getLength()-1&&e>0,i=t<this.getLength()-1,o=n?e-1:e,r=n?this.getLine(o).length:0,a=i?t+1:t,l=i?0:this.getLine(a).length,c=new s(o,r,a,l),u=this.$lines.slice(e,t+1);return this.applyDelta({start:c.start,end:c.end,action:"remove",lines:this.getLinesForRange(c)}),u},e.prototype.removeNewLine=function(e){e<this.getLength()-1&&e>=0&&this.applyDelta({start:this.pos(e,this.getLine(e).length),end:this.pos(e+1,0),action:"remove",lines:["",""]})},e.prototype.replace=function(e,t){return e instanceof s||(e=s.fromPoints(e.start,e.end)),0===t.length&&e.isEmpty()?e.start:t==this.getTextRange(e)?e.end:(this.remove(e),t?this.insert(e.start,t):e.start)},e.prototype.applyDeltas=function(e){for(var t=0;t<e.length;t++)this.applyDelta(e[t])},e.prototype.revertDeltas=function(e){for(var t=e.length-1;t>=0;t--)this.revertDelta(e[t])},e.prototype.applyDelta=function(e,t){var n="insert"==e.action;(n?e.lines.length<=1&&!e.lines[0]:!s.comparePoints(e.start,e.end))||(n&&e.lines.length>2e4?this.$splitAndapplyLargeDelta(e,2e4):(o(this.$lines,e,t),this._signal("change",e)))},e.prototype.$safeApplyDelta=function(e){var t=this.$lines.length;("remove"==e.action&&e.start.row<t&&e.end.row<t||"insert"==e.action&&e.start.row<=t)&&this.applyDelta(e)},e.prototype.$splitAndapplyLargeDelta=function(e,t){for(var n=e.lines,i=n.length-t+1,o=e.start.row,r=e.start.column,s=0,a=0;s<i;s=a){a+=t-1;var l=n.slice(s,a);l.push(""),this.applyDelta({start:this.pos(o+s,r),end:this.pos(o+a,r=0),action:e.action,lines:l},!0)}e.lines=n.slice(s),e.start.row=o+s,e.start.column=r,this.applyDelta(e,!0)},e.prototype.revertDelta=function(e){this.$safeApplyDelta({start:this.clonePos(e.start),end:this.clonePos(e.end),action:"insert"==e.action?"remove":"insert",lines:e.lines.slice()})},e.prototype.indexToPosition=function(e,t){for(var n=this.$lines||this.getAllLines(),i=this.getNewLineCharacter().length,o=t||0,r=n.length;o<r;o++)if((e-=n[o].length+i)<0)return{row:o,column:e+n[o].length+i};return{row:r-1,column:e+n[r-1].length+i}},e.prototype.positionToIndex=function(e,t){for(var n=this.$lines||this.getAllLines(),i=this.getNewLineCharacter().length,o=0,r=Math.min(e.row,n.length),s=t||0;s<r;++s)o+=n[s].length+i;return o+e.column},e.prototype.$split=function(e){return e.split(/\r\n|\r|\n/)},e}();l.prototype.$autoNewLine="",l.prototype.$newLineMode="auto",i.implement(l.prototype,r),t.Document=l})),ace.define("ace/background_tokenizer",[],(function(e,t,n){"use strict";var i=e("./lib/oop"),o=e("./lib/event_emitter").EventEmitter,r=function(){function e(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var n=this;this.$worker=function(){if(n.running){for(var e=new Date,t=n.currentLine,i=-1,o=n.doc,r=t;n.lines[t];)t++;var s=o.getLength(),a=0;for(n.running=!1;t<s;){n.$tokenizeRow(t),i=t;do{t++}while(n.lines[t]);if(++a%5==0&&new Date-e>20){n.running=setTimeout(n.$worker,20);break}}n.currentLine=t,-1==i&&(i=t),r<=i&&n.fireUpdateEvent(r,i)}}}return e.prototype.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},e.prototype.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},e.prototype.fireUpdateEvent=function(e,t){var n={first:e,last:t};this._signal("update",{data:n})},e.prototype.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},e.prototype.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},e.prototype.$updateOnChange=function(e){var t=e.start.row,n=e.end.row-t;if(0===n)this.lines[t]=null;else if("remove"==e.action)this.lines.splice(t,n+1,null),this.states.splice(t,n+1,null);else{var i=Array(n+1);i.unshift(t,1),this.lines.splice.apply(this.lines,i),this.states.splice.apply(this.states,i)}this.currentLine=Math.min(t,this.currentLine,this.doc.getLength()),this.stop()},e.prototype.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},e.prototype.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},e.prototype.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},e.prototype.$tokenizeRow=function(e){var t=this.doc.getLine(e),n=this.states[e-1],i=this.tokenizer.getLineTokens(t,n,e);return this.states[e]+""!=i.state+""?(this.states[e]=i.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=i.tokens},e.prototype.cleanup=function(){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.removeAllListeners()},e}();i.implement(r.prototype,o),t.BackgroundTokenizer=r})),ace.define("ace/search_highlight",[],(function(e,t,n){"use strict";var i=e("./lib/lang"),o=e("./range").Range,r=function(){function e(e,t,n){void 0===n&&(n="text"),this.setRegexp(e),this.clazz=t,this.type=n}return e.prototype.setRegexp=function(e){this.regExp+""!=e+""&&(this.regExp=e,this.cache=[])},e.prototype.update=function(e,t,n,r){if(this.regExp)for(var s=r.firstRow,a=r.lastRow,l={},c=s;c<=a;c++){var u=this.cache[c];null==u&&((u=i.getMatchOffsets(n.getLine(c),this.regExp)).length>this.MAX_RANGES&&(u=u.slice(0,this.MAX_RANGES)),u=u.map((function(e){return new o(c,e.offset,c,e.offset+e.length)})),this.cache[c]=u.length?u:"");for(var h=u.length;h--;){var d=u[h].toScreenRange(n),p=d.toString();l[p]||(l[p]=!0,t.drawSingleLineMarker(e,d,this.clazz,r))}}},e}();r.prototype.MAX_RANGES=500,t.SearchHighlight=r})),ace.define("ace/undomanager",[],(function(e,t,n){"use strict";var i=function(){function e(){this.$keepRedoStack,this.$maxRev=0,this.$fromUndo=!1,this.$undoDepth=1/0,this.reset()}return e.prototype.addSession=function(e){this.$session=e},e.prototype.add=function(e,t,n){if(!this.$fromUndo&&e!=this.$lastDelta){if(this.$keepRedoStack||(this.$redoStack.length=0),!1===t||!this.lastDeltas){this.lastDeltas=[];var i=this.$undoStack.length;i>this.$undoDepth-1&&this.$undoStack.splice(0,i-this.$undoDepth+1),this.$undoStack.push(this.lastDeltas),e.id=this.$rev=++this.$maxRev}"remove"!=e.action&&"insert"!=e.action||(this.$lastDelta=e),this.lastDeltas.push(e)}},e.prototype.addSelection=function(e,t){this.selections.push({value:e,rev:t||this.$rev})},e.prototype.startNewGroup=function(){return this.lastDeltas=null,this.$rev},e.prototype.markIgnored=function(e,t){null==t&&(t=this.$rev+1);for(var n=this.$undoStack,i=n.length;i--;){var o=n[i][0];if(o.id<=e)break;o.id<t&&(o.ignore=!0)}this.lastDeltas=null},e.prototype.getSelection=function(e,t){for(var n=this.selections,i=n.length;i--;){var o=n[i];if(o.rev<e)return t&&(o=n[i+1]),o}},e.prototype.getRevision=function(){return this.$rev},e.prototype.getDeltas=function(e,t){null==t&&(t=this.$rev+1);for(var n=this.$undoStack,i=null,o=0,r=n.length;r--;){var s=n[r][0];if(s.id<t&&!i&&(i=r+1),s.id<=e){o=r+1;break}}return n.slice(o,i)},e.prototype.getChangedRanges=function(e,t){null==t&&(t=this.$rev+1)},e.prototype.getChangedLines=function(e,t){null==t&&(t=this.$rev+1)},e.prototype.undo=function(e,t){this.lastDeltas=null;var n=this.$undoStack;if(function(e,t){for(var n=t;n--;){var i=e[n];if(i&&!i[0].ignore){for(;n<t-1;){var o=u(e[n],e[n+1]);e[n]=o[0],e[n+1]=o[1],n++}return!0}}}(n,n.length)){e||(e=this.$session),this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length&&(this.$redoStack=[]),this.$fromUndo=!0;var i=n.pop(),o=null;return i&&(o=e.undoChanges(i,t),this.$redoStack.push(i),this.$syncRev()),this.$fromUndo=!1,o}},e.prototype.redo=function(e,t){if(this.lastDeltas=null,e||(e=this.$session),this.$fromUndo=!0,this.$redoStackBaseRev!=this.$rev){var n=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);!function(e,t){for(var n=0;n<t.length;n++)for(var i=t[n],o=0;o<i.length;o++)g(e,i[o])}(this.$redoStack,n),this.$redoStackBaseRev=this.$rev,this.$redoStack.forEach((function(e){e[0].id=++this.$maxRev}),this)}var i=this.$redoStack.pop(),o=null;return i&&(o=e.redoChanges(i,t),this.$undoStack.push(i),this.$syncRev()),this.$fromUndo=!1,o},e.prototype.$syncRev=function(){var e=this.$undoStack,t=e[e.length-1],n=t&&t[0].id||0;this.$redoStackBaseRev=n,this.$rev=n},e.prototype.reset=function(){this.lastDeltas=null,this.$lastDelta=null,this.$undoStack=[],this.$redoStack=[],this.$rev=0,this.mark=0,this.$redoStackBaseRev=this.$rev,this.selections=[]},e.prototype.canUndo=function(){return this.$undoStack.length>0},e.prototype.canRedo=function(){return this.$redoStack.length>0},e.prototype.bookmark=function(e){null==e&&(e=this.$rev),this.mark=e},e.prototype.isAtBookmark=function(){return this.$rev===this.mark},e.prototype.toJSON=function(){return{$redoStack:this.$redoStack,$undoStack:this.$undoStack}},e.prototype.fromJSON=function(e){this.reset(),this.$undoStack=e.$undoStack,this.$redoStack=e.$redoStack},e.prototype.$prettyPrint=function(e){return e?a(e):a(this.$undoStack)+"\n---\n"+a(this.$redoStack)},e}();i.prototype.hasUndo=i.prototype.canUndo,i.prototype.hasRedo=i.prototype.canRedo,i.prototype.isClean=i.prototype.isAtBookmark,i.prototype.markClean=i.prototype.bookmark;var o=e("./range").Range,r=o.comparePoints;o.comparePoints;function s(e){return{row:e.row,column:e.column}}function a(e){if(e=e||this,Array.isArray(e))return e.map(a).join("\n");var t="";return e.action?(t="insert"==e.action?"+":"-",t+="["+e.lines+"]"):e.value&&(t=Array.isArray(e.value)?e.value.map(l).join("\n"):l(e.value)),e.start&&(t+=l(e)),(e.id||e.rev)&&(t+="\t("+(e.id||e.rev)+")"),t}function l(e){return e.start.row+":"+e.start.column+"=>"+e.end.row+":"+e.end.column}function c(e,t){var n="insert"==e.action,i="insert"==t.action;if(n&&i)if(r(t.start,e.end)>=0)d(t,e,-1);else{if(!(r(t.start,e.start)<=0))return null;d(e,t,1)}else if(n&&!i)if(r(t.start,e.end)>=0)d(t,e,-1);else{if(!(r(t.end,e.start)<=0))return null;d(e,t,-1)}else if(!n&&i)if(r(t.start,e.start)>=0)d(t,e,1);else{if(!(r(t.start,e.start)<=0))return null;d(e,t,1)}else if(!n&&!i)if(r(t.start,e.start)>=0)d(t,e,1);else{if(!(r(t.end,e.start)<=0))return null;d(e,t,-1)}return[t,e]}function u(e,t){for(var n=e.length;n--;)for(var i=0;i<t.length;i++)if(!c(e[n],t[i])){for(;n<e.length;){for(;i--;)c(t[i],e[n]);i=t.length,n++}return[e,t]}return e.selectionBefore=t.selectionBefore=e.selectionAfter=t.selectionAfter=null,[t,e]}function h(e,t){var n="insert"==e.action,i="insert"==t.action;if(n&&i)r(e.start,t.start)<0?d(t,e,1):d(e,t,1);else if(n&&!i)r(e.start,t.end)>=0?d(e,t,-1):(r(e.start,t.start)<=0||d(e,o.fromPoints(t.start,e.start),-1),d(t,e,1));else if(!n&&i)r(t.start,e.end)>=0?d(t,e,-1):(r(t.start,e.start)<=0||d(t,o.fromPoints(e.start,t.start),-1),d(e,t,1));else if(!n&&!i)if(r(t.start,e.end)>=0)d(t,e,-1);else{var s,a;if(!(r(t.end,e.start)<=0))return r(e.start,t.start)<0&&(s=e,e=f(e,t.start)),r(e.end,t.end)>0&&(a=f(e,t.end)),p(t.end,e.start,e.end,-1),a&&!s&&(e.lines=a.lines,e.start=a.start,e.end=a.end,a=e),[t,s,a].filter(Boolean);d(e,t,-1)}return[t,e]}function d(e,t,n){p(e.start,t.start,t.end,n),p(e.end,t.start,t.end,n)}function p(e,t,n,i){e.row==(1==i?t:n).row&&(e.column+=i*(n.column-t.column)),e.row+=i*(n.row-t.row)}function f(e,t){var n=e.lines,i=e.end;e.end=s(t);var o=e.end.row-e.start.row,r=n.splice(o,n.length),a=o?t.column:t.column-e.start.column;return n.push(r[0].substring(0,a)),r[0]=r[0].substr(a),{start:s(t),end:i,lines:r,action:e.action}}function g(e,t){t=function(e){return{start:s(e.start),end:s(e.end),action:e.action,lines:e.lines.slice()}}(t);for(var n=e.length;n--;){for(var i=e[n],o=0;o<i.length;o++){var r=h(i[o],t);t=r[0],2!=r.length&&(r[2]?(i.splice(o+1,1,r[1],r[2]),o++):r[1]||(i.splice(o,1),o--))}i.length||e.splice(n,1)}return e}t.UndoManager=i})),ace.define("ace/edit_session/fold_line",[],(function(e,t,n){"use strict";var i=e("../range").Range,o=function(){function e(e,t){this.foldData=e,Array.isArray(t)?this.folds=t:t=this.folds=[t];var n=t[t.length-1];this.range=new i(t[0].start.row,t[0].start.column,n.end.row,n.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach((function(e){e.setFoldLine(this)}),this)}return e.prototype.shiftRow=function(e){this.start.row+=e,this.end.row+=e,this.folds.forEach((function(t){t.start.row+=e,t.end.row+=e}))},e.prototype.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(e),this.folds.sort((function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)})),this.range.compareEnd(e.start.row,e.start.column)>0?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},e.prototype.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},e.prototype.walk=function(e,t,n){var i,o,r=0,s=this.folds,a=!0;null==t&&(t=this.end.row,n=this.end.column);for(var l=0;l<s.length;l++){if(-1==(o=(i=s[l]).range.compareStart(t,n)))return void e(null,t,n,r,a);if(!e(null,i.start.row,i.start.column,r,a)&&e(i.placeholder,i.start.row,i.start.column,r)||0===o)return;a=!i.sameRow,r=i.end.column}e(null,t,n,r,a)},e.prototype.getNextFoldTo=function(e,t){for(var n,i,o=0;o<this.folds.length;o++){if(-1==(i=(n=this.folds[o]).range.compareEnd(e,t)))return{fold:n,kind:"after"};if(0===i)return{fold:n,kind:"inside"}}return null},e.prototype.addRemoveChars=function(e,t,n){var i,o,r=this.getNextFoldTo(e,t);if(r)if(i=r.fold,"inside"==r.kind&&i.start.column!=t&&i.start.row!=e)window.console&&window.console.log(e,t,i);else if(i.start.row==e){var s=(o=this.folds).indexOf(i);for(0===s&&(this.start.column+=n);s<o.length;s++){if((i=o[s]).start.column+=n,!i.sameRow)return;i.end.column+=n}this.end.column+=n}},e.prototype.split=function(t,n){var i=this.getNextFoldTo(t,n);if(!i||"inside"==i.kind)return null;var o=i.fold,r=this.folds,s=this.foldData,a=r.indexOf(o),l=r[a-1];this.end.row=l.end.row,this.end.column=l.end.column;var c=new e(s,r=r.splice(a,r.length-a));return s.splice(s.indexOf(this)+1,0,c),c},e.prototype.merge=function(e){for(var t=e.folds,n=0;n<t.length;n++)this.addFold(t[n]);var i=this.foldData;i.splice(i.indexOf(e),1)},e.prototype.toString=function(){var e=[this.range.toString()+": ["];return this.folds.forEach((function(t){e.push("  "+t.toString())})),e.push("]"),e.join("\n")},e.prototype.idxToPosition=function(e){for(var t=0,n=0;n<this.folds.length;n++){var i=this.folds[n];if((e-=i.start.column-t)<0)return{row:i.start.row,column:i.start.column+e};if((e-=i.placeholder.length)<0)return i.start;t=i.end.column}return{row:this.end.row,column:this.end.column+e}},e}();t.FoldLine=o})),ace.define("ace/range_list",[],(function(e,t,n){"use strict";var i=e("./range").Range.comparePoints,o=function(){function e(){this.ranges=[],this.$bias=1}return e.prototype.pointIndex=function(e,t,n){for(var o=this.ranges,r=n||0;r<o.length;r++){var s=o[r],a=i(e,s.end);if(!(a>0)){var l=i(e,s.start);return 0===a?t&&0!==l?-r-2:r:l>0||0===l&&!t?r:-r-1}}return-r-1},e.prototype.add=function(e){var t=!e.isEmpty(),n=this.pointIndex(e.start,t);n<0&&(n=-n-1);var i=this.pointIndex(e.end,t,n);return i<0?i=-i-1:i++,this.ranges.splice(n,i-n,e)},e.prototype.addList=function(e){for(var t=[],n=e.length;n--;)t.push.apply(t,this.add(e[n]));return t},e.prototype.substractPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges.splice(t,1)},e.prototype.merge=function(){for(var e,t=[],n=this.ranges,o=(n=n.sort((function(e,t){return i(e.start,t.start)})))[0],r=1;r<n.length;r++){e=o,o=n[r];var s=i(e.end,o.start);s<0||(0!=s||e.isEmpty()||o.isEmpty())&&(i(e.end,o.end)<0&&(e.end.row=o.end.row,e.end.column=o.end.column),n.splice(r,1),t.push(o),o=e,r--)}return this.ranges=n,t},e.prototype.contains=function(e,t){return this.pointIndex({row:e,column:t})>=0},e.prototype.containsPoint=function(e){return this.pointIndex(e)>=0},e.prototype.rangeAtPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges[t]},e.prototype.clipRows=function(e,t){var n=this.ranges;if(n[0].start.row>t||n[n.length-1].start.row<e)return[];var i=this.pointIndex({row:e,column:0});i<0&&(i=-i-1);var o=this.pointIndex({row:t,column:0},i);o<0&&(o=-o-1);for(var r=[],s=i;s<o;s++)r.push(n[s]);return r},e.prototype.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},e.prototype.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},e.prototype.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},e.prototype.$onChange=function(e){for(var t=e.start,n=e.end,i=t.row,o=n.row,r=this.ranges,s=0,a=r.length;s<a;s++){if((u=r[s]).end.row>=i)break}if("insert"==e.action)for(var l=o-i,c=-t.column+n.column;s<a;s++){if((u=r[s]).start.row>i)break;if(u.start.row==i&&u.start.column>=t.column&&(u.start.column==t.column&&this.$bias<=0||(u.start.column+=c,u.start.row+=l)),u.end.row==i&&u.end.column>=t.column){if(u.end.column==t.column&&this.$bias<0)continue;u.end.column==t.column&&c>0&&s<a-1&&u.end.column>u.start.column&&u.end.column==r[s+1].start.column&&(u.end.column-=c),u.end.column+=c,u.end.row+=l}}else for(l=i-o,c=t.column-n.column;s<a;s++){if((u=r[s]).start.row>o)break;u.end.row<o&&(i<u.end.row||i==u.end.row&&t.column<u.end.column)?(u.end.row=i,u.end.column=t.column):u.end.row==o?u.end.column<=n.column?(l||u.end.column>t.column)&&(u.end.column=t.column,u.end.row=t.row):(u.end.column+=c,u.end.row+=l):u.end.row>o&&(u.end.row+=l),u.start.row<o&&(i<u.start.row||i==u.start.row&&t.column<u.start.column)?(u.start.row=i,u.start.column=t.column):u.start.row==o?u.start.column<=n.column?(l||u.start.column>t.column)&&(u.start.column=t.column,u.start.row=t.row):(u.start.column+=c,u.start.row+=l):u.start.row>o&&(u.start.row+=l)}if(0!=l&&s<a)for(;s<a;s++){var u;(u=r[s]).start.row+=l,u.end.row+=l}},e}();o.prototype.comparePoints=i,t.RangeList=o})),ace.define("ace/edit_session/fold",[],(function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=function(e){function t(t,n){var i=e.call(this)||this;return i.foldLine=null,i.placeholder=n,i.range=t,i.start=t.start,i.end=t.end,i.sameRow=t.start.row==t.end.row,i.subFolds=i.ranges=[],i}return o(t,e),t.prototype.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},t.prototype.setFoldLine=function(e){this.foldLine=e,this.subFolds.forEach((function(t){t.setFoldLine(e)}))},t.prototype.clone=function(){var e=new t(this.range.clone(),this.placeholder);return this.subFolds.forEach((function(t){e.subFolds.push(t.clone())})),e.collapseChildren=this.collapseChildren,e},t.prototype.addSubFold=function(e){if(!this.range.isEqual(e)){var t,n;t=e,n=this.start,s(t.start,n),s(t.end,n);for(var i=e.start.row,o=e.start.column,r=0,a=-1;r<this.subFolds.length&&1==(a=this.subFolds[r].range.compare(i,o));r++);var l=this.subFolds[r],c=0;if(0==a){if(l.range.containsRange(e))return l.addSubFold(e);c=1}i=e.range.end.row,o=e.range.end.column;var u=r;for(a=-1;u<this.subFolds.length&&1==(a=this.subFolds[u].range.compare(i,o));u++);0==a&&u++;for(var h=this.subFolds.splice(r,u-r,e),d=0==a?h.length-1:h.length,p=c;p<d;p++)e.addSubFold(h[p]);return e.setFoldLine(this.foldLine),e}},t.prototype.restoreRange=function(e){return function(e,t){a(e.start,t),a(e.end,t)}(e,this.start)},t}(e("../range_list").RangeList);function s(e,t){e.row-=t.row,0==e.row&&(e.column-=t.column)}function a(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row}t.Fold=r})),ace.define("ace/edit_session/folding",[],(function(e,t,n){var i=e("../range").Range,o=e("./fold_line").FoldLine,r=e("./fold").Fold,s=e("../token_iterator").TokenIterator,a=e("../mouse/mouse_event").MouseEvent;t.Folding=function(){this.getFoldAt=function(e,t,n){var i=this.getFoldLine(e);if(!i)return null;for(var o=i.folds,r=0;r<o.length;r++){var s=o[r].range;if(s.contains(e,t)){if(1==n&&s.isEnd(e,t)&&!s.isEmpty())continue;if(-1==n&&s.isStart(e,t)&&!s.isEmpty())continue;return o[r]}}},this.getFoldsInRange=function(e){var t=e.start,n=e.end,i=this.$foldData,o=[];t.column+=1,n.column-=1;for(var r=0;r<i.length;r++){var s=i[r].range.compareRange(e);if(2!=s){if(-2==s)break;for(var a=i[r].folds,l=0;l<a.length;l++){var c=a[l];if(-2==(s=c.range.compareRange(e)))break;if(2!=s){if(42==s)break;o.push(c)}}}}return t.column-=1,n.column+=1,o},this.getFoldsInRangeList=function(e){if(Array.isArray(e)){var t=[];e.forEach((function(e){t=t.concat(this.getFoldsInRange(e))}),this)}else t=this.getFoldsInRange(e);return t},this.getAllFolds=function(){for(var e=[],t=this.$foldData,n=0;n<t.length;n++)for(var i=0;i<t[n].folds.length;i++)e.push(t[n].folds[i]);return e},this.getFoldStringAt=function(e,t,n,i){if(!(i=i||this.getFoldLine(e)))return null;for(var o,r,s={end:{column:0}},a=0;a<i.folds.length;a++){var l=(r=i.folds[a]).range.compareEnd(e,t);if(-1==l){o=this.getLine(r.start.row).substring(s.end.column,r.start.column);break}if(0===l)return null;s=r}return o||(o=this.getLine(r.start.row).substring(s.end.column)),-1==n?o.substring(0,t-s.end.column):1==n?o.substring(t-s.end.column):o},this.getFoldLine=function(e,t){var n=this.$foldData,i=0;for(t&&(i=n.indexOf(t)),-1==i&&(i=0);i<n.length;i++){var o=n[i];if(o.start.row<=e&&o.end.row>=e)return o;if(o.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var n=this.$foldData,i=0;for(t&&(i=n.indexOf(t)),-1==i&&(i=0);i<n.length;i++){var o=n[i];if(o.end.row>=e)return o}return null},this.getFoldedRowCount=function(e,t){for(var n=this.$foldData,i=t-e+1,o=0;o<n.length;o++){var r=n[o],s=r.end.row,a=r.start.row;if(s>=t){a<t&&(a>=e?i-=t-a:i=0);break}s>=e&&(i-=a>=e?s-a:s-e+1)}return i},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort((function(e,t){return e.start.row-t.start.row})),e},this.addFold=function(e,t){var n,i=this.$foldData,s=!1;e instanceof r?n=e:(n=new r(t,e)).collapseChildren=t.collapseChildren,this.$clipRangeToDocument(n.range);var a=n.start.row,l=n.start.column,c=n.end.row,u=n.end.column,h=this.getFoldAt(a,l,1),d=this.getFoldAt(c,u,-1);if(h&&d==h)return h.addSubFold(n);h&&!h.range.isStart(a,l)&&this.removeFold(h),d&&!d.range.isEnd(c,u)&&this.removeFold(d);var p=this.getFoldsInRange(n.range);p.length>0&&(this.removeFolds(p),n.collapseChildren||p.forEach((function(e){n.addSubFold(e)})));for(var f=0;f<i.length;f++){var g=i[f];if(c==g.start.row){g.addFold(n),s=!0;break}if(a==g.end.row){if(g.addFold(n),s=!0,!n.sameRow){var m=i[f+1];if(m&&m.start.row==c){g.merge(m);break}}break}if(c<=g.start.row)break}return s||(g=this.$addFoldLine(new o(this.$foldData,n))),this.$useWrapMode?this.$updateWrapData(g.start.row,g.start.row):this.$updateRowLengthCache(g.start.row,g.start.row),this.$modified=!0,this._signal("changeFold",{data:n,action:"add"}),n},this.addFolds=function(e){e.forEach((function(e){this.addFold(e)}),this)},this.removeFold=function(e){var t=e.foldLine,n=t.start.row,i=t.end.row,o=this.$foldData,r=t.folds;if(1==r.length)o.splice(o.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))r.pop(),t.end.row=r[r.length-1].end.row,t.end.column=r[r.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))r.shift(),t.start.row=r[0].start.row,t.start.column=r[0].start.column;else if(e.sameRow)r.splice(r.indexOf(e),1);else{var s=t.split(e.start.row,e.start.column);(r=s.folds).shift(),s.start.row=r[0].start.row,s.start.column=r[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(n,i):this.$updateRowLengthCache(n,i)),this.$modified=!0,this._signal("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);t.forEach((function(e){this.removeFold(e)}),this),this.$modified=!0},this.expandFold=function(e){this.removeFold(e),e.subFolds.forEach((function(t){e.restoreRange(t),this.addFold(t)}),this),e.collapseChildren>0&&this.foldAll(e.start.row+1,e.end.row,e.collapseChildren-1),e.subFolds=[]},this.expandFolds=function(e){e.forEach((function(e){this.expandFold(e)}),this)},this.unfold=function(e,t){var n,o;if(null==e)n=new i(0,0,this.getLength(),0),null==t&&(t=!0);else if("number"==typeof e)n=new i(e,0,e,this.getLine(e).length);else if("row"in e)n=i.fromPoints(e,e);else{if(Array.isArray(e))return o=[],e.forEach((function(e){o=o.concat(this.unfold(e))}),this),o;n=e}for(var r=o=this.getFoldsInRangeList(n);1==o.length&&i.comparePoints(o[0].start,n.start)<0&&i.comparePoints(o[0].end,n.end)>0;)this.expandFolds(o),o=this.getFoldsInRangeList(n);if(0!=t?this.removeFolds(o):this.expandFolds(o),r.length)return r},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var n=this.getFoldLine(e,t);return n?n.end.row:e},this.getRowFoldStart=function(e,t){var n=this.getFoldLine(e,t);return n?n.start.row:e},this.getFoldDisplayLine=function(e,t,n,i,o){null==i&&(i=e.start.row),null==o&&(o=0),null==t&&(t=e.end.row),null==n&&(n=this.getLine(t).length);var r=this.doc,s="";return e.walk((function(e,t,n,a){if(!(t<i)){if(t==i){if(n<o)return;a=Math.max(o,a)}s+=null!=e?e:r.getLine(t).substring(a,n)}}),t,n),s},this.getDisplayLine=function(e,t,n,i){var o,r=this.getFoldLine(e);return r?this.getFoldDisplayLine(r,e,t,n,i):(o=this.doc.getLine(e)).substring(i||0,t||o.length)},this.$cloneFoldData=function(){var e=[];return e=this.$foldData.map((function(t){var n=t.folds.map((function(e){return e.clone()}));return new o(e,n)}))},this.toggleFold=function(e){var t,n,i=this.selection.getRange();if(i.isEmpty()){var o=i.start;if(t=this.getFoldAt(o.row,o.column))return void this.expandFold(t);(n=this.findMatchingBracket(o))?1==i.comparePoint(n)?i.end=n:(i.start=n,i.start.column++,i.end.column--):(n=this.findMatchingBracket({row:o.row,column:o.column+1}))?(1==i.comparePoint(n)?i.end=n:i.start=n,i.start.column++):i=this.getCommentFoldRange(o.row,o.column)||i}else{var r=this.getFoldsInRange(i);if(e&&r.length)return void this.expandFolds(r);1==r.length&&(t=r[0])}if(t||(t=this.getFoldAt(i.start.row,i.start.column)),t&&t.range.toString()==i.toString())this.expandFold(t);else{var s="...";if(!i.isMultiLine()){if((s=this.getTextRange(i)).length<4)return;s=s.trim().substring(0,2)+".."}this.addFold(s,i)}},this.getCommentFoldRange=function(e,t,n){var o=new s(this,e,t),r=o.getCurrentToken(),a=r&&r.type;if(r&&/^comment|string/.test(a)){"comment"==(a=a.match(/comment|string/)[0])&&(a+="|doc-start|\\.doc");var l=new RegExp(a),c=new i;if(1!=n){do{r=o.stepBackward()}while(r&&l.test(r.type)&&!/^comment.end/.test(r.type));r=o.stepForward()}if(c.start.row=o.getCurrentTokenRow(),c.start.column=o.getCurrentTokenColumn()+(/^comment.start/.test(r.type)?r.value.length:2),o=new s(this,e,t),-1!=n){var u=-1;do{if(r=o.stepForward(),-1==u){var h=this.getState(o.$row);l.test(h)||(u=o.$row)}else if(o.$row>u)break}while(r&&l.test(r.type)&&!/^comment.start/.test(r.type));r=o.stepBackward()}else r=o.getCurrentToken();return c.end.row=o.getCurrentTokenRow(),c.end.column=o.getCurrentTokenColumn(),/^comment.end/.test(r.type)||(c.end.column+=r.value.length-2),c}},this.foldAll=function(e,t,n,i){null==n&&(n=1e5);var o=this.foldWidgets;if(o){t=t||this.getLength();for(var r=e=e||0;r<t;r++)if(null==o[r]&&(o[r]=this.getFoldWidget(r)),"start"==o[r]&&(!i||i(r))){var s=this.getFoldWidgetRange(r);s&&s.isMultiLine()&&s.end.row<=t&&s.start.row>=e&&(r=s.end.row,s.collapseChildren=n,this.addFold("...",s))}}},this.foldToLevel=function(e){for(this.foldAll();e-- >0;)this.unfold(null,!1)},this.foldAllComments=function(){var e=this;this.foldAll(null,null,null,(function(t){for(var n=e.getTokens(t),i=0;i<n.length;i++){var o=n[i];if("text"!=o.type||!/^\s+$/.test(o.value))return!!/comment/.test(o.type)}}))},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=e){this.$foldStyle=e,"manual"==e&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)}},this.$setFolding=function(e){this.$foldMode!=e&&(this.$foldMode=e,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),e&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(e,t){var n=this.foldWidgets;if(!n||t&&n[e])return{};for(var i,o=e-1;o>=0;){var r=n[o];if(null==r&&(r=n[o]=this.getFoldWidget(o)),"start"==r){var s=this.getFoldWidgetRange(o);if(i||(i=s),s&&s.end.row>=e)break}o--}return{range:-1!==o&&s,firstRange:i}},this.onFoldWidgetClick=function(e,t){t instanceof a&&(t=t.domEvent);var n={children:t.shiftKey,all:t.ctrlKey||t.metaKey,siblings:t.altKey};if(!this.$toggleFoldWidget(e,n)){var i=t.target||t.srcElement;i&&/ace_fold-widget/.test(i.className)&&(i.className+=" ace_invalid")}},this.$toggleFoldWidget=function(e,t){if(this.getFoldWidget){var n=this.getFoldWidget(e),i=this.getLine(e),o="end"===n?-1:1,r=this.getFoldAt(e,-1===o?0:i.length,o);if(r)return t.children||t.all?this.removeFold(r):this.expandFold(r),r;var s=this.getFoldWidgetRange(e,!0);if(s&&!s.isMultiLine()&&(r=this.getFoldAt(s.start.row,s.start.column,1))&&s.isEqual(r.range))return this.removeFold(r),r;if(t.siblings){var a=this.getParentFoldRangeData(e);if(a.range)var l=a.range.start.row+1,c=a.range.end.row;this.foldAll(l,c,t.all?1e4:0)}else t.children?(c=s?s.end.row:this.getLength(),this.foldAll(e+1,c,t.all?1e4:0)):s&&(t.all&&(s.collapseChildren=1e4),this.addFold("...",s));return s}},this.toggleFoldWidget=function(e){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var n=this.$toggleFoldWidget(t,{});if(!n){var i=this.getParentFoldRangeData(t,!0);if(n=i.range||i.firstRange){t=n.start.row;var o=this.getFoldAt(t,this.getLine(t).length,1);o?this.removeFold(o):this.addFold("...",n)}}},this.updateFoldWidgets=function(e){var t=e.start.row,n=e.end.row-t;if(0===n)this.foldWidgets[t]=null;else if("remove"==e.action)this.foldWidgets.splice(t,n+1,null);else{var i=Array(n+1);i.unshift(t,1),this.foldWidgets.splice.apply(this.foldWidgets,i)}},this.tokenizerUpdateFoldWidgets=function(e){var t=e.data;t.first!=t.last&&this.foldWidgets.length>t.first&&this.foldWidgets.splice(t.first,this.foldWidgets.length)}}})),ace.define("ace/edit_session/bracket_match",[],(function(e,t,n){"use strict";var i=e("../token_iterator").TokenIterator,o=e("../range").Range;t.BracketMatch=function(){this.findMatchingBracket=function(e,t){if(0==e.column)return null;var n=t||this.getLine(e.row).charAt(e.column-1);if(""==n)return null;var i=n.match(/([\(\[\{])|([\)\]\}])/);return i?i[1]?this.$findClosingBracket(i[1],e):this.$findOpeningBracket(i[2],e):null},this.getBracketRange=function(e){var t,n=this.getLine(e.row),i=!0,r=n.charAt(e.column-1),s=r&&r.match(/([\(\[\{])|([\)\]\}])/);if(s||(r=n.charAt(e.column),e={row:e.row,column:e.column+1},s=r&&r.match(/([\(\[\{])|([\)\]\}])/),i=!1),!s)return null;if(s[1]){if(!(a=this.$findClosingBracket(s[1],e)))return null;t=o.fromPoints(e,a),i||(t.end.column++,t.start.column--),t.cursor=t.end}else{var a;if(!(a=this.$findOpeningBracket(s[2],e)))return null;t=o.fromPoints(a,e),i||(t.start.column++,t.end.column--),t.cursor=t.start}return t},this.getMatchingBracketRanges=function(e,t){var n=this.getLine(e.row),i=/([\(\[\{])|([\)\]\}])/,r=!t&&n.charAt(e.column-1),s=r&&r.match(i);if(s||(r=(void 0===t||t)&&n.charAt(e.column),e={row:e.row,column:e.column+1},s=r&&r.match(i)),!s)return null;var a=new o(e.row,e.column-1,e.row,e.column),l=s[1]?this.$findClosingBracket(s[1],e):this.$findOpeningBracket(s[2],e);return l?[a,new o(l.row,l.column,l.row,l.column+1)]:[a]},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{","<":">",">":"<"},this.$findOpeningBracket=function(e,t,n){var o=this.$brackets[e],r=1,s=new i(this,t.row,t.column),a=s.getCurrentToken();if(a||(a=s.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)").replace(/-close\b/,"-(close|open)")+")+"));for(var l=t.column-s.getCurrentTokenColumn()-2,c=a.value;;){for(;l>=0;){var u=c.charAt(l);if(u==o){if(0==(r-=1))return{row:s.getCurrentTokenRow(),column:l+s.getCurrentTokenColumn()}}else u==e&&(r+=1);l-=1}do{a=s.stepBackward()}while(a&&!n.test(a.type));if(null==a)break;l=(c=a.value).length-1}return null}},this.$findClosingBracket=function(e,t,n){var o=this.$brackets[e],r=1,s=new i(this,t.row,t.column),a=s.getCurrentToken();if(a||(a=s.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)").replace(/-open\b/,"-(close|open)")+")+"));for(var l=t.column-s.getCurrentTokenColumn();;){for(var c=a.value,u=c.length;l<u;){var h=c.charAt(l);if(h==o){if(0==(r-=1))return{row:s.getCurrentTokenRow(),column:l+s.getCurrentTokenColumn()}}else h==e&&(r+=1);l+=1}do{a=s.stepForward()}while(a&&!n.test(a.type));if(null==a)break;l=0}return null}},this.getMatchingTags=function(e){var t=new i(this,e.row,e.column),n=this.$findTagName(t);if(n)return"<"===t.stepBackward().value?this.$findClosingTag(t,n):this.$findOpeningTag(t,n)},this.$findTagName=function(e){var t=e.getCurrentToken(),n=!1,i=!1;if(t&&-1===t.type.indexOf("tag-name"))do{(t=i?e.stepBackward():e.stepForward())&&("/>"===t.value?i=!0:-1!==t.type.indexOf("tag-name")&&(n=!0))}while(t&&!n);return t},this.$findClosingTag=function(e,t){var n,i=t.value,r=t.value,s=0,a=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+1);t=e.stepForward();var l=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+t.value.length),c=!1;do{if(n=t,t=e.stepForward()){if(">"===t.value&&!c){var u=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+1);c=!0}if(-1!==t.type.indexOf("tag-name")){if(r===(i=t.value))if("<"===n.value)s++;else if("</"===n.value&&--s<0){e.stepBackward();var h=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+2);t=e.stepForward();var d=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+t.value.length);if(!(t=e.stepForward())||">"!==t.value)return;var p=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+1)}}else if(r===i&&"/>"===t.value&&--s<0)p=d=h=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+2),u=new o(l.end.row,l.end.column,l.end.row,l.end.column+1)}}while(t&&s>=0);if(a&&u&&h&&p&&l&&d)return{openTag:new o(a.start.row,a.start.column,u.end.row,u.end.column),closeTag:new o(h.start.row,h.start.column,p.end.row,p.end.column),openTagName:l,closeTagName:d}},this.$findOpeningTag=function(e,t){var n=e.getCurrentToken(),i=t.value,r=0,s=e.getCurrentTokenRow(),a=e.getCurrentTokenColumn(),l=a+2,c=new o(s,a,s,l);e.stepForward();var u=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+t.value.length);if((t=e.stepForward())&&">"===t.value){var h=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+1);e.stepBackward(),e.stepBackward();do{if(t=n,s=e.getCurrentTokenRow(),l=(a=e.getCurrentTokenColumn())+t.value.length,n=e.stepBackward(),t)if(-1!==t.type.indexOf("tag-name")){if(i===t.value)if("<"===n.value){if(++r>0){var d=new o(s,a,s,l),p=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+1);do{t=e.stepForward()}while(t&&">"!==t.value);var f=new o(e.getCurrentTokenRow(),e.getCurrentTokenColumn(),e.getCurrentTokenRow(),e.getCurrentTokenColumn()+1)}}else"</"===n.value&&r--}else if("/>"===t.value){for(var g=0,m=n;m;){if(-1!==m.type.indexOf("tag-name")&&m.value===i){r--;break}if("<"===m.value)break;m=e.stepBackward(),g++}for(var y=0;y<g;y++)e.stepForward()}}while(n&&r<=0);return p&&f&&c&&h&&d&&u?{openTag:new o(p.start.row,p.start.column,f.end.row,f.end.column),closeTag:new o(c.start.row,c.start.column,h.end.row,h.end.column),openTagName:d,closeTagName:u}:void 0}}}})),ace.define("ace/edit_session",[],(function(e,t,n){"use strict";var i=e("./lib/oop"),o=e("./lib/lang"),r=e("./bidihandler").BidiHandler,s=e("./config"),a=e("./lib/event_emitter").EventEmitter,l=e("./selection").Selection,c=e("./mode/text").Mode,u=e("./range").Range,h=e("./document").Document,d=e("./background_tokenizer").BackgroundTokenizer,p=e("./search_highlight").SearchHighlight,f=e("./undomanager").UndoManager,g=function(){function e(t,n){this.doc,this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++e.$uid,this.$foldData.toString=function(){return this.join("\n")},this.bgTokenizer=new d((new c).getTokenizer(),this);var i=this;this.bgTokenizer.on("update",(function(e){i._signal("tokenizerUpdate",e)})),this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof t&&t.getLine||(t=new h(t)),this.setDocument(t),this.selection=new l(this),this.$bidiHandler=new r(this),s.resetOptions(this),this.setMode(n),s._signal("session",this),this.destroyed=!1}return e.prototype.setDocument=function(e){this.doc&&this.doc.off("change",this.$onChange),this.doc=e,e.on("change",this.$onChange,!0),this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},e.prototype.getDocument=function(){return this.doc},e.prototype.$resetRowCache=function(e){if(!e)return this.$docRowCache=[],void(this.$screenRowCache=[]);var t=this.$docRowCache.length,n=this.$getRowCacheIndex(this.$docRowCache,e)+1;t>n&&(this.$docRowCache.splice(n,t),this.$screenRowCache.splice(n,t))},e.prototype.$getRowCacheIndex=function(e,t){for(var n=0,i=e.length-1;n<=i;){var o=n+i>>1,r=e[o];if(t>r)n=o+1;else{if(!(t<r))return o;i=o-1}}return n-1},e.prototype.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.destroyed||this.bgTokenizer.start(0)},e.prototype.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},e.prototype.onChange=function(e){this.$modified=!0,this.$bidiHandler.onChange(e),this.$resetRowCache(e.start.row);var t=this.$updateInternalDataOnChange(e);!this.$fromUndo&&this.$undoManager&&(t&&t.length&&(this.$undoManager.add({action:"removeFolds",folds:t},this.mergeUndoDeltas),this.mergeUndoDeltas=!0),this.$undoManager.add(e,this.mergeUndoDeltas),this.mergeUndoDeltas=!0,this.$informUndoManager.schedule()),this.bgTokenizer.$updateOnChange(e),this._signal("change",e)},e.prototype.setValue=function(e){this.doc.setValue(e),this.selection.moveTo(0,0),this.$resetRowCache(0),this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},e.fromJSON=function(t){"string"==typeof t&&(t=JSON.parse(t));var n=new f;n.$undoStack=t.history.undo,n.$redoStack=t.history.redo,n.mark=t.history.mark,n.$rev=t.history.rev;var i=new e(t.value);return t.folds.forEach((function(e){i.addFold("...",u.fromPoints(e.start,e.end))})),i.setAnnotations(t.annotations),i.setBreakpoints(t.breakpoints),i.setMode(t.mode),i.setScrollLeft(t.scrollLeft),i.setScrollTop(t.scrollTop),i.setUndoManager(n),i.selection.fromJSON(t.selection),i},e.prototype.toJSON=function(){return{annotations:this.$annotations,breakpoints:this.$breakpoints,folds:this.getAllFolds().map((function(e){return e.range})),history:this.getUndoManager(),mode:this.$mode.$id,scrollLeft:this.$scrollLeft,scrollTop:this.$scrollTop,selection:this.selection.toJSON(),value:this.doc.getValue()}},e.prototype.toString=function(){return this.doc.getValue()},e.prototype.getSelection=function(){return this.selection},e.prototype.getState=function(e){return this.bgTokenizer.getState(e)},e.prototype.getTokens=function(e){return this.bgTokenizer.getTokens(e)},e.prototype.getTokenAt=function(e,t){var n,i=this.bgTokenizer.getTokens(e),o=0;if(null==t){var r=i.length-1;o=this.getLine(e).length}else for(r=0;r<i.length&&!((o+=i[r].value.length)>=t);r++);return(n=i[r])?(n.index=r,n.start=o-n.value.length,n):null},e.prototype.setUndoManager=function(e){if(this.$undoManager=e,this.$informUndoManager&&this.$informUndoManager.cancel(),e){var t=this;e.addSession(this),this.$syncInformUndoManager=function(){t.$informUndoManager.cancel(),t.mergeUndoDeltas=!1},this.$informUndoManager=o.delayedCall(this.$syncInformUndoManager)}else this.$syncInformUndoManager=function(){}},e.prototype.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},e.prototype.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},e.prototype.getTabString=function(){return this.getUseSoftTabs()?o.stringRepeat(" ",this.getTabSize()):"\t"},e.prototype.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},e.prototype.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},e.prototype.setTabSize=function(e){this.setOption("tabSize",e)},e.prototype.getTabSize=function(){return this.$tabSize},e.prototype.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize==0},e.prototype.setNavigateWithinSoftTabs=function(e){this.setOption("navigateWithinSoftTabs",e)},e.prototype.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},e.prototype.setOverwrite=function(e){this.setOption("overwrite",e)},e.prototype.getOverwrite=function(){return this.$overwrite},e.prototype.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},e.prototype.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._signal("changeBreakpoint",{})},e.prototype.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._signal("changeBreakpoint",{})},e.prototype.getBreakpoints=function(){return this.$breakpoints},e.prototype.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._signal("changeBreakpoint",{})},e.prototype.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},e.prototype.setBreakpoint=function(e,t){void 0===t&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},e.prototype.clearBreakpoint=function(e){delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},e.prototype.addMarker=function(e,t,n,i){var o=this.$markerId++,r={range:e,type:n||"line",renderer:"function"==typeof n?n:null,clazz:t,inFront:!!i,id:o};return i?(this.$frontMarkers[o]=r,this._signal("changeFrontMarker")):(this.$backMarkers[o]=r,this._signal("changeBackMarker")),o},e.prototype.addDynamicMarker=function(e,t){if(e.update){var n=this.$markerId++;return e.id=n,e.inFront=!!t,t?(this.$frontMarkers[n]=e,this._signal("changeFrontMarker")):(this.$backMarkers[n]=e,this._signal("changeBackMarker")),e}},e.prototype.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];t&&(delete(t.inFront?this.$frontMarkers:this.$backMarkers)[e],this._signal(t.inFront?"changeFrontMarker":"changeBackMarker"))},e.prototype.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},e.prototype.highlight=function(e){if(!this.$searchHighlight){var t=new p(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},e.prototype.highlightLines=function(e,t,n,i){"number"!=typeof t&&(n=t,t=e),n||(n="ace_step");var o=new u(e,0,t,1/0);return o.id=this.addMarker(o,n,"fullLine",i),o},e.prototype.setAnnotations=function(e){this.$annotations=e,this._signal("changeAnnotation",{})},e.prototype.getAnnotations=function(){return this.$annotations||[]},e.prototype.clearAnnotations=function(){this.setAnnotations([])},e.prototype.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);this.$autoNewLine=t?t[1]:"\n"},e.prototype.getWordRange=function(e,t){var n=this.getLine(e),i=!1;if(t>0&&(i=!!n.charAt(t-1).match(this.tokenRe)),i||(i=!!n.charAt(t).match(this.tokenRe)),i)var o=this.tokenRe;else if(/^\s+$/.test(n.slice(t-1,t+1)))o=/\s/;else o=this.nonTokenRe;var r=t;if(r>0){do{r--}while(r>=0&&n.charAt(r).match(o));r++}for(var s=t;s<n.length&&n.charAt(s).match(o);)s++;return new u(e,r,e,s)},e.prototype.getAWordRange=function(e,t){for(var n=this.getWordRange(e,t),i=this.getLine(n.end.row);i.charAt(n.end.column).match(/[ \t]/);)n.end.column+=1;return n},e.prototype.setNewLineMode=function(e){this.doc.setNewLineMode(e)},e.prototype.getNewLineMode=function(){return this.doc.getNewLineMode()},e.prototype.setUseWorker=function(e){this.setOption("useWorker",e)},e.prototype.getUseWorker=function(){return this.$useWorker},e.prototype.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._signal("tokenizerUpdate",e)},e.prototype.setMode=function(e,t){if(e&&"object"==typeof e){if(e.getTokenizer)return this.$onChangeMode(e);var n=e,i=n.path}else i=e||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new c),this.$modes[i]&&!n)return this.$onChangeMode(this.$modes[i]),void(t&&t());this.$modeId=i,s.loadModule(["mode",i],function(e){if(this.$modeId!==i)return t&&t();this.$modes[i]&&!n?this.$onChangeMode(this.$modes[i]):e&&e.Mode&&(e=new e.Mode(n),n||(this.$modes[i]=e,e.$id=i),this.$onChangeMode(e)),t&&t()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},e.prototype.$onChangeMode=function(e,t){if(t||(this.$modeId=e.$id),this.$mode!==e){var n=this.$mode;this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var i=e.getTokenizer();if(void 0!==i.on){var o=this.onReloadTokenizer.bind(this);i.on("update",o)}this.bgTokenizer.setTokenizer(i),this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(e.attachToSession&&e.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(e.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode",{oldMode:n,mode:e}))}},e.prototype.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},e.prototype.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){s.warn("Could not load worker",e),this.$worker=null}},e.prototype.getMode=function(){return this.$mode},e.prototype.setScrollTop=function(e){this.$scrollTop===e||isNaN(e)||(this.$scrollTop=e,this._signal("changeScrollTop",e))},e.prototype.getScrollTop=function(){return this.$scrollTop},e.prototype.setScrollLeft=function(e){this.$scrollLeft===e||isNaN(e)||(this.$scrollLeft=e,this._signal("changeScrollLeft",e))},e.prototype.getScrollLeft=function(){return this.$scrollLeft},e.prototype.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},e.prototype.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var e=0;return this.lineWidgets.forEach((function(t){t&&t.screenWidth>e&&(e=t.screenWidth)})),this.lineWidgetWidth=e},e.prototype.$computeWidth=function(e){if(this.$modified||e){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var t=this.doc.getAllLines(),n=this.$rowLengthCache,i=0,o=0,r=this.$foldData[o],s=r?r.start.row:1/0,a=t.length,l=0;l<a;l++){if(l>s){if((l=r.end.row+1)>=a)break;s=(r=this.$foldData[o++])?r.start.row:1/0}null==n[l]&&(n[l]=this.$getStringScreenWidth(t[l])[0]),n[l]>i&&(i=n[l])}this.screenWidth=i}},e.prototype.getLine=function(e){return this.doc.getLine(e)},e.prototype.getLines=function(e,t){return this.doc.getLines(e,t)},e.prototype.getLength=function(){return this.doc.getLength()},e.prototype.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},e.prototype.insert=function(e,t){return this.doc.insert(e,t)},e.prototype.remove=function(e){return this.doc.remove(e)},e.prototype.removeFullLines=function(e,t){return this.doc.removeFullLines(e,t)},e.prototype.undoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var n=e.length-1;-1!=n;n--){var i=e[n];"insert"==i.action||"remove"==i.action?this.doc.revertDelta(i):i.folds&&this.addFolds(i.folds)}!t&&this.$undoSelect&&(e.selectionBefore?this.selection.fromJSON(e.selectionBefore):this.selection.setRange(this.$getUndoSelection(e,!0))),this.$fromUndo=!1}},e.prototype.redoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var n=0;n<e.length;n++){var i=e[n];"insert"!=i.action&&"remove"!=i.action||this.doc.$safeApplyDelta(i)}!t&&this.$undoSelect&&(e.selectionAfter?this.selection.fromJSON(e.selectionAfter):this.selection.setRange(this.$getUndoSelection(e,!1))),this.$fromUndo=!1}},e.prototype.setUndoSelect=function(e){this.$undoSelect=e},e.prototype.$getUndoSelection=function(e,t){function n(e){return t?"insert"!==e.action:"insert"===e.action}for(var i,o,r=0;r<e.length;r++){var s=e[r];s.start&&(i?n(s)?(o=s.start,-1==i.compare(o.row,o.column)&&i.setStart(o),o=s.end,1==i.compare(o.row,o.column)&&i.setEnd(o)):(o=s.start,-1==i.compare(o.row,o.column)&&(i=u.fromPoints(s.start,s.start))):i=n(s)?u.fromPoints(s.start,s.end):u.fromPoints(s.start,s.start))}return i},e.prototype.replace=function(e,t){return this.doc.replace(e,t)},e.prototype.moveText=function(e,t,n){var i=this.getTextRange(e),o=this.getFoldsInRange(e),r=u.fromPoints(t,t);if(!n){this.remove(e);var s=e.start.row-e.end.row;(c=s?-e.end.column:e.start.column-e.end.column)&&(r.start.row==e.end.row&&r.start.column>e.end.column&&(r.start.column+=c),r.end.row==e.end.row&&r.end.column>e.end.column&&(r.end.column+=c)),s&&r.start.row>=e.end.row&&(r.start.row+=s,r.end.row+=s)}if(r.end=this.insert(r.start,i),o.length){var a=e.start,l=r.start,c=(s=l.row-a.row,l.column-a.column);this.addFolds(o.map((function(e){return(e=e.clone()).start.row==a.row&&(e.start.column+=c),e.end.row==a.row&&(e.end.column+=c),e.start.row+=s,e.end.row+=s,e})))}return r},e.prototype.indentRows=function(e,t,n){n=n.replace(/\t/g,this.getTabString());for(var i=e;i<=t;i++)this.doc.insertInLine({row:i,column:0},n)},e.prototype.outdentRows=function(e){for(var t=e.collapseRows(),n=new u(0,0,0,0),i=this.getTabSize(),o=t.start.row;o<=t.end.row;++o){var r=this.getLine(o);n.start.row=o,n.end.row=o;for(var s=0;s<i&&" "==r.charAt(s);++s);s<i&&"\t"==r.charAt(s)?(n.start.column=s,n.end.column=s+1):(n.start.column=0,n.end.column=s),this.remove(n)}},e.prototype.$moveLines=function(e,t,n){if(e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t),n<0){if((o=this.getRowFoldStart(e+n))<0)return 0;var i=o-e}else if(n>0){var o;if((o=this.getRowFoldEnd(t+n))>this.doc.getLength()-1)return 0;i=o-t}else{e=this.$clipRowToDocument(e);i=(t=this.$clipRowToDocument(t))-e+1}var r=new u(e,0,t,Number.MAX_VALUE),s=this.getFoldsInRange(r).map((function(e){return(e=e.clone()).start.row+=i,e.end.row+=i,e})),a=0==n?this.doc.getLines(e,t):this.doc.removeFullLines(e,t);return this.doc.insertFullLines(e+i,a),s.length&&this.addFolds(s),i},e.prototype.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},e.prototype.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},e.prototype.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},e.prototype.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},e.prototype.$clipColumnToRow=function(e,t){return t<0?0:Math.min(this.doc.getLine(e).length,t)},e.prototype.$clipPositionToDocument=function(e,t){if(t=Math.max(0,t),e<0)e=0,t=0;else{var n=this.doc.getLength();e>=n?(e=n-1,t=this.doc.getLine(n-1).length):t=Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},e.prototype.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},e.prototype.setUseWrapMode=function(e){if(e!=this.$useWrapMode){if(this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0),e){var t=this.getLength();this.$wrapData=Array(t),this.$updateWrapData(0,t-1)}this._signal("changeWrapMode")}},e.prototype.getUseWrapMode=function(){return this.$useWrapMode},e.prototype.setWrapLimitRange=function(e,t){this.$wrapLimitRange.min===e&&this.$wrapLimitRange.max===t||(this.$wrapLimitRange={min:e,max:t},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},e.prototype.adjustWrapLimit=function(e,t){var n=this.$wrapLimitRange;n.max<0&&(n={min:t,max:t});var i=this.$constrainWrapLimit(e,n.min,n.max);return i!=this.$wrapLimit&&i>1&&(this.$wrapLimit=i,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},e.prototype.$constrainWrapLimit=function(e,t,n){return t&&(e=Math.max(t,e)),n&&(e=Math.min(n,e)),e},e.prototype.getWrapLimit=function(){return this.$wrapLimit},e.prototype.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},e.prototype.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},e.prototype.$updateInternalDataOnChange=function(e){var t=this.$useWrapMode,n=e.action,i=e.start,o=e.end,r=i.row,s=o.row,a=s-r,l=null;if(this.$updating=!0,0!=a)if("remove"===n){this[t?"$wrapData":"$rowLengthCache"].splice(r,a);var c=this.$foldData;l=this.getFoldsInRange(e),this.removeFolds(l);var u=0;if(g=this.getFoldLine(o.row)){g.addRemoveChars(o.row,o.column,i.column-o.column),g.shiftRow(-a);var h=this.getFoldLine(r);h&&h!==g&&(h.merge(g),g=h),u=c.indexOf(g)+1}for(;u<c.length;u++){(g=c[u]).start.row>=o.row&&g.shiftRow(-a)}s=r}else{var d=Array(a);d.unshift(r,0);var p=t?this.$wrapData:this.$rowLengthCache;p.splice.apply(p,d);c=this.$foldData,u=0;if(g=this.getFoldLine(r)){var f=g.range.compareInside(i.row,i.column);0==f?(g=g.split(i.row,i.column))&&(g.shiftRow(a),g.addRemoveChars(s,0,o.column-i.column)):-1==f&&(g.addRemoveChars(r,0,o.column-i.column),g.shiftRow(a)),u=c.indexOf(g)+1}for(;u<c.length;u++){var g;(g=c[u]).start.row>=r&&g.shiftRow(a)}}else a=Math.abs(e.start.column-e.end.column),"remove"===n&&(l=this.getFoldsInRange(e),this.removeFolds(l),a=-a),(g=this.getFoldLine(r))&&g.addRemoveChars(r,i.column,a);return t&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,t?this.$updateWrapData(r,s):this.$updateRowLengthCache(r,s),l},e.prototype.$updateRowLengthCache=function(e,t){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},e.prototype.$updateWrapData=function(e,t){var n,i,o=this.doc.getAllLines(),r=this.getTabSize(),s=this.$wrapData,a=this.$wrapLimit,l=e;for(t=Math.min(t,o.length-1);l<=t;)(i=this.getFoldLine(l,i))?(n=[],i.walk(function(e,t,i,r){var s;if(null!=e){(s=this.$getDisplayTokens(e,n.length))[0]=v;for(var a=1;a<s.length;a++)s[a]=b}else s=this.$getDisplayTokens(o[t].substring(r,i),n.length);n=n.concat(s)}.bind(this),i.end.row,o[i.end.row].length+1),s[i.start.row]=this.$computeWrapSplits(n,a,r),l=i.end.row+1):(n=this.$getDisplayTokens(o[l]),s[l]=this.$computeWrapSplits(n,a,r),l++)},e.prototype.$computeWrapSplits=function(e,t,n){if(0==e.length)return[];var i=[],o=e.length,r=0,s=0,a=this.$wrapAsCode,l=this.$indentedSoftWrap,c=t<=Math.max(2*n,8)||!1===l?0:Math.floor(t/2);function u(t){for(var o=t-r,u=r;u<t;u++){var d=e[u];12!==d&&2!==d||(o-=1)}i.length||(h=function(){var t=0;if(0===c)return t;if(l)for(var i=0;i<e.length;i++){var o=e[i];if(o==w)t+=1;else{if(o!=_){if(o==S)continue;break}t+=n}}return a&&!1!==l&&(t+=n),Math.min(t,c)}(),i.indent=h),s+=o,i.push(s),r=t}for(var h=0;o-r>t-h;){var d=r+t-h;if(e[d-1]>=w&&e[d]>=w)u(d);else if(e[d]!=v&&e[d]!=b){for(var p=Math.max(d-(t-(t>>2)),r-1);d>p&&e[d]<v;)d--;if(a){for(;d>p&&e[d]<v;)d--;for(;d>p&&e[d]==x;)d--}else for(;d>p&&e[d]<w;)d--;d>p?u(++d):(e[d=r+t]==y&&d--,u(d-h))}else{for(;d!=r-1&&e[d]!=v;d--);if(d>r){u(d);continue}for(d=r+t;d<e.length&&e[d]==b;d++);if(d==e.length)break;u(d)}}return i},e.prototype.$getDisplayTokens=function(e,t){var n,i=[];t=t||0;for(var o=0;o<e.length;o++){var r=e.charCodeAt(o);if(9==r){n=this.getScreenTabSize(i.length+t),i.push(_);for(var s=1;s<n;s++)i.push(S)}else 32==r?i.push(w):r>39&&r<48||r>57&&r<64?i.push(x):r>=4352&&C(r)?i.push(m,y):i.push(m)}return i},e.prototype.$getStringScreenWidth=function(e,t,n){if(0==t)return[0,0];var i,o;for(null==t&&(t=1/0),n=n||0,o=0;o<e.length&&(9==(i=e.charCodeAt(o))?n+=this.getScreenTabSize(n):i>=4352&&C(i)?n+=2:n+=1,!(n>t));o++);return[n,o]},e.prototype.getRowLength=function(e){var t=1;return this.lineWidgets&&(t+=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0),this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+t:t},e.prototype.getRowLineCount=function(e){return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1:1},e.prototype.getRowWrapIndent=function(e){if(this.$useWrapMode){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE),n=this.$wrapData[t.row];return n.length&&n[0]<t.column?n.indent:0}return 0},e.prototype.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},e.prototype.getDocumentLastRowColumn=function(e,t){var n=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(n)},e.prototype.getDocumentLastRowColumnPosition=function(e,t){var n=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(n,Number.MAX_VALUE/10)},e.prototype.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:void 0},e.prototype.getScreenTabSize=function(e){return this.$tabSize-(e%this.$tabSize|0)},e.prototype.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},e.prototype.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},e.prototype.screenToDocumentPosition=function(e,t,n){if(e<0)return{row:0,column:0};var i,o,r=0,s=0,a=0,l=0,c=this.$screenRowCache,u=this.$getRowCacheIndex(c,e),h=c.length;if(h&&u>=0){a=c[u],r=this.$docRowCache[u];var d=e>c[h-1]}else d=!h;for(var p=this.getLength()-1,f=this.getNextFoldLine(r),g=f?f.start.row:1/0;a<=e&&!(a+(l=this.getRowLength(r))>e||r>=p);)a+=l,++r>g&&(r=f.end.row+1,g=(f=this.getNextFoldLine(r,f))?f.start.row:1/0),d&&(this.$docRowCache.push(r),this.$screenRowCache.push(a));if(f&&f.start.row<=r)i=this.getFoldDisplayLine(f),r=f.start.row;else{if(a+l<=e||r>p)return{row:p,column:this.getLine(p).length};i=this.getLine(r),f=null}var m=0,y=Math.floor(e-a);if(this.$useWrapMode){var v=this.$wrapData[r];v&&(o=v[y],y>0&&v.length&&(m=v.indent,s=v[y-1]||v[v.length-1],i=i.substring(s)))}return void 0!==n&&this.$bidiHandler.isBidiRow(a+y,r,y)&&(t=this.$bidiHandler.offsetToCol(n)),s+=this.$getStringScreenWidth(i,t-m)[1],this.$useWrapMode&&s>=o&&(s=o-1),f?f.idxToPosition(s):{row:r,column:s}},e.prototype.documentToScreenPosition=function(e,t){if(void 0===t)var n=this.$clipPositionToDocument(e.row,e.column);else n=this.$clipPositionToDocument(e,t);e=n.row,t=n.column;var i,o=0,r=null;(i=this.getFoldAt(e,t,1))&&(e=i.start.row,t=i.start.column);var s,a=0,l=this.$docRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&c>=0){a=l[c],o=this.$screenRowCache[c];var h=e>l[u-1]}else h=!u;for(var d=this.getNextFoldLine(a),p=d?d.start.row:1/0;a<e;){if(a>=p){if((s=d.end.row+1)>e)break;p=(d=this.getNextFoldLine(s,d))?d.start.row:1/0}else s=a+1;o+=this.getRowLength(a),a=s,h&&(this.$docRowCache.push(a),this.$screenRowCache.push(o))}var f="";d&&a>=p?(f=this.getFoldDisplayLine(d,e,t),r=d.start.row):(f=this.getLine(e).substring(0,t),r=e);var g=0;if(this.$useWrapMode){var m=this.$wrapData[r];if(m){for(var y=0;f.length>=m[y];)o++,y++;f=f.substring(m[y-1]||0,f.length),g=y>0?m.indent:0}}return this.lineWidgets&&this.lineWidgets[a]&&this.lineWidgets[a].rowsAbove&&(o+=this.lineWidgets[a].rowsAbove),{row:o,column:g+this.$getStringScreenWidth(f)[0]}},e.prototype.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},e.prototype.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},e.prototype.getScreenLength=function(){var e=0,t=null;if(this.$useWrapMode)for(var n=this.$wrapData.length,i=0,o=(a=0,(t=this.$foldData[a++])?t.start.row:1/0);i<n;){var r=this.$wrapData[i];e+=r?r.length+1:1,++i>o&&(i=t.end.row+1,o=(t=this.$foldData[a++])?t.start.row:1/0)}else{e=this.getLength();for(var s=this.$foldData,a=0;a<s.length;a++)e-=(t=s[a]).end.row-t.start.row}return this.lineWidgets&&(e+=this.$getWidgetScreenLength()),e},e.prototype.$setFontMetrics=function(e){this.$enableVarChar&&(this.$getStringScreenWidth=function(t,n,i){if(0===n)return[0,0];var o,r;for(n||(n=1/0),i=i||0,r=0;r<t.length&&!((i+="\t"===(o=t.charAt(r))?this.getScreenTabSize(i):e.getCharacterWidth(o))>n);r++);return[i,r]})},e.prototype.destroy=function(){this.destroyed||(this.bgTokenizer.setDocument(null),this.bgTokenizer.cleanup(),this.destroyed=!0),this.$stopWorker(),this.removeAllListeners(),this.doc&&this.doc.off("change",this.$onChange),this.selection.detach()},e}();g.$uid=0,g.prototype.$modes=s.$modes,g.prototype.getValue=g.prototype.toString,g.prototype.$defaultUndoManager={undo:function(){},redo:function(){},hasUndo:function(){},hasRedo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}},g.prototype.$overwrite=!1,g.prototype.$mode=null,g.prototype.$modeId=null,g.prototype.$scrollTop=0,g.prototype.$scrollLeft=0,g.prototype.$wrapLimit=80,g.prototype.$useWrapMode=!1,g.prototype.$wrapLimitRange={min:null,max:null},g.prototype.lineWidgets=null,g.prototype.isFullWidth=C,i.implement(g.prototype,a);var m=1,y=2,v=3,b=4,x=9,w=10,_=11,S=12;function C(e){return!(e<4352)&&(e>=4352&&e<=4447||e>=4515&&e<=4519||e>=4602&&e<=4607||e>=9001&&e<=9002||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12283||e>=12288&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12589||e>=12593&&e<=12686||e>=12688&&e<=12730||e>=12736&&e<=12771||e>=12784&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=13054||e>=13056&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=55216&&e<=55238||e>=55243&&e<=55291||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=65281&&e<=65376||e>=65504&&e<=65510)}e("./edit_session/folding").Folding.call(g.prototype),e("./edit_session/bracket_match").BracketMatch.call(g.prototype),s.defineOptions(g.prototype,"session",{wrap:{set:function(e){if(e&&"off"!=e?"free"==e?e=!0:"printMargin"==e?e=-1:"string"==typeof e&&(e=parseInt(e,10)||!1):e=!1,this.$wrap!=e)if(this.$wrap=e,e){var t="number"==typeof e?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(e){(e="auto"==e?"text"!=this.$mode.type:"text"!=e)!=this.$wrapAsCode&&(this.$wrapAsCode=e,this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0)))},initialValue:"auto"},indentedSoftWrap:{set:function(){this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0))},initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){(e=parseInt(e))>0&&this.$tabSize!==e&&(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},foldStyle:{set:function(e){this.setFoldStyle(e)},handlesSet:!0},overwrite:{set:function(e){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(e){this.setMode(e)},get:function(){return this.$modeId},handlesSet:!0}}),t.EditSession=g})),ace.define("ace/search",[],(function(e,t,n){"use strict";var i=e("./lib/lang"),o=e("./lib/oop"),r=e("./range").Range,s=function(){function e(){this.$options={}}return e.prototype.set=function(e){return o.mixin(this.$options,e),this},e.prototype.getOptions=function(){return i.copyObject(this.$options)},e.prototype.setOptions=function(e){this.$options=e},e.prototype.find=function(e){var t=this.$options,n=this.$matchIterator(e,t);if(!n)return!1;var i=null;return n.forEach((function(e,n,o,s){return i=new r(e,n,o,s),!(n==s&&t.start&&t.start.start&&0!=t.skipCurrent&&i.isEqual(t.start))||(i=null,!1)})),i},e.prototype.findAll=function(e){var t=this.$options;if(!t.needle)return[];this.$assembleRegExp(t);var n=t.range,o=n?e.getLines(n.start.row,n.end.row):e.doc.getAllLines(),s=[],a=t.re;if(t.$isMultiLine){var l,c=a.length,u=o.length-c;e:for(var h=a.offset||0;h<=u;h++){for(var d=0;d<c;d++)if(-1==o[h+d].search(a[d]))continue e;var p=o[h],f=o[h+c-1],g=p.length-p.match(a[0])[0].length,m=f.match(a[c-1])[0].length;l&&l.end.row===h&&l.end.column>g||(s.push(l=new r(h,g,h+c-1,m)),c>2&&(h=h+c-2))}}else for(var y=0;y<o.length;y++){var v=i.getMatchOffsets(o[y],a);for(d=0;d<v.length;d++){var b=v[d];s.push(new r(y,b.offset,y,b.offset+b.length))}}if(n){var x=n.start.column,w=n.end.column;for(y=0,d=s.length-1;y<d&&s[y].start.column<x&&0==s[y].start.row;)y++;for(var _=n.end.row-n.start.row;y<d&&s[d].end.column>w&&s[d].end.row==_;)d--;for(s=s.slice(y,d+1),y=0,d=s.length;y<d;y++)s[y].start.row+=n.start.row,s[y].end.row+=n.start.row}return s},e.prototype.replace=function(e,t){var n=this.$options,i=this.$assembleRegExp(n);if(n.$isMultiLine)return t;if(i){var o=i.exec(e);if(!o||o[0].length!=e.length)return null;if(t=e.replace(i,t),n.preserveCase){t=t.split("");for(var r=Math.min(e.length,e.length);r--;){var s=e[r];s&&s.toLowerCase()!=s?t[r]=t[r].toUpperCase():t[r]=t[r].toLowerCase()}t=t.join("")}return t}},e.prototype.$assembleRegExp=function(e,t){if(e.needle instanceof RegExp)return e.re=e.needle;var n=e.needle;if(!e.needle)return e.re=!1;e.regExp||(n=i.escapeRegExp(n));var o=e.caseSensitive?"gm":"gmi";try{new RegExp(n,"u"),e.$supportsUnicodeFlag=!0,o+="u"}catch(t){e.$supportsUnicodeFlag=!1}if(e.wholeWord&&(n=function(e,t){var n=i.supportsLookbehind();function o(e,i){return void 0===i&&(i=!0),(n&&t.$supportsUnicodeFlag?new RegExp("[\\p{L}\\p{N}_]","u"):new RegExp("\\w")).test(e)||t.regExp?n&&t.$supportsUnicodeFlag?i?"(?<=^|[^\\p{L}\\p{N}_])":"(?=[^\\p{L}\\p{N}_]|$)":"\\b":""}var r=Array.from(e),s=r[0],a=r[r.length-1];return o(s)+e+o(a,!1)}(n,e)),e.$isMultiLine=!t&&/[\n\r]/.test(n),e.$isMultiLine)return e.re=this.$assembleMultilineRegExp(n,o);try{var r=new RegExp(n,o)}catch(e){r=!1}return e.re=r},e.prototype.$assembleMultilineRegExp=function(e,t){for(var n=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),i=[],o=0;o<n.length;o++)try{i.push(new RegExp(n[o],t))}catch(e){return!1}return i},e.prototype.$matchIterator=function(e,t){var n=this.$assembleRegExp(t);if(!n)return!1;var o=1==t.backwards,r=0!=t.skipCurrent,s=n.unicode,a=t.range,l=t.start;l||(l=a?a[o?"end":"start"]:e.selection.getRange()),l.start&&(l=l[r!=o?"end":"start"]);var c=a?a.start.row:0,u=a?a.end.row:e.getLength()-1;if(o)var h=function(e){var n=l.row;if(!p(n,l.column,e)){for(n--;n>=c;n--)if(p(n,Number.MAX_VALUE,e))return;if(0!=t.wrap)for(n=u,c=l.row;n>=c;n--)if(p(n,Number.MAX_VALUE,e))return}};else h=function(e){var n=l.row;if(!p(n,l.column,e)){for(n+=1;n<=u;n++)if(p(n,0,e))return;if(0!=t.wrap)for(n=c,u=l.row;n<=u;n++)if(p(n,0,e))return}};if(t.$isMultiLine)var d=n.length,p=function(t,i,r){var s=o?t-d+1:t;if(!(s<0||s+d>e.getLength())){var a=e.getLine(s),l=a.search(n[0]);if(!(!o&&l<i||-1===l)){for(var c=1;c<d;c++)if(-1==(a=e.getLine(s+c)).search(n[c]))return;var u=a.match(n[d-1])[0].length;if(!(o&&u>i))return!!r(s,l,s+d-1,u)||void 0}}};else if(o)p=function(t,o,r){var a,l=e.getLine(t),c=[],u=0;for(n.lastIndex=0;a=n.exec(l);){var h=a[0].length;if(u=a.index,!h){if(u>=l.length)break;n.lastIndex=u+=i.skipEmptyMatch(l,u,s)}if(a.index+h>o)break;c.push(a.index,h)}for(var d=c.length-1;d>=0;d-=2){var p=c[d-1];if(r(t,p,t,p+(h=c[d])))return!0}};else p=function(t,o,r){var a,l,c=e.getLine(t);for(n.lastIndex=o;l=n.exec(c);){var u=l[0].length;if(r(t,a=l.index,t,a+u))return!0;if(!u&&(n.lastIndex=a+=i.skipEmptyMatch(c,a,s),a>=c.length))return!1}};return{forEach:h}},e}();t.Search=s})),ace.define("ace/keyboard/hash_handler",[],(function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=e("../lib/keys"),s=e("../lib/useragent"),a=r.KEY_MODS,l=function(){function e(e,t){this.$init(e,t,!1)}return e.prototype.$init=function(e,t,n){this.platform=t||(s.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(e),this.$singleCommand=n},e.prototype.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),this.commands[e.name]=e,e.bindKey&&this._buildKeyHash(e)},e.prototype.removeCommand=function(e,t){var n=e&&("string"==typeof e?e:e.name);e=this.commands[n],t||delete this.commands[n];var i=this.commandKeyBinding;for(var o in i){var r=i[o];if(r==e)delete i[o];else if(Array.isArray(r)){var s=r.indexOf(e);-1!=s&&(r.splice(s,1),1==r.length&&(i[o]=r[0]))}}},e.prototype.bindKey=function(e,t,n){if("object"==typeof e&&e&&(null==n&&(n=e.position),e=e[this.platform]),e)return"function"==typeof t?this.addCommand({exec:t,bindKey:e,name:t.name||e}):void e.split("|").forEach((function(e){var i="";if(-1!=e.indexOf(" ")){var o=e.split(/\s+/);e=o.pop(),o.forEach((function(e){var t=this.parseKeys(e),n=a[t.hashId]+t.key;i+=(i?" ":"")+n,this._addCommandToBinding(i,"chainKeys")}),this),i+=" "}var r=this.parseKeys(e),s=a[r.hashId]+r.key;this._addCommandToBinding(i+s,t,n)}),this)},e.prototype._addCommandToBinding=function(e,t,n){var i,o=this.commandKeyBinding;if(t)if(!o[e]||this.$singleCommand)o[e]=t;else{Array.isArray(o[e])?-1!=(i=o[e].indexOf(t))&&o[e].splice(i,1):o[e]=[o[e]],"number"!=typeof n&&(n=c(t));var r=o[e];for(i=0;i<r.length;i++){if(c(r[i])>n)break}r.splice(i,0,t)}else delete o[e]},e.prototype.addCommands=function(e){e&&Object.keys(e).forEach((function(t){var n=e[t];if(n){if("string"==typeof n)return this.bindKey(n,t);"function"==typeof n&&(n={exec:n}),"object"==typeof n&&(n.name||(n.name=t),this.addCommand(n))}}),this)},e.prototype.removeCommands=function(e){Object.keys(e).forEach((function(t){this.removeCommand(e[t])}),this)},e.prototype.bindKeys=function(e){Object.keys(e).forEach((function(t){this.bindKey(t,e[t])}),this)},e.prototype._buildKeyHash=function(e){this.bindKey(e.bindKey,e)},e.prototype.parseKeys=function(e){var t=e.toLowerCase().split(/[\-\+]([\-\+])?/).filter((function(e){return e})),n=t.pop(),i=r[n];if(r.FUNCTION_KEYS[i])n=r.FUNCTION_KEYS[i].toLowerCase();else{if(!t.length)return{key:n,hashId:-1};if(1==t.length&&"shift"==t[0])return{key:n.toUpperCase(),hashId:-1}}for(var o=0,s=t.length;s--;){var a=r.KEY_MODS[t[s]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+t[s]+" in "+e),!1;o|=a}return{key:n,hashId:o}},e.prototype.findKeyCommand=function(e,t){var n=a[e]+t;return this.commandKeyBinding[n]},e.prototype.handleKeyboard=function(e,t,n,i){if(!(i<0)){var o=a[t]+n,r=this.commandKeyBinding[o];return e.$keyChain&&(e.$keyChain+=" "+o,r=this.commandKeyBinding[e.$keyChain]||r),!r||"chainKeys"!=r&&"chainKeys"!=r[r.length-1]?(e.$keyChain&&(t&&4!=t||1!=n.length?(-1==t||i>0)&&(e.$keyChain=""):e.$keyChain=e.$keyChain.slice(0,-o.length-1)),{command:r}):(e.$keyChain=e.$keyChain||o,{command:"null"})}},e.prototype.getStatusText=function(e,t){return t.$keyChain||""},e}();function c(e){return"object"==typeof e&&e.bindKey&&e.bindKey.position||(e.isDefault?-100:0)}var u=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.$singleCommand=!0,i}return o(t,e),t}(l);u.call=function(e,t,n){l.prototype.$init.call(e,t,n,!0)},l.call=function(e,t,n){l.prototype.$init.call(e,t,n,!1)},t.HashHandler=u,t.MultiHashHandler=l})),ace.define("ace/commands/command_manager",[],(function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=e("../lib/oop"),s=e("../keyboard/hash_handler").MultiHashHandler,a=e("../lib/event_emitter").EventEmitter,l=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.byName=i.commands,i.setDefaultHandler("exec",(function(e){return e.args?e.command.exec(e.editor,e.args,e.event,!1):e.command.exec(e.editor,{},e.event,!0)})),i}return o(t,e),t.prototype.exec=function(e,t,n){if(Array.isArray(e)){for(var i=e.length;i--;)if(this.exec(e[i],t,n))return!0;return!1}if("string"==typeof e&&(e=this.commands[e]),!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;if(0!=this.$checkCommandState&&e.isAvailable&&!e.isAvailable(t))return!1;var o={editor:t,command:e,args:n};return o.returnValue=this._emit("exec",o),this._signal("afterExec",o),!1!==o.returnValue},t.prototype.toggleRecording=function(e){if(!this.$inReplay)return e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.off("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},t.prototype.replay=function(e){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(e);try{this.$inReplay=!0,this.macro.forEach((function(t){"string"==typeof t?this.exec(t,e):this.exec(t[0],e,t[1])}),this)}finally{this.$inReplay=!1}}},t.prototype.trimMacro=function(e){return e.map((function(e){return"string"!=typeof e[0]&&(e[0]=e[0].name),e[1]||(e=e[0]),e}))},t}(s);r.implement(l.prototype,a),t.CommandManager=l})),ace.define("ace/commands/default_commands",[],(function(e,t,n){"use strict";var i=e("../lib/lang"),o=e("../config"),r=e("../range").Range;function s(e,t){return{win:e,mac:t}}t.commands=[{name:"showSettingsMenu",description:"Show settings menu",bindKey:s("Ctrl-,","Command-,"),exec:function(e){o.loadModule("ace/ext/settings_menu",(function(t){t.init(e),e.showSettingsMenu()}))},readOnly:!0},{name:"goToNextError",description:"Go to next error",bindKey:s("Alt-E","F4"),exec:function(e){o.loadModule("ace/ext/error_marker",(function(t){t.showErrorMarker(e,1)}))},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",description:"Go to previous error",bindKey:s("Alt-Shift-E","Shift-F4"),exec:function(e){o.loadModule("ace/ext/error_marker",(function(t){t.showErrorMarker(e,-1)}))},scrollIntoView:"animate",readOnly:!0},{name:"selectall",description:"Select all",bindKey:s("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",description:"Center selection",bindKey:s(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",description:"Go to line...",bindKey:s("Ctrl-L","Command-L"),exec:function(e,t){"number"!=typeof t||isNaN(t)||e.gotoLine(t),e.prompt({$type:"gotoLine"})},readOnly:!0},{name:"fold",bindKey:s("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:s("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",description:"Toggle fold widget",bindKey:s("F2","F2"),exec:function(e){e.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",description:"Toggle parent fold widget",bindKey:s("Alt-F2","Alt-F2"),exec:function(e){e.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",description:"Fold all",bindKey:s(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldAllComments",description:"Fold all comments",bindKey:s(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAllComments()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",description:"Fold other",bindKey:s("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll(),e.session.unfold(e.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",description:"Unfold all",bindKey:s("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",description:"Find next",bindKey:s("Ctrl-K","Command-G"),exec:function(e){e.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",description:"Find previous",bindKey:s("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",description:"Select or find next",bindKey:s("Alt-K","Ctrl-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findNext()},readOnly:!0},{name:"selectOrFindPrevious",description:"Select or find previous",bindKey:s("Alt-Shift-K","Ctrl-Shift-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findPrevious()},readOnly:!0},{name:"find",description:"Find",bindKey:s("Ctrl-F","Command-F"),exec:function(e){o.loadModule("ace/ext/searchbox",(function(t){t.Search(e)}))},readOnly:!0},{name:"overwrite",description:"Overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",description:"Select to start",bindKey:s("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",description:"Go to start",bindKey:s("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",description:"Select up",bindKey:s("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",description:"Go line up",bindKey:s("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",description:"Select to end",bindKey:s("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",description:"Go to end",bindKey:s("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",description:"Select down",bindKey:s("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",description:"Go line down",bindKey:s("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",description:"Select word left",bindKey:s("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",description:"Go to word left",bindKey:s("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",description:"Select to line start",bindKey:s("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",description:"Go to line start",bindKey:s("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",description:"Select left",bindKey:s("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",description:"Go to left",bindKey:s("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",description:"Select word right",bindKey:s("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",description:"Go to word right",bindKey:s("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",description:"Select to line end",bindKey:s("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",description:"Go to line end",bindKey:s("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",description:"Select right",bindKey:s("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",description:"Go to right",bindKey:s("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",description:"Select page down",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",description:"Page down",bindKey:s(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",description:"Go to page down",bindKey:s("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",description:"Select page up",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",description:"Page up",bindKey:s(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",description:"Go to page up",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",description:"Scroll up",bindKey:s("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",description:"Scroll down",bindKey:s("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",description:"Select line start",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",description:"Select line end",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",description:"Toggle recording",bindKey:s("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",description:"Replay macro",bindKey:s("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",description:"Jump to matching",bindKey:s("Ctrl-\\|Ctrl-P","Command-\\"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",description:"Select to matching",bindKey:s("Ctrl-Shift-\\|Ctrl-Shift-P","Command-Shift-\\"),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",description:"Expand to matching",bindKey:s("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(e){e.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",description:"Pass keys to browser",bindKey:s(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",description:"Copy",exec:function(e){},readOnly:!0},{name:"cut",description:"Cut",exec:function(e){var t=e.$copyWithEmptySelection&&e.selection.isEmpty()?e.selection.getLineRange():e.selection.getRange();e._emit("cut",t),t.isEmpty()||e.session.remove(t),e.clearSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",description:"Paste",exec:function(e,t){e.$handlePaste(t)},scrollIntoView:"cursor"},{name:"removeline",description:"Remove line",bindKey:s("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",description:"Duplicate selection",bindKey:s("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",description:"Sort lines",bindKey:s("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",description:"Toggle comment",bindKey:s("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",description:"Toggle block comment",bindKey:s("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",description:"Modify number up",bindKey:s("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",description:"Modify number down",bindKey:s("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",description:"Replace",bindKey:s("Ctrl-H","Command-Option-F"),exec:function(e){o.loadModule("ace/ext/searchbox",(function(t){t.Search(e,!0)}))}},{name:"undo",description:"Undo",bindKey:s("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",description:"Redo",bindKey:s("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",description:"Copy lines up",bindKey:s("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",description:"Move lines up",bindKey:s("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",description:"Copy lines down",bindKey:s("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",description:"Move lines down",bindKey:s("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",description:"Delete",bindKey:s("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",description:"Backspace",bindKey:s("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",description:"Cut or delete",bindKey:s("Shift-Delete",null),exec:function(e){if(!e.selection.isEmpty())return!1;e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",description:"Remove to line start",bindKey:s("Alt-Backspace","Command-Backspace"),exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",description:"Remove to line end",bindKey:s("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",description:"Remove to line start hard",bindKey:s("Ctrl-Shift-Backspace",null),exec:function(e){var t=e.selection.getRange();t.start.column=0,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",description:"Remove to line end hard",bindKey:s("Ctrl-Shift-Delete",null),exec:function(e){var t=e.selection.getRange();t.end.column=Number.MAX_VALUE,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",description:"Remove word left",bindKey:s("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",description:"Remove word right",bindKey:s("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",description:"Outdent",bindKey:s("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",description:"Indent",bindKey:s("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",description:"Block outdent",bindKey:s("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",description:"Block indent",bindKey:s("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",description:"Insert string",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",description:"Insert text",exec:function(e,t){e.insert(i.stringRepeat(t.text||"",t.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",description:"Split line",bindKey:s(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",description:"Transpose letters",bindKey:s("Alt-Shift-X","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",description:"To uppercase",bindKey:s("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",description:"To lowercase",bindKey:s("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"autoindent",description:"Auto Indent",bindKey:s(null,null),exec:function(e){e.autoIndent()},scrollIntoView:"animate"},{name:"expandtoline",description:"Expand to line",bindKey:s("Ctrl-Shift-L","Command-Shift-L"),exec:function(e){var t=e.selection.getRange();t.start.column=t.end.column=0,t.end.row++,e.selection.setRange(t,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"openlink",bindKey:s("Ctrl+F3","F3"),exec:function(e){e.openLink()}},{name:"joinlines",description:"Join lines",bindKey:s(null,null),exec:function(e){for(var t=e.selection.isBackwards(),n=t?e.selection.getSelectionLead():e.selection.getSelectionAnchor(),o=t?e.selection.getSelectionAnchor():e.selection.getSelectionLead(),s=e.session.doc.getLine(n.row).length,a=e.session.doc.getTextRange(e.selection.getRange()).replace(/\n\s*/," ").length,l=e.session.doc.getLine(n.row),c=n.row+1;c<=o.row+1;c++){var u=i.stringTrimLeft(i.stringTrimRight(e.session.doc.getLine(c)));0!==u.length&&(u=" "+u),l+=u}o.row+1<e.session.doc.getLength()-1&&(l+=e.session.doc.getNewLineCharacter()),e.clearSelection(),e.session.doc.replace(new r(n.row,0,o.row+2,0),l),a>0?(e.selection.moveCursorTo(n.row,n.column),e.selection.selectTo(n.row,n.column+a)):(s=e.session.doc.getLine(n.row).length>s?s+1:s,e.selection.moveCursorTo(n.row,s))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",description:"Invert selection",bindKey:s(null,null),exec:function(e){var t=e.session.doc.getLength()-1,n=e.session.doc.getLine(t).length,i=e.selection.rangeList.ranges,o=[];i.length<1&&(i=[e.selection.getRange()]);for(var s=0;s<i.length;s++)s==i.length-1&&(i[s].end.row===t&&i[s].end.column===n||o.push(new r(i[s].end.row,i[s].end.column,t,n))),0===s?0===i[s].start.row&&0===i[s].start.column||o.push(new r(0,0,i[s].start.row,i[s].start.column)):o.push(new r(i[s-1].end.row,i[s-1].end.column,i[s].start.row,i[s].start.column));e.exitMultiSelectMode(),e.clearSelection();for(s=0;s<o.length;s++)e.selection.addRange(o[s],!1)},readOnly:!0,scrollIntoView:"none"},{name:"addLineAfter",description:"Add new line after the current line",exec:function(e){e.selection.clearSelection(),e.navigateLineEnd(),e.insert("\n")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"addLineBefore",description:"Add new line before the current line",exec:function(e){e.selection.clearSelection();var t=e.getCursorPosition();e.selection.moveTo(t.row-1,Number.MAX_VALUE),e.insert("\n"),0===t.row&&e.navigateUp()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"openCommandPallete",exec:function(e){console.warn("This is an obsolete command. Please use `openCommandPalette` instead."),e.prompt({$type:"commands"})},readOnly:!0},{name:"openCommandPalette",description:"Open command palette",bindKey:s("F1","F1"),exec:function(e){e.prompt({$type:"commands"})},readOnly:!0},{name:"modeSelect",description:"Change language mode...",bindKey:s(null,null),exec:function(e){e.prompt({$type:"modes"})},readOnly:!0}];for(var a=1;a<9;a++)t.commands.push({name:"foldToLevel"+a,description:"Fold To Level "+a,level:a,exec:function(e){e.session.foldToLevel(this.level)},scrollIntoView:"center",readOnly:!0})})),ace.define("ace/line_widgets",[],(function(e,t,n){"use strict";var i=e("./lib/dom"),o=function(){function e(e){this.session=e,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}return e.prototype.getRowLength=function(e){var t;return t=this.lineWidgets&&this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0,this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},e.prototype.$getWidgetScreenLength=function(){var e=0;return this.lineWidgets.forEach((function(t){t&&t.rowCount&&!t.hidden&&(e+=t.rowCount)})),e},e.prototype.$onChangeEditor=function(e){this.attach(e.editor)},e.prototype.attach=function(e){e&&e.widgetManager&&e.widgetManager!=this&&e.widgetManager.detach(),this.editor!=e&&(this.detach(),this.editor=e,e&&(e.widgetManager=this,e.renderer.on("beforeRender",this.measureWidgets),e.renderer.on("afterRender",this.renderWidgets)))},e.prototype.detach=function(e){var t=this.editor;if(t){this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var n=this.session.lineWidgets;n&&n.forEach((function(e){e&&e.el&&e.el.parentNode&&(e._inDocument=!1,e.el.parentNode.removeChild(e.el))}))}},e.prototype.updateOnFold=function(e,t){var n=t.lineWidgets;if(n&&e.action){for(var i=e.data,o=i.start.row,r=i.end.row,s="add"==e.action,a=o+1;a<r;a++)n[a]&&(n[a].hidden=s);n[r]&&(s?n[o]?n[r].hidden=s:n[o]=n[r]:(n[o]==n[r]&&(n[o]=void 0),n[r].hidden=s))}},e.prototype.updateOnChange=function(e){var t=this.session.lineWidgets;if(t){var n=e.start.row,i=e.end.row-n;if(0===i);else if("remove"==e.action){var o=t.splice(n+1,i);!t[n]&&o[o.length-1]&&(t[n]=o.pop()),o.forEach((function(e){e&&this.removeLineWidget(e)}),this),this.$updateRows()}else{var r=new Array(i);t[n]&&null!=t[n].column&&e.start.column>t[n].column&&n++,r.unshift(n,0),t.splice.apply(t,r),this.$updateRows()}}},e.prototype.$updateRows=function(){var e=this.session.lineWidgets;if(e){var t=!0;e.forEach((function(e,n){if(e)for(t=!1,e.row=n;e.$oldWidget;)e.$oldWidget.row=n,e=e.$oldWidget})),t&&(this.session.lineWidgets=null)}},e.prototype.$registerLineWidget=function(e){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var t=this.session.lineWidgets[e.row];return t&&(e.$oldWidget=t,t.el&&t.el.parentNode&&(t.el.parentNode.removeChild(t.el),t._inDocument=!1)),this.session.lineWidgets[e.row]=e,e},e.prototype.addLineWidget=function(e){if(this.$registerLineWidget(e),e.session=this.session,!this.editor)return e;var t=this.editor.renderer;e.html&&!e.el&&(e.el=i.createElement("div"),e.el.innerHTML=e.html),e.text&&!e.el&&(e.el=i.createElement("div"),e.el.textContent=e.text),e.el&&(i.addCssClass(e.el,"ace_lineWidgetContainer"),e.className&&i.addCssClass(e.el,e.className),e.el.style.position="absolute",e.el.style.zIndex="5",t.container.appendChild(e.el),e._inDocument=!0,e.coverGutter||(e.el.style.zIndex="3"),null==e.pixelHeight&&(e.pixelHeight=e.el.offsetHeight)),null==e.rowCount&&(e.rowCount=e.pixelHeight/t.layerConfig.lineHeight);var n=this.session.getFoldAt(e.row,0);if(e.$fold=n,n){var o=this.session.lineWidgets;e.row!=n.end.row||o[n.start.row]?e.hidden=!0:o[n.start.row]=e}return this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows(),this.renderWidgets(null,t),this.onWidgetChanged(e),e},e.prototype.removeLineWidget=function(e){if(e._inDocument=!1,e.session=null,e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el),e.editor&&e.editor.destroy)try{e.editor.destroy()}catch(e){}if(this.session.lineWidgets){var t=this.session.lineWidgets[e.row];if(t==e)this.session.lineWidgets[e.row]=e.$oldWidget,e.$oldWidget&&this.onWidgetChanged(e.$oldWidget);else for(;t;){if(t.$oldWidget==e){t.$oldWidget=e.$oldWidget;break}t=t.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows()},e.prototype.getWidgetsAtRow=function(e){for(var t=this.session.lineWidgets,n=t&&t[e],i=[];n;)i.push(n),n=n.$oldWidget;return i},e.prototype.onWidgetChanged=function(e){this.session._changedWidgets.push(e),this.editor&&this.editor.renderer.updateFull()},e.prototype.measureWidgets=function(e,t){var n=this.session._changedWidgets,i=t.layerConfig;if(n&&n.length){for(var o=1/0,r=0;r<n.length;r++){var s=n[r];if(s&&s.el&&s.session==this.session){if(!s._inDocument){if(this.session.lineWidgets[s.row]!=s)continue;s._inDocument=!0,t.container.appendChild(s.el)}s.h=s.el.offsetHeight,s.fixedWidth||(s.w=s.el.offsetWidth,s.screenWidth=Math.ceil(s.w/i.characterWidth));var a=s.h/i.lineHeight;s.coverLine&&(a-=this.session.getRowLineCount(s.row))<0&&(a=0),s.rowCount!=a&&(s.rowCount=a,s.row<o&&(o=s.row))}}o!=1/0&&(this.session._emit("changeFold",{data:{start:{row:o}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},e.prototype.renderWidgets=function(e,t){var n=t.layerConfig,i=this.session.lineWidgets;if(i){for(var o=Math.min(this.firstRow,n.firstRow),r=Math.max(this.lastRow,n.lastRow,i.length);o>0&&!i[o];)o--;this.firstRow=n.firstRow,this.lastRow=n.lastRow,t.$cursorLayer.config=n;for(var s=o;s<=r;s++){var a=i[s];if(a&&a.el)if(a.hidden)a.el.style.top=-100-(a.pixelHeight||0)+"px";else{a._inDocument||(a._inDocument=!0,t.container.appendChild(a.el));var l=t.$cursorLayer.getPixelPosition({row:s,column:0},!0).top;a.coverLine||(l+=n.lineHeight*this.session.getRowLineCount(a.row)),a.el.style.top=l-n.offset+"px";var c=a.coverGutter?0:t.gutterWidth;a.fixedWidth||(c-=t.scrollLeft),a.el.style.left=c+"px",a.fullWidth&&a.screenWidth&&(a.el.style.minWidth=n.width+2*n.padding+"px"),a.fixedWidth?a.el.style.right=t.scrollBar.getWidth()+"px":a.el.style.right=""}}}},e}();t.LineWidgets=o})),ace.define("ace/keyboard/gutter_handler",[],(function(e,t,n){"use strict";var i=e("../lib/keys"),o=e("../mouse/default_gutter_handler").GutterTooltip,r=function(){function e(e){this.editor=e,this.gutterLayer=e.renderer.$gutterLayer,this.element=e.renderer.$gutter,this.lines=e.renderer.$gutterLayer.$lines,this.activeRowIndex=null,this.activeLane=null,this.annotationTooltip=new o(this.editor)}return e.prototype.addListener=function(){this.element.addEventListener("keydown",this.$onGutterKeyDown.bind(this)),this.element.addEventListener("focusout",this.$blurGutter.bind(this)),this.editor.on("mousewheel",this.$blurGutter.bind(this))},e.prototype.removeListener=function(){this.element.removeEventListener("keydown",this.$onGutterKeyDown.bind(this)),this.element.removeEventListener("focusout",this.$blurGutter.bind(this)),this.editor.off("mousewheel",this.$blurGutter.bind(this))},e.prototype.$onGutterKeyDown=function(e){if(this.annotationTooltip.isOpen)return e.preventDefault(),void(e.keyCode===i.escape&&this.annotationTooltip.hideTooltip());if(e.target===this.element){if(e.keyCode!=i.enter)return;e.preventDefault();var t=this.editor.getCursorPosition().row;return this.editor.isRowVisible(t)||this.editor.scrollToLine(t,!0,!0),void setTimeout(function(){var e=this.$rowToRowIndex(this.gutterLayer.$cursorCell.row),t=this.$findNearestFoldWidget(e),n=this.$findNearestAnnotation(e);if(null!==t||null!==n)return null===t&&null!==n?(this.activeRowIndex=n,this.activeLane="annotation",void this.$focusAnnotation(this.activeRowIndex)):null!==t&&null===n?(this.activeRowIndex=t,this.activeLane="fold",void this.$focusFoldWidget(this.activeRowIndex)):Math.abs(n-e)<Math.abs(t-e)?(this.activeRowIndex=n,this.activeLane="annotation",void this.$focusAnnotation(this.activeRowIndex)):(this.activeRowIndex=t,this.activeLane="fold",void this.$focusFoldWidget(this.activeRowIndex))}.bind(this),10)}this.$handleGutterKeyboardInteraction(e),setTimeout(function(){this.editor._signal("gutterkeydown",new s(e,this))}.bind(this),10)},e.prototype.$handleGutterKeyboardInteraction=function(e){if(e.keyCode!==i.tab){if(e.keyCode===i.escape)return e.preventDefault(),this.$blurGutter(),this.element.focus(),void(this.lane=null);if(e.keyCode!==i.up)if(e.keyCode!==i.down){if(e.keyCode===i.left)return e.preventDefault(),void this.$switchLane("annotation");if(e.keyCode===i.right)return e.preventDefault(),void this.$switchLane("fold");if(e.keyCode!==i.enter&&e.keyCode!==i.space);else switch(e.preventDefault(),this.activeLane){case"fold":if("start"===this.gutterLayer.session.foldWidgets[this.$rowIndexToRow(this.activeRowIndex)]){var t=this.$rowIndexToRow(this.activeRowIndex);this.editor.session.onFoldWidgetClick(this.$rowIndexToRow(this.activeRowIndex),e),setTimeout(function(){this.$rowIndexToRow(this.activeRowIndex)!==t&&(this.$blurFoldWidget(this.activeRowIndex),this.activeRowIndex=this.$rowToRowIndex(t),this.$focusFoldWidget(this.activeRowIndex))}.bind(this),10);break}if("end"===this.gutterLayer.session.foldWidgets[this.$rowIndexToRow(this.activeRowIndex)])break;return;case"annotation":var n=this.lines.cells[this.activeRowIndex].element.childNodes[2].getBoundingClientRect(),o=this.annotationTooltip.getElement().style;o.left=n.right+"px",o.top=n.bottom+"px",this.annotationTooltip.showTooltip(this.$rowIndexToRow(this.activeRowIndex))}}else switch(e.preventDefault(),this.activeLane){case"fold":this.$moveFoldWidgetDown();break;case"annotation":this.$moveAnnotationDown()}else switch(e.preventDefault(),this.activeLane){case"fold":this.$moveFoldWidgetUp();break;case"annotation":this.$moveAnnotationUp()}}else e.preventDefault()},e.prototype.$blurGutter=function(){if(null!==this.activeRowIndex)switch(this.activeLane){case"fold":this.$blurFoldWidget(this.activeRowIndex);break;case"annotation":this.$blurAnnotation(this.activeRowIndex)}this.annotationTooltip.isOpen&&this.annotationTooltip.hideTooltip()},e.prototype.$isFoldWidgetVisible=function(e){var t=this.editor.isRowFullyVisible(this.$rowIndexToRow(e)),n="none"!==this.$getFoldWidget(e).style.display;return t&&n},e.prototype.$isAnnotationVisible=function(e){var t=this.editor.isRowFullyVisible(this.$rowIndexToRow(e)),n="none"!==this.$getAnnotation(e).style.display;return t&&n},e.prototype.$getFoldWidget=function(e){return this.lines.get(e).element.childNodes[1]},e.prototype.$getAnnotation=function(e){return this.lines.get(e).element.childNodes[2]},e.prototype.$findNearestFoldWidget=function(e){if(this.$isFoldWidgetVisible(e))return e;for(var t=0;e-t>0||e+t<this.lines.getLength()-1;){if(e-++t>=0&&this.$isFoldWidgetVisible(e-t))return e-t;if(e+t<=this.lines.getLength()-1&&this.$isFoldWidgetVisible(e+t))return e+t}return null},e.prototype.$findNearestAnnotation=function(e){if(this.$isAnnotationVisible(e))return e;for(var t=0;e-t>0||e+t<this.lines.getLength()-1;){if(e-++t>=0&&this.$isAnnotationVisible(e-t))return e-t;if(e+t<=this.lines.getLength()-1&&this.$isAnnotationVisible(e+t))return e+t}return null},e.prototype.$focusFoldWidget=function(e){if(null!=e){var t=this.$getFoldWidget(e);t.classList.add(this.editor.renderer.keyboardFocusClassName),t.focus()}},e.prototype.$focusAnnotation=function(e){if(null!=e){var t=this.$getAnnotation(e);t.classList.add(this.editor.renderer.keyboardFocusClassName),t.focus()}},e.prototype.$blurFoldWidget=function(e){var t=this.$getFoldWidget(e);t.classList.remove(this.editor.renderer.keyboardFocusClassName),t.blur()},e.prototype.$blurAnnotation=function(e){var t=this.$getAnnotation(e);t.classList.remove(this.editor.renderer.keyboardFocusClassName),t.blur()},e.prototype.$moveFoldWidgetUp=function(){for(var e=this.activeRowIndex;e>0;)if(e--,this.$isFoldWidgetVisible(e))return this.$blurFoldWidget(this.activeRowIndex),this.activeRowIndex=e,void this.$focusFoldWidget(this.activeRowIndex)},e.prototype.$moveFoldWidgetDown=function(){for(var e=this.activeRowIndex;e<this.lines.getLength()-1;)if(e++,this.$isFoldWidgetVisible(e))return this.$blurFoldWidget(this.activeRowIndex),this.activeRowIndex=e,void this.$focusFoldWidget(this.activeRowIndex)},e.prototype.$moveAnnotationUp=function(){for(var e=this.activeRowIndex;e>0;)if(e--,this.$isAnnotationVisible(e))return this.$blurAnnotation(this.activeRowIndex),this.activeRowIndex=e,void this.$focusAnnotation(this.activeRowIndex)},e.prototype.$moveAnnotationDown=function(){for(var e=this.activeRowIndex;e<this.lines.getLength()-1;)if(e++,this.$isAnnotationVisible(e))return this.$blurAnnotation(this.activeRowIndex),this.activeRowIndex=e,void this.$focusAnnotation(this.activeRowIndex)},e.prototype.$switchLane=function(e){switch(e){case"annotation":if("annotation"===this.activeLane)break;var t=this.$findNearestAnnotation(this.activeRowIndex);if(null==t)break;this.activeLane="annotation",this.$blurFoldWidget(this.activeRowIndex),this.activeRowIndex=t,this.$focusAnnotation(this.activeRowIndex);break;case"fold":if("fold"===this.activeLane)break;var n=this.$findNearestFoldWidget(this.activeRowIndex);if(null==n)break;this.activeLane="fold",this.$blurAnnotation(this.activeRowIndex),this.activeRowIndex=n,this.$focusFoldWidget(this.activeRowIndex)}},e.prototype.$rowIndexToRow=function(e){var t=this.lines.get(e);return t?t.row:null},e.prototype.$rowToRowIndex=function(e){for(var t=0;t<this.lines.getLength();t++){if(this.lines.get(t).row==e)return t}return null},e}();t.GutterKeyboardHandler=r;var s=function(){function e(e,t){this.gutterKeyboardHandler=t,this.domEvent=e}return e.prototype.getKey=function(){return i.keyCodeToString(this.domEvent.keyCode)},e.prototype.getRow=function(){return this.gutterKeyboardHandler.$rowIndexToRow(this.gutterKeyboardHandler.activeRowIndex)},e.prototype.isInAnnotationLane=function(){return"annotation"===this.gutterKeyboardHandler.activeLane},e.prototype.isInFoldLane=function(){return"fold"===this.gutterKeyboardHandler.activeLane},e}();t.GutterKeyboardEvent=s})),ace.define("ace/editor",[],(function(e,t,n){"use strict";var i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=e("./lib/oop"),r=e("./lib/dom"),s=e("./lib/lang"),a=e("./lib/useragent"),l=e("./keyboard/textinput").TextInput,c=e("./mouse/mouse_handler").MouseHandler,u=e("./mouse/fold_handler").FoldHandler,h=e("./keyboard/keybinding").KeyBinding,d=e("./edit_session").EditSession,p=e("./search").Search,f=e("./range").Range,g=e("./lib/event_emitter").EventEmitter,m=e("./commands/command_manager").CommandManager,y=e("./commands/default_commands").commands,v=e("./config"),b=e("./token_iterator").TokenIterator,x=e("./line_widgets").LineWidgets,w=e("./keyboard/gutter_handler").GutterKeyboardHandler,_=e("./config").nls,S=e("./clipboard"),C=e("./lib/keys"),k=function(){function e(t,n,i){this.session,this.$toDestroy=[];var o=t.getContainerElement();this.container=o,this.renderer=t,this.id="editor"+ ++e.$uid,this.commands=new m(a.isMac?"mac":"win",y),"object"==typeof document&&(this.textInput=new l(t.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new c(this),new u(this)),this.keyBinding=new h(this),this.$search=(new p).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=s.delayedCall(function(){this._signal("input",{}),this.session&&!this.session.destroyed&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",(function(e,t){t._$emitInputEvent.schedule(31)})),this.setSession(n||i&&i.session||new d("")),v.resetOptions(this),i&&this.setOptions(i),v._signal("editor",this)}return e.prototype.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=s.delayedCall(this.endOperation.bind(this,!0)),this.on("change",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.selectionChanged=!0}.bind(this),!0)},e.prototype.startOperation=function(e){if(this.curOp){if(!e||this.curOp.command)return;this.prevOp=this.curOp}e||(this.previousCommand=null,e={}),this.$opResetTimer.schedule(),this.curOp=this.session.curOp={command:e.command||{},args:e.args,scrollTop:this.renderer.scrollTop},this.curOp.selectionBefore=this.selection.toJSON()},e.prototype.endOperation=function(e){if(this.curOp&&this.session){if(e&&!1===e.returnValue||!this.session)return this.curOp=null;if(1==e&&this.curOp.command&&"mouse"==this.curOp.command.name)return;if(this._signal("beforeEndOperation"),!this.curOp)return;var t=this.curOp.command,n=t&&t.scrollIntoView;if(n){switch(n){case"center-animate":n="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var i=this.selection.getRange(),o=this.renderer.layerConfig;(i.start.row>=o.lastRow||i.end.row<=o.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==n&&this.renderer.animateScrolling(this.curOp.scrollTop)}var r=this.selection.toJSON();this.curOp.selectionAfter=r,this.$lastSel=this.selection.toJSON(),this.session.getUndoManager().addSelection(r),this.prevOp=this.curOp,this.curOp=null}},e.prototype.$historyTracker=function(e){if(this.$mergeUndoDeltas){var t=this.prevOp,n=this.$mergeableCommands,i=t.command&&e.command.name==t.command.name;if("insertstring"==e.command.name){var o=e.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),i=i&&this.mergeNextCommand&&(!/\s/.test(o)||/\s/.test(t.args)),this.mergeNextCommand=!0}else i=i&&-1!==n.indexOf(e.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(i=!1),i?this.session.mergeUndoDeltas=!0:-1!==n.indexOf(e.command.name)&&(this.sequenceStartTime=Date.now())}},e.prototype.setKeyboardHandler=function(e,t){if(e&&"string"==typeof e&&"ace"!=e){this.$keybindingId=e;var n=this;v.loadModule(["keybinding",e],(function(i){n.$keybindingId==e&&n.keyBinding.setKeyboardHandler(i&&i.handler),t&&t()}))}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(e),t&&t()},e.prototype.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},e.prototype.setSession=function(e){if(this.session!=e){this.curOp&&this.endOperation(),this.curOp={};var t=this.session;if(t){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var n=this.session.getSelection();n.off("changeCursor",this.$onCursorChange),n.off("changeSelection",this.$onSelectionChange)}this.session=e,e?(this.$onDocumentChange=this.onDocumentChange.bind(this),e.on("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.onCursorChange(),this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(e)),this._signal("changeSession",{session:e,oldSession:t}),this.curOp=null,t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this}),e&&!e.destroyed&&e.bgTokenizer.scheduleStart()}},e.prototype.getSession=function(){return this.session},e.prototype.setValue=function(e,t){return this.session.doc.setValue(e),t?1==t?this.navigateFileEnd():-1==t&&this.navigateFileStart():this.selectAll(),e},e.prototype.getValue=function(){return this.session.getValue()},e.prototype.getSelection=function(){return this.selection},e.prototype.resize=function(e){this.renderer.onResize(e)},e.prototype.setTheme=function(e,t){this.renderer.setTheme(e,t)},e.prototype.getTheme=function(){return this.renderer.getTheme()},e.prototype.setStyle=function(e){this.renderer.setStyle(e)},e.prototype.unsetStyle=function(e){this.renderer.unsetStyle(e)},e.prototype.getFontSize=function(){return this.getOption("fontSize")||r.computedStyle(this.container).fontSize},e.prototype.setFontSize=function(e){this.setOption("fontSize",e)},e.prototype.$highlightBrackets=function(){if(!this.$highlightPending){var e=this;this.$highlightPending=!0,setTimeout((function(){e.$highlightPending=!1;var t=e.session;if(t&&!t.destroyed){t.$bracketHighlight&&(t.$bracketHighlight.markerIds.forEach((function(e){t.removeMarker(e)})),t.$bracketHighlight=null);var n=e.getCursorPosition(),i=e.getKeyboardHandler(),o=i&&i.$getDirectionForHighlight&&i.$getDirectionForHighlight(e),r=t.getMatchingBracketRanges(n,o);if(!r){var s=new b(t,n.row,n.column).getCurrentToken();if(s&&/\b(?:tag-open|tag-name)/.test(s.type)){var a=t.getMatchingTags(n);a&&(r=[a.openTagName,a.closeTagName])}}if(!r&&t.$mode.getMatching&&(r=t.$mode.getMatching(e.session)),r){var l="ace_bracket";Array.isArray(r)?1==r.length&&(l="ace_error_bracket"):r=[r],2==r.length&&(0==f.comparePoints(r[0].end,r[1].start)?r=[f.fromPoints(r[0].start,r[1].end)]:0==f.comparePoints(r[0].start,r[1].end)&&(r=[f.fromPoints(r[1].start,r[0].end)])),t.$bracketHighlight={ranges:r,markerIds:r.map((function(e){return t.addMarker(e,l,"text")}))},e.getHighlightIndentGuides()&&e.renderer.$textLayer.$highlightIndentGuide()}else e.getHighlightIndentGuides()&&e.renderer.$textLayer.$highlightIndentGuide()}}),50)}},e.prototype.focus=function(){this.textInput.focus()},e.prototype.isFocused=function(){return this.textInput.isFocused()},e.prototype.blur=function(){this.textInput.blur()},e.prototype.onFocus=function(e){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e))},e.prototype.onBlur=function(e){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e))},e.prototype.$cursorChange=function(){this.renderer.updateCursor(),this.$highlightBrackets(),this.$updateHighlightActiveLine()},e.prototype.onDocumentChange=function(e){var t=this.session.$useWrapMode,n=e.start.row==e.end.row?e.end.row:1/0;this.renderer.updateLines(e.start.row,n,t),this._signal("change",e),this.$cursorChange()},e.prototype.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},e.prototype.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},e.prototype.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},e.prototype.onCursorChange=function(){this.$cursorChange(),this._signal("changeSelection")},e.prototype.$updateHighlightActiveLine=function(){var e,t=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(e=this.getCursorPosition()),this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty()&&(e=!1),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(e=!1)),t.$highlightLineMarker&&!e)t.removeMarker(t.$highlightLineMarker.id),t.$highlightLineMarker=null;else if(!t.$highlightLineMarker&&e){var n=new f(e.row,e.column,e.row,1/0);n.id=t.addMarker(n,"ace_active-line","screenLine"),t.$highlightLineMarker=n}else e&&(t.$highlightLineMarker.start.row=e.row,t.$highlightLineMarker.end.row=e.row,t.$highlightLineMarker.start.column=e.column,t._signal("changeBackMarker"))},e.prototype.onSelectionChange=function(e){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var n=this.selection.getRange(),i=this.getSelectionStyle();t.$selectionMarker=t.addMarker(n,"ace_selection",i)}var o=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(o),this._signal("changeSelection")},e.prototype.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(!t.isEmpty()&&!t.isMultiLine()){var n=t.start.column,i=t.end.column,o=e.getLine(t.start.row),r=o.substring(n,i);if(!(r.length>5e3)&&/[\w\d]/.test(r)){var s=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:r}),a=o.substring(n-1,i+1);if(s.test(a))return s}}},e.prototype.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},e.prototype.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},e.prototype.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},e.prototype.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},e.prototype.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},e.prototype.onChangeWrapLimit=function(){this.renderer.updateFull()},e.prototype.onChangeWrapMode=function(){this.renderer.onResize(!0)},e.prototype.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},e.prototype.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},e.prototype.getCopyText=function(){var e=this.getSelectedText(),t=this.session.doc.getNewLineCharacter(),n=!1;if(!e&&this.$copyWithEmptySelection){n=!0;for(var i=this.selection.getAllRanges(),o=0;o<i.length;o++){var r=i[o];o&&i[o-1].start.row==r.start.row||(e+=this.session.getLine(r.start.row)+t)}}var s={text:e};return this._signal("copy",s),S.lineMode=!!n&&s.text,s.text},e.prototype.onCopy=function(){this.commands.exec("copy",this)},e.prototype.onCut=function(){this.commands.exec("cut",this)},e.prototype.onPaste=function(e,t){var n={text:e,event:t};this.commands.exec("paste",this,n)},e.prototype.$handlePaste=function(e){"string"==typeof e&&(e={text:e}),this._signal("paste",e);var t=e.text,n=t===S.lineMode,i=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)n?i.insert({row:this.selection.lead.row,column:0},t):this.insert(t);else if(n)this.selection.rangeList.ranges.forEach((function(e){i.insert({row:e.start.row,column:0},t)}));else{var o=t.split(/\r\n|\r|\n/),r=this.selection.rangeList.ranges,s=!(2!=o.length||o[0]&&o[1]);if(o.length!=r.length||s)return this.commands.exec("insertstring",this,t);for(var a=r.length;a--;){var l=r[a];l.isEmpty()||i.remove(l),i.insert(l.start,o[a])}}},e.prototype.execCommand=function(e,t){return this.commands.exec(e,this,t)},e.prototype.insert=function(e,t){var n=this.session,i=n.getMode(),o=this.getCursorPosition();if(this.getBehavioursEnabled()&&!t){var r=i.transformAction(n.getState(o.row),"insertion",this,n,e);r&&(e!==r.text&&(this.inVirtualSelectionMode||(this.session.mergeUndoDeltas=!1,this.mergeNextCommand=!1)),e=r.text)}if("\t"==e&&(e=this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()&&-1==e.indexOf("\n")){(s=f.fromPoints(o,o)).end.column+=e.length,this.session.remove(s)}}else{var s=this.getSelectionRange();o=this.session.remove(s),this.clearSelection()}if("\n"==e||"\r\n"==e){var a=n.getLine(o.row);if(o.column>a.search(/\S|$/)){var l=a.substr(o.column).search(/\S|$/);n.doc.removeInLine(o.row,o.column,o.column+l)}}this.clearSelection();var c=o.column,u=n.getState(o.row),h=(a=n.getLine(o.row),i.checkOutdent(u,a,e));if(n.insert(o,e),r&&r.selection&&(2==r.selection.length?this.selection.setSelectionRange(new f(o.row,c+r.selection[0],o.row,c+r.selection[1])):this.selection.setSelectionRange(new f(o.row+r.selection[0],r.selection[1],o.row+r.selection[2],r.selection[3]))),this.$enableAutoIndent){if(n.getDocument().isNewLine(e)){var d=i.getNextLineIndent(u,a.slice(0,o.column),n.getTabString());n.insert({row:o.row+1,column:0},d)}h&&i.autoOutdent(u,n,o.row)}},e.prototype.autoIndent=function(){for(var e=this.session,t=e.getMode(),n=this.selection.isEmpty()?[new f(0,0,e.doc.getLength()-1,0)]:this.selection.getAllRanges(),i="",o="",r="",s=e.getTabString(),a=0;a<n.length;a++)for(var l=n[a].start.row,c=n[a].end.row,u=l;u<=c;u++){u>0&&(i=e.getState(u-1),o=e.getLine(u-1),r=t.getNextLineIndent(i,o,s));var h=e.getLine(u),d=t.$getIndent(h);if(r!==d){if(d.length>0){var p=new f(u,0,u,d.length);e.remove(p)}r.length>0&&e.insert({row:u,column:0},r)}t.autoOutdent(i,e,u)}},e.prototype.onTextInput=function(e,t){if(!t)return this.keyBinding.onTextInput(e);this.startOperation({command:{name:"insertstring"}});var n=this.applyComposition.bind(this,e,t);this.selection.rangeCount?this.forEachSelection(n):n(),this.endOperation()},e.prototype.applyComposition=function(e,t){var n;(t.extendLeft||t.extendRight)&&((n=this.selection.getRange()).start.column-=t.extendLeft,n.end.column+=t.extendRight,n.start.column<0&&(n.start.row--,n.start.column+=this.session.getLine(n.start.row).length+1),this.selection.setRange(n),e||n.isEmpty()||this.remove());(!e&&this.selection.isEmpty()||this.insert(e,!0),t.restoreStart||t.restoreEnd)&&((n=this.selection.getRange()).start.column-=t.restoreStart,n.end.column-=t.restoreEnd,this.selection.setRange(n))},e.prototype.onCommandKey=function(e,t,n){return this.keyBinding.onCommandKey(e,t,n)},e.prototype.setOverwrite=function(e){this.session.setOverwrite(e)},e.prototype.getOverwrite=function(){return this.session.getOverwrite()},e.prototype.toggleOverwrite=function(){this.session.toggleOverwrite()},e.prototype.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},e.prototype.getScrollSpeed=function(){return this.getOption("scrollSpeed")},e.prototype.setDragDelay=function(e){this.setOption("dragDelay",e)},e.prototype.getDragDelay=function(){return this.getOption("dragDelay")},e.prototype.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},e.prototype.getSelectionStyle=function(){return this.getOption("selectionStyle")},e.prototype.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},e.prototype.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},e.prototype.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},e.prototype.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},e.prototype.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},e.prototype.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},e.prototype.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},e.prototype.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},e.prototype.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},e.prototype.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},e.prototype.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},e.prototype.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},e.prototype.setHighlightIndentGuides=function(e){this.renderer.setHighlightIndentGuides(e)},e.prototype.getHighlightIndentGuides=function(){return this.renderer.getHighlightIndentGuides()},e.prototype.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},e.prototype.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},e.prototype.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},e.prototype.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},e.prototype.setReadOnly=function(e){this.setOption("readOnly",e)},e.prototype.getReadOnly=function(){return this.getOption("readOnly")},e.prototype.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},e.prototype.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},e.prototype.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},e.prototype.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},e.prototype.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},e.prototype.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},e.prototype.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},e.prototype.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},e.prototype.remove=function(e){this.selection.isEmpty()&&("left"==e?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var n=this.session,i=n.getState(t.start.row),o=n.getMode().transformAction(i,"deletion",this,n,t);if(0===t.end.column){var r=n.getTextRange(t);if("\n"==r[r.length-1]){var s=n.getLine(t.end.row);/^\s+$/.test(s)&&(t.end.column=s.length)}}o&&(t=o)}this.session.remove(t),this.clearSelection()},e.prototype.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},e.prototype.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},e.prototype.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.selection.isEmpty()&&this.selection.selectLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},e.prototype.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},e.prototype.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},e.prototype.setGhostText=function(e,t){this.session.widgetManager||(this.session.widgetManager=new x(this.session),this.session.widgetManager.attach(this)),this.renderer.setGhostText(e,t)},e.prototype.removeGhostText=function(){this.session.widgetManager&&this.renderer.removeGhostText()},e.prototype.transposeLetters=function(){if(this.selection.isEmpty()){var e=this.getCursorPosition(),t=e.column;if(0!==t){var n,i,o=this.session.getLine(e.row);t<o.length?(n=o.charAt(t)+o.charAt(t-1),i=new f(e.row,t-1,e.row,t+1)):(n=o.charAt(t-1)+o.charAt(t-2),i=new f(e.row,t-2,e.row,t)),this.session.replace(i,n),this.session.selection.moveToPosition(i.end)}}},e.prototype.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toLowerCase()),this.selection.setSelectionRange(e)},e.prototype.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toUpperCase()),this.selection.setSelectionRange(e)},e.prototype.indent=function(){var e=this.session,t=this.getSelectionRange();if(!(t.start.row<t.end.row)){if(t.start.column<t.end.column){var n=e.getTextRange(t);if(!/^\s+$/.test(n)){u=this.$getSelectedRows();return void e.indentRows(u.first,u.last,"\t")}}var i=e.getLine(t.start.row),o=t.start,r=e.getTabSize(),a=e.documentToScreenColumn(o.row,o.column);if(this.session.getUseSoftTabs())var l=r-a%r,c=s.stringRepeat(" ",l);else{for(l=a%r;" "==i[t.start.column-1]&&l;)t.start.column--,l--;this.selection.setSelectionRange(t),c="\t"}return this.insert(c)}var u=this.$getSelectedRows();e.indentRows(u.first,u.last,"\t")},e.prototype.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"\t")},e.prototype.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},e.prototype.sortLines=function(){for(var e=this.$getSelectedRows(),t=this.session,n=[],i=e.first;i<=e.last;i++)n.push(t.getLine(i));n.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}));var o=new f(0,0,0,0);for(i=e.first;i<=e.last;i++){var r=t.getLine(i);o.start.row=i,o.end.row=i,o.end.column=r.length,t.replace(o,n[i-e.first])}},e.prototype.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},e.prototype.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),n=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,n,e)},e.prototype.getNumberAt=function(e,t){var n=/[\-]?[0-9]+(?:\.[0-9]+)?/g;n.lastIndex=0;for(var i=this.session.getLine(e);n.lastIndex<t;){var o=n.exec(i);if(o.index<=t&&o.index+o[0].length>=t)return{value:o[0],start:o.index,end:o.index+o[0].length}}return null},e.prototype.modifyNumber=function(e){var t=this.selection.getCursor().row,n=this.selection.getCursor().column,i=new f(t,n-1,t,n),o=this.session.getTextRange(i);if(!isNaN(parseFloat(o))&&isFinite(o)){var r=this.getNumberAt(t,n);if(r){var s=r.value.indexOf(".")>=0?r.start+r.value.indexOf(".")+1:r.end,a=r.start+r.value.length-s,l=parseFloat(r.value);l*=Math.pow(10,a),s!==r.end&&n<s?e*=Math.pow(10,r.end-n-1):e*=Math.pow(10,r.end-n),l+=e;var c=(l/=Math.pow(10,a)).toFixed(a),u=new f(t,r.start,t,r.end);this.session.replace(u,c),this.moveCursorTo(t,Math.max(r.start+1,n+c.length-r.value.length))}}else this.toggleWord()},e.prototype.toggleWord=function(){var e=this.selection.getCursor().row,t=this.selection.getCursor().column;this.selection.selectWord();var n=this.getSelectedText(),i=this.selection.getWordRange().start.column,o=n.replace(/([a-z]+|[A-Z]+)(?=[A-Z_]|$)/g,"$1 ").split(/\s/),r=t-i-1;r<0&&(r=0);var a=0,l=0,c=this;n.match(/[A-Za-z0-9_]+/)&&o.forEach((function(t,o){l=a+t.length,r>=a&&r<=l&&(n=t,c.selection.clearSelection(),c.moveCursorTo(e,a+i),c.selection.selectTo(e,l+i)),a=l}));for(var u,h=this.$toggleWordPairs,d=0;d<h.length;d++)for(var p=h[d],f=0;f<=1;f++){var g=+!f,m=n.match(new RegExp("^\\s?_?("+s.escapeRegExp(p[f])+")\\s?$","i"));if(m)n.match(new RegExp("([_]|^|\\s)("+s.escapeRegExp(m[1])+")($|\\s)","g"))&&(u=n.replace(new RegExp(s.escapeRegExp(p[f]),"i"),(function(e){var t=p[g];return e.toUpperCase()==e?t=t.toUpperCase():e.charAt(0).toUpperCase()==e.charAt(0)&&(t=t.substr(0,0)+p[g].charAt(0).toUpperCase()+t.substr(1)),t})),this.insert(u),u="")}},e.prototype.findLinkAt=function(e,t){var n,o,r=this.session.getLine(e).split(/((?:https?|ftp):\/\/[\S]+)/),s=t;s<0&&(s=0);var a,l=0,c=0;try{for(var u=i(r),h=u.next();!h.done;h=u.next()){var d=h.value;if(c=l+d.length,s>=l&&s<=c&&d.match(/((?:https?|ftp):\/\/[\S]+)/)){a=d.replace(/[\s:.,'";}\]]+$/,"");break}l=c}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return a},e.prototype.openLink=function(){var e=this.selection.getCursor(),t=this.findLinkAt(e.row,e.column);return t&&window.open(t,"_blank"),null!=t},e.prototype.removeLines=function(){var e=this.$getSelectedRows();this.session.removeFullLines(e.first,e.last),this.clearSelection()},e.prototype.duplicateSelection=function(){var e=this.selection,t=this.session,n=e.getRange(),i=e.isBackwards();if(n.isEmpty()){var o=n.start.row;t.duplicateLines(o,o)}else{var r=i?n.start:n.end,s=t.insert(r,t.getTextRange(n));n.start=r,n.end=s,e.setSelectionRange(n,i)}},e.prototype.moveLinesDown=function(){this.$moveLines(1,!1)},e.prototype.moveLinesUp=function(){this.$moveLines(-1,!1)},e.prototype.moveText=function(e,t,n){return this.session.moveText(e,t,n)},e.prototype.copyLinesUp=function(){this.$moveLines(-1,!0)},e.prototype.copyLinesDown=function(){this.$moveLines(1,!0)},e.prototype.$moveLines=function(e,t){var n,i,o=this.selection;if(!o.inMultiSelectMode||this.inVirtualSelectionMode){var r=o.toOrientedRange();n=this.$getSelectedRows(r),i=this.session.$moveLines(n.first,n.last,t?0:e),t&&-1==e&&(i=0),r.moveBy(i,0),o.fromOrientedRange(r)}else{var s=o.rangeList.ranges;o.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var a=0,l=0,c=s.length,u=0;u<c;u++){var h=u;s[u].moveBy(a,0);for(var d=(n=this.$getSelectedRows(s[u])).first,p=n.last;++u<c;){l&&s[u].moveBy(l,0);var f=this.$getSelectedRows(s[u]);if(t&&f.first!=p)break;if(!t&&f.first>p+1)break;p=f.last}for(u--,a=this.session.$moveLines(d,p,t?0:e),t&&-1==e&&(h=u+1);h<=u;)s[h].moveBy(a,0),h++;t||(a=0),l+=a}o.fromOrientedRange(o.ranges[0]),o.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},e.prototype.$getSelectedRows=function(e){return e=(e||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(e.start.row),last:this.session.getRowFoldEnd(e.end.row)}},e.prototype.onCompositionStart=function(e){this.renderer.showComposition(e)},e.prototype.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},e.prototype.onCompositionEnd=function(){this.renderer.hideComposition()},e.prototype.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},e.prototype.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},e.prototype.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},e.prototype.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},e.prototype.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},e.prototype.$moveByPage=function(e,t){var n=this.renderer,i=this.renderer.layerConfig,o=e*Math.floor(i.height/i.lineHeight);!0===t?this.selection.$moveSelection((function(){this.moveCursorBy(o,0)})):!1===t&&(this.selection.moveCursorBy(o,0),this.selection.clearSelection());var r=n.scrollTop;n.scrollBy(0,o*i.lineHeight),null!=t&&n.scrollCursorIntoView(null,.5),n.animateScrolling(r)},e.prototype.selectPageDown=function(){this.$moveByPage(1,!0)},e.prototype.selectPageUp=function(){this.$moveByPage(-1,!0)},e.prototype.gotoPageDown=function(){this.$moveByPage(1,!1)},e.prototype.gotoPageUp=function(){this.$moveByPage(-1,!1)},e.prototype.scrollPageDown=function(){this.$moveByPage(1)},e.prototype.scrollPageUp=function(){this.$moveByPage(-1)},e.prototype.scrollToRow=function(e){this.renderer.scrollToRow(e)},e.prototype.scrollToLine=function(e,t,n,i){this.renderer.scrollToLine(e,t,n,i)},e.prototype.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},e.prototype.getCursorPosition=function(){return this.selection.getCursor()},e.prototype.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},e.prototype.getSelectionRange=function(){return this.selection.getRange()},e.prototype.selectAll=function(){this.selection.selectAll()},e.prototype.clearSelection=function(){this.selection.clearSelection()},e.prototype.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},e.prototype.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},e.prototype.jumpToMatching=function(e,t){var n=this.getCursorPosition(),i=new b(this.session,n.row,n.column),o=i.getCurrentToken(),r=0;o&&-1!==o.type.indexOf("tag-name")&&(o=i.stepBackward());var s=o||i.stepForward();if(s){var a,l,c=!1,u={},h=n.column-s.start,d={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(s.value.match(/[{}()\[\]]/g)){for(;h<s.value.length&&!c;h++)if(d[s.value[h]])switch(l=d[s.value[h]]+"."+s.type.replace("rparen","lparen"),isNaN(u[l])&&(u[l]=0),s.value[h]){case"(":case"[":case"{":u[l]++;break;case")":case"]":case"}":u[l]--,-1===u[l]&&(a="bracket",c=!0)}}else-1!==s.type.indexOf("tag-name")&&(isNaN(u[s.value])&&(u[s.value]=0),"<"===o.value&&r>1?u[s.value]++:"</"===o.value&&u[s.value]--,-1===u[s.value]&&(a="tag",c=!0));c||(o=s,r++,s=i.stepForward(),h=0)}while(s&&!c);if(a){var p,g;if("bracket"===a)(p=this.session.getBracketRange(n))||(g=(p=new f(i.getCurrentTokenRow(),i.getCurrentTokenColumn()+h-1,i.getCurrentTokenRow(),i.getCurrentTokenColumn()+h-1)).start,(t||g.row===n.row&&Math.abs(g.column-n.column)<2)&&(p=this.session.getBracketRange(g)));else if("tag"===a){if(!s||-1===s.type.indexOf("tag-name"))return;if(0===(p=new f(i.getCurrentTokenRow(),i.getCurrentTokenColumn()-2,i.getCurrentTokenRow(),i.getCurrentTokenColumn()-2)).compare(n.row,n.column)){var m=this.session.getMatchingTags(n);m&&(m.openTag.contains(n.row,n.column)?g=(p=m.closeTag).start:(p=m.openTag,g=m.closeTag.start.row===n.row&&m.closeTag.start.column===n.column?p.end:p.start))}g=g||p.start}(g=p&&p.cursor||g)&&(e?p&&t?this.selection.setRange(p):p&&p.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(g.row,g.column):this.selection.moveTo(g.row,g.column))}}},e.prototype.gotoLine=function(e,t,n){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,n)},e.prototype.navigateTo=function(e,t){this.selection.moveTo(e,t)},e.prototype.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(-e||-1,0)},e.prototype.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(e||1,0)},e.prototype.navigateLeft=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorLeft();else{var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}this.clearSelection()},e.prototype.navigateRight=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorRight();else{var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}this.clearSelection()},e.prototype.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},e.prototype.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},e.prototype.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},e.prototype.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},e.prototype.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},e.prototype.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},e.prototype.replace=function(e,t){t&&this.$search.set(t);var n=this.$search.find(this.session),i=0;return n?(this.$tryReplace(n,e)&&(i=1),this.selection.setSelectionRange(n),this.renderer.scrollSelectionIntoView(n.start,n.end),i):i},e.prototype.replaceAll=function(e,t){t&&this.$search.set(t);var n=this.$search.findAll(this.session),i=0;if(!n.length)return i;var o=this.getSelectionRange();this.selection.moveTo(0,0);for(var r=n.length-1;r>=0;--r)this.$tryReplace(n[r],e)&&i++;return this.selection.setSelectionRange(o),i},e.prototype.$tryReplace=function(e,t){var n=this.session.getTextRange(e);return null!==(t=this.$search.replace(n,t))?(e.end=this.session.replace(e,t),e):null},e.prototype.getLastSearchOptions=function(){return this.$search.getOptions()},e.prototype.find=function(e,t,n){t||(t={}),"string"==typeof e||e instanceof RegExp?t.needle=e:"object"==typeof e&&o.mixin(t,e),this._emit("searched for",t);var i=this.selection.getRange();null==t.needle&&((e=this.session.getTextRange(i)||this.$search.$options.needle)||(i=this.session.getWordRange(i.start.row,i.start.column),e=this.session.getTextRange(i)),this.$search.set({needle:e})),this.$search.set(t),t.start||this.$search.set({start:i});var r=this.$search.find(this.session);return t.preventScroll?r:r?(this.revealRange(r,n),r):(t.backwards?i.start=i.end:i.end=i.start,void this.selection.setRange(i))},e.prototype.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},e.prototype.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},e.prototype.revealRange=function(e,t){this.session.unfold(e),this.selection.setSelectionRange(e);var n=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),!1!==t&&this.renderer.animateScrolling(n)},e.prototype.undo=function(){this.session.getUndoManager().undo(this.session),this.renderer.scrollCursorIntoView(null,.5)},e.prototype.redo=function(){this.session.getUndoManager().redo(this.session),this.renderer.scrollCursorIntoView(null,.5)},e.prototype.destroy=function(){this.$toDestroy&&(this.$toDestroy.forEach((function(e){e.destroy()})),this.$toDestroy=null),this.$mouseHandler&&this.$mouseHandler.destroy(),this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy(),this._$emitInputEvent&&this._$emitInputEvent.cancel(),this.removeAllListeners()},e.prototype.setAutoScrollEditorIntoView=function(e){if(e){var t,n=this,i=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var o=this.$scrollAnchor;o.style.cssText="position:absolute",this.container.insertBefore(o,this.container.firstChild);var r=this.on("changeSelection",(function(){i=!0})),s=this.renderer.on("beforeRender",(function(){i&&(t=n.renderer.container.getBoundingClientRect())})),a=this.renderer.on("afterRender",(function(){if(i&&t&&(n.isFocused()||n.searchBox&&n.searchBox.isFocused())){var e=n.renderer,r=e.$cursorLayer.$pixelPos,s=e.layerConfig,a=r.top-s.offset;null!=(i=r.top>=0&&a+t.top<0||!(r.top<s.height&&r.top+t.top+s.lineHeight>window.innerHeight)&&null)&&(o.style.top=a+"px",o.style.left=r.left+"px",o.style.height=s.lineHeight+"px",o.scrollIntoView(i)),i=t=null}}));this.setAutoScrollEditorIntoView=function(e){e||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",r),this.renderer.off("afterRender",a),this.renderer.off("beforeRender",s))}}},e.prototype.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",t=this.renderer.$cursorLayer;t&&(t.setSmoothBlinking(/smooth/.test(e)),t.isBlinking=!this.$readOnly&&"wide"!=e,r.setCssClass(t.element,"ace_slim-cursors",/slim/.test(e)))},e.prototype.prompt=function(e,t,n){var i=this;v.loadModule("ace/ext/prompt",(function(o){o.prompt(i,e,t,n)}))},e}();k.$uid=0,k.prototype.curOp=null,k.prototype.prevOp={},k.prototype.$mergeableCommands=["backspace","del","insertstring"],k.prototype.$toggleWordPairs=[["first","last"],["true","false"],["yes","no"],["width","height"],["top","bottom"],["right","left"],["on","off"],["x","y"],["get","set"],["max","min"],["horizontal","vertical"],["show","hide"],["add","remove"],["up","down"],["before","after"],["even","odd"],["in","out"],["inside","outside"],["next","previous"],["increase","decrease"],["attach","detach"],["&&","||"],["==","!="]],o.implement(k.prototype,g),v.defineOptions(k.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.textInput.setReadOnly(e),this.$resetCursorStyle()},initialValue:!1},copyWithEmptySelection:{set:function(e){this.textInput.setCopyWithEmptySelection(e)},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},enableAutoIndent:{initialValue:!0},autoScrollEditorIntoView:{set:function(e){this.setAutoScrollEditorIntoView(e)}},keyboardHandler:{set:function(e){this.setKeyboardHandler(e)},get:function(){return this.$keybindingId},handlesSet:!0},value:{set:function(e){this.session.setValue(e)},get:function(){return this.getValue()},handlesSet:!0,hidden:!0},session:{set:function(e){this.setSession(e)},get:function(){return this.session},handlesSet:!0,hidden:!0},showLineNumbers:{set:function(e){this.renderer.$gutterLayer.setShowLineNumbers(e),this.renderer.$loop.schedule(this.renderer.CHANGE_GUTTER),e&&this.$relativeLineNumbers?A.attach(this):A.detach(this)},initialValue:!0},relativeLineNumbers:{set:function(e){this.$showLineNumbers&&e?A.attach(this):A.detach(this)}},placeholder:{set:function(e){this.$updatePlaceholder||(this.$updatePlaceholder=function(){var e=this.session&&(this.renderer.$composition||this.session.getLength()>1||this.session.getLine(0).length>0);if(e&&this.renderer.placeholderNode)this.renderer.off("afterRender",this.$updatePlaceholder),r.removeCssClass(this.container,"ace_hasPlaceholder"),this.renderer.placeholderNode.remove(),this.renderer.placeholderNode=null;else if(e||this.renderer.placeholderNode)!e&&this.renderer.placeholderNode&&(this.renderer.placeholderNode.textContent=this.$placeholder||"");else{this.renderer.on("afterRender",this.$updatePlaceholder),r.addCssClass(this.container,"ace_hasPlaceholder");var t=r.createElement("div");t.className="ace_placeholder",t.textContent=this.$placeholder||"",this.renderer.placeholderNode=t,this.renderer.content.appendChild(this.renderer.placeholderNode)}}.bind(this),this.on("input",this.$updatePlaceholder)),this.$updatePlaceholder()}},enableKeyboardAccessibility:{set:function(e){var t,n={name:"blurTextInput",description:"Set focus to the editor content div to allow tabbing through the page",bindKey:"Esc",exec:function(e){e.blur(),e.renderer.scroller.focus()},readOnly:!0},i=function(e){if(e.target==this.renderer.scroller&&e.keyCode===C.enter){e.preventDefault();var t=this.getCursorPosition().row;this.isRowVisible(t)||this.scrollToLine(t,!0,!0),this.focus()}};e?(this.renderer.enableKeyboardAccessibility=!0,this.renderer.keyboardFocusClassName="ace_keyboard-focus",this.textInput.getElement().setAttribute("tabindex",-1),this.textInput.setNumberOfExtraLines(a.isWin?3:0),this.renderer.scroller.setAttribute("tabindex",0),this.renderer.scroller.setAttribute("role","group"),this.renderer.scroller.setAttribute("aria-roledescription",_("editor")),this.renderer.scroller.classList.add(this.renderer.keyboardFocusClassName),this.renderer.scroller.setAttribute("aria-label",_("Editor content, press Enter to start editing, press Escape to exit")),this.renderer.scroller.addEventListener("keyup",i.bind(this)),this.commands.addCommand(n),this.renderer.$gutter.setAttribute("tabindex",0),this.renderer.$gutter.setAttribute("aria-hidden",!1),this.renderer.$gutter.setAttribute("role","group"),this.renderer.$gutter.setAttribute("aria-roledescription",_("editor")),this.renderer.$gutter.setAttribute("aria-label",_("Editor gutter, press Enter to interact with controls using arrow keys, press Escape to exit")),this.renderer.$gutter.classList.add(this.renderer.keyboardFocusClassName),this.renderer.content.setAttribute("aria-hidden",!0),t||(t=new w(this)),t.addListener()):(this.renderer.enableKeyboardAccessibility=!1,this.textInput.getElement().setAttribute("tabindex",0),this.textInput.setNumberOfExtraLines(0),this.renderer.scroller.setAttribute("tabindex",-1),this.renderer.scroller.removeAttribute("role"),this.renderer.scroller.removeAttribute("aria-roledescription"),this.renderer.scroller.classList.remove(this.renderer.keyboardFocusClassName),this.renderer.scroller.removeAttribute("aria-label"),this.renderer.scroller.removeEventListener("keyup",i.bind(this)),this.commands.removeCommand(n),this.renderer.content.removeAttribute("aria-hidden"),this.renderer.$gutter.setAttribute("tabindex",-1),this.renderer.$gutter.setAttribute("aria-hidden",!0),this.renderer.$gutter.removeAttribute("role"),this.renderer.$gutter.removeAttribute("aria-roledescription"),this.renderer.$gutter.removeAttribute("aria-label"),this.renderer.$gutter.classList.remove(this.renderer.keyboardFocusClassName),t&&t.removeListener())},initialValue:!1},customScrollbar:"renderer",hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",displayIndentGuides:"renderer",highlightIndentGuides:"renderer",showGutter:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",hasCssTransforms:"renderer",maxPixelHeight:"renderer",useTextareaForIME:"renderer",useResizeObserver:"renderer",useSvgGutterIcons:"renderer",showFoldedAnnotations:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"});var A={getText:function(e,t){return(Math.abs(e.selection.lead.row-t)||t+1+(t<9?"·":""))+""},getWidth:function(e,t,n){return Math.max(t.toString().length,(n.lastRow+1).toString().length,2)*n.characterWidth},update:function(e,t){t.renderer.$loop.schedule(t.renderer.CHANGE_GUTTER)},attach:function(e){e.renderer.$gutterLayer.$renderer=this,e.on("changeSelection",this.update),this.update(null,e)},detach:function(e){e.renderer.$gutterLayer.$renderer==this&&(e.renderer.$gutterLayer.$renderer=null),e.off("changeSelection",this.update),this.update(null,e)}};t.Editor=k})),ace.define("ace/layer/lines",[],(function(e,t,n){"use strict";var i=e("../lib/dom"),o=function(){function e(e,t){this.element=e,this.canvasHeight=t||5e5,this.element.style.height=2*this.canvasHeight+"px",this.cells=[],this.cellCache=[],this.$offsetCoefficient=0}return e.prototype.moveContainer=function(e){i.translate(this.element,0,-e.firstRowScreen*e.lineHeight%this.canvasHeight-e.offset*this.$offsetCoefficient)},e.prototype.pageChanged=function(e,t){return Math.floor(e.firstRowScreen*e.lineHeight/this.canvasHeight)!==Math.floor(t.firstRowScreen*t.lineHeight/this.canvasHeight)},e.prototype.computeLineTop=function(e,t,n){var i=t.firstRowScreen*t.lineHeight,o=Math.floor(i/this.canvasHeight);return n.documentToScreenRow(e,0)*t.lineHeight-o*this.canvasHeight},e.prototype.computeLineHeight=function(e,t,n){return t.lineHeight*n.getRowLineCount(e)},e.prototype.getLength=function(){return this.cells.length},e.prototype.get=function(e){return this.cells[e]},e.prototype.shift=function(){this.$cacheCell(this.cells.shift())},e.prototype.pop=function(){this.$cacheCell(this.cells.pop())},e.prototype.push=function(e){if(Array.isArray(e)){this.cells.push.apply(this.cells,e);for(var t=i.createFragment(this.element),n=0;n<e.length;n++)t.appendChild(e[n].element);this.element.appendChild(t)}else this.cells.push(e),this.element.appendChild(e.element)},e.prototype.unshift=function(e){if(Array.isArray(e)){this.cells.unshift.apply(this.cells,e);for(var t=i.createFragment(this.element),n=0;n<e.length;n++)t.appendChild(e[n].element);this.element.firstChild?this.element.insertBefore(t,this.element.firstChild):this.element.appendChild(t)}else this.cells.unshift(e),this.element.insertAdjacentElement("afterbegin",e.element)},e.prototype.last=function(){return this.cells.length?this.cells[this.cells.length-1]:null},e.prototype.$cacheCell=function(e){e&&(e.element.remove(),this.cellCache.push(e))},e.prototype.createCell=function(e,t,n,o){var r=this.cellCache.pop();if(!r){var s=i.createElement("div");o&&o(s),this.element.appendChild(s),r={element:s,text:"",row:e}}return r.row=e,r},e}();t.Lines=o})),ace.define("ace/layer/gutter",[],(function(e,t,n){"use strict";var i=e("../lib/dom"),o=e("../lib/oop"),r=e("../lib/lang"),s=e("../lib/event_emitter").EventEmitter,a=e("./lines").Lines,l=e("../config").nls,c=function(){function e(e){this.element=i.createElement("div"),this.element.className="ace_layer ace_gutter-layer",e.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$lines=new a(this.element),this.$lines.$offsetCoefficient=1}return e.prototype.setSession=function(e){this.session&&this.session.off("change",this.$updateAnnotations),this.session=e,e&&e.on("change",this.$updateAnnotations)},e.prototype.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},e.prototype.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},e.prototype.setAnnotations=function(e){this.$annotations=[];for(var t=0;t<e.length;t++){var n=e[t],i=n.row,o=this.$annotations[i];o||(o=this.$annotations[i]={text:[],type:[]});var s=n.text,a=n.type;s=s?r.escapeHTML(s):n.html||"",-1===o.text.indexOf(s)&&(o.text.push(s),o.type.push(a));var l=n.className;l?o.className=l:"error"==a?o.className=" ace_error":"warning"==a&&" ace_error"!=o.className?o.className=" ace_warning":"info"!=a||o.className||(o.className=" ace_info")}},e.prototype.$updateAnnotations=function(e){if(this.$annotations.length){var t=e.start.row,n=e.end.row-t;if(0===n);else if("remove"==e.action)this.$annotations.splice(t,n+1,null);else{var i=new Array(n+1);i.unshift(t,1),this.$annotations.splice.apply(this.$annotations,i)}}},e.prototype.update=function(e){this.config=e;var t=this.session,n=e.firstRow,i=Math.min(e.lastRow+e.gutterOffset,t.getLength()-1);this.oldLastRow=i,this.config=e,this.$lines.moveContainer(e),this.$updateCursorRow();for(var o=t.getNextFoldLine(n),r=o?o.start.row:1/0,s=null,a=-1,l=n;;){if(l>r&&(l=o.end.row+1,r=(o=t.getNextFoldLine(l,o))?o.start.row:1/0),l>i){for(;this.$lines.getLength()>a+1;)this.$lines.pop();break}(s=this.$lines.get(++a))?s.row=l:(s=this.$lines.createCell(l,e,this.session,u),this.$lines.push(s)),this.$renderCell(s,e,o,l),l++}this._signal("afterRender"),this.$updateGutterWidth(e)},e.prototype.$updateGutterWidth=function(e){var t=this.session,n=t.gutterRenderer||this.$renderer,i=t.$firstLineNumber,o=this.$lines.last()?this.$lines.last().text:"";(this.$fixedWidth||t.$useWrapMode)&&(o=t.getLength()+i-1);var r=n?n.getWidth(t,o,e):o.toString().length*e.characterWidth,s=this.$padding||this.$computePadding();(r+=s.left+s.right)===this.gutterWidth||isNaN(r)||(this.gutterWidth=r,this.element.parentNode.style.width=this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._signal("changeGutterWidth",r))},e.prototype.$updateCursorRow=function(){if(this.$highlightGutterLine){var e=this.session.selection.getCursor();this.$cursorRow!==e.row&&(this.$cursorRow=e.row)}},e.prototype.updateLineHighlight=function(){if(this.$highlightGutterLine){var e=this.session.selection.cursor.row;if(this.$cursorRow=e,!this.$cursorCell||this.$cursorCell.row!=e){this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ",""));var t=this.$lines.cells;this.$cursorCell=null;for(var n=0;n<t.length;n++){var i=t[n];if(i.row>=this.$cursorRow){if(i.row>this.$cursorRow){var o=this.session.getFoldLine(this.$cursorRow);if(!(n>0&&o&&o.start.row==t[n-1].row))break;i=t[n-1]}i.element.className="ace_gutter-active-line "+i.element.className,this.$cursorCell=i;break}}}}},e.prototype.scrollLines=function(e){var t=this.config;if(this.config=e,this.$updateCursorRow(),this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var n=Math.min(e.lastRow+e.gutterOffset,this.session.getLength()-1),i=this.oldLastRow;if(this.oldLastRow=n,!t||i<e.firstRow)return this.update(e);if(n<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var o=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);o>0;o--)this.$lines.shift();if(i>n)for(o=this.session.getFoldedRowCount(n+1,i);o>0;o--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLines(e,e.firstRow,t.firstRow-1)),n>i&&this.$lines.push(this.$renderLines(e,i+1,n)),this.updateLineHighlight(),this._signal("afterRender"),this.$updateGutterWidth(e)},e.prototype.$renderLines=function(e,t,n){for(var i=[],o=t,r=this.session.getNextFoldLine(o),s=r?r.start.row:1/0;o>s&&(o=r.end.row+1,s=(r=this.session.getNextFoldLine(o,r))?r.start.row:1/0),!(o>n);){var a=this.$lines.createCell(o,e,this.session,u);this.$renderCell(a,e,r,o),i.push(a),o++}return i},e.prototype.$renderCell=function(e,t,n,o){var r=e.element,s=this.session,a=r.childNodes[0],c=r.childNodes[1],u=r.childNodes[2],h=u.firstChild,d=s.$firstLineNumber,p=s.$breakpoints,f=s.$decorations,g=s.gutterRenderer||this.$renderer,m=this.$showFoldWidgets&&s.foldWidgets,y=n?n.start.row:Number.MAX_VALUE,v=t.lineHeight+"px",b=this.$useSvgGutterIcons?"ace_gutter-cell_svg-icons ":"ace_gutter-cell ",x=this.$useSvgGutterIcons?"ace_icon_svg":"ace_icon",w=(g?g.getText(s,o):o+d).toString();if(this.$highlightGutterLine&&(o==this.$cursorRow||n&&o<this.$cursorRow&&o>=y&&this.$cursorRow<=n.end.row)&&(b+="ace_gutter-active-line ",this.$cursorCell!=e&&(this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ","")),this.$cursorCell=e)),p[o]&&(b+=p[o]),f[o]&&(b+=f[o]),this.$annotations[o]&&o!==y&&(b+=this.$annotations[o].className),m){var _=m[o];null==_&&(_=m[o]=s.getFoldWidget(o))}if(_){var S="ace_fold-widget ace_"+_,C="start"==_&&o==y&&o<n.end.row;if(C){S+=" ace_closed";for(var k="",A=!1,M=o+1;M<=n.end.row;M++)if(this.$annotations[M]){if(" ace_error"===this.$annotations[M].className){A=!0,k=" ace_error_fold";break}" ace_warning"!==this.$annotations[M].className||(A=!0,k=" ace_warning_fold")}b+=k}else S+=" ace_open";c.className!=S&&(c.className=S),i.setStyle(c.style,"height",v),i.setStyle(c.style,"display","inline-block"),c.setAttribute("role","button"),c.setAttribute("tabindex","-1");var T=s.getFoldWidgetRange(o);T?c.setAttribute("aria-label",l("Toggle code folding, rows $0 through $1",[T.start.row+1,T.end.row+1])):n?c.setAttribute("aria-label",l("Toggle code folding, rows $0 through $1",[n.start.row+1,n.end.row+1])):c.setAttribute("aria-label",l("Toggle code folding, row $0",[o+1])),C?(c.setAttribute("aria-expanded","false"),c.setAttribute("title",l("Unfold code"))):(c.setAttribute("aria-expanded","true"),c.setAttribute("title",l("Fold code")))}else c&&(i.setStyle(c.style,"display","none"),c.setAttribute("tabindex","0"),c.removeAttribute("role"),c.removeAttribute("aria-label"));return A&&this.$showFoldedAnnotations?(u.className="ace_gutter_annotation",h.className=x,h.className+=k,i.setStyle(h.style,"height",v),i.setStyle(u.style,"display","block"),i.setStyle(u.style,"height",v),u.setAttribute("aria-label",l("Read annotations row $0",[w])),u.setAttribute("tabindex","-1"),u.setAttribute("role","button")):this.$annotations[o]?(u.className="ace_gutter_annotation",h.className=x,this.$useSvgGutterIcons?h.className+=this.$annotations[o].className:r.classList.add(this.$annotations[o].className.replace(" ","")),i.setStyle(h.style,"height",v),i.setStyle(u.style,"display","block"),i.setStyle(u.style,"height",v),u.setAttribute("aria-label",l("Read annotations row $0",[w])),u.setAttribute("tabindex","-1"),u.setAttribute("role","button")):(i.setStyle(u.style,"display","none"),u.removeAttribute("aria-label"),u.removeAttribute("role"),u.setAttribute("tabindex","0")),w!==a.data&&(a.data=w),r.className!=b&&(r.className=b),i.setStyle(e.element.style,"height",this.$lines.computeLineHeight(o,t,s)+"px"),i.setStyle(e.element.style,"top",this.$lines.computeLineTop(o,t,s)+"px"),e.text=w,"none"===u.style.display&&"none"===c.style.display?e.element.setAttribute("aria-hidden",!0):e.element.setAttribute("aria-hidden",!1),e},e.prototype.setHighlightGutterLine=function(e){this.$highlightGutterLine=e},e.prototype.setShowLineNumbers=function(e){this.$renderer=!e&&{getWidth:function(){return 0},getText:function(){return""}}},e.prototype.getShowLineNumbers=function(){return this.$showLineNumbers},e.prototype.setShowFoldWidgets=function(e){e?i.addCssClass(this.element,"ace_folding-enabled"):i.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=e,this.$padding=null},e.prototype.getShowFoldWidgets=function(){return this.$showFoldWidgets},e.prototype.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var e=i.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=(parseInt(e.borderLeftWidth)||0)+(parseInt(e.paddingLeft)||0)+1,this.$padding.right=(parseInt(e.borderRightWidth)||0)+(parseInt(e.paddingRight)||0),this.$padding},e.prototype.getRegion=function(e){var t=this.$padding||this.$computePadding(),n=this.element.getBoundingClientRect();return e.x<t.left+n.left?"markers":this.$showFoldWidgets&&e.x>n.right-t.right?"foldWidgets":void 0},e}();function u(e){var t=document.createTextNode("");e.appendChild(t);var n=i.createElement("span");e.appendChild(n);var o=i.createElement("span");e.appendChild(o);var r=i.createElement("span");return o.appendChild(r),e}c.prototype.$fixedWidth=!1,c.prototype.$highlightGutterLine=!0,c.prototype.$renderer="",c.prototype.$showLineNumbers=!0,c.prototype.$showFoldWidgets=!0,o.implement(c.prototype,s),t.Gutter=c})),ace.define("ace/layer/marker",[],(function(e,t,n){"use strict";var i=e("../range").Range,o=e("../lib/dom"),r=function(){function e(e){this.element=o.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)}return e.prototype.setPadding=function(e){this.$padding=e},e.prototype.setSession=function(e){this.session=e},e.prototype.setMarkers=function(e){this.markers=e},e.prototype.elt=function(e,t){var n=-1!=this.i&&this.element.childNodes[this.i];n?this.i++:(n=document.createElement("div"),this.element.appendChild(n),this.i=-1),n.style.cssText=t,n.className=e},e.prototype.update=function(e){if(e){var t;for(var n in this.config=e,this.i=0,this.markers){var i=this.markers[n];if(i.range){var o=i.range.clipRows(e.firstRow,e.lastRow);if(!o.isEmpty())if(o=o.toScreenRange(this.session),i.renderer){var r=this.$getTop(o.start.row,e),s=this.$padding+o.start.column*e.characterWidth;i.renderer(t,o,s,r,e,this)}else"fullLine"==i.type?this.drawFullLineMarker(t,o,i.clazz,e):"screenLine"==i.type?this.drawScreenLineMarker(t,o,i.clazz,e):o.isMultiLine()?"text"==i.type?this.drawTextMarker(t,o,i.clazz,e):this.drawMultiLineMarker(t,o,i.clazz,e):this.drawSingleLineMarker(t,o,i.clazz+" ace_start ace_br15",e)}else i.update(t,this,this.session,e)}if(-1!=this.i)for(;this.i<this.element.childElementCount;)this.element.removeChild(this.element.lastChild)}},e.prototype.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},e.prototype.drawTextMarker=function(e,t,n,o,r){for(var s=this.session,a=t.start.row,l=t.end.row,c=a,u=0,h=0,d=s.getScreenLastRowColumn(c),p=new i(c,t.start.column,c,h);c<=l;c++)p.start.row=p.end.row=c,p.start.column=c==a?t.start.column:s.getRowWrapIndent(c),p.end.column=d,u=h,h=d,d=c+1<l?s.getScreenLastRowColumn(c+1):c==l?0:t.end.column,this.drawSingleLineMarker(e,p,n+(c==a?" ace_start":"")+" ace_br"+((c==a||c==a+1&&t.start.column?1:0)|(u<h?2:0)|(h>d?4:0)|(c==l?8:0)),o,c==l?0:1,r)},e.prototype.drawMultiLineMarker=function(e,t,n,i,o){var r=this.$padding,s=i.lineHeight,a=this.$getTop(t.start.row,i),l=r+t.start.column*i.characterWidth;(o=o||"",this.session.$bidiHandler.isBidiRow(t.start.row))?((c=t.clone()).end.row=c.start.row,c.end.column=this.session.getLine(c.start.row).length,this.drawBidiSingleLineMarker(e,c,n+" ace_br1 ace_start",i,null,o)):this.elt(n+" ace_br1 ace_start","height:"+s+"px;right:0;top:"+a+"px;left:"+l+"px;"+(o||""));if(this.session.$bidiHandler.isBidiRow(t.end.row)){var c;(c=t.clone()).start.row=c.end.row,c.start.column=0,this.drawBidiSingleLineMarker(e,c,n+" ace_br12",i,null,o)}else{a=this.$getTop(t.end.row,i);var u=t.end.column*i.characterWidth;this.elt(n+" ace_br12","height:"+s+"px;width:"+u+"px;top:"+a+"px;left:"+r+"px;"+(o||""))}if(!((s=(t.end.row-t.start.row-1)*i.lineHeight)<=0)){a=this.$getTop(t.start.row+1,i);var h=(t.start.column?1:0)|(t.end.column?0:8);this.elt(n+(h?" ace_br"+h:""),"height:"+s+"px;right:0;top:"+a+"px;left:"+r+"px;"+(o||""))}},e.prototype.drawSingleLineMarker=function(e,t,n,i,o,r){if(this.session.$bidiHandler.isBidiRow(t.start.row))return this.drawBidiSingleLineMarker(e,t,n,i,o,r);var s=i.lineHeight,a=(t.end.column+(o||0)-t.start.column)*i.characterWidth,l=this.$getTop(t.start.row,i),c=this.$padding+t.start.column*i.characterWidth;this.elt(n,"height:"+s+"px;width:"+a+"px;top:"+l+"px;left:"+c+"px;"+(r||""))},e.prototype.drawBidiSingleLineMarker=function(e,t,n,i,o,r){var s=i.lineHeight,a=this.$getTop(t.start.row,i),l=this.$padding;this.session.$bidiHandler.getSelections(t.start.column,t.end.column).forEach((function(e){this.elt(n,"height:"+s+"px;width:"+(e.width+(o||0))+"px;top:"+a+"px;left:"+(l+e.left)+"px;"+(r||""))}),this)},e.prototype.drawFullLineMarker=function(e,t,n,i,o){var r=this.$getTop(t.start.row,i),s=i.lineHeight;t.start.row!=t.end.row&&(s+=this.$getTop(t.end.row,i)-r),this.elt(n,"height:"+s+"px;top:"+r+"px;left:0;right:0;"+(o||""))},e.prototype.drawScreenLineMarker=function(e,t,n,i,o){var r=this.$getTop(t.start.row,i),s=i.lineHeight;this.elt(n,"height:"+s+"px;top:"+r+"px;left:0;right:0;"+(o||""))},e}();r.prototype.$padding=0,t.Marker=r})),ace.define("ace/layer/text_util",[],(function(e,t,n){var i=new Set(["text","rparen","lparen"]);t.isTextToken=function(e){return i.has(e)}})),ace.define("ace/layer/text",[],(function(e,t,n){"use strict";var i=e("../lib/oop"),o=e("../lib/dom"),r=e("../lib/lang"),s=e("./lines").Lines,a=e("../lib/event_emitter").EventEmitter,l=e("../config").nls,c=e("./text_util").isTextToken,u=function(){function e(e){this.dom=o,this.element=this.dom.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this),this.$lines=new s(this.element)}return e.prototype.$updateEolChar=function(){var e=this.session.doc,t="\n"==e.getNewLineCharacter()&&"windows"!=e.getNewLineMode()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=t)return this.EOL_CHAR=t,!0},e.prototype.setPadding=function(e){this.$padding=e,this.element.style.margin="0 "+e+"px"},e.prototype.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},e.prototype.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},e.prototype.$setFontMetrics=function(e){this.$fontMetrics=e,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},e.prototype.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},e.prototype.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},e.prototype.setSession=function(e){this.session=e,e&&this.$computeTabString()},e.prototype.setShowInvisibles=function(e){return this.showInvisibles!=e&&(this.showInvisibles=e,"string"==typeof e?(this.showSpaces=/tab/i.test(e),this.showTabs=/space/i.test(e),this.showEOL=/eol/i.test(e)):this.showSpaces=this.showTabs=this.showEOL=e,this.$computeTabString(),!0)},e.prototype.setDisplayIndentGuides=function(e){return this.displayIndentGuides!=e&&(this.displayIndentGuides=e,this.$computeTabString(),!0)},e.prototype.setHighlightIndentGuides=function(e){return this.$highlightIndentGuides!==e&&(this.$highlightIndentGuides=e,e)},e.prototype.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;for(var t=this.$tabStrings=[0],n=1;n<e+1;n++){if(this.showTabs)(i=this.dom.createElement("span")).className="ace_invisible ace_invisible_tab",i.textContent=r.stringRepeat(this.TAB_CHAR,n),t.push(i);else t.push(this.dom.createTextNode(r.stringRepeat(" ",n),this.element))}if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var i,o="ace_indent-guide",s=this.showSpaces?" ace_invisible ace_invisible_space":"",a=this.showSpaces?r.stringRepeat(this.SPACE_CHAR,this.tabSize):r.stringRepeat(" ",this.tabSize),l=this.showTabs?" ace_invisible ace_invisible_tab":"",c=this.showTabs?r.stringRepeat(this.TAB_CHAR,this.tabSize):a;(i=this.dom.createElement("span")).className=o+s,i.textContent=a,this.$tabStrings[" "]=i,(i=this.dom.createElement("span")).className=o+l,i.textContent=c,this.$tabStrings["\t"]=i}},e.prototype.updateLines=function(e,t,n){if(this.config.lastRow!=e.lastRow||this.config.firstRow!=e.firstRow)return this.update(e);this.config=e;for(var i=Math.max(t,e.firstRow),o=Math.min(n,e.lastRow),r=this.element.childNodes,s=0,a=e.firstRow;a<i;a++){if(l=this.session.getFoldLine(a)){if(l.containsRow(i)){i=l.start.row;break}a=l.end.row}s++}for(var l,c=!1,u=(a=i,(l=this.session.getNextFoldLine(a))?l.start.row:1/0);a>u&&(a=l.end.row+1,u=(l=this.session.getNextFoldLine(a,l))?l.start.row:1/0),!(a>o);){var h=r[s++];if(h){this.dom.removeChildren(h),this.$renderLine(h,a,a==u&&l),c&&(h.style.top=this.$lines.computeLineTop(a,e,this.session)+"px");var d=e.lineHeight*this.session.getRowLength(a)+"px";h.style.height!=d&&(c=!0,h.style.height=d)}a++}if(c)for(;s<this.$lines.cells.length;){var p=this.$lines.cells[s++];p.element.style.top=this.$lines.computeLineTop(p.row,e,this.session)+"px"}},e.prototype.scrollLines=function(e){var t=this.config;if(this.config=e,this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var n=e.lastRow,i=t?t.lastRow:-1;if(!t||i<e.firstRow)return this.update(e);if(n<t.firstRow)return this.update(e);if(!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var o=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);o>0;o--)this.$lines.shift();if(t.lastRow>e.lastRow)for(o=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);o>0;o--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLinesFragment(e,e.firstRow,t.firstRow-1)),e.lastRow>t.lastRow&&this.$lines.push(this.$renderLinesFragment(e,t.lastRow+1,e.lastRow)),this.$highlightIndentGuide()},e.prototype.$renderLinesFragment=function(e,t,n){for(var i=[],r=t,s=this.session.getNextFoldLine(r),a=s?s.start.row:1/0;r>a&&(r=s.end.row+1,a=(s=this.session.getNextFoldLine(r,s))?s.start.row:1/0),!(r>n);){var l=this.$lines.createCell(r,e,this.session),c=l.element;this.dom.removeChildren(c),o.setStyle(c.style,"height",this.$lines.computeLineHeight(r,e,this.session)+"px"),o.setStyle(c.style,"top",this.$lines.computeLineTop(r,e,this.session)+"px"),this.$renderLine(c,r,r==a&&s),this.$useLineGroups()?c.className="ace_line_group":c.className="ace_line",c.setAttribute("data-line",r+1),this._signal("line element added",{element:c,line:r+1}),i.push(l),r++}return i},e.prototype.update=function(e){this.$lines.moveContainer(e),this.config=e;for(var t=e.firstRow,n=e.lastRow,i=this.$lines;i.getLength();)i.pop();i.push(this.$renderLinesFragment(e,t,n))},e.prototype.$renderToken=function(e,t,n,i,o){for(var s,a=this,u=/(\t)|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\uFEFF\uFFF9-\uFFFC\u2066\u2067\u2068\u202A\u202B\u202D\u202E\u202C\u2069]+)|(\u3000)|([\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3001-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,h=this.dom.createFragment(this.element),d=0;s=u.exec(i);){var p=s[1],f=s[2],g=s[3],m=s[4],y=s[5];if(a.showSpaces||!f){var v=d!=s.index?i.slice(d,s.index):"";if(d=s.index+s[0].length,v&&h.appendChild(this.dom.createTextNode(v,this.element)),p){var b=a.session.getScreenTabSize(t+s.index);h.appendChild(a.$tabStrings[b].cloneNode(!0)),t+=b-1}else if(f){if(a.showSpaces)(w=this.dom.createElement("span")).className="ace_invisible ace_invisible_space",w.textContent=r.stringRepeat(a.SPACE_CHAR,f.length),h.appendChild(w);else h.appendChild(this.dom.createTextNode(f,this.element))}else if(g){(w=this.dom.createElement("span")).className="ace_invisible ace_invisible_space ace_invalid",w.textContent=r.stringRepeat(a.SPACE_CHAR,g.length),h.appendChild(w)}else if(m){t+=1,(w=this.dom.createElement("span")).style.width=2*a.config.characterWidth+"px",w.className=a.showSpaces?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",w.textContent=a.showSpaces?a.SPACE_CHAR:m,h.appendChild(w)}else if(y){t+=1,(w=this.dom.createElement("span")).style.width=2*a.config.characterWidth+"px",w.className="ace_cjk",w.textContent=y,h.appendChild(w)}}}if(h.appendChild(this.dom.createTextNode(d?i.slice(d):i,this.element)),c(n.type))e.appendChild(h);else{var x="ace_"+n.type.replace(/\./g," ace_"),w=this.dom.createElement("span");"fold"==n.type&&(w.style.width=n.value.length*this.config.characterWidth+"px",w.setAttribute("title",l("Unfold code"))),w.className=x,w.appendChild(h),w.setAttribute("data-column",t),this._signal("token element added",{element:w,token:n,currentLineValue:i,line:e.row,column:t,startIndex:o}),e.appendChild(w)}return t+i.length},e.prototype.renderIndentGuide=function(e,t,n){var i=t.search(this.$indentGuideRe);if(i<=0||i>=n)return t;if(" "==t[0]){for(var o=(i-=i%this.tabSize)/this.tabSize,r=0;r<o;r++)e.appendChild(this.$tabStrings[" "].cloneNode(!0));return this.$highlightIndentGuide(),t.substr(i)}if("\t"==t[0]){for(r=0;r<i;r++)e.appendChild(this.$tabStrings["\t"].cloneNode(!0));return this.$highlightIndentGuide(),t.substr(i)}return this.$highlightIndentGuide(),t},e.prototype.$highlightIndentGuide=function(){if(this.$highlightIndentGuides&&this.displayIndentGuides){this.$highlightIndentGuideMarker={indentLevel:void 0,start:void 0,end:void 0,dir:void 0};var e=this.session.doc.$lines;if(e){var t=this.session.selection.getCursor(),n=/^\s*/.exec(this.session.doc.getLine(t.row))[0].length,i=Math.floor(n/this.tabSize);if(this.$highlightIndentGuideMarker={indentLevel:i,start:t.row},this.session.$bracketHighlight)for(var o=this.session.$bracketHighlight.ranges,r=0;r<o.length;r++)if(t.row!==o[r].start.row){this.$highlightIndentGuideMarker.end=o[r].start.row,t.row>o[r].start.row?this.$highlightIndentGuideMarker.dir=-1:this.$highlightIndentGuideMarker.dir=1;break}if(!this.$highlightIndentGuideMarker.end&&""!==e[t.row]&&t.column===e[t.row].length){this.$highlightIndentGuideMarker.dir=1;for(r=t.row+1;r<e.length;r++){var s=e[r],a=/^\s*/.exec(s)[0].length;if(""!==s&&(this.$highlightIndentGuideMarker.end=r,a<=n))break}}this.$renderHighlightIndentGuide()}}},e.prototype.$clearActiveIndentGuide=function(){for(var e=this.$lines.cells,t=0;t<e.length;t++){var n=e[t].element.childNodes;if(n.length>0)for(var i=0;i<n.length;i++)if(n[i].classList&&n[i].classList.contains("ace_indent-guide-active")){n[i].classList.remove("ace_indent-guide-active");break}}},e.prototype.$setIndentGuideActive=function(e,t){if(""!==this.session.doc.getLine(e.row)){var n=e.element.childNodes;if(n){var i=n[t-1];i&&i.classList&&i.classList.contains("ace_indent-guide")&&i.classList.add("ace_indent-guide-active")}}},e.prototype.$renderHighlightIndentGuide=function(){if(this.$lines){var e=this.$lines.cells;this.$clearActiveIndentGuide();var t=this.$highlightIndentGuideMarker.indentLevel;if(0!==t)if(1===this.$highlightIndentGuideMarker.dir)for(var n=0;n<e.length;n++){var i=e[n];if(this.$highlightIndentGuideMarker.end&&i.row>=this.$highlightIndentGuideMarker.start+1){if(i.row>=this.$highlightIndentGuideMarker.end)break;this.$setIndentGuideActive(i,t)}}else for(n=e.length-1;n>=0;n--){i=e[n];if(this.$highlightIndentGuideMarker.end&&i.row<this.$highlightIndentGuideMarker.start){if(i.row<=this.$highlightIndentGuideMarker.end)break;this.$setIndentGuideActive(i,t)}}}},e.prototype.$createLineElement=function(e){var t=this.dom.createElement("div");return t.className="ace_line",t.style.height=this.config.lineHeight+"px",t},e.prototype.$renderWrappedLine=function(e,t,n){var i=0,o=0,s=n[0],a=0,l=this.$createLineElement();e.appendChild(l);for(var c=0;c<t.length;c++){var u=t[c],h=u.value;if(0==c&&this.displayIndentGuides){if(i=h.length,!(h=this.renderIndentGuide(l,h,s)))continue;i-=h.length}if(i+h.length<s)a=this.$renderToken(l,a,u,h,0),i+=h.length;else{for(var d=i;i+h.length>=s;)a=this.$renderToken(l,a,u,h.substring(0,s-i),i-d),h=h.substring(s-i),i=s,l=this.$createLineElement(),e.appendChild(l),l.appendChild(this.dom.createTextNode(r.stringRepeat(" ",n.indent),this.element)),a=0,s=n[++o]||Number.MAX_VALUE;0!=h.length&&(a=this.$renderToken(l,a,u,h,i-d),i+=h.length)}}n[n.length-1]>this.MAX_LINE_LENGTH&&this.$renderOverflowMessage(l,a,null,"",!0)},e.prototype.$renderSimpleLine=function(e,t){for(var n=0,i=0;i<t.length;i++){var o=t[i],r=o.value;if(0!=i||!this.displayIndentGuides||(r=this.renderIndentGuide(e,r))){if(n+r.length>this.MAX_LINE_LENGTH)return this.$renderOverflowMessage(e,n,o,r);n=this.$renderToken(e,n,o,r,0)}}},e.prototype.$renderOverflowMessage=function(e,t,n,i,o){n&&this.$renderToken(e,t,n,i.slice(0,this.MAX_LINE_LENGTH-t),0);var r=this.dom.createElement("span");r.className="ace_inline_button ace_keyword ace_toggle_wrap",r.textContent=o?"<hide>":"<click to see more...>",e.appendChild(r)},e.prototype.$renderLine=function(e,t,n){if(n||0==n||(n=this.session.getFoldLine(t)),n)var i=this.$getFoldLineTokens(t,n);else i=this.session.getTokens(t);var o=e;if(i.length){var r=this.session.getRowSplitData(t);if(r&&r.length){e.row=t+1,this.$renderWrappedLine(e,i,r);o=e.lastChild}else{o=e;this.$useLineGroups()&&(o=this.$createLineElement(),e.appendChild(o)),o.row=t+1,this.$renderSimpleLine(o,i)}}else this.$useLineGroups()&&((o=this.$createLineElement()).row=t+1,e.appendChild(o));if(this.showEOL&&o){n&&(t=n.end.row);var s=this.dom.createElement("span");s.className="ace_invisible ace_invisible_eol",s.textContent=t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,o.appendChild(s)}},e.prototype.$getFoldLineTokens=function(e,t){var n=this.session,i=[];var o=n.getTokens(e);return t.walk((function(e,t,r,s,a){null!=e?i.push({type:"fold",value:e}):(a&&(o=n.getTokens(t)),o.length&&function(e,t,n){for(var o=0,r=0;r+e[o].value.length<t;)if(r+=e[o].value.length,++o==e.length)return;for(r!=t&&((s=e[o].value.substring(t-r)).length>n-t&&(s=s.substring(0,n-t)),i.push({type:e[o].type,value:s}),r=t+s.length,o+=1);r<n&&o<e.length;){var s;(s=e[o].value).length+r>n?i.push({type:e[o].type,value:s.substring(0,n-r)}):i.push(e[o]),r+=s.length,o+=1}}(o,s,r))}),t.end.row,this.session.getLine(t.end.row).length),i},e.prototype.$useLineGroups=function(){return this.session.getUseWrapMode()},e}();u.prototype.EOF_CHAR="¶",u.prototype.EOL_CHAR_LF="¬",u.prototype.EOL_CHAR_CRLF="¤",u.prototype.EOL_CHAR=u.prototype.EOL_CHAR_LF,u.prototype.TAB_CHAR="—",u.prototype.SPACE_CHAR="·",u.prototype.$padding=0,u.prototype.MAX_LINE_LENGTH=1e4,u.prototype.showInvisibles=!1,u.prototype.showSpaces=!1,u.prototype.showTabs=!1,u.prototype.showEOL=!1,u.prototype.displayIndentGuides=!0,u.prototype.$highlightIndentGuides=!0,u.prototype.$tabStrings=[],u.prototype.destroy={},u.prototype.onChangeTabSize=u.prototype.$computeTabString,i.implement(u.prototype,a),t.Text=u})),ace.define("ace/layer/cursor",[],(function(e,t,n){"use strict";var i=e("../lib/dom"),o=function(){function e(e){this.element=i.createElement("div"),this.element.className="ace_layer ace_cursor-layer",e.appendChild(this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),i.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateOpacity.bind(this)}return e.prototype.$updateOpacity=function(e){for(var t=this.cursors,n=t.length;n--;)i.setStyle(t[n].style,"opacity",e?"":"0")},e.prototype.$startCssAnimation=function(){for(var e=this.cursors,t=e.length;t--;)e[t].style.animationDuration=this.blinkInterval+"ms";this.$isAnimating=!0,setTimeout(function(){this.$isAnimating&&i.addCssClass(this.element,"ace_animate-blinking")}.bind(this))},e.prototype.$stopCssAnimation=function(){this.$isAnimating=!1,i.removeCssClass(this.element,"ace_animate-blinking")},e.prototype.setPadding=function(e){this.$padding=e},e.prototype.setSession=function(e){this.session=e},e.prototype.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},e.prototype.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},e.prototype.setSmoothBlinking=function(e){e!=this.smoothBlinking&&(this.smoothBlinking=e,i.setCssClass(this.element,"ace_smooth-blinking",e),this.$updateCursors(!0),this.restartTimer())},e.prototype.addCursor=function(){var e=i.createElement("div");return e.className="ace_cursor",this.element.appendChild(e),this.cursors.push(e),e},e.prototype.removeCursor=function(){if(this.cursors.length>1){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},e.prototype.hideCursor=function(){this.isVisible=!1,i.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},e.prototype.showCursor=function(){this.isVisible=!0,i.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},e.prototype.restartTimer=function(){var e=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.$stopCssAnimation(),this.smoothBlinking&&(this.$isSmoothBlinking=!1,i.removeCssClass(this.element,"ace_smooth-blinking")),e(!0),this.isBlinking&&this.blinkInterval&&this.isVisible)if(this.smoothBlinking&&(this.$isSmoothBlinking=!0,setTimeout(function(){this.$isSmoothBlinking&&i.addCssClass(this.element,"ace_smooth-blinking")}.bind(this))),i.HAS_CSS_ANIMATION)this.$startCssAnimation();else{var t=function(){this.timeoutId=setTimeout((function(){e(!1)}),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval((function(){e(!0),t()}),this.blinkInterval),t()}else this.$stopCssAnimation()},e.prototype.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var n=this.session.documentToScreenPosition(e);return{left:this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,e.row)?this.session.$bidiHandler.getPosLeft(n.column):n.column*this.config.characterWidth),top:(n.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight}},e.prototype.isCursorInView=function(e,t){return e.top>=0&&e.top<t.maxHeight},e.prototype.update=function(e){this.config=e;var t=this.session.$selectionMarkers,n=0,o=0;void 0!==t&&0!==t.length||(t=[{cursor:null}]);n=0;for(var r=t.length;n<r;n++){var s=this.getPixelPosition(t[n].cursor,!0);if(!((s.top>e.height+e.offset||s.top<0)&&n>1)){var a=this.cursors[o++]||this.addCursor(),l=a.style;this.drawCursor?this.drawCursor(a,s,e,t[n],this.session):this.isCursorInView(s,e)?(i.setStyle(l,"display","block"),i.translate(a,s.left,s.top),i.setStyle(l,"width",Math.round(e.characterWidth)+"px"),i.setStyle(l,"height",e.lineHeight+"px")):i.setStyle(l,"display","none")}}for(;this.cursors.length>o;)this.removeCursor();var c=this.session.getOverwrite();this.$setOverwrite(c),this.$pixelPos=s,this.restartTimer()},e.prototype.$setOverwrite=function(e){e!=this.overwrite&&(this.overwrite=e,e?i.addCssClass(this.element,"ace_overwrite-cursors"):i.removeCssClass(this.element,"ace_overwrite-cursors"))},e.prototype.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)},e}();o.prototype.$padding=0,o.prototype.drawCursor=null,t.Cursor=o})),ace.define("ace/scrollbar",[],(function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=e("./lib/oop"),s=e("./lib/dom"),a=e("./lib/event"),l=e("./lib/event_emitter").EventEmitter,c=32768,u=function(){function e(e,t){this.element=s.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+t,this.inner=s.createElement("div"),this.inner.className="ace_scrollbar-inner",this.inner.textContent=" ",this.element.appendChild(this.inner),e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,a.addListener(this.element,"scroll",this.onScroll.bind(this)),a.addListener(this.element,"mousedown",a.preventDefault)}return e.prototype.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e,this.coeff=1},e}();r.implement(u.prototype,l);var h=function(e){function t(t,n){var i=e.call(this,t,"-v")||this;return i.scrollTop=0,i.scrollHeight=0,n.$scrollbarWidth=i.width=s.scrollbarWidth(t.ownerDocument),i.inner.style.width=i.element.style.width=(i.width||15)+5+"px",i.$minWidth=0,i}return o(t,e),t.prototype.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var e=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-e)/(this.coeff-e)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},t.prototype.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},t.prototype.setHeight=function(e){this.element.style.height=e+"px"},t.prototype.setScrollHeight=function(e){this.scrollHeight=e,e>c?(this.coeff=c/e,e=c):1!=this.coeff&&(this.coeff=1),this.inner.style.height=e+"px"},t.prototype.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=e,this.element.scrollTop=e*this.coeff)},t}(u);h.prototype.setInnerHeight=h.prototype.setScrollHeight;var d=function(e){function t(t,n){var i=e.call(this,t,"-h")||this;return i.scrollLeft=0,i.height=n.$scrollbarWidth,i.inner.style.height=i.element.style.height=(i.height||15)+5+"px",i}return o(t,e),t.prototype.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},t.prototype.getHeight=function(){return this.isVisible?this.height:0},t.prototype.setWidth=function(e){this.element.style.width=e+"px"},t.prototype.setInnerWidth=function(e){this.inner.style.width=e+"px"},t.prototype.setScrollWidth=function(e){this.inner.style.width=e+"px"},t.prototype.setScrollLeft=function(e){this.scrollLeft!=e&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=e)},t}(u);t.ScrollBar=h,t.ScrollBarV=h,t.ScrollBarH=d,t.VScrollBar=h,t.HScrollBar=d})),ace.define("ace/scrollbar_custom",[],(function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=e("./lib/oop"),s=e("./lib/dom"),a=e("./lib/event"),l=e("./lib/event_emitter").EventEmitter;s.importCssString(".ace_editor>.ace_sb-v div, .ace_editor>.ace_sb-h div{\n  position: absolute;\n  background: rgba(128, 128, 128, 0.6);\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  border: 1px solid #bbb;\n  border-radius: 2px;\n  z-index: 8;\n}\n.ace_editor>.ace_sb-v, .ace_editor>.ace_sb-h {\n  position: absolute;\n  z-index: 6;\n  background: none;\n  overflow: hidden!important;\n}\n.ace_editor>.ace_sb-v {\n  z-index: 6;\n  right: 0;\n  top: 0;\n  width: 12px;\n}\n.ace_editor>.ace_sb-v div {\n  z-index: 8;\n  right: 0;\n  width: 100%;\n}\n.ace_editor>.ace_sb-h {\n  bottom: 0;\n  left: 0;\n  height: 12px;\n}\n.ace_editor>.ace_sb-h div {\n  bottom: 0;\n  height: 100%;\n}\n.ace_editor>.ace_sb_grabbed {\n  z-index: 8;\n  background: #000;\n}","ace_scrollbar.css",!1);var c=function(){function e(e,t){this.element=s.createElement("div"),this.element.className="ace_sb"+t,this.inner=s.createElement("div"),this.inner.className="",this.element.appendChild(this.inner),this.VScrollWidth=12,this.HScrollHeight=12,e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,a.addMultiMouseDownListener(this.element,[500,300,300],this,"onMouseDown")}return e.prototype.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e,this.coeff=1},e}();r.implement(c.prototype,l);var u=function(e){function t(t,n){var i=e.call(this,t,"-v")||this;return i.scrollTop=0,i.scrollHeight=0,i.parent=t,i.width=i.VScrollWidth,i.renderer=n,i.inner.style.width=i.element.style.width=(i.width||15)+"px",i.$minWidth=0,i}return o(t,e),t.prototype.onMouseDown=function(e,t){if("mousedown"===e&&0===a.getButton(t)&&2!==t.detail){if(t.target===this.inner){var n=this,i=t.clientY,o=t.clientY,r=this.thumbTop;a.capture(this.inner,(function(e){i=e.clientY}),(function(){clearInterval(s)}));var s=setInterval((function(){if(void 0!==i){var e=n.scrollTopFromThumbTop(r+i-o);e!==n.scrollTop&&n._emit("scroll",{data:e})}}),20);return a.preventDefault(t)}var l=t.clientY-this.element.getBoundingClientRect().top-this.thumbHeight/2;return this._emit("scroll",{data:this.scrollTopFromThumbTop(l)}),a.preventDefault(t)}},t.prototype.getHeight=function(){return this.height},t.prototype.scrollTopFromThumbTop=function(e){var t=e*(this.pageHeight-this.viewHeight)/(this.slideHeight-this.thumbHeight);return(t|=0)<0?t=0:t>this.pageHeight-this.viewHeight&&(t=this.pageHeight-this.viewHeight),t},t.prototype.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},t.prototype.setHeight=function(e){this.height=Math.max(0,e),this.slideHeight=this.height,this.viewHeight=this.height,this.setScrollHeight(this.pageHeight,!0)},t.prototype.setScrollHeight=function(e,t){(this.pageHeight!==e||t)&&(this.pageHeight=e,this.thumbHeight=this.slideHeight*this.viewHeight/this.pageHeight,this.thumbHeight>this.slideHeight&&(this.thumbHeight=this.slideHeight),this.thumbHeight<15&&(this.thumbHeight=15),this.inner.style.height=this.thumbHeight+"px",this.scrollTop>this.pageHeight-this.viewHeight&&(this.scrollTop=this.pageHeight-this.viewHeight,this.scrollTop<0&&(this.scrollTop=0),this._emit("scroll",{data:this.scrollTop})))},t.prototype.setScrollTop=function(e){this.scrollTop=e,e<0&&(e=0),this.thumbTop=e*(this.slideHeight-this.thumbHeight)/(this.pageHeight-this.viewHeight),this.inner.style.top=this.thumbTop+"px"},t}(c);u.prototype.setInnerHeight=u.prototype.setScrollHeight;var h=function(e){function t(t,n){var i=e.call(this,t,"-h")||this;return i.scrollLeft=0,i.scrollWidth=0,i.height=i.HScrollHeight,i.inner.style.height=i.element.style.height=(i.height||12)+"px",i.renderer=n,i}return o(t,e),t.prototype.onMouseDown=function(e,t){if("mousedown"===e&&0===a.getButton(t)&&2!==t.detail){if(t.target===this.inner){var n=this,i=t.clientX,o=t.clientX,r=this.thumbLeft;a.capture(this.inner,(function(e){i=e.clientX}),(function(){clearInterval(s)}));var s=setInterval((function(){if(void 0!==i){var e=n.scrollLeftFromThumbLeft(r+i-o);e!==n.scrollLeft&&n._emit("scroll",{data:e})}}),20);return a.preventDefault(t)}var l=t.clientX-this.element.getBoundingClientRect().left-this.thumbWidth/2;return this._emit("scroll",{data:this.scrollLeftFromThumbLeft(l)}),a.preventDefault(t)}},t.prototype.getHeight=function(){return this.isVisible?this.height:0},t.prototype.scrollLeftFromThumbLeft=function(e){var t=e*(this.pageWidth-this.viewWidth)/(this.slideWidth-this.thumbWidth);return(t|=0)<0?t=0:t>this.pageWidth-this.viewWidth&&(t=this.pageWidth-this.viewWidth),t},t.prototype.setWidth=function(e){this.width=Math.max(0,e),this.element.style.width=this.width+"px",this.slideWidth=this.width,this.viewWidth=this.width,this.setScrollWidth(this.pageWidth,!0)},t.prototype.setScrollWidth=function(e,t){(this.pageWidth!==e||t)&&(this.pageWidth=e,this.thumbWidth=this.slideWidth*this.viewWidth/this.pageWidth,this.thumbWidth>this.slideWidth&&(this.thumbWidth=this.slideWidth),this.thumbWidth<15&&(this.thumbWidth=15),this.inner.style.width=this.thumbWidth+"px",this.scrollLeft>this.pageWidth-this.viewWidth&&(this.scrollLeft=this.pageWidth-this.viewWidth,this.scrollLeft<0&&(this.scrollLeft=0),this._emit("scroll",{data:this.scrollLeft})))},t.prototype.setScrollLeft=function(e){this.scrollLeft=e,e<0&&(e=0),this.thumbLeft=e*(this.slideWidth-this.thumbWidth)/(this.pageWidth-this.viewWidth),this.inner.style.left=this.thumbLeft+"px"},t}(c);h.prototype.setInnerWidth=h.prototype.setScrollWidth,t.ScrollBar=u,t.ScrollBarV=u,t.ScrollBarH=h,t.VScrollBar=u,t.HScrollBar=h})),ace.define("ace/renderloop",[],(function(e,t,n){"use strict";var i=e("./lib/event"),o=function(){function e(e,t){this.onRender=e,this.pending=!1,this.changes=0,this.$recursionLimit=2,this.window=t||window;var n=this;this._flush=function(e){n.pending=!1;var t=n.changes;if(t&&(i.blockIdle(100),n.changes=0,n.onRender(t)),n.changes){if(n.$recursionLimit--<0)return;n.schedule()}else n.$recursionLimit=2}}return e.prototype.schedule=function(e){this.changes=this.changes|e,this.changes&&!this.pending&&(i.nextFrame(this._flush),this.pending=!0)},e.prototype.clear=function(e){var t=this.changes;return this.changes=0,t},e}();t.RenderLoop=o})),ace.define("ace/layer/font_metrics",[],(function(e,t,n){var i=e("../lib/oop"),o=e("../lib/dom"),r=e("../lib/lang"),s=e("../lib/event"),a=e("../lib/useragent"),l=e("../lib/event_emitter").EventEmitter,c=512,u="function"==typeof ResizeObserver,h=200,d=function(){function e(e){this.el=o.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=o.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=o.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),e.appendChild(this.el),this.$measureNode.textContent=r.stringRepeat("X",c),this.$characterSize={width:0,height:0},u?this.$addObserver():this.checkForSizeChanges()}return e.prototype.$setMeasureNodeStyles=function(e,t){e.width=e.height="auto",e.left=e.top="0px",e.visibility="hidden",e.position="absolute",e.whiteSpace="pre",a.isIE<8?e["font-family"]="inherit":e.font="inherit",e.overflow=t?"hidden":"visible"},e.prototype.checkForSizeChanges=function(e){if(void 0===e&&(e=this.$measureSizes()),e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},e.prototype.$addObserver=function(){var e=this;this.$observer=new window.ResizeObserver((function(t){e.checkForSizeChanges()})),this.$observer.observe(this.$measureNode)},e.prototype.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=s.onIdle((function t(){e.checkForSizeChanges(),s.onIdle(t,500)}),500)},e.prototype.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},e.prototype.$measureSizes=function(e){var t={height:(e||this.$measureNode).clientHeight,width:(e||this.$measureNode).clientWidth/c};return 0===t.width||0===t.height?null:t},e.prototype.$measureCharWidth=function(e){return this.$main.textContent=r.stringRepeat(e,c),this.$main.getBoundingClientRect().width/c},e.prototype.getCharacterWidth=function(e){var t=this.charSizes[e];return void 0===t&&(t=this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},e.prototype.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$observer&&this.$observer.disconnect(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},e.prototype.$getZoom=function(e){return e&&e.parentElement?(window.getComputedStyle(e).zoom||1)*this.$getZoom(e.parentElement):1},e.prototype.$initTransformMeasureNodes=function(){var e=function(e,t){return["div",{style:"position: absolute;top:"+e+"px;left:"+t+"px;"}]};this.els=o.buildDom([e(0,0),e(h,0),e(0,h),e(h,h)],this.el)},e.prototype.transformCoordinates=function(e,t){e&&(e=r(1/this.$getZoom(this.el),e));function n(e,t,n){var i=e[1]*t[0]-e[0]*t[1];return[(-t[1]*n[0]+t[0]*n[1])/i,(+e[1]*n[0]-e[0]*n[1])/i]}function i(e,t){return[e[0]-t[0],e[1]-t[1]]}function o(e,t){return[e[0]+t[0],e[1]+t[1]]}function r(e,t){return[e*t[0],e*t[1]]}function s(e){var t=e.getBoundingClientRect();return[t.left,t.top]}this.els||this.$initTransformMeasureNodes();var a=s(this.els[0]),l=s(this.els[1]),c=s(this.els[2]),u=s(this.els[3]),d=n(i(u,l),i(u,c),i(o(l,c),o(u,a))),p=r(1+d[0],i(l,a)),f=r(1+d[1],i(c,a));if(t){var g=t,m=d[0]*g[0]/h+d[1]*g[1]/h+1,y=o(r(g[0],p),r(g[1],f));return o(r(1/m/h,y),a)}var v=i(e,a),b=n(i(p,r(d[0],v)),i(f,r(d[1],v)),v);return r(h,b)},e}();d.prototype.$characterSize={width:0,height:0},i.implement(d.prototype,l),t.FontMetrics=d})),ace.define("ace/css/editor-css",[],(function(e,t,n){n.exports='\n.ace_br1 {border-top-left-radius    : 3px;}\n.ace_br2 {border-top-right-radius   : 3px;}\n.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}\n.ace_br4 {border-bottom-right-radius: 3px;}\n.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}\n.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}\n.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}\n.ace_br8 {border-bottom-left-radius : 3px;}\n.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}\n.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}\n.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}\n.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\n.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\n.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\n.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}\n\n\n.ace_editor {\n    position: relative;\n    overflow: hidden;\n    padding: 0;\n    font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'Source Code Pro\', \'source-code-pro\', monospace;\n    direction: ltr;\n    text-align: left;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n\n.ace_scroller {\n    position: absolute;\n    overflow: hidden;\n    top: 0;\n    bottom: 0;\n    background-color: inherit;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    cursor: text;\n}\n\n.ace_content {\n    position: absolute;\n    box-sizing: border-box;\n    min-width: 100%;\n    contain: style size layout;\n    font-variant-ligatures: no-common-ligatures;\n}\n\n.ace_keyboard-focus:focus {\n    box-shadow: inset 0 0 0 2px #5E9ED6;\n    outline: none;\n}\n\n.ace_dragging .ace_scroller:before{\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    content: \'\';\n    background: rgba(250, 250, 250, 0.01);\n    z-index: 1000;\n}\n.ace_dragging.ace_dark .ace_scroller:before{\n    background: rgba(0, 0, 0, 0.01);\n}\n\n.ace_gutter {\n    position: absolute;\n    overflow : hidden;\n    width: auto;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    cursor: default;\n    z-index: 4;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    contain: style size layout;\n}\n\n.ace_gutter-active-line {\n    position: absolute;\n    left: 0;\n    right: 0;\n}\n\n.ace_scroller.ace_scroll-left:after {\n    content: "";\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;\n    pointer-events: none;\n}\n\n.ace_gutter-cell, .ace_gutter-cell_svg-icons {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    padding-left: 19px;\n    padding-right: 6px;\n    background-repeat: no-repeat;\n}\n\n.ace_gutter-cell_svg-icons .ace_gutter_annotation {\n    margin-left: -14px;\n    float: left;\n}\n\n.ace_gutter-cell .ace_gutter_annotation {\n    margin-left: -19px;\n    float: left;\n}\n\n.ace_gutter-cell.ace_error, .ace_icon.ace_error, .ace_icon.ace_error_fold {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");\n    background-repeat: no-repeat;\n    background-position: 2px center;\n}\n\n.ace_gutter-cell.ace_warning, .ace_icon.ace_warning, .ace_icon.ace_warning_fold {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");\n    background-repeat: no-repeat;\n    background-position: 2px center;\n}\n\n.ace_gutter-cell.ace_info, .ace_icon.ace_info {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");\n    background-repeat: no-repeat;\n    background-position: 2px center;\n}\n.ace_dark .ace_gutter-cell.ace_info, .ace_dark .ace_icon.ace_info {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");\n}\n\n.ace_icon_svg.ace_error {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAxNiI+CjxnIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSJyZWQiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KPGNpcmNsZSBmaWxsPSJub25lIiBjeD0iOCIgY3k9IjgiIHI9IjciIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPGxpbmUgeDE9IjExIiB5MT0iNSIgeDI9IjUiIHkyPSIxMSIvPgo8bGluZSB4MT0iMTEiIHkxPSIxMSIgeDI9IjUiIHkyPSI1Ii8+CjwvZz4KPC9zdmc+");\n    background-color: crimson;\n}\n.ace_icon_svg.ace_warning {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAxNiI+CjxnIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSJkYXJrb3JhbmdlIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+Cjxwb2x5Z29uIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiIHBvaW50cz0iOCAxIDE1IDE1IDEgMTUgOCAxIi8+CjxyZWN0IHg9IjgiIHk9IjEyIiB3aWR0aD0iMC4wMSIgaGVpZ2h0PSIwLjAxIi8+CjxsaW5lIHgxPSI4IiB5MT0iNiIgeDI9IjgiIHkyPSIxMCIvPgo8L2c+Cjwvc3ZnPg==");\n    background-color: darkorange;\n}\n.ace_icon_svg.ace_info {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAxNiI+CjxnIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSJibHVlIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+CjxjaXJjbGUgZmlsbD0ibm9uZSIgY3g9IjgiIGN5PSI4IiByPSI3IiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjxwb2x5bGluZSBwb2ludHM9IjggMTEgOCA4Ii8+Cjxwb2x5bGluZSBwb2ludHM9IjkgOCA2IDgiLz4KPGxpbmUgeDE9IjEwIiB5MT0iMTEiIHgyPSI2IiB5Mj0iMTEiLz4KPHJlY3QgeD0iOCIgeT0iNSIgd2lkdGg9IjAuMDEiIGhlaWdodD0iMC4wMSIvPgo8L2c+Cjwvc3ZnPg==");\n    background-color: royalblue;\n}\n\n.ace_icon_svg.ace_error_fold {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAxNiIgZmlsbD0ibm9uZSI+CiAgPHBhdGggZD0ibSAxOC45Mjk4NTEsNy44Mjk4MDc2IGMgMC4xNDYzNTMsNi4zMzc0NjA0IC02LjMyMzE0Nyw3Ljc3Nzg0NDQgLTcuNDc3OTEyLDcuNzc3ODQ0NCAtMi4xMDcyNzI2LC0wLjEyODc1IDUuMTE3Njc4LDAuMzU2MjQ5IDUuMDUxNjk4LC03Ljg3MDA2MTggLTAuNjA0NjcyLC04LjAwMzk3MzQ5IC03LjA3NzI3MDYsLTcuNTYzMTE4OSAtNC44NTczLC03LjQzMDM5NTU2IDEuNjA2LC0wLjExNTE0MjI1IDYuODk3NDg1LDEuMjYyNTQ1OTYgNy4yODM1MTQsNy41MjI2MTI5NiB6IiBmaWxsPSJjcmltc29uIiBzdHJva2Utd2lkdGg9IjIiLz4KICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0ibSA4LjExNDc1NjIsMi4wNTI5ODI4IGMgMy4zNDkxNjk4LDAgNi4wNjQxMzI4LDIuNjc2ODYyNyA2LjA2NDEzMjgsNS45Nzg5NTMgMCwzLjMwMjExMjIgLTIuNzE0OTYzLDUuOTc4OTIwMiAtNi4wNjQxMzI4LDUuOTc4OTIwMiAtMy4zNDkxNDczLDAgLTYuMDY0MTc3MiwtMi42NzY4MDggLTYuMDY0MTc3MiwtNS45Nzg5MjAyIDAuMDA1MzksLTMuMjk5ODg2MSAyLjcxNzI2NTYsLTUuOTczNjQwOCA2LjA2NDE3NzIsLTUuOTc4OTUzIHogbSAwLC0xLjczNTgyNzE5IGMgLTQuMzIxNDgzNiwwIC03LjgyNDc0MDM4LDMuNDU0MDE4NDkgLTcuODI0NzQwMzgsNy43MTQ3ODAxOSAwLDQuMjYwNzI4MiAzLjUwMzI1Njc4LDcuNzE0NzQ1MiA3LjgyNDc0MDM4LDcuNzE0NzQ1MiA0LjMyMTQ0OTgsMCA3LjgyNDY5OTgsLTMuNDU0MDE3IDcuODI0Njk5OCwtNy43MTQ3NDUyIDAsLTIuMDQ2MDkxNCAtMC44MjQzOTIsLTQuMDA4MzY3MiAtMi4yOTE3NTYsLTUuNDU1MTc0NiBDIDEyLjE4MDIyNSwxLjEyOTk2NDggMTAuMTkwMDEzLDAuMzE3MTU1NjEgOC4xMTQ3NTYyLDAuMzE3MTU1NjEgWiBNIDYuOTM3NDU2Myw4LjI0MDU5ODUgNC42NzE4Njg1LDEwLjQ4NTg1MiA2LjAwODY4MTQsMTEuODc2NzI4IDguMzE3MDAzNSw5LjYwMDc5MTEgMTAuNjI1MzM3LDExLjg3NjcyOCAxMS45NjIxMzgsMTAuNDg1ODUyIDkuNjk2NTUwOCw4LjI0MDU5ODUgMTEuOTYyMTM4LDYuMDA2ODA2NiAxMC41NzMyNDYsNC42Mzc0MzM1IDguMzE3MDAzNSw2Ljg3MzQyOTcgNi4wNjA3NjA3LDQuNjM3NDMzNSA0LjY3MTg2ODUsNi4wMDY4MDY2IFoiIGZpbGw9ImNyaW1zb24iIHN0cm9rZS13aWR0aD0iMiIvPgo8L3N2Zz4=");\n    background-color: crimson;\n}\n.ace_icon_svg.ace_warning_fold {\n    -webkit-mask-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAyMCAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNC43NzY5IDE0LjczMzdMOC42NTE5MiAyLjQ4MzY5QzguMzI5NDYgMS44Mzg3NyA3LjQwOTEzIDEuODM4NzcgNy4wODY2NyAyLjQ4MzY5TDAuOTYxNjY5IDE0LjczMzdDMC42NzA3NzUgMTUuMzE1NSAxLjA5MzgzIDE2IDEuNzQ0MjkgMTZIMTMuOTk0M0MxNC42NDQ4IDE2IDE1LjA2NzggMTUuMzE1NSAxNC43NzY5IDE0LjczMzdaTTMuMTYwMDcgMTQuMjVMNy44NjkyOSA0LjgzMTU2TDEyLjU3ODUgMTQuMjVIMy4xNjAwN1pNOC43NDQyOSAxMS42MjVWMTMuMzc1SDYuOTk0MjlWMTEuNjI1SDguNzQ0MjlaTTYuOTk0MjkgMTAuNzVWNy4yNUg4Ljc0NDI5VjEwLjc1SDYuOTk0MjlaIiBmaWxsPSIjRUM3MjExIi8+CjxwYXRoIGQ9Ik0xMS4xOTkxIDIuOTUyMzhDMTAuODgwOSAyLjMxNDY3IDEwLjM1MzcgMS44MDUyNiA5LjcwNTUgMS41MDlMMTEuMDQxIDEuMDY5NzhDMTEuNjg4MyAwLjk0OTgxNCAxMi4zMzcgMS4yNzI2MyAxMi42MzE3IDEuODYxNDFMMTcuNjEzNiAxMS44MTYxQzE4LjM1MjcgMTMuMjkyOSAxNy41OTM4IDE1LjA4MDQgMTYuMDE4IDE1LjU3NDVDMTYuNDA0NCAxNC40NTA3IDE2LjMyMzEgMTMuMjE4OCAxNS43OTI0IDEyLjE1NTVMMTEuMTk5MSAyLjk1MjM4WiIgZmlsbD0iI0VDNzIxMSIvPgo8L3N2Zz4=");\n    background-color: darkorange;\n}\n\n.ace_scrollbar {\n    contain: strict;\n    position: absolute;\n    right: 0;\n    bottom: 0;\n    z-index: 6;\n}\n\n.ace_scrollbar-inner {\n    position: absolute;\n    cursor: text;\n    left: 0;\n    top: 0;\n}\n\n.ace_scrollbar-v{\n    overflow-x: hidden;\n    overflow-y: scroll;\n    top: 0;\n}\n\n.ace_scrollbar-h {\n    overflow-x: scroll;\n    overflow-y: hidden;\n    left: 0;\n}\n\n.ace_print-margin {\n    position: absolute;\n    height: 100%;\n}\n\n.ace_text-input {\n    position: absolute;\n    z-index: 0;\n    width: 0.5em;\n    height: 1em;\n    opacity: 0;\n    background: transparent;\n    -moz-appearance: none;\n    appearance: none;\n    border: none;\n    resize: none;\n    outline: none;\n    overflow: hidden;\n    font: inherit;\n    padding: 0 1px;\n    margin: 0 -1px;\n    contain: strict;\n    -ms-user-select: text;\n    -moz-user-select: text;\n    -webkit-user-select: text;\n    user-select: text;\n    /*with `pre-line` chrome inserts &nbsp; instead of space*/\n    white-space: pre!important;\n}\n.ace_text-input.ace_composition {\n    background: transparent;\n    color: inherit;\n    z-index: 1000;\n    opacity: 1;\n}\n.ace_composition_placeholder { color: transparent }\n.ace_composition_marker { \n    border-bottom: 1px solid;\n    position: absolute;\n    border-radius: 0;\n    margin-top: 1px;\n}\n\n[ace_nocontext=true] {\n    transform: none!important;\n    filter: none!important;\n    clip-path: none!important;\n    mask : none!important;\n    contain: none!important;\n    perspective: none!important;\n    mix-blend-mode: initial!important;\n    z-index: auto;\n}\n\n.ace_layer {\n    z-index: 1;\n    position: absolute;\n    overflow: hidden;\n    /* workaround for chrome bug https://github.com/ajaxorg/ace/issues/2312*/\n    word-wrap: normal;\n    white-space: pre;\n    height: 100%;\n    width: 100%;\n    box-sizing: border-box;\n    /* setting pointer-events: auto; on node under the mouse, which changes\n        during scroll, will break mouse wheel scrolling in Safari */\n    pointer-events: none;\n}\n\n.ace_gutter-layer {\n    position: relative;\n    width: auto;\n    text-align: right;\n    pointer-events: auto;\n    height: 1000000px;\n    contain: style size layout;\n}\n\n.ace_text-layer {\n    font: inherit !important;\n    position: absolute;\n    height: 1000000px;\n    width: 1000000px;\n    contain: style size layout;\n}\n\n.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {\n    contain: style size layout;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n}\n\n.ace_hidpi .ace_text-layer,\n.ace_hidpi .ace_gutter-layer,\n.ace_hidpi .ace_content,\n.ace_hidpi .ace_gutter {\n    contain: strict;\n}\n.ace_hidpi .ace_text-layer > .ace_line, \n.ace_hidpi .ace_text-layer > .ace_line_group {\n    contain: strict;\n}\n\n.ace_cjk {\n    display: inline-block;\n    text-align: center;\n}\n\n.ace_cursor-layer {\n    z-index: 4;\n}\n\n.ace_cursor {\n    z-index: 4;\n    position: absolute;\n    box-sizing: border-box;\n    border-left: 2px solid;\n    /* workaround for smooth cursor repaintng whole screen in chrome */\n    transform: translatez(0);\n}\n\n.ace_multiselect .ace_cursor {\n    border-left-width: 1px;\n}\n\n.ace_slim-cursors .ace_cursor {\n    border-left-width: 1px;\n}\n\n.ace_overwrite-cursors .ace_cursor {\n    border-left-width: 0;\n    border-bottom: 1px solid;\n}\n\n.ace_hidden-cursors .ace_cursor {\n    opacity: 0.2;\n}\n\n.ace_hasPlaceholder .ace_hidden-cursors .ace_cursor {\n    opacity: 0;\n}\n\n.ace_smooth-blinking .ace_cursor {\n    transition: opacity 0.18s;\n}\n\n.ace_animate-blinking .ace_cursor {\n    animation-duration: 1000ms;\n    animation-timing-function: step-end;\n    animation-name: blink-ace-animate;\n    animation-iteration-count: infinite;\n}\n\n.ace_animate-blinking.ace_smooth-blinking .ace_cursor {\n    animation-duration: 1000ms;\n    animation-timing-function: ease-in-out;\n    animation-name: blink-ace-animate-smooth;\n}\n    \n@keyframes blink-ace-animate {\n    from, to { opacity: 1; }\n    60% { opacity: 0; }\n}\n\n@keyframes blink-ace-animate-smooth {\n    from, to { opacity: 1; }\n    45% { opacity: 1; }\n    60% { opacity: 0; }\n    85% { opacity: 0; }\n}\n\n.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {\n    position: absolute;\n    z-index: 3;\n}\n\n.ace_marker-layer .ace_selection {\n    position: absolute;\n    z-index: 5;\n}\n\n.ace_marker-layer .ace_bracket {\n    position: absolute;\n    z-index: 6;\n}\n\n.ace_marker-layer .ace_error_bracket {\n    position: absolute;\n    border-bottom: 1px solid #DE5555;\n    border-radius: 0;\n}\n\n.ace_marker-layer .ace_active-line {\n    position: absolute;\n    z-index: 2;\n}\n\n.ace_marker-layer .ace_selected-word {\n    position: absolute;\n    z-index: 4;\n    box-sizing: border-box;\n}\n\n.ace_line .ace_fold {\n    box-sizing: border-box;\n\n    display: inline-block;\n    height: 11px;\n    margin-top: -2px;\n    vertical-align: middle;\n\n    background-image:\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");\n    background-repeat: no-repeat, repeat-x;\n    background-position: center center, top left;\n    color: transparent;\n\n    border: 1px solid black;\n    border-radius: 2px;\n\n    cursor: pointer;\n    pointer-events: auto;\n}\n\n.ace_dark .ace_fold {\n}\n\n.ace_fold:hover{\n    background-image:\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");\n}\n\n.ace_tooltip {\n    background-color: #f5f5f5;\n    border: 1px solid gray;\n    border-radius: 1px;\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\n    color: black;\n    max-width: 100%;\n    padding: 3px 4px;\n    position: fixed;\n    z-index: 999999;\n    box-sizing: border-box;\n    cursor: default;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    line-height: normal;\n    font-style: normal;\n    font-weight: normal;\n    letter-spacing: normal;\n    pointer-events: none;\n    overflow: auto;\n    max-width: min(60em, 66vw);\n    overscroll-behavior: contain;\n}\n.ace_tooltip pre {\n    white-space: pre-wrap;\n}\n\n.ace_tooltip.ace_dark {\n    background-color: #636363;\n    color: #fff;\n}\n\n.ace_tooltip:focus {\n    outline: 1px solid #5E9ED6;\n}\n\n.ace_icon {\n    display: inline-block;\n    width: 18px;\n    vertical-align: top;\n}\n\n.ace_icon_svg {\n    display: inline-block;\n    width: 12px;\n    vertical-align: top;\n    -webkit-mask-repeat: no-repeat;\n    -webkit-mask-size: 12px;\n    -webkit-mask-position: center;\n}\n\n.ace_folding-enabled > .ace_gutter-cell, .ace_folding-enabled > .ace_gutter-cell_svg-icons {\n    padding-right: 13px;\n}\n\n.ace_fold-widget {\n    box-sizing: border-box;\n\n    margin: 0 -12px 0 1px;\n    display: none;\n    width: 11px;\n    vertical-align: top;\n\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");\n    background-repeat: no-repeat;\n    background-position: center;\n\n    border-radius: 3px;\n    \n    border: 1px solid transparent;\n    cursor: pointer;\n}\n\n.ace_folding-enabled .ace_fold-widget {\n    display: inline-block;   \n}\n\n.ace_fold-widget.ace_end {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");\n}\n\n.ace_fold-widget.ace_closed {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");\n}\n\n.ace_fold-widget:hover {\n    border: 1px solid rgba(0, 0, 0, 0.3);\n    background-color: rgba(255, 255, 255, 0.2);\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);\n}\n\n.ace_fold-widget:active {\n    border: 1px solid rgba(0, 0, 0, 0.4);\n    background-color: rgba(0, 0, 0, 0.05);\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);\n}\n/**\n * Dark version for fold widgets\n */\n.ace_dark .ace_fold-widget {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");\n}\n.ace_dark .ace_fold-widget.ace_end {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");\n}\n.ace_dark .ace_fold-widget.ace_closed {\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");\n}\n.ace_dark .ace_fold-widget:hover {\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);\n    background-color: rgba(255, 255, 255, 0.1);\n}\n.ace_dark .ace_fold-widget:active {\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);\n}\n\n.ace_inline_button {\n    border: 1px solid lightgray;\n    display: inline-block;\n    margin: -1px 8px;\n    padding: 0 5px;\n    pointer-events: auto;\n    cursor: pointer;\n}\n.ace_inline_button:hover {\n    border-color: gray;\n    background: rgba(200,200,200,0.2);\n    display: inline-block;\n    pointer-events: auto;\n}\n\n.ace_fold-widget.ace_invalid {\n    background-color: #FFB4B4;\n    border-color: #DE5555;\n}\n\n.ace_fade-fold-widgets .ace_fold-widget {\n    transition: opacity 0.4s ease 0.05s;\n    opacity: 0;\n}\n\n.ace_fade-fold-widgets:hover .ace_fold-widget {\n    transition: opacity 0.05s ease 0.05s;\n    opacity:1;\n}\n\n.ace_underline {\n    text-decoration: underline;\n}\n\n.ace_bold {\n    font-weight: bold;\n}\n\n.ace_nobold .ace_bold {\n    font-weight: normal;\n}\n\n.ace_italic {\n    font-style: italic;\n}\n\n\n.ace_error-marker {\n    background-color: rgba(255, 0, 0,0.2);\n    position: absolute;\n    z-index: 9;\n}\n\n.ace_highlight-marker {\n    background-color: rgba(255, 255, 0,0.2);\n    position: absolute;\n    z-index: 8;\n}\n\n.ace_mobile-menu {\n    position: absolute;\n    line-height: 1.5;\n    border-radius: 4px;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    background: white;\n    box-shadow: 1px 3px 2px grey;\n    border: 1px solid #dcdcdc;\n    color: black;\n}\n.ace_dark > .ace_mobile-menu {\n    background: #333;\n    color: #ccc;\n    box-shadow: 1px 3px 2px grey;\n    border: 1px solid #444;\n\n}\n.ace_mobile-button {\n    padding: 2px;\n    cursor: pointer;\n    overflow: hidden;\n}\n.ace_mobile-button:hover {\n    background-color: #eee;\n    opacity:1;\n}\n.ace_mobile-button:active {\n    background-color: #ddd;\n}\n\n.ace_placeholder {\n    font-family: arial;\n    transform: scale(0.9);\n    transform-origin: left;\n    white-space: pre;\n    opacity: 0.7;\n    margin: 0 10px;\n}\n\n.ace_ghost_text {\n    opacity: 0.5;\n    font-style: italic;\n    white-space: pre;\n}\n\n.ace_screenreader-only {\n    position:absolute;\n    left:-10000px;\n    top:auto;\n    width:1px;\n    height:1px;\n    overflow:hidden;\n}'})),ace.define("ace/layer/decorators",[],(function(e,t,n){"use strict";var i=e("../lib/dom"),o=e("../lib/oop"),r=e("../lib/event_emitter").EventEmitter,s=function(){function e(e,t){this.canvas=i.createElement("canvas"),this.renderer=t,this.pixelRatio=1,this.maxHeight=t.layerConfig.maxHeight,this.lineHeight=t.layerConfig.lineHeight,this.canvasHeight=e.parent.scrollHeight,this.heightRatio=this.canvasHeight/this.maxHeight,this.canvasWidth=e.width,this.minDecorationHeight=2*this.pixelRatio|0,this.halfMinDecorationHeight=this.minDecorationHeight/2|0,this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight,this.canvas.style.top="0px",this.canvas.style.right="0px",this.canvas.style.zIndex="7px",this.canvas.style.position="absolute",this.colors={},this.colors.dark={error:"rgba(255, 18, 18, 1)",warning:"rgba(18, 136, 18, 1)",info:"rgba(18, 18, 136, 1)"},this.colors.light={error:"rgb(255,51,51)",warning:"rgb(32,133,72)",info:"rgb(35,68,138)"},e.element.appendChild(this.canvas)}return e.prototype.$updateDecorators=function(e){var t=!0===this.renderer.theme.isDark?this.colors.dark:this.colors.light;e&&(this.maxHeight=e.maxHeight,this.lineHeight=e.lineHeight,this.canvasHeight=e.height,(e.lastRow+1)*this.lineHeight<this.canvasHeight?this.heightRatio=1:this.heightRatio=this.canvasHeight/this.maxHeight);var n=this.canvas.getContext("2d");var i=this.renderer.session.$annotations;if(n.clearRect(0,0,this.canvas.width,this.canvas.height),i){var o={info:1,warning:2,error:3};i.forEach((function(e){e.priority=o[e.type]||null})),i=i.sort((function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}));for(var r=this.renderer.session.$foldData,s=0;s<i.length;s++){var a=i[s].row,l=this.compensateFoldRows(a,r),c=Math.round((a-l)*this.lineHeight*this.heightRatio),u=Math.round((a-l)*this.lineHeight*this.heightRatio),h=Math.round(((a-l)*this.lineHeight+this.lineHeight)*this.heightRatio);if(h-u<this.minDecorationHeight){var d=(u+h)/2|0;d<this.halfMinDecorationHeight?d=this.halfMinDecorationHeight:d+this.halfMinDecorationHeight>this.canvasHeight&&(d=this.canvasHeight-this.halfMinDecorationHeight),u=Math.round(d-this.halfMinDecorationHeight),h=Math.round(d+this.halfMinDecorationHeight)}n.fillStyle=t[i[s].type]||null,n.fillRect(0,c,this.canvasWidth,h-u)}}var p=this.renderer.session.selection.getCursor();if(p){l=this.compensateFoldRows(p.row,r),c=Math.round((p.row-l)*this.lineHeight*this.heightRatio);n.fillStyle="rgba(0, 0, 0, 0.5)",n.fillRect(0,c,this.canvasWidth,2)}},e.prototype.compensateFoldRows=function(e,t){var n=0;if(t&&t.length>0)for(var i=0;i<t.length;i++)e>t[i].start.row&&e<t[i].end.row?n+=e-t[i].start.row:e>=t[i].end.row&&(n+=t[i].end.row-t[i].start.row);return n},e}();o.implement(s.prototype,r),t.Decorator=s})),ace.define("ace/virtual_renderer",[],(function(e,t,n){"use strict";var i=e("./lib/oop"),o=e("./lib/dom"),r=e("./lib/lang"),s=e("./config"),a=e("./layer/gutter").Gutter,l=e("./layer/marker").Marker,c=e("./layer/text").Text,u=e("./layer/cursor").Cursor,h=e("./scrollbar").HScrollBar,d=e("./scrollbar").VScrollBar,p=e("./scrollbar_custom").HScrollBar,f=e("./scrollbar_custom").VScrollBar,g=e("./renderloop").RenderLoop,m=e("./layer/font_metrics").FontMetrics,y=e("./lib/event_emitter").EventEmitter,v=e("./css/editor-css"),b=e("./layer/decorators").Decorator,x=e("./lib/useragent");o.importCssString(v,"ace_editor.css",!1);var w=function(){function e(e,t){var n=this;this.container=e||o.createElement("div"),o.addCssClass(this.container,"ace_editor"),o.HI_DPI&&o.addCssClass(this.container,"ace_hidpi"),this.setTheme(t),null==s.get("useStrictCSP")&&s.set("useStrictCSP",!1),this.$gutter=o.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden","true"),this.scroller=o.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=o.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new a(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new l(this.content);var i=this.$textLayer=new c(this.content);this.canvas=i.element,this.$markerFront=new l(this.content),this.$cursorLayer=new u(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new d(this.container,this),this.scrollBarH=new h(this.container,this),this.scrollBarV.on("scroll",(function(e){n.$scrollAnimation||n.session.setScrollTop(e.data-n.scrollMargin.top)})),this.scrollBarH.on("scroll",(function(e){n.$scrollAnimation||n.session.setScrollLeft(e.data-n.scrollMargin.left)})),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new m(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.on("changeCharacterSize",(function(e){n.updateCharacterSize(),n.onResize(!0,n.gutterWidth,n.$size.width,n.$size.height),n._signal("changeCharacterSize",e)})),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.margin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$keepTextAreaAtCursor=!x.isIOS,this.$loop=new g(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),this.$addResizeObserver(),s.resetOptions(this),s._signal("renderer",this)}return e.prototype.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin(),o.setStyle(this.scroller.style,"line-height",this.lineHeight+"px")},e.prototype.setSession=function(e){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=e,e&&this.scrollMargin.top&&e.getScrollTop()<=0&&e.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e),e&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},e.prototype.updateLines=function(e,t,n){if(void 0===t&&(t=1/0),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!n)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},e.prototype.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},e.prototype.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},e.prototype.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},e.prototype.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},e.prototype.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},e.prototype.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},e.prototype.onResize=function(e,t,n,i){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=e?1:0;var o=this.container;i||(i=o.clientHeight||o.scrollHeight),n||(n=o.clientWidth||o.scrollWidth);var r=this.$updateCachedSize(e,t,n,i);if(this.$resizeTimer&&this.$resizeTimer.cancel(),!this.$size.scrollerHeight||!n&&!i)return this.resizing=0;e&&(this.$gutterLayer.$padding=null),e?this.$renderChanges(r|this.$changes,!0):this.$loop.schedule(r|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.$customScrollbar&&this.$updateCustomScrollbar(!0)}},e.prototype.$updateCachedSize=function(e,t,n,i){i-=this.$extraHeight||0;var r=0,s=this.$size,a={width:s.width,height:s.height,scrollerHeight:s.scrollerHeight,scrollerWidth:s.scrollerWidth};if(i&&(e||s.height!=i)&&(s.height=i,r|=this.CHANGE_SIZE,s.scrollerHeight=s.height,this.$horizScroll&&(s.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.setHeight(s.scrollerHeight),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",r|=this.CHANGE_SCROLL),n&&(e||s.width!=n)){r|=this.CHANGE_SIZE,s.width=n,null==t&&(t=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=t,o.setStyle(this.scrollBarH.element.style,"left",t+"px"),o.setStyle(this.scroller.style,"left",t+this.margin.left+"px"),s.scrollerWidth=Math.max(0,n-t-this.scrollBarV.getWidth()-this.margin.h),o.setStyle(this.$gutter.style,"left",this.margin.left+"px");var l=this.scrollBarV.getWidth()+"px";o.setStyle(this.scrollBarH.element.style,"right",l),o.setStyle(this.scroller.style,"right",l),o.setStyle(this.scroller.style,"bottom",this.scrollBarH.getHeight()),this.scrollBarH.setWidth(s.scrollerWidth),(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)&&(r|=this.CHANGE_FULL)}return s.$dirty=!n||!i,r&&this._signal("resize",a),r},e.prototype.onGutterResize=function(e){var t=this.$showGutter?e:0;t!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,t,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()||this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):this.$computeLayerConfig()},e.prototype.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-2*this.$padding,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},e.prototype.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},e.prototype.getAnimatedScroll=function(){return this.$animatedScroll},e.prototype.setShowInvisibles=function(e){this.setOption("showInvisibles",e),this.session.$bidiHandler.setShowInvisibles(e)},e.prototype.getShowInvisibles=function(){return this.getOption("showInvisibles")},e.prototype.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},e.prototype.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},e.prototype.getHighlightIndentGuides=function(){return this.getOption("highlightIndentGuides")},e.prototype.setHighlightIndentGuides=function(e){this.setOption("highlightIndentGuides",e)},e.prototype.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},e.prototype.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},e.prototype.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},e.prototype.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},e.prototype.getShowGutter=function(){return this.getOption("showGutter")},e.prototype.setShowGutter=function(e){return this.setOption("showGutter",e)},e.prototype.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},e.prototype.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},e.prototype.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},e.prototype.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},e.prototype.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var e=o.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=o.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var t=this.$printMarginEl.style;t.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px",t.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},e.prototype.getContainerElement=function(){return this.container},e.prototype.getMouseEventTarget=function(){return this.scroller},e.prototype.getTextAreaContainer=function(){return this.container},e.prototype.$moveTextAreaToCursor=function(){if(!this.$isMousePressed){var e=this.textarea.style,t=this.$composition;if(this.$keepTextAreaAtCursor||t){var n=this.$cursorLayer.$pixelPos;if(n){t&&t.markerRange&&(n=this.$cursorLayer.getPixelPosition(t.markerRange.start,!0));var i=this.layerConfig,r=n.top,s=n.left;r-=i.offset;var a=t&&t.useTextareaForIME||x.isMobile?this.lineHeight:1;if(r<0||r>i.height-a)o.translate(this.textarea,0,0);else{var l=1,c=this.$size.height-a;if(t)if(t.useTextareaForIME){var u=this.textarea.value;l=this.characterWidth*this.session.$getStringScreenWidth(u)[0]}else r+=this.lineHeight+2;else r+=this.lineHeight;(s-=this.scrollLeft)>this.$size.scrollerWidth-l&&(s=this.$size.scrollerWidth-l),s+=this.gutterWidth+this.margin.left,o.setStyle(e,"height",a+"px"),o.setStyle(e,"width",l+"px"),o.translate(this.textarea,Math.min(s,this.$size.scrollerWidth-l),Math.min(r,c))}}}else o.translate(this.textarea,-100,0)}},e.prototype.getFirstVisibleRow=function(){return this.layerConfig.firstRow},e.prototype.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},e.prototype.getLastFullyVisibleRow=function(){var e=this.layerConfig,t=e.lastRow;return this.session.documentToScreenRow(t,0)*e.lineHeight-this.session.getScrollTop()>e.height-e.lineHeight?t-1:t},e.prototype.getLastVisibleRow=function(){return this.layerConfig.lastRow},e.prototype.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},e.prototype.setScrollMargin=function(e,t,n,i){var o=this.scrollMargin;o.top=0|e,o.bottom=0|t,o.right=0|i,o.left=0|n,o.v=o.top+o.bottom,o.h=o.left+o.right,o.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-o.top),this.updateFull()},e.prototype.setMargin=function(e,t,n,i){var o=this.margin;o.top=0|e,o.bottom=0|t,o.right=0|i,o.left=0|n,o.v=o.top+o.bottom,o.h=o.left+o.right,this.$updateCachedSize(!0,this.gutterWidth,this.$size.width,this.$size.height),this.updateFull()},e.prototype.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},e.prototype.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},e.prototype.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},e.prototype.setVScrollBarAlwaysVisible=function(e){this.setOption("vScrollBarAlwaysVisible",e)},e.prototype.$updateScrollBarV=function(){var e=this.layerConfig.maxHeight,t=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(e-=(t-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>e-t&&(e=this.scrollTop+t,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(e+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},e.prototype.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},e.prototype.freeze=function(){this.$frozen=!0},e.prototype.unfreeze=function(){this.$frozen=!1},e.prototype.$renderChanges=function(e,t){if(this.$changes&&(e|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(e||t)){if(this.$size.$dirty)return this.$changes|=e,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender",e),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var n=this.layerConfig;if(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL||e&this.CHANGE_H_SCROLL){if(e|=this.$computeLayerConfig()|this.$loop.clear(),n.firstRow!=this.layerConfig.firstRow&&n.firstRowScreen==this.layerConfig.firstRowScreen){var i=this.scrollTop+(n.firstRow-Math.max(this.layerConfig.firstRow,0))*this.lineHeight;i>0&&(this.scrollTop=i,e|=this.CHANGE_SCROLL,e|=this.$computeLayerConfig()|this.$loop.clear())}n=this.layerConfig,this.$updateScrollBarV(),e&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),o.translate(this.content,-this.scrollLeft,-n.offset);var r=n.width+2*this.$padding+"px",s=n.minHeight+"px";o.setStyle(this.content.style,"width",r),o.setStyle(this.content.style,"height",s)}if(e&this.CHANGE_H_SCROLL&&(o.translate(this.content,-this.scrollLeft,-n.offset),this.scroller.className=this.scrollLeft<=0?"ace_scroller ":"ace_scroller ace_scroll-left ",this.enableKeyboardAccessibility&&(this.scroller.className+=this.keyboardFocusClassName)),e&this.CHANGE_FULL)return this.$changedLines=null,this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(n),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender",e);if(e&this.CHANGE_SCROLL)return this.$changedLines=null,e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(n):this.$textLayer.scrollLines(n),this.$showGutter&&(e&this.CHANGE_GUTTER||e&this.CHANGE_LINES?this.$gutterLayer.update(n):this.$gutterLayer.scrollLines(n)),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(n),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender",e);e&this.CHANGE_TEXT?(this.$changedLines=null,this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(n)):e&this.CHANGE_LINES?((this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(n),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(n)):e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER?(this.$showGutter&&this.$gutterLayer.update(n),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(n)):e&this.CHANGE_CURSOR&&(this.$highlightGutterLine&&this.$gutterLayer.updateLineHighlight(n),this.$customScrollbar&&this.$scrollDecorator.$updateDecorators(n)),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(n),this.$moveTextAreaToCursor()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(n),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(n),this._signal("afterRender",e)}else this.$changes|=e},e.prototype.$autosize=function(){var e=this.session.getScreenLength()*this.lineHeight,t=this.$maxLines*this.lineHeight,n=Math.min(t,Math.max((this.$minLines||1)*this.lineHeight,e))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(n+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&n>this.$maxPixelHeight&&(n=this.$maxPixelHeight);var i=!(n<=2*this.lineHeight)&&e>t;if(n!=this.desiredHeight||this.$size.height!=this.desiredHeight||i!=this.$vScroll){i!=this.$vScroll&&(this.$vScroll=i,this.scrollBarV.setVisible(i));var o=this.container.clientWidth;this.container.style.height=n+"px",this.$updateCachedSize(!0,this.$gutterWidth,o,n),this.desiredHeight=n,this._signal("autosize")}},e.prototype.$computeLayerConfig=function(){var e=this.session,t=this.$size,n=t.height<=2*this.lineHeight,i=this.session.getScreenLength()*this.lineHeight,o=this.$getLongestLine(),r=!n&&(this.$hScrollBarAlwaysVisible||t.scrollerWidth-o-2*this.$padding<0),s=this.$horizScroll!==r;s&&(this.$horizScroll=r,this.scrollBarH.setVisible(r));var a=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var l=t.scrollerHeight+this.lineHeight,c=!this.$maxLines&&this.$scrollPastEnd?(t.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;i+=c;var u=this.scrollMargin;this.session.setScrollTop(Math.max(-u.top,Math.min(this.scrollTop,i-t.scrollerHeight+u.bottom))),this.session.setScrollLeft(Math.max(-u.left,Math.min(this.scrollLeft,o+2*this.$padding-t.scrollerWidth+u.right)));var h=!n&&(this.$vScrollBarAlwaysVisible||t.scrollerHeight-i+c<0||this.scrollTop>u.top),d=a!==h;d&&(this.$vScroll=h,this.scrollBarV.setVisible(h));var p,f,g=this.scrollTop%this.lineHeight,m=Math.ceil(l/this.lineHeight)-1,y=Math.max(0,Math.round((this.scrollTop-g)/this.lineHeight)),v=y+m,b=this.lineHeight;y=e.screenToDocumentRow(y,0);var x=e.getFoldLine(y);x&&(y=x.start.row),p=e.documentToScreenRow(y,0),f=e.getRowLength(y)*b,v=Math.min(e.screenToDocumentRow(v,0),e.getLength()-1),l=t.scrollerHeight+e.getRowLength(v)*b+f,g=this.scrollTop-p*b;var w=0;return(this.layerConfig.width!=o||s)&&(w=this.CHANGE_H_SCROLL),(s||d)&&(w|=this.$updateCachedSize(!0,this.gutterWidth,t.width,t.height),this._signal("scrollbarVisibilityChanged"),d&&(o=this.$getLongestLine())),this.layerConfig={width:o,padding:this.$padding,firstRow:y,firstRowScreen:p,lastRow:v,lineHeight:b,characterWidth:this.characterWidth,minHeight:l,maxHeight:i,offset:g,gutterOffset:b?Math.max(0,Math.ceil((g+t.height-t.scrollerHeight)/b)):0,height:this.$size.scrollerHeight},this.session.$bidiHandler&&this.session.$bidiHandler.setContentWidth(o-this.$padding),w},e.prototype.$updateLines=function(){if(this.$changedLines){var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var n=this.layerConfig;if(!(e>n.lastRow+1||t<n.firstRow))return t===1/0?(this.$showGutter&&this.$gutterLayer.update(n),void this.$textLayer.update(n)):(this.$textLayer.updateLines(n,e,t),!0)}},e.prototype.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(e+=1),this.$textLayer&&e>this.$textLayer.MAX_LINE_LENGTH&&(e=this.$textLayer.MAX_LINE_LENGTH+30),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},e.prototype.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},e.prototype.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},e.prototype.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},e.prototype.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},e.prototype.updateBreakpoints=function(e){this._rows=e,this.$loop.schedule(this.CHANGE_GUTTER)},e.prototype.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},e.prototype.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},e.prototype.hideCursor=function(){this.$cursorLayer.hideCursor()},e.prototype.showCursor=function(){this.$cursorLayer.showCursor()},e.prototype.scrollSelectionIntoView=function(e,t,n){this.scrollCursorIntoView(e,n),this.scrollCursorIntoView(t,n)},e.prototype.scrollCursorIntoView=function(e,t,n){if(0!==this.$size.scrollerHeight){var i=this.$cursorLayer.getPixelPosition(e),o=i.left,r=i.top,s=n&&n.top||0,a=n&&n.bottom||0;this.$scrollAnimation&&(this.$stopAnimation=!0);var l=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;l+s>r?(t&&l+s>r+this.lineHeight&&(r-=t*this.$size.scrollerHeight),0===r&&(r=-this.scrollMargin.top),this.session.setScrollTop(r)):l+this.$size.scrollerHeight-a<r+this.lineHeight&&(t&&l+this.$size.scrollerHeight-a<r-this.lineHeight&&(r+=t*this.$size.scrollerHeight),this.session.setScrollTop(r+this.lineHeight+a-this.$size.scrollerHeight));var c=this.scrollLeft,u=2*this.layerConfig.characterWidth;o-u<c?((o-=u)<this.$padding+u&&(o=-this.scrollMargin.left),this.session.setScrollLeft(o)):(o+=u,c+this.$size.scrollerWidth<o+this.characterWidth?this.session.setScrollLeft(Math.round(o+this.characterWidth-this.$size.scrollerWidth)):c<=this.$padding&&o-c<this.characterWidth&&this.session.setScrollLeft(0))}},e.prototype.getScrollTop=function(){return this.session.getScrollTop()},e.prototype.getScrollLeft=function(){return this.session.getScrollLeft()},e.prototype.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},e.prototype.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},e.prototype.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},e.prototype.alignCursor=function(e,t){"number"==typeof e&&(e={row:e,column:0});var n=this.$cursorLayer.getPixelPosition(e),i=this.$size.scrollerHeight-this.lineHeight,o=n.top-i*(t||0);return this.session.setScrollTop(o),o},e.prototype.$calcSteps=function(e,t){var n,i,o=0,r=this.STEPS,s=[];for(o=0;o<r;++o)s.push((n=o/this.STEPS,i=e,(t-e)*(Math.pow(n-1,3)+1)+i));return s},e.prototype.scrollToLine=function(e,t,n,i){var o=this.$cursorLayer.getPixelPosition({row:e,column:0}).top;t&&(o-=this.$size.scrollerHeight/2);var r=this.scrollTop;this.session.setScrollTop(o),!1!==n&&this.animateScrolling(r,i)},e.prototype.animateScrolling=function(e,t){var n=this.scrollTop;if(this.$animatedScroll){var i=this;if(e!=n){if(this.$scrollAnimation){var o=this.$scrollAnimation.steps;if(o.length&&(e=o[0])==n)return}var r=i.$calcSteps(e,n);this.$scrollAnimation={from:e,to:n,steps:r},clearInterval(this.$timer),i.session.setScrollTop(r.shift()),i.session.$scrollTop=n,this.$timer=setInterval((function(){if(!i.session)return clearInterval(i.$timer);r.length?(i.session.setScrollTop(r.shift()),i.session.$scrollTop=n):null!=n?(i.session.$scrollTop=-1,i.session.setScrollTop(n),n=null):(i.$timer=clearInterval(i.$timer),i.$scrollAnimation=null,i.$stopAnimation=!1,t&&t())}),10)}}},e.prototype.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},e.prototype.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},e.prototype.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(e)},e.prototype.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},e.prototype.isScrollableBy=function(e,t){return t<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||(t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||(e<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||(e>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0)))},e.prototype.pixelToScreenCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var i=this.$fontMetrics.transformCoordinates([e,t]);e=i[1]-this.gutterWidth-this.margin.left,t=i[0]}else n=this.scroller.getBoundingClientRect();var o=e+this.scrollLeft-n.left-this.$padding,r=o/this.characterWidth,s=Math.floor((t+this.scrollTop-n.top)/this.lineHeight),a=this.$blockCursor?Math.floor(r):Math.round(r);return{row:s,column:a,side:r-a>0?1:-1,offsetX:o}},e.prototype.screenToTextCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var i=this.$fontMetrics.transformCoordinates([e,t]);e=i[1]-this.gutterWidth-this.margin.left,t=i[0]}else n=this.scroller.getBoundingClientRect();var o=e+this.scrollLeft-n.left-this.$padding,r=o/this.characterWidth,s=this.$blockCursor?Math.floor(r):Math.round(r),a=Math.floor((t+this.scrollTop-n.top)/this.lineHeight);return this.session.screenToDocumentPosition(a,Math.max(s,0),o)},e.prototype.textToScreenCoordinates=function(e,t){var n=this.scroller.getBoundingClientRect(),i=this.session.documentToScreenPosition(e,t),o=this.$padding+(this.session.$bidiHandler.isBidiRow(i.row,e)?this.session.$bidiHandler.getPosLeft(i.column):Math.round(i.column*this.characterWidth)),r=i.row*this.lineHeight;return{pageX:n.left+o-this.scrollLeft,pageY:n.top+r-this.scrollTop}},e.prototype.visualizeFocus=function(){o.addCssClass(this.container,"ace_focus")},e.prototype.visualizeBlur=function(){o.removeCssClass(this.container,"ace_focus")},e.prototype.showComposition=function(e){this.$composition=e,e.cssText||(e.cssText=this.textarea.style.cssText),null==e.useTextareaForIME&&(e.useTextareaForIME=this.$useTextareaForIME),this.$useTextareaForIME?(o.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor(),this.$cursorLayer.element.style.display="none"):e.markerId=this.session.addMarker(e.markerRange,"ace_composition_marker","text")},e.prototype.setCompositionText=function(e){var t=this.session.selection.cursor;this.addToken(e,"composition_placeholder",t.row,t.column),this.$moveTextAreaToCursor()},e.prototype.hideComposition=function(){if(this.$composition){this.$composition.markerId&&this.session.removeMarker(this.$composition.markerId),o.removeCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText=this.$composition.cssText;var e=this.session.selection.cursor;this.removeExtraToken(e.row,e.column),this.$composition=null,this.$cursorLayer.element.style.display=""}},e.prototype.setGhostText=function(e,t){var n=this.session.selection.cursor,i=t||{row:n.row,column:n.column};this.removeGhostText();var o=e.split("\n");if(this.addToken(o[0],"ghost_text",i.row,i.column),this.$ghostText={text:e,position:{row:i.row,column:i.column}},o.length>1){this.$ghostTextWidget={text:o.slice(1).join("\n"),row:i.row,column:i.column,className:"ace_ghost_text"},this.session.widgetManager.addLineWidget(this.$ghostTextWidget);var r=this.$cursorLayer.getPixelPosition(i,!0),s=this.container.getBoundingClientRect().height,a=o.length*this.lineHeight;if(a<s-r.top)return;a<s?this.scrollBy(0,(o.length-1)*this.lineHeight):this.scrollBy(0,r.top)}},e.prototype.removeGhostText=function(){if(this.$ghostText){var e=this.$ghostText.position;this.removeExtraToken(e.row,e.column),this.$ghostTextWidget&&(this.session.widgetManager.removeLineWidget(this.$ghostTextWidget),this.$ghostTextWidget=null),this.$ghostText=null}},e.prototype.addToken=function(e,t,n,i){var o=this.session;o.bgTokenizer.lines[n]=null;var r={type:t,value:e},s=o.getTokens(n);if(null!=i&&s.length)for(var a=0,l=0;l<s.length;l++){var c=s[l];if(i<=(a+=c.value.length)){var u=c.value.length-(a-i),h=c.value.slice(0,u),d=c.value.slice(u);s.splice(l,1,{type:c.type,value:h},r,{type:c.type,value:d});break}}else s.push(r);this.updateLines(n,n)},e.prototype.removeExtraToken=function(e,t){this.session.bgTokenizer.lines[e]=null,this.updateLines(e,e)},e.prototype.setTheme=function(e,t){var n=this;if(this.$themeId=e,n._dispatchEvent("themeChange",{theme:e}),e&&"string"!=typeof e)r(e);else{var i=e||this.$options.theme.initialValue;s.loadModule(["theme",i],r)}function r(i){if(n.$themeId!=e)return t&&t();if(!i||!i.cssClass)throw new Error("couldn't load module "+e+" or it didn't call define");i.$id&&(n.$themeId=i.$id),o.importCssString(i.cssText,i.cssClass,n.container),n.theme&&o.removeCssClass(n.container,n.theme.cssClass);var r="padding"in i?i.padding:"padding"in(n.theme||{})?4:n.$padding;n.$padding&&r!=n.$padding&&n.setPadding(r),n.$theme=i.cssClass,n.theme=i,o.addCssClass(n.container,i.cssClass),o.setCssClass(n.container,"ace_dark",i.isDark),n.$size&&(n.$size.width=0,n.$updateSizeAsync()),n._dispatchEvent("themeLoaded",{theme:i}),t&&t()}},e.prototype.getTheme=function(){return this.$themeId},e.prototype.setStyle=function(e,t){o.setCssClass(this.container,e,!1!==t)},e.prototype.unsetStyle=function(e){o.removeCssClass(this.container,e)},e.prototype.setCursorStyle=function(e){o.setStyle(this.scroller.style,"cursor",e)},e.prototype.setMouseCursor=function(e){o.setStyle(this.scroller.style,"cursor",e)},e.prototype.attachToShadowRoot=function(){o.importCssString(v,"ace_editor.css",this.container)},e.prototype.destroy=function(){this.freeze(),this.$fontMetrics.destroy(),this.$cursorLayer.destroy(),this.removeAllListeners(),this.container.textContent="",this.setOption("useResizeObserver",!1)},e.prototype.$updateCustomScrollbar=function(e){var t=this;this.$horizScroll=this.$vScroll=null,this.scrollBarV.element.remove(),this.scrollBarH.element.remove(),this.$scrollDecorator&&delete this.$scrollDecorator,!0===e?(this.scrollBarV=new f(this.container,this),this.scrollBarH=new p(this.container,this),this.scrollBarV.setHeight(this.$size.scrollerHeight),this.scrollBarH.setWidth(this.$size.scrollerWidth),this.scrollBarV.addEventListener("scroll",(function(e){t.$scrollAnimation||t.session.setScrollTop(e.data-t.scrollMargin.top)})),this.scrollBarH.addEventListener("scroll",(function(e){t.$scrollAnimation||t.session.setScrollLeft(e.data-t.scrollMargin.left)})),this.$scrollDecorator=new b(this.scrollBarV,this),this.$scrollDecorator.$updateDecorators()):(this.scrollBarV=new d(this.container,this),this.scrollBarH=new h(this.container,this),this.scrollBarV.addEventListener("scroll",(function(e){t.$scrollAnimation||t.session.setScrollTop(e.data-t.scrollMargin.top)})),this.scrollBarH.addEventListener("scroll",(function(e){t.$scrollAnimation||t.session.setScrollLeft(e.data-t.scrollMargin.left)})))},e.prototype.$addResizeObserver=function(){if(window.ResizeObserver&&!this.$resizeObserver){var e=this;this.$resizeTimer=r.delayedCall((function(){e.destroyed||e.onResize()}),50),this.$resizeObserver=new window.ResizeObserver((function(t){var n=t[0].contentRect.width,i=t[0].contentRect.height;Math.abs(e.$size.width-n)>1||Math.abs(e.$size.height-i)>1?e.$resizeTimer.delay():e.$resizeTimer.cancel()})),this.$resizeObserver.observe(this.container)}},e}();w.prototype.CHANGE_CURSOR=1,w.prototype.CHANGE_MARKER=2,w.prototype.CHANGE_GUTTER=4,w.prototype.CHANGE_SCROLL=8,w.prototype.CHANGE_LINES=16,w.prototype.CHANGE_TEXT=32,w.prototype.CHANGE_SIZE=64,w.prototype.CHANGE_MARKER_BACK=128,w.prototype.CHANGE_MARKER_FRONT=256,w.prototype.CHANGE_FULL=512,w.prototype.CHANGE_H_SCROLL=1024,w.prototype.$changes=0,w.prototype.$padding=null,w.prototype.$frozen=!1,w.prototype.STEPS=8,i.implement(w.prototype,y),s.defineOptions(w.prototype,"renderer",{useResizeObserver:{set:function(e){!e&&this.$resizeObserver?(this.$resizeObserver.disconnect(),this.$resizeTimer.cancel(),this.$resizeTimer=this.$resizeObserver=null):e&&!this.$resizeObserver&&this.$addResizeObserver()}},animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){"number"==typeof e&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},useSvgGutterIcons:{set:function(e){this.$gutterLayer.$useSvgGutterIcons=e},initialValue:!1},showFoldedAnnotations:{set:function(e){this.$gutterLayer.$showFoldedAnnotations=e},initialValue:!1},fadeFoldWidgets:{set:function(e){o.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightIndentGuides:{set:function(e){1==this.$textLayer.setHighlightIndentGuides(e)?this.$textLayer.$highlightIndentGuide():this.$textLayer.$clearActiveIndentGuide(this.$textLayer.$lines.cells)},initialValue:!0},highlightGutterLine:{set:function(e){this.$gutterLayer.setHighlightGutterLine(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},hScrollBarAlwaysVisible:{set:function(e){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(e){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){"number"==typeof e&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}},maxLines:{set:function(e){this.updateFull()}},minLines:{set:function(e){this.$minLines<562949953421311||(this.$minLines=0),this.updateFull()}},maxPixelHeight:{set:function(e){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(e){e=+e||0,this.$scrollPastEnd!=e&&(this.$scrollPastEnd=e,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(e){this.$gutterLayer.$fixedWidth=!!e,this.$loop.schedule(this.CHANGE_GUTTER)}},customScrollbar:{set:function(e){this.$updateCustomScrollbar(e)},initialValue:!1},theme:{set:function(e){this.setTheme(e)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0},hasCssTransforms:{},useTextareaForIME:{initialValue:!x.isMobile&&!x.isIE}}),t.VirtualRenderer=w})),ace.define("ace/worker/worker_client",[],(function(e,t,n){"use strict";var i=e("../lib/oop"),o=e("../lib/net"),r=e("../lib/event_emitter").EventEmitter,s=e("../config");function a(e){if("undefined"==typeof Worker)return{postMessage:function(){},terminate:function(){}};if(s.get("loadWorkerFromBlob")){var t=function(e){var t="importScripts('"+o.qualifyURL(e)+"');";try{return new Blob([t],{type:"application/javascript"})}catch(e){var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return n.append(t),n.getBlob("application/javascript")}}(e),n=(window.URL||window.webkitURL).createObjectURL(t);return new Worker(n)}return new Worker(e)}var l=function(e){e.postMessage||(e=this.$createWorkerFromOldConfig.apply(this,arguments)),this.$worker=e,this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){i.implement(this,r),this.$createWorkerFromOldConfig=function(t,n,i,o,r){if(e.nameToUrl&&!e.toUrl&&(e.toUrl=e.nameToUrl),s.get("packaged")||!e.toUrl)o=o||s.moduleUrl(n,"worker");else{var l=this.$normalizePath;o=o||l(e.toUrl("ace/worker/worker.js",null,"_"));var c={};t.forEach((function(t){c[t]=l(e.toUrl(t,null,"_").replace(/(\.js)?(\?.*)?$/,""))}))}return this.$worker=a(o),r&&this.send("importScripts",r),this.$worker.postMessage({init:!0,tlns:c,module:n,classname:i}),this.$worker},this.onMessage=function(e){var t=e.data;switch(t.type){case"event":this._signal(t.name,{data:t.data});break;case"call":var n=this.callbacks[t.id];n&&(n(t.data),delete this.callbacks[t.id]);break;case"error":this.reportError(t.data);break;case"log":window.console&&console.log&&console.log.apply(console,t.data)}},this.reportError=function(e){window.console&&console.error&&console.error(e)},this.$normalizePath=function(e){return o.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker.onerror=function(e){e.preventDefault()},this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,n){if(n){var i=this.callbackId++;this.callbacks[i]=n,t.push(i)}this.send(e,t)},this.emit=function(e,t){try{t.data&&t.data.err&&(t.data.err={message:t.data.err.message,stack:t.data.err.stack,code:t.data.err.code}),this.$worker&&this.$worker.postMessage({event:e,data:{data:t.data}})}catch(e){console.error(e.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener,!0)},this.changeListener=function(e){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),"insert"==e.action?this.deltaQueue.push(e.start,e.lines):this.deltaQueue.push(e.start,e.end)},this.$sendDeltaQueue=function(){var e=this.deltaQueue;e&&(this.deltaQueue=null,e.length>50&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e}))}}).call(l.prototype);t.UIWorkerClient=function(e,t,n){var i=null,o=!1,a=Object.create(r),c=[],u=new l({messageBuffer:c,terminate:function(){},postMessage:function(e){c.push(e),i&&(o?setTimeout(h):h())}});u.setEmitSync=function(e){o=e};var h=function(){var e=c.shift();e.command?i[e.command].apply(i,e.args):e.event&&a._signal(e.event,e.data)};return a.postMessage=function(e){u.onMessage({data:e})},a.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},a.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},s.loadModule(["worker",t],(function(e){for(i=new e[n](a);c.length;)h()})),u},t.WorkerClient=l,t.createWorker=a})),ace.define("ace/placeholder",[],(function(e,t,n){"use strict";var i=e("./range").Range,o=e("./lib/event_emitter").EventEmitter,r=e("./lib/oop"),s=function(){function e(e,t,n,i,o,r){var s=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=o,this.othersClass=r,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate,!0),this.$others=i,this.$onCursorChange=function(){setTimeout((function(){s.onCursorChange()}))},this.$pos=n;var a=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=a.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)}return e.prototype.setup=function(){var e=this,t=this.doc,n=this.session;this.selectionBefore=n.selection.toJSON(),n.selection.inMultiSelectMode&&n.selection.toSingleRange(),this.pos=t.createAnchor(this.$pos.row,this.$pos.column);var o=this.pos;o.$insertRight=!0,o.detach(),o.markerId=n.addMarker(new i(o.row,o.column,o.row,o.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach((function(n){var i=t.createAnchor(n.row,n.column);i.$insertRight=!0,i.detach(),e.others.push(i)})),n.setUndoSelect(!1)},e.prototype.showOtherMarkers=function(){if(!this.othersActive){var e=this.session,t=this;this.othersActive=!0,this.others.forEach((function(n){n.markerId=e.addMarker(new i(n.row,n.column,n.row,n.column+t.length),t.othersClass,null,!1)}))}},e.prototype.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)}},e.prototype.onUpdate=function(e){if(this.$updating)return this.updateAnchors(e);var t=e;if(t.start.row===t.end.row&&t.start.row===this.pos.row){this.$updating=!0;var n="insert"===e.action?t.end.column-t.start.column:t.start.column-t.end.column,o=t.start.column>=this.pos.column&&t.start.column<=this.pos.column+this.length+1,r=t.start.column-this.pos.column;if(this.updateAnchors(e),o&&(this.length+=n),o&&!this.session.$fromUndo)if("insert"===e.action)for(var s=this.others.length-1;s>=0;s--){var a={row:(l=this.others[s]).row,column:l.column+r};this.doc.insertMergedLines(a,e.lines)}else if("remove"===e.action)for(s=this.others.length-1;s>=0;s--){var l;a={row:(l=this.others[s]).row,column:l.column+r};this.doc.remove(new i(a.row,a.column,a.row,a.column-n))}this.$updating=!1,this.updateMarkers()}},e.prototype.updateAnchors=function(e){this.pos.onChange(e);for(var t=this.others.length;t--;)this.others[t].onChange(e);this.updateMarkers()},e.prototype.updateMarkers=function(){if(!this.$updating){var e=this,t=this.session,n=function(n,o){t.removeMarker(n.markerId),n.markerId=t.addMarker(new i(n.row,n.column,n.row,n.column+e.length),o,null,!1)};n(this.pos,this.mainClass);for(var o=this.others.length;o--;)n(this.others[o],this.othersClass)}},e.prototype.onCursorChange=function(e){if(!this.$updating&&this.session){var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))}},e.prototype.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.off("change",this.$onUpdate),this.session.selection.off("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},e.prototype.cancel=function(){if(-1!==this.$undoStackDepth){for(var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth,n=0;n<t;n++)e.undo(this.session,!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}},e}();r.implement(s.prototype,o),t.PlaceHolder=s})),ace.define("ace/mouse/multi_select_handler",[],(function(e,t,n){var i=e("../lib/event"),o=e("../lib/useragent");function r(e,t){return e.row==t.row&&e.column==t.column}t.onMouseDown=function(e){var t=e.domEvent,n=t.altKey,s=t.shiftKey,a=t.ctrlKey,l=e.getAccelKey(),c=e.getButton();if(a&&o.isMac&&(c=t.button),e.editor.inMultiSelectMode&&2==c)e.editor.textInput.onContextMenu(e.domEvent);else if(a||n||l){if(0===c){var u,h=e.editor,d=h.selection,p=h.inMultiSelectMode,f=e.getDocumentPosition(),g=d.getCursor(),m=e.inSelection()||d.isEmpty()&&r(f,g),y=e.x,v=e.y,b=h.session,x=h.renderer.pixelToScreenCoordinates(y,v),w=x;if(h.$mouseHandler.$enableJumpToDef)a&&n||l&&n?u=s?"block":"add":n&&h.$blockSelectEnabled&&(u="block");else if(l&&!n){if(u="add",!p&&s)return}else n&&h.$blockSelectEnabled&&(u="block");if(u&&o.isMac&&t.ctrlKey&&h.$mouseHandler.cancelContextMenu(),"add"==u){if(!p&&m)return;if(!p){var _=d.toOrientedRange();h.addSelectionMarker(_)}var S=d.rangeList.rangeAtPoint(f);h.inVirtualSelectionMode=!0,s&&(S=null,_=d.ranges[0]||_,h.removeSelectionMarker(_)),h.once("mouseup",(function(){var e=d.toOrientedRange();S&&e.isEmpty()&&r(S.cursor,e.cursor)?d.substractPoint(e.cursor):(s?d.substractPoint(_.cursor):_&&(h.removeSelectionMarker(_),d.addRange(_)),d.addRange(e)),h.inVirtualSelectionMode=!1}))}else if("block"==u){var C;e.stop(),h.inVirtualSelectionMode=!0;var k=[],A=function(){var e=h.renderer.pixelToScreenCoordinates(y,v),t=b.screenToDocumentPosition(e.row,e.column,e.offsetX);r(w,e)&&r(t,d.lead)||(w=e,h.selection.moveToPosition(t),h.renderer.scrollCursorIntoView(),h.removeSelectionMarkers(k),k=d.rectangularRangeBlock(w,x),h.$mouseHandler.$clickSelection&&1==k.length&&k[0].isEmpty()&&(k[0]=h.$mouseHandler.$clickSelection.clone()),k.forEach(h.addSelectionMarker,h),h.updateSelectionMarkers())};p&&!l?d.toSingleRange():!p&&l&&(C=d.toOrientedRange(),h.addSelectionMarker(C)),s?x=b.documentToScreenPosition(d.lead):d.moveToPosition(f),w={row:-1,column:-1};var M=A;i.capture(h.container,(function(e){y=e.clientX,v=e.clientY}),(function(e){A(),clearInterval(T),h.removeSelectionMarkers(k),k.length||(k=[d.toOrientedRange()]),C&&(h.removeSelectionMarker(C),d.toSingleRange(C));for(var t=0;t<k.length;t++)d.addRange(k[t]);h.inVirtualSelectionMode=!1,h.$mouseHandler.$clickSelection=null}));var T=setInterval((function(){M()}),20);return e.preventDefault()}}}else 0===c&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode()}})),ace.define("ace/commands/multi_select_commands",[],(function(e,t,n){t.defaultCommands=[{name:"addCursorAbove",description:"Add cursor above",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",description:"Add cursor below",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",description:"Add cursor above (skip current)",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",description:"Add cursor below (skip current)",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",description:"Select more before",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",description:"Select more after",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",description:"Select next before",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",description:"Select next after",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"toggleSplitSelectionIntoLines",description:"Split selection into lines",exec:function(e){e.multiSelect.rangeCount>1?e.multiSelect.joinSelections():e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"splitSelectionIntoLines",description:"Split into lines",exec:function(e){e.multiSelect.splitIntoLines()},readOnly:!0},{name:"alignCursors",description:"Align cursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",description:"Find all",exec:function(e){e.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],t.multiSelectCommands=[{name:"singleSelection",description:"Single selection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var i=e("../keyboard/hash_handler").HashHandler;t.keyboardHandler=new i(t.multiSelectCommands)})),ace.define("ace/multi_select",[],(function(e,t,n){var i=e("./range_list").RangeList,o=e("./range").Range,r=e("./selection").Selection,s=e("./mouse/multi_select_handler").onMouseDown,a=e("./lib/event"),l=e("./lib/lang"),c=e("./commands/multi_select_commands");t.commands=c.defaultCommands.concat(c.multiSelectCommands);var u=new(0,e("./search").Search);var h=e("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(h.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(e){if(!this.inMultiSelectMode&&0===this.rangeCount){var n=this.toOrientedRange();if(this.rangeList.add(n),this.rangeList.add(e),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(n),this.$onAddRange(n)}e.cursor||(e.cursor=e.end);var i=this.rangeList.add(e);return this.$onAddRange(e),i.length&&this.$onRemoveRange(i),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)}},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);if(t)return this.$onRemoveRange(t),t[0]},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length&&this.$onRemoveRange(e)},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._signal("addRange",{range:e})},this.$onRemoveRange=function(e){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var n=e.length;n--;){var i=this.ranges.indexOf(e[n]);this.ranges.splice(i,1)}this._signal("removeRange",{ranges:e}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(t=t||this.ranges[0])&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new i,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){for(var e=this.ranges.length?this.ranges:[this.getRange()],t=[],n=0;n<e.length;n++){var i=e[n],r=i.start.row,s=i.end.row;if(r===s)t.push(i.clone());else{for(t.push(new o(r,i.start.column,r,this.session.getLine(r).length));++r<s;)t.push(this.getLineRange(r,!0));t.push(new o(s,0,s,i.end.column))}0!=n||this.isBackwards()||(t=t.reverse())}this.toSingleRange();for(n=t.length;n--;)this.addRange(t[n])},this.joinSelections=function(){var e=this.rangeList.ranges,t=e[e.length-1],n=o.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)},this.toggleBlockSelection=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],n=o.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)}else{var i=this.session.documentToScreenPosition(this.cursor),r=this.session.documentToScreenPosition(this.anchor);this.rectangularRangeBlock(i,r).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,t,n){var i=[],r=e.column<t.column;if(r)var s=e.column,a=t.column,l=e.offsetX,c=t.offsetX;else s=t.column,a=e.column,l=t.offsetX,c=e.offsetX;var u,h,d,p=e.row<t.row;if(p)var f=e.row,g=t.row;else f=t.row,g=e.row;s<0&&(s=0),f<0&&(f=0),f==g&&(n=!0);for(var m=f;m<=g;m++){var y=o.fromPoints(this.session.screenToDocumentPosition(m,s,l),this.session.screenToDocumentPosition(m,a,c));if(y.isEmpty()){if(u&&(h=y.end,d=u,h.row==d.row&&h.column==d.column))break;u=y.end}y.cursor=r?y.start:y.end,i.push(y)}if(p&&i.reverse(),!n){for(var v=i.length-1;i[v].isEmpty()&&v>0;)v--;if(v>0)for(var b=0;i[b].isEmpty();)b++;for(var x=v;x>=b;x--)i[x].isEmpty()&&i.splice(x,1)}return i}}.call(r.prototype);var d=e("./editor").Editor;function p(e){e.$multiselectOnSessionChange||(e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),e.$multiselectOnSessionChange=t.onSessionChange.bind(e),e.$checkMultiselectChange=e.$checkMultiselectChange.bind(e),e.$multiselectOnSessionChange(e),e.on("changeSession",e.$multiselectOnSessionChange),e.on("mousedown",s),e.commands.addCommands(c.defaultCommands),function(e){if(!e.textInput)return;var t=e.textInput.getElement(),n=!1;function i(t){n&&(e.renderer.setMouseCursor(""),n=!1)}a.addListener(t,"keydown",(function(t){var o=18==t.keyCode&&!(t.ctrlKey||t.shiftKey||t.metaKey);e.$blockSelectEnabled&&o?n||(e.renderer.setMouseCursor("crosshair"),n=!0):n&&i()}),e),a.addListener(t,"keyup",i,e),a.addListener(t,"blur",i,e)}(e))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(e.marker){this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);-1!=t&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(e){for(var t=this.session.$selectionMarkers,n=e.length;n--;){var i=e[n];if(i.marker){this.session.removeMarker(i.marker);var o=t.indexOf(i);-1!=o&&t.splice(o,1)}}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(c.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(c.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(e){var t=e.command,n=e.editor;if(n.multiSelect){if(t.multiSelectAction)"forEach"==t.multiSelectAction?i=n.forEachSelection(t,e.args):"forEachLine"==t.multiSelectAction?i=n.forEachSelection(t,e.args,!0):"single"==t.multiSelectAction?(n.exitMultiSelectMode(),i=t.exec(n,e.args||{})):i=t.multiSelectAction(n,e.args||{});else{var i=t.exec(n,e.args||{});n.multiSelect.addRange(n.multiSelect.toOrientedRange()),n.multiSelect.mergeOverlappingRanges()}return i}},this.forEachSelection=function(e,t,n){if(!this.inVirtualSelectionMode){var i,o=n&&n.keepOrder,s=1==n||n&&n.$byLines,a=this.session,l=this.selection,c=l.rangeList,u=(o?l:c).ranges;if(!u.length)return e.exec?e.exec(this,t||{}):e(this,t||{});var h=l._eventRegistry;l._eventRegistry={};var d=new r(a);this.inVirtualSelectionMode=!0;for(var p=u.length;p--;){if(s)for(;p>0&&u[p].start.row==u[p-1].end.row;)p--;d.fromOrientedRange(u[p]),d.index=p,this.selection=a.selection=d;var f=e.exec?e.exec(this,t||{}):e(this,t||{});i||void 0===f||(i=f),d.toOrientedRange(u[p])}d.detach(),this.selection=a.selection=l,this.inVirtualSelectionMode=!1,l._eventRegistry=h,l.mergeOverlappingRanges(),l.ranges[0]&&l.fromOrientedRange(l.ranges[0]);var g=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),g&&g.from==g.to&&this.renderer.animateScrolling(g.from),i}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var t=this.multiSelect.rangeList.ranges,n=[],i=0;i<t.length;i++)n.push(this.session.getTextRange(t[i]));var o=this.session.getDocument().getNewLineCharacter();(e=n.join(o)).length==(n.length-1)*o.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return e},this.$checkMultiselectChange=function(e,t){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var n=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&t==this.multiSelect.anchor)return;var i=t==this.multiSelect.anchor?n.cursor==n.start?n.end:n.start:n.cursor;i.row!=t.row||this.session.$clipPositionToDocument(i.row,i.column).column!=t.column?this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange()):this.multiSelect.mergeOverlappingRanges()}},this.findAll=function(e,t,n){if((t=t||{}).needle=e||t.needle,null==t.needle){var i=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();t.needle=this.session.getTextRange(i)}this.$search.set(t);var o=this.$search.findAll(this.session);if(!o.length)return 0;var r=this.multiSelect;n||r.toSingleRange(o[0]);for(var s=o.length;s--;)r.addRange(o[s],!0);return i&&r.rangeList.rangeAtPoint(i.start)&&r.addRange(i,!0),o.length},this.selectMoreLines=function(e,t){var n=this.selection.toOrientedRange(),i=n.cursor==n.end,r=this.session.documentToScreenPosition(n.cursor);this.selection.$desiredColumn&&(r.column=this.selection.$desiredColumn);var s,a=this.session.screenToDocumentPosition(r.row+e,r.column);if(n.isEmpty())c=a;else var l=this.session.documentToScreenPosition(i?n.end:n.start),c=this.session.screenToDocumentPosition(l.row+e,l.column);i?(s=o.fromPoints(a,c)).cursor=s.start:(s=o.fromPoints(c,a)).cursor=s.end;if(s.desiredColumn=r.column,this.selection.inMultiSelectMode){if(t)var u=n.cursor}else this.selection.addRange(n);this.selection.addRange(s),u&&this.selection.substractPoint(u)},this.transposeSelections=function(e){for(var t=this.session,n=t.multiSelect,i=n.ranges,o=i.length;o--;){if((a=i[o]).isEmpty()){var r=t.getWordRange(a.start.row,a.start.column);a.start.row=r.start.row,a.start.column=r.start.column,a.end.row=r.end.row,a.end.column=r.end.column}}n.mergeOverlappingRanges();var s=[];for(o=i.length;o--;){var a=i[o];s.unshift(t.getTextRange(a))}e<0?s.unshift(s.pop()):s.push(s.shift());for(o=i.length;o--;){var l=(a=i[o]).clone();t.replace(a,s[o]),a.start.row=l.start.row,a.start.column=l.start.column}n.fromOrientedRange(n.ranges[0])},this.selectMore=function(e,t,n){var i=this.session,o=i.multiSelect.toOrientedRange();if(!o.isEmpty()||((o=i.getWordRange(o.start.row,o.start.column)).cursor=-1==e?o.start:o.end,this.multiSelect.addRange(o),!n)){var r=i.getTextRange(o),s=function(e,t,n){return u.$options.wrap=!0,u.$options.needle=t,u.$options.backwards=-1==n,u.find(e)}(i,r,e);s&&(s.cursor=-1==e?s.start:s.end,this.session.unfold(s),this.multiSelect.addRange(s),this.renderer.scrollCursorIntoView(null,.5)),t&&this.multiSelect.substractPoint(o.cursor)}},this.alignCursors=function(){var e=this.session,t=e.multiSelect,n=t.ranges,i=-1,r=n.filter((function(e){if(e.cursor.row==i)return!0;i=e.cursor.row}));if(n.length&&r.length!=n.length-1){r.forEach((function(e){t.substractPoint(e.cursor)}));var s=0,a=1/0,c=n.map((function(t){var n=t.cursor,i=e.getLine(n.row).substr(n.column).search(/\S/g);return-1==i&&(i=0),n.column>s&&(s=n.column),i<a&&(a=i),i}));n.forEach((function(t,n){var i=t.cursor,r=s-i.column,u=c[n]-a;r>u?e.insert(i,l.stringRepeat(" ",r-u)):e.remove(new o(i.row,i.column,i.row,i.column-r+u)),t.start.column=t.end.column=s,t.start.row=t.end.row=i.row,t.cursor=t.end})),t.fromOrientedRange(n[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var u=this.selection.getRange(),h=u.start.row,d=u.end.row,p=h==d;if(p){var f,g=this.session.getLength();do{f=this.session.getLine(d)}while(/[=:]/.test(f)&&++d<g);do{f=this.session.getLine(h)}while(/[=:]/.test(f)&&--h>0);h<0&&(h=0),d>=g&&(d=g-1)}var m=this.session.removeFullLines(h,d);m=this.$reAlignText(m,p),this.session.insert({row:h,column:0},m.join("\n")+"\n"),p||(u.start.column=0,u.end.column=m[m.length-1].length),this.selection.setRange(u)}},this.$reAlignText=function(e,t){var n,i,o,r=!0,s=!0;return e.map((function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?null==n?(n=t[1].length,i=t[2].length,o=t[3].length,t):(n+i+o!=t[1].length+t[2].length+t[3].length&&(s=!1),n!=t[1].length&&(r=!1),n>t[1].length&&(n=t[1].length),i<t[2].length&&(i=t[2].length),o>t[3].length&&(o=t[3].length),t):[e]})).map(t?c:r?s?function(e){return e[2]?a(n+i-e[2].length)+e[2]+a(o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}:c:function(e){return e[2]?a(n)+e[2]+a(o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]});function a(e){return l.stringRepeat(" ",e)}function c(e){return e[2]?a(n)+e[2]+a(i-e[2].length+o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}}}).call(d.prototype),t.onSessionChange=function(e){var t=e.session;t&&!t.multiSelect&&(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t&&t.multiSelect;var n=e.oldSession;n&&(n.multiSelect.off("addRange",this.$onAddRange),n.multiSelect.off("removeRange",this.$onRemoveRange),n.multiSelect.off("multiSelect",this.$onMultiSelect),n.multiSelect.off("singleSelect",this.$onSingleSelect),n.multiSelect.lead.off("change",this.$checkMultiselectChange),n.multiSelect.anchor.off("change",this.$checkMultiselectChange)),t&&(t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),t.multiSelect.lead.on("change",this.$checkMultiselectChange),t.multiSelect.anchor.on("change",this.$checkMultiselectChange)),t&&this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},t.MultiSelect=p,e("./config").defineOptions(d.prototype,"editor",{enableMultiselect:{set:function(e){p(this),e?this.on("mousedown",s):this.off("mousedown",s)},value:!0},enableBlockSelect:{set:function(e){this.$blockSelectEnabled=e},value:!0}})})),ace.define("ace/mode/folding/fold_mode",[],(function(e,t,n){"use strict";var i=e("../../range").Range,o=t.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,n){var i=e.getLine(n);return this.foldingStartMarker.test(i)?"start":"markbeginend"==t&&this.foldingStopMarker&&this.foldingStopMarker.test(i)?"end":""},this.getFoldWidgetRange=function(e,t,n){return null},this.indentationBlock=function(e,t,n){var o=/\S/,r=e.getLine(t),s=r.search(o);if(-1!=s){for(var a=n||r.length,l=e.getLength(),c=t,u=t;++t<l;){var h=e.getLine(t).search(o);if(-1!=h){if(h<=s){var d=e.getTokenAt(t,0);if(!d||"string"!==d.type)break}u=t}}if(u>c){var p=e.getLine(u).length;return new i(c,a,u,p)}}},this.openingBracketBlock=function(e,t,n,o,r){var s={row:n,column:o+1},a=e.$findClosingBracket(t,s,r);if(a){var l=e.foldWidgets[a.row];return null==l&&(l=e.getFoldWidget(a.row)),"start"==l&&a.row>s.row&&(a.row--,a.column=e.getLine(a.row).length),i.fromPoints(s,a)}},this.closingBracketBlock=function(e,t,n,o,r){var s={row:n,column:o},a=e.$findOpeningBracket(t,s);if(a)return a.column++,s.column--,i.fromPoints(a,s)}}).call(o.prototype)})),ace.define("ace/ext/error_marker",[],(function(e,t,n){"use strict";var i=e("../line_widgets").LineWidgets,o=e("../lib/dom"),r=e("../range").Range,s=e("../config").nls;t.showErrorMarker=function(e,t){var n=e.session;n.widgetManager||(n.widgetManager=new i(n),n.widgetManager.attach(e));var a=e.getCursorPosition(),l=a.row,c=n.widgetManager.getWidgetsAtRow(l).filter((function(e){return"errorMarker"==e.type}))[0];c?c.destroy():l-=t;var u,h=function(e,t,n){var i=e.getAnnotations().sort(r.comparePoints);if(i.length){var o=function(e,t,n){for(var i=0,o=e.length-1;i<=o;){var r=i+o>>1,s=n(t,e[r]);if(s>0)i=r+1;else{if(!(s<0))return r;o=r-1}}return-(i+1)}(i,{row:t,column:-1},r.comparePoints);o<0&&(o=-o-1),o>=i.length?o=n>0?0:i.length-1:0===o&&n<0&&(o=i.length-1);var s=i[o];if(s&&n){if(s.row===t){do{s=i[o+=n]}while(s&&s.row===t);if(!s)return i.slice()}var a=[];t=s.row;do{a[n<0?"unshift":"push"](s),s=i[o+=n]}while(s&&s.row==t);return a.length&&a}}}(n,l,t);if(h){var d=h[0];a.column=(d.pos&&"number"!=typeof d.column?d.pos.sc:d.column)||0,a.row=d.row,u=e.renderer.$gutterLayer.$annotations[a.row]}else{if(c)return;u={text:[s("Looks good!")],className:"ace_ok"}}e.session.unfold(a.row),e.selection.moveToPosition(a);var p={row:a.row,fixedWidth:!0,coverGutter:!0,el:o.createElement("div"),type:"errorMarker"},f=p.el.appendChild(o.createElement("div")),g=p.el.appendChild(o.createElement("div"));g.className="error_widget_arrow "+u.className;var m=e.renderer.$cursorLayer.getPixelPosition(a).left;g.style.left=m+e.renderer.gutterWidth-5+"px",p.el.className="error_widget_wrapper",f.className="error_widget "+u.className,f.innerHTML=u.text.join("<br>"),f.appendChild(o.createElement("div"));var y=function(e,t,n){if(0===t&&("esc"===n||"return"===n))return p.destroy(),{command:"null"}};p.destroy=function(){e.$mouseHandler.isMousePressed||(e.keyBinding.removeKeyboardHandler(y),n.widgetManager.removeLineWidget(p),e.off("changeSelection",p.destroy),e.off("changeSession",p.destroy),e.off("mouseup",p.destroy),e.off("change",p.destroy))},e.keyBinding.addKeyboardHandler(y),e.on("changeSelection",p.destroy),e.on("changeSession",p.destroy),e.on("mouseup",p.destroy),e.on("change",p.destroy),e.session.widgetManager.addLineWidget(p),p.el.onmousedown=e.focus.bind(e),e.renderer.scrollCursorIntoView(null,.5,{bottom:p.el.offsetHeight})},o.importCssString("\n    .error_widget_wrapper {\n        background: inherit;\n        color: inherit;\n        border:none\n    }\n    .error_widget {\n        border-top: solid 2px;\n        border-bottom: solid 2px;\n        margin: 5px 0;\n        padding: 10px 40px;\n        white-space: pre-wrap;\n    }\n    .error_widget.ace_error, .error_widget_arrow.ace_error{\n        border-color: #ff5a5a\n    }\n    .error_widget.ace_warning, .error_widget_arrow.ace_warning{\n        border-color: #F1D817\n    }\n    .error_widget.ace_info, .error_widget_arrow.ace_info{\n        border-color: #5a5a5a\n    }\n    .error_widget.ace_ok, .error_widget_arrow.ace_ok{\n        border-color: #5aaa5a\n    }\n    .error_widget_arrow {\n        position: absolute;\n        border: solid 5px;\n        border-top-color: transparent!important;\n        border-right-color: transparent!important;\n        border-left-color: transparent!important;\n        top: -5px;\n    }\n","error_marker.css",!1)})),ace.define("ace/ace",[],(function(e,t,n){e("./loader_build")(t);var i=e("./lib/dom"),o=e("./range").Range,r=e("./editor").Editor,s=e("./edit_session").EditSession,a=e("./undomanager").UndoManager,l=e("./virtual_renderer").VirtualRenderer;e("./worker/worker_client"),e("./keyboard/hash_handler"),e("./placeholder"),e("./multi_select"),e("./mode/folding/fold_mode"),e("./theme/textmate"),e("./ext/error_marker"),t.config=e("./config"),t.edit=function(e,n){if("string"==typeof e){var o=e;if(!(e=document.getElementById(o)))throw new Error("ace.edit can't find div #"+o)}if(e&&e.env&&e.env.editor instanceof r)return e.env.editor;var s="";if(e&&/input|textarea/i.test(e.tagName)){var a=e;s=a.value,e=i.createElement("pre"),a.parentNode.replaceChild(e,a)}else e&&(s=e.textContent,e.innerHTML="");var c=t.createEditSession(s),u=new r(new l(e),c,n),h={document:c,editor:u,onResize:u.resize.bind(u,null)};return a&&(h.textarea=a),u.on("destroy",(function(){h.editor.container.env=null})),u.container.env=u.env=h,u},t.createEditSession=function(e,t){var n=new s(e,t);return n.setUndoManager(new a),n},t.Range=o,t.Editor=r,t.EditSession=s,t.UndoManager=a,t.VirtualRenderer=l,t.version=t.config.version})),ace.require(["ace/ace"],(function(e){e&&(e.config.init(!0),e.define=ace.define);var t=function(){return this}();for(var n in t||"undefined"==typeof window||(t=window),t||"undefined"==typeof self||(t=self),t.ace||(t.ace=e),e)e.hasOwnProperty(n)&&(t.ace[n]=e[n]);t.ace.default=t.ace,"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=t.ace)})),define("toxilibs/embedded_extlibs/ace/ace",function(e){return function(){return e.ace}}(this)),
/*! Toxilib code_highlighter_ace
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/code_highlighter_ace",["jquery","./embedded_extlibs/ace/ace"],(function(e,t){let n;return t.define("ace/theme/blank",["require","exports"],(function(e,t){t.isDark=!0,t.cssClass=" ",t.cssText=""})),function(i,{language:o="javascript",showLines:r,htmlClass:s,theme:a}={}){void 0===r&&(r=i.split("\n").length>15),r&&(s+=" with-gutter");const l=e(`<div class="${s}"></div>`);function c(){l.text(i),n(l[0],{mode:`ace/mode/${o}`,theme:`ace/theme/${a||"blank"}`,firstLineNumber:1,showGutter:r,trim:!1})}return n?c():t.config.loadModule("ace/ext/static_highlight",(function(){n=t.require("ace/ext/static_highlight"),c()})),l}})),define("view/textarea_autosize",[],(function(){function e(e){""===e.val().trim()?e.css("height",""):(e.css("height","0.1px"),e.css("height",e[0].scrollHeight))}return function(t){t.on("input propertychange",(()=>e(t))),setTimeout((()=>e(t)),1)}})),define("render/background_css",[],(function(){let e={fill:"cover",fit:"contain",stretch:"100% 100%"},t={topLeft:"top left",topRight:"top right",bottomLeft:"bottom left",bottomRight:"bottom right"};return function(n,i={}){n=Object.assign(i,function(n){if(!n)return{color:!1};if("string"==typeof n)return n.includes("http")||n.includes("/")?{imageUrl:n}:{color:n};if("object"!=typeof n)throw new Error("setBackground value is incorrect or unsupported");let{color:i,image:o}=n;if(i&&!o)return{color:i};let{size:r,repeat:s,position:a}=n;if(o=o||n,o.toDataURL)o=o.toDataURL();else if("string"!=typeof o)throw new Error("Image value is incorrect or unsupported");return r=e[r]||r,a=t[a]||a,{imageUrl:o,size:r,repeat:s,position:a,color:i}}(n));let{color:o,imageUrl:r,size:s="cover",repeat:a,position:l="center"}=n;return r?{backgroundColor:o||"",backgroundImage:`url("${r}")`,backgroundSize:s,backgroundPosition:l,backgroundRepeat:a?"repeat":"no-repeat"}:"color"in n&&{backgroundColor:o||"",backgroundImage:""}}})),define("render/ui_tools",["jquery","toxilibs/topleft_and_pivot","./background_css"],(function(e,t,n){let i=window.document.createElement("textarea");return function(o){const r=o.$uiBody;function s(t={},{internalWhenClosed:n=()=>{}}={}){const{$currentPopup:r,disableDefaultPopupBlur:s}=o.storageForThisLaunch;let{blur:a=!s,closable:l=!1,clickOutsideToClose:c=l,clickToClose:u=!1,whenClosed:d=()=>{},whenCanceled:p=()=>{},whenClicked:f,class:g}=t;r&&h(r),a&&o.blur(a);const m=e(`<div class="ui_popup not_blurred ${g}">`),y=e('<div class="inside"></div>');if(m.append(y),m.$inside=y,o.storageForThisLaunch.$currentPopup=m,m.createdAt=Date.now(),m.clickOutsideToClose=c,m.whenClosed=d,m.whenCanceled=p,m.result=null,m.internalWhenClosed=n,l){let t=e('<div class="close">×</div>');t.on("click",(()=>h(m))),m.append(t)}return u&&m.addClass("click_to_close"),(u||f)&&m.on("click",(()=>{f&&f(),u&&h(m)})),function(e,{title:t,content:n}){t&&e.$inside.append(`<h3>${t}</h3>`);n&&(Array.isArray(n)||(n=[n]),n.forEach((t=>{var n;"object"==typeof t&&t.toString&&(t=t.toString()),"string"!=typeof t||t.match(/<([a-z]+)(?![^>]*\/>)[^>]*>/)||(t=(n=t,i.textContent=n,i.innerHTML).replaceAll("\n","<br>")),e.$inside.append(`<div class="content">${t}</div>`)})))}(m,t),m}function a(e,n){r.append(e),t.containsPositionParam(n)&&function(e,n){const{hybridScreen:i}=o,{scale:s}=i.getCamera(),a=e.outerWidth(),l=e.outerHeight(),c=t.getTopLeftPoint(n,a/s,l/s);e.addClass("precise_position");let{x:u,y:h}=i.coordsToPixelCoords(c);u=Math.min(Math.max(u,0),r.width()-a),h=Math.min(Math.max(h,0),r.height()-l),e.css({top:`${Math.round(h)}px`,left:`${Math.round(u)}px`})}(e,n)}function l(e,t){const n=s(e=Object.assign({closable:!0},e),t);return a(n,e),n}function c(t,{label:n,choiceOrCallback:i,resolve:o}){const r=e(`<div class="ui_button">${n}</div>`);let s;"function"==typeof i&&(s=i);const{whenReplied:a}=t;r.on("click",(async function(){if(t.result=i,s&&(t.callback=s),h(t,!0),a(i),s){let e=await s(n);o&&o(e)}})),t.$choicesContainer.append(r)}function u(e,{type:t="text",value:n,label:i=e}){if("select"===t)throw new Error('Type "select" is not supported yet');{let o="";return void 0!==n&&(o=`value="${n}"`),`${i}<input name="${e}" type="${t}" ${o} />`}}function h(e,t){e.remove(),o.storageForThisLaunch.$currentPopup===e&&delete o.storageForThisLaunch.$currentPopup,e.whenClosed(),t||e.whenCanceled(),e.internalWhenClosed(t),o.unblur()}return r.on("click",(function(t){const{$currentPopup:n}=o.storageForThisLaunch;if(!n||!n.clickOutsideToClose||Date.now()-n.createdAt<200)return;let i=e(t.target);i.hasClass("ui_popup")||0!==i.parents(".ui_popup").length||h(n)})),{showPopup:function(e={}){return new Promise((t=>l(e,{internalWhenClosed:t})))},showSlides:async function({speaker:t={},title:n=t.name,image:i=t.image,contents:r,previousButton:s,nextButton:a,blur:c=!o.storageForThisLaunch.disableDefaultPopupBlur,closable:u=!1}={}){for(let t=0;t<r.length;t++){let o;if(await new Promise((h=>{let d=l({title:n,closable:u,blur:c,content:r[t],clickToClose:!0,whenClicked:()=>{o=o||!0}},{internalWhenClosed:h});if(i&&(d.addClass("with_title_image"),d.prepend(`<img class="title_image" src="${i}">`)),t>0&&s){let t=e(`<div class="ui_button ui_previous_button">${s}</div>`);d.append(t),t.click((()=>{o="back"}))}a&&d.append(`<div class="ui_button ui_next_button">${a}</div>`),d.addClass("ui_slide")})),!o)return!1;"back"===o&&(t-=2)}return!0},showChoices:function(t={}){return new Promise((n=>{const i=s(t,{internalWhenClosed:()=>{i.callback||n(i.result)}});!function(t,{choices:n={},choicesDisposition:i="auto",whenChosen:o=()=>{},whenReplied:r=o},{resolve:s}){t.whenReplied=r;const a=e('<div class="choices">');t.$choicesContainer=a;let l=0,u=0;if(Array.isArray(n))n.forEach((e=>{c(t,{label:e,choiceOrCallback:e}),l+=e.length,u+=1}));else for(let e in n)c(t,{label:e,choiceOrCallback:n[e],resolve:s}),l+=e.length,u+=1;(1===u||l>20&&"auto"===i)&&(i="vertical");"vertical"===i?t.addClass("vertical_choices"):t.addClass("horizontal_choices");t.$inside.append(t.$choicesContainer)}(i,t,{resolve:n}),a(i,t)}))},showForm:function(t={}){return new Promise((n=>{const i=s(t,{internalWhenClosed:()=>n(i.result)});!function(t,{fields:n,whenReplied:i=()=>{}}){let o=e("<form>");if(n)for(let e in n)o.append(u(e,n[e]));else o.append('<input name="default" type="text" />');o.append('<input class="submit" type="submit" value="Ok" />'),o.on("submit",(e=>{e.preventDefault();let r={};o.serializeArray().forEach((({name:e,value:t})=>{""!==t.trim()&&(n&&n[e]&&"number"===n[e].type&&(t=parseFloat(t)),r[e]=t)})),n||(r=r.default),t.result=r,i(r),h(t,!0)})),t.$inside.append(o)}(i,t),a(i,t),i.find("input:first").focus()}))},hidePopup:function(){const{$currentPopup:e}=o.storageForThisLaunch;e&&h(e)},setBackground:function(e){let t=n(e);t&&o.$background.css(t)}}}})),define("render/ui_restart_sliders",["event_bus","toxilibs/string_utils"],(function(e,t){const n=new RegExp(`(${t.regexpPortions.latinVariableName})\\s*[=|:]`,"g");return function(t,{addSlider:i,addIntSlider:o}){const{persistingOnRestart:r}=t;function s(t,n={},i={}){let o=(n="number"==typeof n?Object.assign({value:n},i):Object.assign({},n)).value,{label:s=a(n),whenChanged:l}=n,c=!1,u=s in r;n.whenChanged=function(t){if(u)return;l&&l(t);c&&(r[s]={wasDragging:h.slider.isDragging,value:t,initialValue:o},e.emit("wants to restart"))};const h=t(n);return u=!1,function(e,t){if(e in r){const{slider:n}=t,{value:i,wasDragging:o,initialValue:s}=r[e];if(s!==n.initialValue)return;t.value=i,o&&(delete r[e].wasDragging,n.listenToDrag())}}(s,h),c=!0,h.value}function a(e){let{content:i=""}=t.getCurrentLine(),o=Array.from(i.replace(/addRestart(.*)/,"").matchAll(n));if(o.length>0){let n=o.pop()[1];return n=function(e){let{tempStorageForThisExecution:n}=t;"uiRestartLabels"in n||(n.uiRestartLabels={});let{uiRestartLabels:i}=n,o=(i[e]||0)+1;return i[e]=o,o>1?`${e}(${o-1})`:e}(n),e.label=n,n}{let{tempStorageForThisExecution:e}=t;"indexForPersistingOnRestart"in e||(e.indexForPersistingOnRestart=1);let n=e.indexForPersistingOnRestart;return e.indexForPersistingOnRestart+=1,n}}return{addRestartSlider:function(e,t){return s(i,e,t)},addRestartIntSlider:function(e,t){return s(o,e,t)}}}})),define("render/toolbars",["jquery","toxilibs/element","toxilibs/string_utils"],(function(e,t,n){const i=["left","right","top","bottom"],o=i.map((e=>`${e}Toolbar`)),r={class:"ui_toolbar"};function s(e){return`ui_toolbar_${n.spaceToSnake(e)}`}return function(n){const a=n.$uiBody;function l(t){return i.includes(t)?c(t)||function(t){const n=e(`<div class="ui_toolbar_container ui_toolbar_container_${t}">`);let i="horizontal_toolbar";if("top"===t)a.prepend(n);else if("left"===t||"right"===t){i="vertical_toolbar";const e=c("top");e?n.insertAfter(e):a.prepend(n)}else a.append(n);return n.addClass(i),n}(t):null}function c(e){let t=a.find(`.ui_toolbar_container_${e}`);return 0===t.length?null:t}function u(e){let t=a.find(`.${s(e)}`);return 0===t.length?null:t.data("toxiElement")}function h(e={}){e=Object.assign({},r,e);const{name:n,position:i}=e;if(!n)throw new Error("a toolbar must have a name");e.class=`${e.class||""} ${s(n)}`;let o=l(i)||a;e.click=e.whenClicked;let c=new t(e);return"topToolbar"===n||"leftToolbar"===n?o.prepend(c.$element):o.append(c.$element),c}return{positionElementInToolbar:function(e,{position:t}){if("string"==typeof t)if("toolbar"===t&&(t="topToolbar"),o.includes(t)){(u(n=t)||h({name:n,position:n.replace("Toolbar","")})).add(e)}else{let n=u(t);if(!n)throw new Error(`position ${t} unknown`);n.add(e)}var n},addToolbar:function(e={}){return h(e)},getToolbar:u}}})),
/*! Toxilib color_picker
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/color_picker",["jquery","./screen","./screen_image","./color"],(function(e,t,n,i){let o;const r=1.65,s=2.15;let a=.28,l=.7;function c(e){const{screen:t,colorSquareImage:n}=e;e.color=i.createFromOkHSV(e),t.clear(),t.drawImage(o),t.drawImage({image:n,center:{x:0,y:0},width:2,height:2}),t.drawRectangle({center:{x:2*e.saturation-1,y:2*e.value-1},width:.15,height:.15,color:"#FFF",strokeColor:"#333"});let r=360*e.hue;t.drawPie({center:{x:0,y:0},radius:2.1999999999999997,innerRadius:1.5999999999999999,startAngle:r-1.2,endAngle:r+1.2,color:"#FFF"}),t.drawRectangle({center:{x:3,y:0},width:1,height:3,color:e.color})}function u(e,t,n){const i=g(t,n);e.hue=i,f(e),c(e)}function h(e,t,n){e.saturation=Math.max(0,Math.min(1,(1+t)/2)),e.value=Math.max(0,Math.min(1,(1+n)/2)),c(e)}const d=1.9,p=.25;function f(e){const{hue:t}=e;e.colorSquareImage.setColorForEachPixel(((e,n)=>i.createFromOkHSV({hue:t,saturation:e,value:n})))}function g(e,t){return(Math.atan2(t,e)/(2*Math.PI)+1)%1}return function({container:m,color:y,callback:v=()=>{}}){o||function(){o=new n({center:{x:0,y:0},width:4.4,height:4.4,widthInPixels:600,heightInPixels:600,useOpacity:!0});const e={red255:0,green255:0,blue255:0,opacity:0};o.setColorForEachPixel(((t,n)=>{const o=Math.abs(d-Math.sqrt(t*t+n*n))-p;if(o>0)return e;const r=g(t,n);let s=Math.min(1,20*-o);return i.createFromOklab({L:l,h:r,C:a,opacity:s})}))}(),this.colorSquareImage=new n({bottomLeft:{x:0,y:0},width:1,height:1,widthInPixels:40,heightInPixels:40}),this.container=m,m.css({position:"relative"});const b=document.createElement("canvas");b.style.position="absolute",b.style.top=0,b.style.left=0,b.style.width="100%",b.style.height="100%",b.width=m.innerWidth(),b.height=m.innerHeight(),m.append(b);let x=e("<button>ok</button>");x.css({position:"absolute",bottom:0,right:0}),x.on("click",(()=>{v(this.color)})),m.append(x),this.screen=new t(b),this.screen.setOptimalCamera([{x:-2.5,y:-3},{x:4,y:3}]),m.on("mousedown",(t=>function(t,n){const{screen:i}=t;let{x:o,y:a}=i.mouseEventToCoords(n);const l=Math.sqrt(o*o+a*a);e("body").one("mouseup",(()=>{delete t.moveMode})),r<l&&l<s?(t.moveMode="hue",u(t,o,a)):function(e,t){return-1<e&&e<1&&-1<t&&t<1}(o,a)&&(t.moveMode="square",h(t,o,a))}(this,t))),m.on("mousemove",(e=>function(e,t){const{screen:n,moveMode:i}=e;if(!i)return;let{x:o,y:r}=n.mouseEventToCoords(t);"hue"===i?u(e,o,r):"square"===i&&h(e,o,r)}(this,e))),function(e,t){if(t){t instanceof i||(t=new i(t));let{hue:n,value:o,saturation:r}=i.convertRGBToOkHSV(t);e.hue=n,e.value=o,e.saturation=r}else e.hue=Math.random(),e.value=.5,e.saturation=.7;f(e)}(this,y),c(this)}})),
/*! Toxilib copy_to_clipboard
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/copy_to_clipboard",[],(function(){return function(e){const t=document.activeElement,n=document.createElement("textarea");n.value=e,n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n);let i=document.getSelection();const o=i.rangeCount>0&&i.getRangeAt(0);n.select(),document.execCommand("copy"),document.body.removeChild(n),o&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(o)),t.focus()}})),define("view/color_picker",["jquery","toxilibs/color_picker","toxilibs/copy_to_clipboard","logger"],(function(e,t,n,i){return function({color:o,copyToClipboard:r=!0}={}){const s=e('<div class="discovery_color_picker"></div>');return e(".render_ui").append(s),new Promise((e=>{new t({container:s,color:o,callback:t=>{s.remove();let o=t.toString();i.log(`Color chosen : ${o}`),r&&n(o),e(o)}})}))}})),define("render/dom_api",["event_bus","jquery","toxilibs/object_utils","./add_style","editor/snippet_tools","toxilibs/element","toxilibs/element_input","toxilibs/element_slider","toxilibs/code_highlighter_ace","view/textarea_autosize","./ui_tools","./ui_restart_sliders","./toolbars","logger","user_code/deprecate","./font_loader","./hybrid_screen","view/color_picker"],(function(e,t,n,i,o,r,s,a,l,c,u,h,d,p,f,g,m,y){const{addMethodSnippet:v}=o,{deepMerge:b}=n,x={setBackground:{color:'"white"'},showSlides:{speaker:"{}",contents:'[\n\t\t"What is an astronaut’s favorite part on a computer?",\n\t\t"The space bar."\n\t]'},showChoices:{title:'"Which one ?"',choices:'{\n\t\t"Dog": "woof",\n\t\t"Cat": "meow"\n\t}',whenReplied:"log"},showForm:{title:'"Who are you ?"',fields:{name:"{type: 'text'}",age:"{type: 'number'}"},whenReplied:"log"},showPopup:{title:'"What is an astronaut’s favorite part on a computer?"',content:'"The space bar."'},addButton:{content:'"my button"',whenClicked:'() => log("button clicked")'},addSlider:{label:'"rating"',min:0,max:5,value:2,whenChanged:"log"},addIntSlider:{label:'"rating"',min:0,max:100,value:40,whenChanged:"log"},addRestartSlider:1,addRestartIntSlider:10,addBox:{content:'"my box"',style:{top:'"50px"',left:'"30%"',color:'"yellow"'}},addCodeBox:{content:'"let a = 3 + (5 * 2)"',style:{top:'"50px"',left:'"30%"'}},addTextInput:{label:'"Name"',whenChanged:"log"},addSelect:{label:'"Painter"',choices:'{\n\t\t"Van Gogh": "gogh",\n\t\t"da Vinci": "vinci",\n\t\t"Imagine": "imagine"\n\t}',whenChanged:"log"},addToolbar:{name:'"topToolbar"',position:'"top"'},addToolbarButtons:"{}",showColorPicker:{color:'"yellow"'}};return function(t){const n=t.$uiBody,{positionElementInToolbar:o,addToolbar:w,getToolbar:_}=d(t),S=t.createExecutionErrorHandler("Explorers - dom_api.js - element event error"),C={parent:n,errorHandler:S},k={parent:n,style:{position:"absolute"},errorHandler:S},A={parent:n,errorHandler:S,storagePrefix:`explorers_input_${t.fullId}`,earlyHook:function(e,n){const{label:i}=n;i&&(t.storageForThisLaunch[`input_${i}`]=e)}},M={content:"my button",whenClicked:()=>p.log("Button clicked")};function T(e={}){(e=Object.assign({},C,M,e)).click=e.whenClicked,O(e);const t=new r(e);return t.addClass("ui_button"),o(t,e),t}function E(e={}){O(e=Object.assign({},A,e));const t=new a(e);return t.addClass("ui_slider"),o(t,e),t}function $(e={}){return"step"in(e=Object.assign({},e))?e.step<0?e.step=Math.min(-1,Math.round(e.step)):e.step=Math.max(1,Math.round(e.step)):e.step=1,E(e)}const{addRestartSlider:L,addRestartIntSlider:R}=h(t,{addSlider:E,addIntSlider:$});function P(e={}){(e=b(k,e)).click=e.whenClicked,e.content="";const t=new r(e);o(t,e),t.setContent("<canvas></canvas>");const{$element:n}=t;return t.canvas=n.find("canvas")[0],t.canvas.width=n.width(),t.canvas.height=n.height(),t}let I=1;function O({style:e}){e&&!("position"in e)&&("left"in e||"top"in e||"right"in e||"bottom"in e)&&(e.position="absolute")}const D={setTheme:function(e){t.setTheme(e)},addStyle:i(t),loadFont:g,clear:function(){n.empty()},enableBrowserContextMenu:function(){n.addClass("enable_context_menu")},disableBrowserContextMenu:function(){n.removeClass("enable_context_menu")},addBox:function(e){!function(e){let{fitWithAspectRatio:t}=e;if(t){let{parent:n}=e;n instanceof r&&(n=n.$element);let i,o,s=n.width()/n.height();t>s?(i=100,o=100*s/t):(i=100*t/s,o=100),e.style=Object.assign({},e.style,{width:i+"%",height:o+"%",top:(100-o)/2+"%",left:(100-i)/2+"%"})}}(e=Object.assign({},C,e));let t=new r(e);return t.addClass("ui_box enable_context_menu"),t},addCodeBox:function(e={}){(e=b(k,e)).click=e.whenClicked,e.content=l(e.content,{language:e.language||"javascript",htmlClass:"ace-explorers"});const t=new r(e);return o(t,e),t},addCanvasBox:P,addScreenBox:function(e={}){const t=P(e);return t.screen=new m({name:`screenbox_${I}`,canvas:t.canvas,mode:e.mode,directScreenMode:"glsl"!==e.mode}),I+=1,t},addButton:T,addToolbarButtons:function(...e){let t,n;1===e.length?(n="toolbar",t=e[0]):(n=e[0],t=e[1]);for(let e in t)T({position:n,content:e,whenClicked:t[e]})},addToolbar:w,getToolbar:_,addTextInput:function(e={}){O(e=Object.assign({type:"textarea"},A,e));const t=new s(e);t.addClass("ui_text_input"),o(t,e);let{autoResize:n=!0}=e;return"textarea"===e.type&&n&&c(t.$element.find("textarea")),t},addSlider:E,addIntSlider:$,addRestartSlider:L,addRestartIntSlider:R,addSelect:function(e={}){O(e=Object.assign({type:"select"},A,e));const t=new s(e);return t.addClass("ui_select"),o(t,e),t},addSpinner:function(e={}){(e=Object.assign({content:'<i class="ui_spinning fas"></i>'},C,e)).click=e.whenClicked;const t=new r(e);return t.addClass("ui_spinner"),o(t,e),t},addPerformanceMonitor:function(n={}){(n=Object.assign({},C,n)).click=n.whenClicked;const i=new r(n);i.addClass("ui_monitor"),o(i,n);let s=0,a=0,l=0,c=0;return e.on("drawing frame reached",(e=>{if(a+=e,l+=t.onEveryFrameExecutionTime||0,c+=t.renderTime,s+=1,s>=10){let e=a/s,t=1e3/e,n=`${Math.round(t)} FPS (${Math.round(10*e)/10} ms)<br>\n                        Render : ${Math.round(10*c/s)/10} ms`;l&&(n+="<br>onEveryFrame "+Math.round(10*l/s)/10+"ms"),i.setContent(n),s=0,a=0,l=0,c=0}})),i},valueFor:function(e){const n=t.storageForThisLaunch[`input_${e}`];return n&&n.value},showColorPicker:y};if(Object.assign(D,u(t)),"generic render"===t.name)for(let e in D){let t=x[e];t&&v(D[e],e,t)}return f(D,{showMenu:"showChoices",hideMenu:"hidePopup",addInput:"addTextInput"}),D}})),
/*!
 * Chart.js v3.5.0
 * https://www.chartjs.org
 * (c) 2021 Chart.js Contributors
 * Released under the MIT License
 */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("toxilibs/extlibs/chart-3.5.0",t):(e="undefined"!=typeof globalThis?globalThis:e||self).Chart=t()}(this,(function(){"use strict";const e="undefined"==typeof window?function(e){return e()}:window.requestAnimationFrame;function t(t,n,i){const o=i||(e=>Array.prototype.slice.call(e));let r=!1,s=[];return function(...i){s=o(i),r||(r=!0,e.call(window,(()=>{r=!1,t.apply(n,s)})))}}function n(e,t){let n;return function(){return t?(clearTimeout(n),n=setTimeout(e,t)):e(),t}}const i=e=>"start"===e?"left":"end"===e?"right":"center",o=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2,r=(e,t,n,i)=>e===(i?"left":"right")?n:"center"===e?(t+n)/2:t;var s=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,i){const o=t.listeners[i],r=t.duration;o.forEach((i=>i({chart:e,initial:t.initial,numSteps:r,currentStep:Math.min(n-t.start,r)})))}_refresh(){const t=this;t._request||(t._running=!0,t._request=e.call(window,(()=>{t._update(),t._request=null,t._running&&t._refresh()})))}_update(e=Date.now()){const t=this;let n=0;t._charts.forEach(((i,o)=>{if(!i.running||!i.items.length)return;const r=i.items;let s,a=r.length-1,l=!1;for(;a>=0;--a)s=r[a],s._active?(s._total>i.duration&&(i.duration=s._total),s.tick(e),l=!0):(r[a]=r[r.length-1],r.pop());l&&(o.draw(),t._notify(o,i,e,"progress")),r.length||(i.running=!1,t._notify(o,i,e,"complete"),i.initial=!1),n+=r.length})),t._lastDate=e,0===n&&(t._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(((e,t)=>Math.max(e,t._duration)),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}};
/*!
 * @kurkle/color v0.1.9
 * https://github.com/kurkle/color#readme
 * (c) 2020 Jukka Kurkela
 * Released under the MIT License
 */const a={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},l="0123456789ABCDEF",c=e=>l[15&e],u=e=>l[(240&e)>>4]+l[15&e],h=e=>(240&e)>>4==(15&e);function d(e){var t=function(e){return h(e.r)&&h(e.g)&&h(e.b)&&h(e.a)}(e)?c:u;return e?"#"+t(e.r)+t(e.g)+t(e.b)+(e.a<255?t(e.a):""):e}function p(e){return e+.5|0}const f=(e,t,n)=>Math.max(Math.min(e,n),t);function g(e){return f(p(2.55*e),0,255)}function m(e){return f(p(255*e),0,255)}function y(e){return f(p(e/2.55)/100,0,1)}function v(e){return f(p(100*e),0,100)}const b=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const x=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function w(e,t,n){const i=t*Math.min(n,1-n),o=(t,o=(t+e/30)%12)=>n-i*Math.max(Math.min(o-3,9-o,1),-1);return[o(0),o(8),o(4)]}function _(e,t,n){const i=(i,o=(i+e/60)%6)=>n-n*t*Math.max(Math.min(o,4-o,1),0);return[i(5),i(3),i(1)]}function S(e,t,n){const i=w(e,1,.5);let o;for(t+n>1&&(o=1/(t+n),t*=o,n*=o),o=0;o<3;o++)i[o]*=1-t-n,i[o]+=t;return i}function C(e){const t=e.r/255,n=e.g/255,i=e.b/255,o=Math.max(t,n,i),r=Math.min(t,n,i),s=(o+r)/2;let a,l,c;return o!==r&&(c=o-r,l=s>.5?c/(2-o-r):c/(o+r),a=o===t?(n-i)/c+(n<i?6:0):o===n?(i-t)/c+2:(t-n)/c+4,a=60*a+.5),[0|a,l||0,s]}function k(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(m)}function A(e,t,n){return k(w,e,t,n)}function M(e){return(e%360+360)%360}function T(e){const t=x.exec(e);let n,i=255;if(!t)return;t[5]!==n&&(i=t[6]?g(+t[5]):m(+t[5]));const o=M(+t[2]),r=+t[3]/100,s=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return k(S,e,t,n)}(o,r,s):"hsv"===t[1]?function(e,t,n){return k(_,e,t,n)}(o,r,s):A(o,r,s),{r:n[0],g:n[1],b:n[2],a:i}}const E={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},$={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let L;function R(e){L||(L=function(){const e={},t=Object.keys($),n=Object.keys(E);let i,o,r,s,a;for(i=0;i<t.length;i++){for(s=a=t[i],o=0;o<n.length;o++)r=n[o],a=a.replace(r,E[r]);r=parseInt($[s],16),e[a]=[r>>16&255,r>>8&255,255&r]}return e}(),L.transparent=[0,0,0,0]);const t=L[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}function P(e,t,n){if(e){let i=C(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,0===t?360:1)),i=A(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function I(e,t){return e?Object.assign(t||{},e):e}function O(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=m(e[3]))):(t=I(e,{r:0,g:0,b:0,a:1})).a=m(t.a),t}function D(e){return"r"===e.charAt(0)?function(e){const t=b.exec(e);let n,i,o,r=255;if(t){if(t[7]!==n){const e=+t[7];r=255&(t[8]?g(e):255*e)}return n=+t[1],i=+t[3],o=+t[5],n=255&(t[2]?g(n):n),i=255&(t[4]?g(i):i),o=255&(t[6]?g(o):o),{r:n,g:i,b:o,a:r}}}(e):T(e)}class F{constructor(e){if(e instanceof F)return e;const t=typeof e;let n;var i,o,r;"object"===t?n=O(e):"string"===t&&(r=(i=e).length,"#"===i[0]&&(4===r||5===r?o={r:255&17*a[i[1]],g:255&17*a[i[2]],b:255&17*a[i[3]],a:5===r?17*a[i[4]]:255}:7!==r&&9!==r||(o={r:a[i[1]]<<4|a[i[2]],g:a[i[3]]<<4|a[i[4]],b:a[i[5]]<<4|a[i[6]],a:9===r?a[i[7]]<<4|a[i[8]]:255})),n=o||R(e)||D(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=I(this._rgb);return e&&(e.a=y(e.a)),e}set rgb(e){this._rgb=O(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${y(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):this._rgb;var e}hexString(){return this._valid?d(this._rgb):this._rgb}hslString(){return this._valid?function(e){if(!e)return;const t=C(e),n=t[0],i=v(t[1]),o=v(t[2]);return e.a<255?`hsla(${n}, ${i}%, ${o}%, ${y(e.a)})`:`hsl(${n}, ${i}%, ${o}%)`}(this._rgb):this._rgb}mix(e,t){const n=this;if(e){const i=n.rgb,o=e.rgb;let r;const s=t===r?.5:t,a=2*s-1,l=i.a-o.a,c=((a*l==-1?a:(a+l)/(1+a*l))+1)/2;r=1-c,i.r=255&c*i.r+r*o.r+.5,i.g=255&c*i.g+r*o.g+.5,i.b=255&c*i.b+r*o.b+.5,i.a=s*i.a+(1-s)*o.a,n.rgb=i}return n}clone(){return new F(this.rgb)}alpha(e){return this._rgb.a=m(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=p(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return P(this._rgb,2,e),this}darken(e){return P(this._rgb,2,-e),this}saturate(e){return P(this._rgb,1,e),this}desaturate(e){return P(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=C(e);n[0]=M(n[0]+t),n=A(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function N(e){return new F(e)}const B=e=>e instanceof CanvasGradient||e instanceof CanvasPattern;function j(e){return B(e)?e:N(e)}function H(e){return B(e)?e:N(e).saturate(.5).darken(.1).hexString()}function W(){}const z=function(){let e=0;return function(){return e++}}();function V(e){return null==e}function G(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.substr(0,7)&&"Array]"===t.substr(-6)}function U(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}const q=e=>("number"==typeof e||e instanceof Number)&&isFinite(+e);function K(e,t){return q(e)?e:t}function Y(e,t){return void 0===e?t:e}const X=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100:e/t,J=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Q(e,t,n){if(e&&"function"==typeof e.call)return e.apply(n,t)}function Z(e,t,n,i){let o,r,s;if(G(e))if(r=e.length,i)for(o=r-1;o>=0;o--)t.call(n,e[o],o);else for(o=0;o<r;o++)t.call(n,e[o],o);else if(U(e))for(s=Object.keys(e),r=s.length,o=0;o<r;o++)t.call(n,e[s[o]],s[o])}function ee(e,t){let n,i,o,r;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(o=e[n],r=t[n],o.datasetIndex!==r.datasetIndex||o.index!==r.index)return!1;return!0}function te(e){if(G(e))return e.map(te);if(U(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let o=0;for(;o<i;++o)t[n[o]]=te(e[n[o]]);return t}return e}function ne(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function ie(e,t,n,i){if(!ne(e))return;const o=t[e],r=n[e];U(o)&&U(r)?oe(o,r,i):t[e]=te(r)}function oe(e,t,n){const i=G(t)?t:[t],o=i.length;if(!U(e))return e;const r=(n=n||{}).merger||ie;for(let s=0;s<o;++s){if(!U(t=i[s]))continue;const o=Object.keys(t);for(let i=0,s=o.length;i<s;++i)r(o[i],e,t,n)}return e}function re(e,t){return oe(e,t,{merger:se})}function se(e,t,n){if(!ne(e))return;const i=t[e],o=n[e];U(i)&&U(o)?re(i,o):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=te(o))}function ae(e,t){const n=e.indexOf(".",t);return-1===n?e.length:n}function le(e,t){if(""===t)return e;let n=0,i=ae(t,n);for(;e&&i>n;)e=e[t.substr(n,i-n)],n=i+1,i=ae(t,n);return e}function ce(e){return e.charAt(0).toUpperCase()+e.slice(1)}const ue=e=>void 0!==e,he=e=>"function"==typeof e,de=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0},pe=Object.create(null),fe=Object.create(null);function ge(e,t){if(!t)return e;const n=t.split(".");for(let t=0,i=n.length;t<i;++t){const i=n[t];e=e[i]||(e[i]=Object.create(null))}return e}function me(e,t,n){return"string"==typeof t?oe(ge(e,t),n):oe(ge(e,""),t)}var ye=new class{constructor(e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>H(t.backgroundColor),this.hoverBorderColor=(e,t)=>H(t.borderColor),this.hoverColor=(e,t)=>H(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.describe(e)}set(e,t){return me(this,e,t)}get(e){return ge(this,e)}describe(e,t){return me(fe,e,t)}override(e,t){return me(pe,e,t)}route(e,t,n,i){const o=ge(this,e),r=ge(this,n),s="_"+t;Object.defineProperties(o,{[s]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[s],t=r[i];return U(e)?Object.assign({},t,e):Y(e,t)},set(e){this[s]=e}}})}}({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});const ve=Math.PI,be=2*ve,xe=be+ve,we=Number.POSITIVE_INFINITY,_e=ve/180,Se=ve/2,Ce=ve/4,ke=2*ve/3,Ae=Math.log10,Me=Math.sign;function Te(e){const t=Math.round(e);e=Le(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Ae(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function Ee(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i==0&&(t.push(i),t.push(e/i));return n===(0|n)&&t.push(n),t.sort(((e,t)=>e-t)).pop(),t}function $e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Le(e,t,n){return Math.abs(e-t)<n}function Re(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function Pe(e,t,n){let i,o,r;for(i=0,o=e.length;i<o;i++)r=e[i][n],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function Ie(e){return e*(ve/180)}function Oe(e){return e*(180/ve)}function De(e){if(!q(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Fe(e,t){const n=t.x-e.x,i=t.y-e.y,o=Math.sqrt(n*n+i*i);let r=Math.atan2(i,n);return r<-.5*ve&&(r+=be),{angle:r,distance:o}}function Ne(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Be(e,t){return(e-t+xe)%be-ve}function je(e){return(e%be+be)%be}function He(e,t,n,i){const o=je(e),r=je(t),s=je(n),a=je(r-o),l=je(s-o),c=je(o-r),u=je(o-s);return o===r||o===s||i&&r===s||a>l&&c<u}function We(e,t,n){return Math.max(t,Math.min(n,e))}function ze(e){return We(e,-32768,32767)}function Ve(e){return!e||V(e.size)||V(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function Ge(e,t,n,i,o){let r=t[o];return r||(r=t[o]=e.measureText(o).width,n.push(o)),r>i&&(i=r),i}function Ue(e,t,n,i){let o=(i=i||{}).data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(o=i.data={},r=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let s=0;const a=n.length;let l,c,u,h,d;for(l=0;l<a;l++)if(h=n[l],null!=h&&!0!==G(h))s=Ge(e,o,r,s,h);else if(G(h))for(c=0,u=h.length;c<u;c++)d=h[c],null==d||G(d)||(s=Ge(e,o,r,s,d));e.restore();const p=r.length/2;if(p>n.length){for(l=0;l<p;l++)delete o[r[l]];r.splice(0,p)}return s}function qe(e,t,n){const i=e.currentDevicePixelRatio,o=0!==n?Math.max(n/2,.5):0;return Math.round((t-o)*i)/i+o}function Ke(e,t){(t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Ye(e,t,n,i){let o,r,s,a,l;const c=t.pointStyle,u=t.rotation,h=t.radius;let d=(u||0)*_e;if(c&&"object"==typeof c&&(o=c.toString(),"[object HTMLImageElement]"===o||"[object HTMLCanvasElement]"===o))return e.save(),e.translate(n,i),e.rotate(d),e.drawImage(c,-c.width/2,-c.height/2,c.width,c.height),void e.restore();if(!(isNaN(h)||h<=0)){switch(e.beginPath(),c){default:e.arc(n,i,h,0,be),e.closePath();break;case"triangle":e.moveTo(n+Math.sin(d)*h,i-Math.cos(d)*h),d+=ke,e.lineTo(n+Math.sin(d)*h,i-Math.cos(d)*h),d+=ke,e.lineTo(n+Math.sin(d)*h,i-Math.cos(d)*h),e.closePath();break;case"rectRounded":l=.516*h,a=h-l,r=Math.cos(d+Ce)*a,s=Math.sin(d+Ce)*a,e.arc(n-r,i-s,l,d-ve,d-Se),e.arc(n+s,i-r,l,d-Se,d),e.arc(n+r,i+s,l,d,d+Se),e.arc(n-s,i+r,l,d+Se,d+ve),e.closePath();break;case"rect":if(!u){a=Math.SQRT1_2*h,e.rect(n-a,i-a,2*a,2*a);break}d+=Ce;case"rectRot":r=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-r,i-s),e.lineTo(n+s,i-r),e.lineTo(n+r,i+s),e.lineTo(n-s,i+r),e.closePath();break;case"crossRot":d+=Ce;case"cross":r=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-r,i-s),e.lineTo(n+r,i+s),e.moveTo(n+s,i-r),e.lineTo(n-s,i+r);break;case"star":r=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-r,i-s),e.lineTo(n+r,i+s),e.moveTo(n+s,i-r),e.lineTo(n-s,i+r),d+=Ce,r=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-r,i-s),e.lineTo(n+r,i+s),e.moveTo(n+s,i-r),e.lineTo(n-s,i+r);break;case"line":r=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-r,i-s),e.lineTo(n+r,i+s);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(d)*h,i+Math.sin(d)*h)}e.fill(),t.borderWidth>0&&e.stroke()}}function Xe(e,t,n){return n=n||.5,e&&t&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Je(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Qe(e){e.restore()}function Ze(e,t,n,i,o){if(!t)return e.lineTo(n.x,n.y);if("middle"===o){const i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else"after"===o!=!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function et(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function tt(e,t,n,i,o,r={}){const s=G(t)?t:[t],a=r.strokeWidth>0&&""!==r.strokeColor;let l,c;for(e.save(),e.font=o.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]);V(t.rotation)||e.rotate(t.rotation);t.color&&(e.fillStyle=t.color);t.textAlign&&(e.textAlign=t.textAlign);t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,r),l=0;l<s.length;++l)c=s[l],a&&(r.strokeColor&&(e.strokeStyle=r.strokeColor),V(r.strokeWidth)||(e.lineWidth=r.strokeWidth),e.strokeText(c,n,i,r.maxWidth)),e.fillText(c,n,i,r.maxWidth),nt(e,n,i,c,r),i+=o.lineHeight;e.restore()}function nt(e,t,n,i,o){if(o.strikethrough||o.underline){const r=e.measureText(i),s=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,l=n-r.actualBoundingBoxAscent,c=n+r.actualBoundingBoxDescent,u=o.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=o.decorationWidth||2,e.moveTo(s,u),e.lineTo(a,u),e.stroke()}}function it(e,t){const{x:n,y:i,w:o,h:r,radius:s}=t;e.arc(n+s.topLeft,i+s.topLeft,s.topLeft,-Se,ve,!0),e.lineTo(n,i+r-s.bottomLeft),e.arc(n+s.bottomLeft,i+r-s.bottomLeft,s.bottomLeft,ve,Se,!0),e.lineTo(n+o-s.bottomRight,i+r),e.arc(n+o-s.bottomRight,i+r-s.bottomRight,s.bottomRight,Se,0,!0),e.lineTo(n+o,i+s.topRight),e.arc(n+o-s.topRight,i+s.topRight,s.topRight,0,-Se,!0),e.lineTo(n+s.topLeft,i)}function ot(e,t,n){n=n||(n=>e[n]<t);let i,o=e.length-1,r=0;for(;o-r>1;)i=r+o>>1,n(i)?r=i:o=i;return{lo:r,hi:o}}const rt=(e,t,n)=>ot(e,n,(i=>e[i][t]<n)),st=(e,t,n)=>ot(e,n,(i=>e[i][t]>=n));function at(e,t,n){let i=0,o=e.length;for(;i<o&&e[i]<t;)i++;for(;o>i&&e[o-1]>n;)o--;return i>0||o<e.length?e.slice(i,o):e}const lt=["push","pop","shift","splice","unshift"];function ct(e,t){e._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),lt.forEach((t=>{const n="_onData"+ce(t),i=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value(...t){const o=i.apply(this,t);return e._chartjs.listeners.forEach((e=>{"function"==typeof e[n]&&e[n](...t)})),o}})})))}function ut(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,o=i.indexOf(t);-1!==o&&i.splice(o,1),i.length>0||(lt.forEach((t=>{delete e[t]})),delete e._chartjs)}function ht(e){const t=new Set;let n,i;for(n=0,i=e.length;n<i;++n)t.add(e[n]);return t.size===i?e:Array.from(t)}function dt(){return"undefined"!=typeof window&&"undefined"!=typeof document}function pt(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function ft(e,t,n){let i;return"string"==typeof e?(i=parseInt(e,10),-1!==e.indexOf("%")&&(i=i/100*t.parentNode[n])):i=e,i}const gt=e=>window.getComputedStyle(e,null);function mt(e,t){return gt(e).getPropertyValue(t)}const yt=["top","right","bottom","left"];function vt(e,t,n){const i={};n=n?"-"+n:"";for(let o=0;o<4;o++){const r=yt[o];i[r]=parseFloat(e[t+"-"+r+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function bt(e,t){const{canvas:n,currentDevicePixelRatio:i}=t,o=gt(n),r="border-box"===o.boxSizing,s=vt(o,"padding"),a=vt(o,"border","width"),{x:l,y:c,box:u}=function(e,t){const n=e.native||e,i=n.touches,o=i&&i.length?i[0]:n,{offsetX:r,offsetY:s}=o;let a,l,c=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(r,s,n.target))a=r,l=s;else{const e=t.getBoundingClientRect();a=o.clientX-e.left,l=o.clientY-e.top,c=!0}return{x:a,y:l,box:c}}(e,n),h=s.left+(u&&a.left),d=s.top+(u&&a.top);let{width:p,height:f}=t;return r&&(p-=s.width+a.width,f-=s.height+a.height),{x:Math.round((l-h)/p*n.width/i),y:Math.round((c-d)/f*n.height/i)}}const xt=e=>Math.round(10*e)/10;function wt(e,t,n,i){const o=gt(e),r=vt(o,"margin"),s=ft(o.maxWidth,e,"clientWidth")||we,a=ft(o.maxHeight,e,"clientHeight")||we,l=function(e,t,n){let i,o;if(void 0===t||void 0===n){const r=pt(e);if(r){const e=r.getBoundingClientRect(),s=gt(r),a=vt(s,"border","width"),l=vt(s,"padding");t=e.width-l.width-a.width,n=e.height-l.height-a.height,i=ft(s.maxWidth,r,"clientWidth"),o=ft(s.maxHeight,r,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:i||we,maxHeight:o||we}}(e,t,n);let{width:c,height:u}=l;if("content-box"===o.boxSizing){const e=vt(o,"border","width"),t=vt(o,"padding");c-=t.width+e.width,u-=t.height+e.height}return c=Math.max(0,c-r.width),u=Math.max(0,i?Math.floor(c/i):u-r.height),c=xt(Math.min(c,s,l.maxWidth)),u=xt(Math.min(u,a,l.maxHeight)),c&&!u&&(u=xt(c/2)),{width:c,height:u}}function _t(e,t,n){const i=t||1,o=Math.floor(e.height*i),r=Math.floor(e.width*i);e.height=o/i,e.width=r/i;const s=e.canvas;return s.style&&(n||!s.style.height&&!s.style.width)&&(s.style.height=`${e.height}px`,s.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==i||s.height!==o||s.width!==r)&&(e.currentDevicePixelRatio=i,s.height=o,s.width=r,e.ctx.setTransform(i,0,0,i,0,0),!0)}const St=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}();function Ct(e,t){const n=mt(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function kt(e,t){return"native"in e?{x:e.x,y:e.y}:bt(e,t)}function At(e,t,n,i){const{controller:o,data:r,_sorted:s}=e,a=o._cachedMeta.iScale;if(a&&t===a.axis&&s&&r.length){const e=a._reversePixels?st:rt;if(!i)return e(r,t,n);if(o._sharedOptions){const i=r[0],o="function"==typeof i.getRange&&i.getRange(t);if(o){const i=e(r,t,n-o),s=e(r,t,n+o);return{lo:i.lo,hi:s.hi}}}}return{lo:0,hi:r.length-1}}function Mt(e,t,n,i,o){const r=e.getSortedVisibleDatasetMetas(),s=n[t];for(let e=0,n=r.length;e<n;++e){const{index:n,data:a}=r[e],{lo:l,hi:c}=At(r[e],t,s,o);for(let e=l;e<=c;++e){const t=a[e];t.skip||i(t,n,e)}}}function Tt(e,t,n,i){const o=[];if(!Xe(t,e.chartArea,e._minPadding))return o;return Mt(e,n,t,(function(e,n,r){e.inRange(t.x,t.y,i)&&o.push({element:e,datasetIndex:n,index:r})}),!0),o}function Et(e,t,n,i,o){const r=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,i){const o=t?Math.abs(e.x-i.x):0,r=n?Math.abs(e.y-i.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(r,2))}}(n);let s=Number.POSITIVE_INFINITY,a=[];if(!Xe(t,e.chartArea,e._minPadding))return a;return Mt(e,n,t,(function(n,l,c){if(i&&!n.inRange(t.x,t.y,o))return;const u=n.getCenterPoint(o);if(!Xe(u,e.chartArea,e._minPadding)&&!n.inRange(t.x,t.y,o))return;const h=r(t,u);h<s?(a=[{element:n,datasetIndex:l,index:c}],s=h):h===s&&a.push({element:n,datasetIndex:l,index:c})})),a}function $t(e,t,n,i){const o=kt(t,e),r=[],s=n.axis,a="x"===s?"inXRange":"inYRange";let l=!1;return function(e,t){const n=e.getSortedVisibleDatasetMetas();let i,o,r;for(let e=0,s=n.length;e<s;++e){({index:i,data:o}=n[e]);for(let e=0,n=o.length;e<n;++e)r=o[e],r.skip||t(r,i,e)}}(e,((e,t,n)=>{e[a](o[s],i)&&r.push({element:e,datasetIndex:t,index:n}),e.inRange(o.x,o.y,i)&&(l=!0)})),n.intersect&&!l?[]:r}var Lt={modes:{index(e,t,n,i){const o=kt(t,e),r=n.axis||"x",s=n.intersect?Tt(e,o,r,i):Et(e,o,r,!1,i),a=[];return s.length?(e.getSortedVisibleDatasetMetas().forEach((e=>{const t=s[0].index,n=e.data[t];n&&!n.skip&&a.push({element:n,datasetIndex:e.index,index:t})})),a):[]},dataset(e,t,n,i){const o=kt(t,e),r=n.axis||"xy";let s=n.intersect?Tt(e,o,r,i):Et(e,o,r,!1,i);if(s.length>0){const t=s[0].datasetIndex,n=e.getDatasetMeta(t).data;s=[];for(let e=0;e<n.length;++e)s.push({element:n[e],datasetIndex:t,index:e})}return s},point:(e,t,n,i)=>Tt(e,kt(t,e),n.axis||"xy",i),nearest:(e,t,n,i)=>Et(e,kt(t,e),n.axis||"xy",n.intersect,i),x:(e,t,n,i)=>(n.axis="x",$t(e,t,n,i)),y:(e,t,n,i)=>(n.axis="y",$t(e,t,n,i))}};const Rt=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),Pt=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function It(e,t){const n=(""+e).match(Rt);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}function Ot(e,t){const n={},i=U(t),o=i?Object.keys(t):t,r=U(e)?i?n=>Y(e[n],e[t[n]]):t=>e[t]:()=>e;for(const e of o)n[e]=+r(e)||0;return n}function Dt(e){return Ot(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Ft(e){return Ot(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Nt(e){const t=Dt(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Bt(e,t){e=e||{},t=t||ye.font;let n=Y(e.size,t.size);"string"==typeof n&&(n=parseInt(n,10));let i=Y(e.style,t.style);i&&!(""+i).match(Pt)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const o={family:Y(e.family,t.family),lineHeight:It(Y(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:Y(e.weight,t.weight),string:""};return o.string=Ve(o),o}function jt(e,t,n,i){let o,r,s,a=!0;for(o=0,r=e.length;o<r;++o)if(s=e[o],void 0!==s&&(void 0!==t&&"function"==typeof s&&(s=s(t),a=!1),void 0!==n&&G(s)&&(s=s[n%s.length],a=!1),void 0!==s))return i&&!a&&(i.cacheable=!1),s}function Ht(e,t){const{min:n,max:i}=e;return{min:n-Math.abs(J(t,n)),max:i+J(t,i)}}const Wt=["left","top","right","bottom"];function zt(e,t){return e.filter((e=>e.pos===t))}function Vt(e,t){return e.filter((e=>-1===Wt.indexOf(e.pos)&&e.box.axis===t))}function Gt(e,t){return e.sort(((e,n)=>{const i=t?n:e,o=t?e:n;return i.weight===o.weight?i.index-o.index:i.weight-o.weight}))}function Ut(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:i,stackWeight:o}=n;if(!e||!Wt.includes(i))continue;const r=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});r.count++,r.weight+=o}return t}(e),{vBoxMaxWidth:i,hBoxMaxHeight:o}=t;let r,s,a;for(r=0,s=e.length;r<s;++r){a=e[r];const{fullSize:s}=a.box,l=n[a.stack],c=l&&a.stackWeight/l.weight;a.horizontal?(a.width=c?c*i:s&&t.availableWidth,a.height=o):(a.width=i,a.height=c?c*o:s&&t.availableHeight)}return n}function qt(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function Kt(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Yt(e,t,n,i){const{pos:o,box:r}=n,s=e.maxPadding;if(!U(o)){n.size&&(e[o]-=n.size);const t=i[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?r.height:r.width),n.size=t.size/t.count,e[o]+=n.size}r.getPadding&&Kt(s,r.getPadding());const a=Math.max(0,t.outerWidth-qt(s,e,"left","right")),l=Math.max(0,t.outerHeight-qt(s,e,"top","bottom")),c=a!==e.w,u=l!==e.h;return e.w=a,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function Xt(e,t){const n=t.maxPadding;function i(e){const i={left:0,top:0,right:0,bottom:0};return e.forEach((e=>{i[e]=Math.max(t[e],n[e])})),i}return i(e?["left","right"]:["top","bottom"])}function Jt(e,t,n,i){const o=[];let r,s,a,l,c,u;for(r=0,s=e.length,c=0;r<s;++r){a=e[r],l=a.box,l.update(a.width||t.w,a.height||t.h,Xt(a.horizontal,t));const{same:s,other:h}=Yt(t,n,a,i);c|=s&&o.length,u=u||h,l.fullSize||o.push(a)}return c&&Jt(o,t,n,i)||u}function Qt(e,t,n,i,o){e.top=n,e.left=t,e.right=t+i,e.bottom=n+o,e.width=i,e.height=o}function Zt(e,t,n,i){const o=n.padding;let{x:r,y:s}=t;for(const a of e){const e=a.box,l=i[a.stack]||{count:1,placed:0,weight:1},c=a.stackWeight/l.weight||1;if(a.horizontal){const i=t.w*c,r=l.size||e.height;ue(l.start)&&(s=l.start),e.fullSize?Qt(e,o.left,s,n.outerWidth-o.right-o.left,r):Qt(e,t.left+l.placed,s,i,r),l.start=s,l.placed+=i,s=e.bottom}else{const i=t.h*c,s=l.size||e.width;ue(l.start)&&(r=l.start),e.fullSize?Qt(e,r,o.top,s,n.outerHeight-o.bottom-o.top):Qt(e,r,t.top+l.placed,s,i),l.start=r,l.placed+=i,r=e.right}}t.x=r,t.y=s}ye.set("layout",{padding:{top:0,right:0,bottom:0,left:0}});var en={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const o=Nt(e.options.layout.padding),r=Math.max(t-o.width,0),s=Math.max(n-o.height,0),a=function(e){const t=function(e){const t=[];let n,i,o,r,s,a;for(n=0,i=(e||[]).length;n<i;++n)o=e[n],({position:r,options:{stack:s,stackWeight:a=1}}=o),t.push({index:n,box:o,pos:r,horizontal:o.isHorizontal(),weight:o.weight,stack:s&&r+s,stackWeight:a});return t}(e),n=Gt(t.filter((e=>e.box.fullSize)),!0),i=Gt(zt(t,"left"),!0),o=Gt(zt(t,"right")),r=Gt(zt(t,"top"),!0),s=Gt(zt(t,"bottom")),a=Vt(t,"x"),l=Vt(t,"y");return{fullSize:n,leftAndTop:i.concat(r),rightAndBottom:o.concat(l).concat(s).concat(a),chartArea:zt(t,"chartArea"),vertical:i.concat(o).concat(l),horizontal:r.concat(s).concat(a)}}(e.boxes),l=a.vertical,c=a.horizontal;Z(e.boxes,(e=>{"function"==typeof e.beforeLayout&&e.beforeLayout()}));const u=l.reduce(((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1),0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:o,availableWidth:r,availableHeight:s,vBoxMaxWidth:r/2/u,hBoxMaxHeight:s/2}),d=Object.assign({},o);Kt(d,Nt(i));const p=Object.assign({maxPadding:d,w:r,h:s,x:o.left,y:o.top},o),f=Ut(l.concat(c),h);Jt(a.fullSize,p,h,f),Jt(l,p,h,f),Jt(c,p,h,f)&&Jt(l,p,h,f),function(e){const t=e.maxPadding;function n(n){const i=Math.max(t[n]-e[n],0);return e[n]+=i,i}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(p),Zt(a.leftAndTop,p,h,f),p.x+=p.w,p.y+=p.h,Zt(a.rightAndBottom,p,h,f),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Z(a.chartArea,(t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(p.w,p.h)}))}};function tn(e,t=[""],n=e,i,o=()=>e[0]){ue(i)||(i=pn("_fallback",e));const r={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:n,_fallback:i,_getTarget:o,override:o=>tn([o,...e],t,n,i)};return new Proxy(r,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,i)=>an(n,i,(()=>function(e,t,n,i){let o;for(const r of t)if(o=pn(rn(r,e),n),ue(o))return sn(e,o)?hn(n,i,e,o):o}(i,t,e,n))),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>fn(e).includes(t),ownKeys:e=>fn(e),set:(e,t,n)=>((e._storage||(e._storage=o()))[t]=n,delete e[t],delete e._keys,!0)})}function nn(e,t,n,i){const o={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:on(e,i),setContext:t=>nn(e,t,n,i),override:o=>nn(e.override(o),t,n,i)};return new Proxy(o,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>an(e,t,(()=>function(e,t,n){const{_proxy:i,_context:o,_subProxy:r,_descriptors:s}=e;let a=i[t];he(a)&&s.isScriptable(t)&&(a=function(e,t,n,i){const{_proxy:o,_context:r,_subProxy:s,_stack:a}=n;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e),t=t(r,s||i),a.delete(e),U(t)&&(t=hn(o._scopes,o,e,t));return t}(t,a,e,n));G(a)&&a.length&&(a=function(e,t,n,i){const{_proxy:o,_context:r,_subProxy:s,_descriptors:a}=n;if(ue(r.index)&&i(e))t=t[r.index%t.length];else if(U(t[0])){const n=t,i=o._scopes.filter((e=>e!==n));t=[];for(const l of n){const n=hn(i,o,e,l);t.push(nn(n,r,s&&s[e],a))}}return t}(t,a,e,s.isIndexable));sn(t,a)&&(a=nn(a,o,r&&r[t],s));return a}(e,t,n))),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,i)=>(e[n]=i,delete t[n],!0)})}function on(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:o=t.allKeys}=e;return{allKeys:o,scriptable:n,indexable:i,isScriptable:he(n)?n:()=>n,isIndexable:he(i)?i:()=>i}}const rn=(e,t)=>e?e+ce(t):t,sn=(e,t)=>U(t)&&"adapters"!==e;function an(e,t,n){let i=e[t];return ue(i)||(i=n(),ue(i)&&(e[t]=i)),i}function ln(e,t,n){return he(e)?e(t,n):e}const cn=(e,t)=>!0===e?t:"string"==typeof e?le(t,e):void 0;function un(e,t,n,i){for(const o of t){const t=cn(n,o);if(t){e.add(t);const o=ln(t._fallback,n,t);if(ue(o)&&o!==n&&o!==i)return o}else if(!1===t&&ue(i)&&n!==i)return null}return!1}function hn(e,t,n,i){const o=t._rootScopes,r=ln(t._fallback,n,i),s=[...e,...o],a=new Set;a.add(i);let l=dn(a,s,n,r||n);return null!==l&&((!ue(r)||r===n||(l=dn(a,s,r,l),null!==l))&&tn(Array.from(a),[""],o,r,(()=>function(e,t,n){const i=e._getTarget();t in i||(i[t]={});const o=i[t];if(G(o)&&U(n))return n;return o}(t,n,i))))}function dn(e,t,n,i){for(;n;)n=un(e,t,n,i);return n}function pn(e,t){for(const n of t){if(!n)continue;const t=n[e];if(ue(t))return t}}function fn(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter((e=>!e.startsWith("_"))))t.add(e);return Array.from(t)}(e._scopes)),t}const gn=Number.EPSILON||1e-14,mn=(e,t)=>t<e.length&&!e[t].skip&&e[t],yn=e=>"x"===e?"y":"x";function vn(e,t,n,i){const o=e.skip?t:e,r=t,s=n.skip?t:n,a=Ne(r,o),l=Ne(s,r);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=i*c,d=i*u;return{previous:{x:r.x-h*(s.x-o.x),y:r.y-h*(s.y-o.y)},next:{x:r.x+d*(s.x-o.x),y:r.y+d*(s.y-o.y)}}}function bn(e,t="x"){const n=yn(t),i=e.length,o=Array(i).fill(0),r=Array(i);let s,a,l,c=mn(e,0);for(s=0;s<i;++s)if(a=l,l=c,c=mn(e,s+1),l){if(c){const e=c[t]-l[t];o[s]=0!==e?(c[n]-l[n])/e:0}r[s]=a?c?Me(o[s-1])!==Me(o[s])?0:(o[s-1]+o[s])/2:o[s-1]:o[s]}!function(e,t,n){const i=e.length;let o,r,s,a,l,c=mn(e,0);for(let u=0;u<i-1;++u)l=c,c=mn(e,u+1),l&&c&&(Le(t[u],0,gn)?n[u]=n[u+1]=0:(o=n[u]/t[u],r=n[u+1]/t[u],a=Math.pow(o,2)+Math.pow(r,2),a<=9||(s=3/Math.sqrt(a),n[u]=o*s*t[u],n[u+1]=r*s*t[u])))}(e,o,r),function(e,t,n="x"){const i=yn(n),o=e.length;let r,s,a,l=mn(e,0);for(let c=0;c<o;++c){if(s=a,a=l,l=mn(e,c+1),!a)continue;const o=a[n],u=a[i];s&&(r=(o-s[n])/3,a[`cp1${n}`]=o-r,a[`cp1${i}`]=u-r*t[c]),l&&(r=(l[n]-o)/3,a[`cp2${n}`]=o+r,a[`cp2${i}`]=u+r*t[c])}}(e,r,t)}function xn(e,t,n){return Math.max(Math.min(e,n),t)}function wn(e,t,n,i,o){let r,s,a,l;if(t.spanGaps&&(e=e.filter((e=>!e.skip))),"monotone"===t.cubicInterpolationMode)bn(e,o);else{let n=i?e[e.length-1]:e[0];for(r=0,s=e.length;r<s;++r)a=e[r],l=vn(n,a,e[Math.min(r+1,s-(i?0:1))%s],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,n=a}t.capBezierPoints&&function(e,t){let n,i,o,r,s,a=Xe(e[0],t);for(n=0,i=e.length;n<i;++n)s=r,r=a,a=n<i-1&&Xe(e[n+1],t),r&&(o=e[n],s&&(o.cp1x=xn(o.cp1x,t.left,t.right),o.cp1y=xn(o.cp1y,t.top,t.bottom)),a&&(o.cp2x=xn(o.cp2x,t.left,t.right),o.cp2y=xn(o.cp2y,t.top,t.bottom)))}(e,n)}const _n=e=>0===e||1===e,Sn=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*be/n),Cn=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*be/n)+1,kn={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Se),easeOutSine:e=>Math.sin(e*Se),easeInOutSine:e=>-.5*(Math.cos(ve*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>_n(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>_n(e)?e:Sn(e,.075,.3),easeOutElastic:e=>_n(e)?e:Cn(e,.075,.3),easeInOutElastic(e){const t=.1125;return _n(e)?e:e<.5?.5*Sn(2*e,t,.45):.5+.5*Cn(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-kn.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*kn.easeInBounce(2*e):.5*kn.easeOutBounce(2*e-1)+.5};function An(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Mn(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:"middle"===i?n<.5?e.y:t.y:"after"===i?n<1?e.y:t.y:n>0?t.y:e.y}}function Tn(e,t,n,i){const o={x:e.cp2x,y:e.cp2y},r={x:t.cp1x,y:t.cp1y},s=An(e,o,n),a=An(o,r,n),l=An(r,t,n),c=An(s,a,n),u=An(a,l,n);return An(c,u,n)}const En=new Map;function $n(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let i=En.get(n);return i||(i=new Intl.NumberFormat(e,t),En.set(n,i)),i}(t,n).format(e)}function Ln(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function Rn(e,t){let n,i;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function Pn(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function In(e){return"angle"===e?{between:He,compare:Be,normalize:je}:{between:(e,t,n)=>e>=Math.min(t,n)&&e<=Math.max(n,t),compare:(e,t)=>e-t,normalize:e=>e}}function On({start:e,end:t,count:n,loop:i,style:o}){return{start:e%n,end:t%n,loop:i&&(t-e+1)%n==0,style:o}}function Dn(e,t,n){if(!n)return[e];const{property:i,start:o,end:r}=n,s=t.length,{compare:a,between:l,normalize:c}=In(i),{start:u,end:h,loop:d,style:p}=function(e,t,n){const{property:i,start:o,end:r}=n,{between:s,normalize:a}=In(i),l=t.length;let c,u,{start:h,end:d,loop:p}=e;if(p){for(h+=l,d+=l,c=0,u=l;c<u&&s(a(t[h%l][i]),o,r);++c)h--,d--;h%=l,d%=l}return d<h&&(d+=l),{start:h,end:d,loop:p,style:e.style}}(e,t,n),f=[];let g,m,y,v=!1,b=null;const x=()=>v||l(o,y,g)&&0!==a(o,y),w=()=>!v||0===a(r,g)||l(r,y,g);for(let e=u,n=u;e<=h;++e)m=t[e%s],m.skip||(g=c(m[i]),g!==y&&(v=l(g,o,r),null===b&&x()&&(b=0===a(g,o)?e:n),null!==b&&w()&&(f.push(On({start:b,end:e,loop:d,count:s,style:p})),b=null),n=e,y=g));return null!==b&&f.push(On({start:b,end:h,loop:d,count:s,style:p})),f}function Fn(e,t){const n=[],i=e.segments;for(let o=0;o<i.length;o++){const r=Dn(i[o],e.points,t);r.length&&n.push(...r)}return n}function Nn(e,t){const n=e.points,i=e.options.spanGaps,o=n.length;if(!o)return[];const r=!!e._loop,{start:s,end:a}=function(e,t,n,i){let o=0,r=t-1;if(n&&!i)for(;o<t&&!e[o].skip;)o++;for(;o<t&&e[o].skip;)o++;for(o%=t,n&&(r+=o);r>o&&e[r%t].skip;)r--;return r%=t,{start:o,end:r}}(n,o,r,i);if(!0===i)return Bn(e,[{start:s,end:a,loop:r}],n,t);return Bn(e,function(e,t,n,i){const o=e.length,r=[];let s,a=t,l=e[t];for(s=t+1;s<=n;++s){const n=e[s%o];n.skip||n.stop?l.skip||(i=!1,r.push({start:t%o,end:(s-1)%o,loop:i}),t=a=n.stop?s:null):(a=s,l.skip&&(t=s)),l=n}return null!==a&&r.push({start:t%o,end:a%o,loop:i}),r}(n,s,a<s?a+o:a,!!e._fullLoop&&0===s&&a===o-1),n,t)}function Bn(e,t,n,i){return i&&i.setContext&&n?function(e,t,n,i){const o=jn(e.options),r=n.length,s=[];let a=t[0].start,l=a;for(const c of t){let t,u=o,h=n[a%r];for(l=a+1;l<=c.end;l++){const o=n[l%r];t=jn(i.setContext({type:"segment",p0:h,p1:o,p0DataIndex:(l-1)%r,p1DataIndex:l%r,datasetIndex:e._datasetIndex})),Hn(t,u)&&(s.push({start:a,end:l-1,loop:c.loop,style:u}),u=t,a=l-1),h=o,u=t}a<l-1&&(s.push({start:a,end:l-1,loop:c.loop,style:t}),a=l-1)}return s}(e,t,n,i):t}function jn(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Hn(e,t){return t&&JSON.stringify(e)!==JSON.stringify(t)}var Wn=Object.freeze({__proto__:null,easingEffects:kn,color:j,getHoverColor:H,noop:W,uid:z,isNullOrUndef:V,isArray:G,isObject:U,isFinite:q,finiteOrDefault:K,valueOrDefault:Y,toPercentage:X,toDimension:J,callback:Q,each:Z,_elementsEqual:ee,clone:te,_merger:ie,merge:oe,mergeIf:re,_mergerIf:se,_deprecated:function(e,t,n,i){void 0!==t&&console.warn(e+': "'+n+'" is deprecated. Please use "'+i+'" instead')},resolveObjectKey:le,_capitalize:ce,defined:ue,isFunction:he,setsEqual:de,toFontString:Ve,_measureText:Ge,_longestText:Ue,_alignPixel:qe,clearCanvas:Ke,drawPoint:Ye,_isPointInArea:Xe,clipArea:Je,unclipArea:Qe,_steppedLineTo:Ze,_bezierCurveTo:et,renderText:tt,addRoundedRectPath:it,_lookup:ot,_lookupByKey:rt,_rlookupByKey:st,_filterBetween:at,listenArrayEvents:ct,unlistenArrayEvents:ut,_arrayUnique:ht,_createResolver:tn,_attachContext:nn,_descriptors:on,splineCurve:vn,splineCurveMonotone:bn,_updateBezierControlPoints:wn,_isDomSupported:dt,_getParentNode:pt,getStyle:mt,getRelativePosition:bt,getMaximumSize:wt,retinaScale:_t,supportsEventListenerOptions:St,readUsedSize:Ct,fontString:function(e,t,n){return t+" "+e+"px "+n},requestAnimFrame:e,throttled:t,debounce:n,_toLeftRightCenter:i,_alignStartEnd:o,_textX:r,_pointInLine:An,_steppedInterpolation:Mn,_bezierInterpolation:Tn,formatNumber:$n,toLineHeight:It,_readValueToProps:Ot,toTRBL:Dt,toTRBLCorners:Ft,toPadding:Nt,toFont:Bt,resolve:jt,_addGrace:Ht,PI:ve,TAU:be,PITAU:xe,INFINITY:we,RAD_PER_DEG:_e,HALF_PI:Se,QUARTER_PI:Ce,TWO_THIRDS_PI:ke,log10:Ae,sign:Me,niceNum:Te,_factorize:Ee,isNumber:$e,almostEquals:Le,almostWhole:Re,_setMinAndMaxByKey:Pe,toRadians:Ie,toDegrees:Oe,_decimalPlaces:De,getAngleFromPoint:Fe,distanceBetweenPoints:Ne,_angleDiff:Be,_normalizeAngle:je,_angleBetween:He,_limitValue:We,_int16Range:ze,getRtlAdapter:Ln,overrideTextDirection:Rn,restoreTextDirection:Pn,_boundSegment:Dn,_boundSegments:Fn,_computeSegments:Nn});class zn{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}isAttached(e){return!0}}class Vn extends zn{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}}const Gn="$chartjs",Un={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},qn=e=>null===e||""===e;const Kn=!!St&&{passive:!0};function Yn(e,t,n){e.canvas.removeEventListener(t,n,Kn)}function Xn(e,t,n){const i=e.canvas,o=i&&pt(i)||i,r=new MutationObserver((e=>{const t=pt(o);e.forEach((e=>{for(let i=0;i<e.addedNodes.length;i++){const r=e.addedNodes[i];r!==o&&r!==t||n(e.target)}}))}));return r.observe(document,{childList:!0,subtree:!0}),r}function Jn(e,t,n){const i=e.canvas,o=i&&pt(i);if(!o)return;const r=new MutationObserver((e=>{e.forEach((e=>{for(let t=0;t<e.removedNodes.length;t++)if(e.removedNodes[t]===i){n();break}}))}));return r.observe(o,{childList:!0}),r}const Qn=new Map;let Zn=0;function ei(){const e=window.devicePixelRatio;e!==Zn&&(Zn=e,Qn.forEach(((t,n)=>{n.currentDevicePixelRatio!==e&&t()})))}function ti(e,n,i){const o=e.canvas,r=o&&pt(o);if(!r)return;const s=t(((e,t)=>{const n=r.clientWidth;i(e,t),n<r.clientWidth&&i()}),window),a=new ResizeObserver((e=>{const t=e[0],n=t.contentRect.width,i=t.contentRect.height;0===n&&0===i||s(n,i)}));return a.observe(r),function(e,t){Qn.size||window.addEventListener("resize",ei),Qn.set(e,t)}(e,s),a}function ni(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){Qn.delete(e),Qn.size||window.removeEventListener("resize",ei)}(e)}function ii(e,n,i){const o=e.canvas,r=t((t=>{null!==e.ctx&&i(function(e,t){const n=Un[e.type]||e.type,{x:i,y:o}=bt(e,t);return{type:n,chart:t,native:e,x:void 0!==i?i:null,y:void 0!==o?o:null}}(t,e))}),e,(e=>{const t=e[0];return[t,t.offsetX,t.offsetY]}));return function(e,t,n){e.addEventListener(t,n,Kn)}(o,n,r),r}class oi extends zn{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,i=e.getAttribute("height"),o=e.getAttribute("width");if(e[Gn]={initial:{height:i,width:o,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",qn(o)){const t=Ct(e,"width");void 0!==t&&(e.width=t)}if(qn(i))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Ct(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[Gn])return!1;const n=t[Gn].initial;["height","width"].forEach((e=>{const i=n[e];V(i)?t.removeAttribute(e):t.setAttribute(e,i)}));const i=n.style||{};return Object.keys(i).forEach((e=>{t.style[e]=i[e]})),t.width=t.width,delete t[Gn],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:Xn,detach:Jn,resize:ti}[t]||ii;i[t]=o(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),i=n[t];if(!i)return;({attach:ni,detach:ni,resize:ni}[t]||Yn)(e,t,i),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,i){return wt(e,t,n,i)}isAttached(e){const t=pt(e);return!(!t||!t.isConnected)}}function ri(e){return!dt()||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?Vn:oi}var si=Object.freeze({__proto__:null,_detectPlatform:ri,BasePlatform:zn,BasicPlatform:Vn,DomPlatform:oi});const ai="transparent",li={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const i=j(e||ai),o=i.valid&&j(t||ai);return o&&o.valid?o.mix(i,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class ci{constructor(e,t,n,i){const o=t[n];i=jt([e.to,i,o,e.from]);const r=jt([e.from,o,i]);this._active=!0,this._fn=e.fn||li[e.type||typeof r],this._easing=kn[e.easing]||kn.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=r,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,n){const i=this;if(i._active){i._notify(!1);const o=i._target[i._prop],r=n-i._start,s=i._duration-r;i._start=n,i._duration=Math.floor(Math.max(s,e.duration)),i._total+=r,i._loop=!!e.loop,i._to=jt([e.to,t,o,e.from]),i._from=jt([e.from,o,t])}}cancel(){const e=this;e._active&&(e.tick(Date.now()),e._active=!1,e._notify(!1))}tick(e){const t=this,n=e-t._start,i=t._duration,o=t._prop,r=t._from,s=t._loop,a=t._to;let l;if(t._active=r!==a&&(s||n<i),!t._active)return t._target[o]=a,void t._notify(!0);n<0?t._target[o]=r:(l=n/i%2,l=s&&l>1?2-l:l,l=t._easing(Math.min(1,Math.max(0,l))),t._target[o]=t._fn(r,a,l))}wait(){const e=this._promises||(this._promises=[]);return new Promise(((t,n)=>{e.push({res:t,rej:n})}))}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let e=0;e<n.length;e++)n[e][t]()}}ye.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const ui=Object.keys(ye.animation);ye.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),ye.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),ye.describe("animations",{_fallback:"animation"}),ye.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}});class hi{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!U(e))return;const t=this._properties;Object.getOwnPropertyNames(e).forEach((n=>{const i=e[n];if(!U(i))return;const o={};for(const e of ui)o[e]=i[e];(G(i.properties)&&i.properties||[n]).forEach((e=>{e!==n&&t.has(e)||t.set(e,o)}))}))}_animateOptions(e,t){const n=t.options,i=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!i)return[];const o=this._createAnimations(i,n);return n.$shared&&function(e,t){const n=[],i=Object.keys(t);for(let t=0;t<i.length;t++){const o=e[i[t]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}(e.options.$animations,n).then((()=>{e.options=n}),(()=>{})),o}_createAnimations(e,t){const n=this._properties,i=[],o=e.$animations||(e.$animations={}),r=Object.keys(t),s=Date.now();let a;for(a=r.length-1;a>=0;--a){const l=r[a];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(e,t));continue}const c=t[l];let u=o[l];const h=n.get(l);if(u){if(h&&u.active()){u.update(h,c,s);continue}u.cancel()}h&&h.duration?(o[l]=u=new ci(h,e,l,c),i.push(u)):e[l]=c}return i}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(s.add(this._chart,n),!0):void 0}}function di(e,t){const n=e&&e.options||{},i=n.reverse,o=void 0===n.min?t:0,r=void 0===n.max?t:0;return{start:i?r:o,end:i?o:r}}function pi(e,t){const n=[],i=e._getSortedDatasetMetas(t);let o,r;for(o=0,r=i.length;o<r;++o)n.push(i[o].index);return n}function fi(e,t,n,i){const o=e.keys,r="single"===i.mode;let s,a,l,c;if(null!==t){for(s=0,a=o.length;s<a;++s){if(l=+o[s],l===n){if(i.all)continue;break}c=e.values[l],q(c)&&(r||0===t||Me(t)===Me(c))&&(t+=c)}return t}}function gi(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function mi(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function yi(e,t,n){for(const i of t.getMatchingVisibleMetas("bar").reverse()){const t=e[i.index];if(n&&t>0||!n&&t<0)return i.index}return null}function vi(e,t){const{chart:n,_cachedMeta:i}=e,o=n._stacks||(n._stacks={}),{iScale:r,vScale:s,index:a}=i,l=r.axis,c=s.axis,u=function(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}(r,s,i),h=t.length;let d;for(let e=0;e<h;++e){const n=t[e],{[l]:i,[c]:r}=n;d=(n._stacks||(n._stacks={}))[c]=mi(o,u,i),d[a]=r,d._top=yi(d,s,!0),d._bottom=yi(d,s,!1)}}function bi(e,t){const n=e.scales;return Object.keys(n).filter((e=>n[e].axis===t)).shift()}function xi(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[i]||void 0===t[i][n])return;delete t[i][n]}}}const wi=e=>"reset"===e||"none"===e,_i=(e,t)=>t?e:Object.assign({},e);class Si{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const e=this,t=e._cachedMeta;e.configure(),e.linkScales(),t._stacked=gi(t.vScale,t),e.addElements()}updateIndex(e){this.index!==e&&xi(this._cachedMeta),this.index=e}linkScales(){const e=this,t=e.chart,n=e._cachedMeta,i=e.getDataset(),o=(e,t,n,i)=>"x"===e?t:"r"===e?i:n,r=n.xAxisID=Y(i.xAxisID,bi(t,"x")),s=n.yAxisID=Y(i.yAxisID,bi(t,"y")),a=n.rAxisID=Y(i.rAxisID,bi(t,"r")),l=n.indexAxis,c=n.iAxisID=o(l,r,s,a),u=n.vAxisID=o(l,s,r,a);n.xScale=e.getScaleForId(r),n.yScale=e.getScaleForId(s),n.rScale=e.getScaleForId(a),n.iScale=e.getScaleForId(c),n.vScale=e.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&ut(this._data,this),e._stacked&&xi(e)}_dataCheck(){const e=this,t=e.getDataset(),n=t.data||(t.data=[]),i=e._data;if(U(n))e._data=function(e){const t=Object.keys(e),n=new Array(t.length);let i,o,r;for(i=0,o=t.length;i<o;++i)r=t[i],n[i]={x:r,y:e[r]};return n}(n);else if(i!==n){if(i){ut(i,e);const t=e._cachedMeta;xi(t),t._parsed=[]}n&&Object.isExtensible(n)&&ct(n,e),e._syncList=[],e._data=n}}addElements(){const e=this,t=e._cachedMeta;e._dataCheck(),e.datasetElementType&&(t.dataset=new e.datasetElementType)}buildOrUpdateElements(e){const t=this,n=t._cachedMeta,i=t.getDataset();let o=!1;t._dataCheck();const r=n._stacked;n._stacked=gi(n.vScale,n),n.stack!==i.stack&&(o=!0,xi(n),n.stack=i.stack),t._resyncElements(e),(o||r!==n._stacked)&&vi(t,n._parsed)}configure(){const e=this,t=e.chart.config,n=t.datasetScopeKeys(e._type),i=t.getOptionScopes(e.getDataset(),n,!0);e.options=t.createResolver(i,e.getContext()),e._parsing=e.options.parsing}parse(e,t){const n=this,{_cachedMeta:i,_data:o}=n,{iScale:r,_stacked:s}=i,a=r.axis;let l,c,u,h=0===e&&t===o.length||i._sorted,d=e>0&&i._parsed[e-1];if(!1===n._parsing)i._parsed=o,i._sorted=!0,u=o;else{u=G(o[e])?n.parseArrayData(i,o,e,t):U(o[e])?n.parseObjectData(i,o,e,t):n.parsePrimitiveData(i,o,e,t);const r=()=>null===c[a]||d&&c[a]<d[a];for(l=0;l<t;++l)i._parsed[l+e]=c=u[l],h&&(r()&&(h=!1),d=c);i._sorted=h}s&&vi(n,u)}parsePrimitiveData(e,t,n,i){const{iScale:o,vScale:r}=e,s=o.axis,a=r.axis,l=o.getLabels(),c=o===r,u=new Array(i);let h,d,p;for(h=0,d=i;h<d;++h)p=h+n,u[h]={[s]:c||o.parse(l[p],p),[a]:r.parse(t[p],p)};return u}parseArrayData(e,t,n,i){const{xScale:o,yScale:r}=e,s=new Array(i);let a,l,c,u;for(a=0,l=i;a<l;++a)c=a+n,u=t[c],s[a]={x:o.parse(u[0],c),y:r.parse(u[1],c)};return s}parseObjectData(e,t,n,i){const{xScale:o,yScale:r}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l=new Array(i);let c,u,h,d;for(c=0,u=i;c<u;++c)h=c+n,d=t[h],l[c]={x:o.parse(le(d,s),h),y:r.parse(le(d,a),h)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const i=this.chart,o=this._cachedMeta,r=t[e.axis];return fi({keys:pi(i,!0),values:t._stacks[e.axis]},r,o.index,{mode:n})}updateRangeFromParsed(e,t,n,i){const o=n[t.axis];let r=null===o?NaN:o;const s=i&&n._stacks[t.axis];i&&s&&(i.values=s,e.min=Math.min(e.min,r),e.max=Math.max(e.max,r),r=fi(i,o,this._cachedMeta.index,{all:!0})),e.min=Math.min(e.min,r),e.max=Math.max(e.max,r)}getMinMax(e,t){const n=this,i=n._cachedMeta,o=i._parsed,r=i._sorted&&e===i.iScale,s=o.length,a=n._getOtherScale(e),l=t&&i._stacked&&{keys:pi(n.chart,!0),values:null},c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=function(e){const{min:t,max:n,minDefined:i,maxDefined:o}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:o?n:Number.POSITIVE_INFINITY}}(a);let d,p,f,g;function m(){return f=o[d],p=f[e.axis],g=f[a.axis],!q(p)||u>g||h<g}for(d=0;d<s&&(m()||(n.updateRangeFromParsed(c,e,f,l),!r));++d);if(r)for(d=s-1;d>=0;--d)if(!m()){n.updateRangeFromParsed(c,e,f,l);break}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let i,o,r;for(i=0,o=t.length;i<o;++i)r=t[i][e.axis],q(r)&&n.push(r);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,i=t.vScale,o=this.getParsed(e);return{label:n?""+n.getLabelForValue(o[n.axis]):"",value:i?""+i.getLabelForValue(o[i.axis]):""}}_update(e){const t=this,n=t._cachedMeta;t.configure(),t._cachedDataOpts={},t.update(e||"default"),n._clip=function(e){let t,n,i,o;return U(e)?(t=e.top,n=e.right,i=e.bottom,o=e.left):t=n=i=o=e,{top:t,right:n,bottom:i,left:o,disabled:!1===e}}(Y(t.options.clip,function(e,t,n){if(!1===n)return!1;const i=di(e,n),o=di(t,n);return{top:o.end,right:i.end,bottom:o.start,left:i.start}}(n.xScale,n.yScale,t.getMaxOverflow())))}update(e){}draw(){const e=this,t=e._ctx,n=e.chart,i=e._cachedMeta,o=i.data||[],r=n.chartArea,s=[],a=e._drawStart||0,l=e._drawCount||o.length-a;let c;for(i.dataset&&i.dataset.draw(t,r,a,l),c=a;c<a+l;++c){const e=o[c];e.hidden||(e.active?s.push(e):e.draw(t,r))}for(c=0;c<s.length;++c)s[c].draw(t,r)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const i=this,o=i.getDataset();let r;if(e>=0&&e<i._cachedMeta.data.length){const t=i._cachedMeta.data[e];r=t.$context||(t.$context=function(e,t,n){return Object.assign(Object.create(e),{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(i.getContext(),e,t)),r.parsed=i.getParsed(e),r.raw=o.data[e],r.index=r.dataIndex=e}else r=i.$context||(i.$context=function(e,t){return Object.assign(Object.create(e),{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(i.chart.getContext(),i.index)),r.dataset=o,r.index=r.datasetIndex=i.index;return r.active=!!t,r.mode=n,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const i=this,o="active"===t,r=i._cachedDataOpts,s=e+"-"+t,a=r[s],l=i.enableOptionSharing&&ue(n);if(a)return _i(a,l);const c=i.chart.config,u=c.datasetElementScopeKeys(i._type,e),h=o?[`${e}Hover`,"hover",e,""]:[e,""],d=c.getOptionScopes(i.getDataset(),u),p=Object.keys(ye.elements[e]),f=c.resolveNamedOptions(d,p,(()=>i.getContext(n,o)),h);return f.$shared&&(f.$shared=l,r[s]=Object.freeze(_i(f,l))),f}_resolveAnimations(e,t,n){const i=this,o=i.chart,r=i._cachedDataOpts,s=`animation-${t}`,a=r[s];if(a)return a;let l;if(!1!==o.options.animation){const o=i.chart.config,r=o.datasetAnimationScopeKeys(i._type,t),s=o.getOptionScopes(i.getDataset(),r);l=o.createResolver(s,i.getContext(e,n,t))}const c=new hi(o,l&&l.animations);return l&&l._cacheable&&(r[s]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||wi(e)||this.chart._animationsDisabled}updateElement(e,t,n,i){wi(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}updateSharedOptions(e,t,n){e&&!wi(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,i){e.active=i;const o=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(o)||o})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this,n=t._data,i=t._cachedMeta.data;for(const[e,n,i]of t._syncList)t[e](n,i);t._syncList=[];const o=i.length,r=n.length,s=Math.min(r,o);s&&t.parse(0,s),r>o?t._insertElements(o,r-o,e):r<o&&t._removeElements(r,o-r)}_insertElements(e,t,n=!0){const i=this,o=i._cachedMeta,r=o.data,s=e+t;let a;const l=e=>{for(e.length+=t,a=e.length-1;a>=s;a--)e[a]=e[a-t]};for(l(r),a=e;a<s;++a)r[a]=new i.dataElementType;i._parsing&&l(o._parsed),i.parse(e,t),n&&i.updateElements(r,e,t,"reset")}updateElements(e,t,n,i){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,t);n._stacked&&xi(n,i)}n.data.splice(e,t)}_onDataPush(){const e=arguments.length;this._syncList.push(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._syncList.push(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._syncList.push(["_removeElements",0,1])}_onDataSplice(e,t){this._syncList.push(["_removeElements",e,t]),this._syncList.push(["_insertElements",e,arguments.length-2])}_onDataUnshift(){this._syncList.push(["_insertElements",0,arguments.length])}}Si.defaults={},Si.prototype.datasetElementType=null,Si.prototype.dataElementType=null;class Ci{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return $e(this.x)&&$e(this.y)}getProps(e,t){const n=this,i=this.$animations;if(!t||!i)return n;const o={};return e.forEach((e=>{o[e]=i[e]&&i[e].active()?i[e]._to:n[e]})),o}}Ci.defaults={},Ci.defaultRoutes=void 0;const ki={values:e=>G(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const i=this.chart.options.locale;let o,r=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(o="scientific"),r=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const s=Ae(Math.abs(r)),a=Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:o,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),$n(e,i,l)},logarithmic(e,t,n){if(0===e)return"0";const i=e/Math.pow(10,Math.floor(Ae(e)));return 1===i||2===i||5===i?ki.numeric.call(this,e,t,n):""}};var Ai={formatters:ki};function Mi(e,t){const n=e.options.ticks,i=n.maxTicksLimit||function(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),o=e._maxLength/n;return Math.floor(Math.min(i,o))}(e),o=n.major.enabled?function(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}(t):[],r=o.length,s=o[0],a=o[r-1],l=[];if(r>i)return function(e,t,n,i){let o,r=0,s=n[0];for(i=Math.ceil(i),o=0;o<e.length;o++)o===s&&(t.push(e[o]),r++,s=n[r*i])}(t,l,o,r/i),l;const c=function(e,t,n){const i=function(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}(e),o=t.length/n;if(!i)return Math.max(o,1);const r=Ee(i);for(let e=0,t=r.length-1;e<t;e++){const t=r[e];if(t>o)return t}return Math.max(o,1)}(o,t,i);if(r>0){let e,n;const i=r>1?Math.round((a-s)/(r-1)):null;for(Ti(t,l,c,V(i)?0:s-i,s),e=0,n=r-1;e<n;e++)Ti(t,l,c,o[e],o[e+1]);return Ti(t,l,c,a,V(i)?t.length:a+i),l}return Ti(t,l,c),l}function Ti(e,t,n,i,o){const r=Y(i,0),s=Math.min(Y(o,e.length),e.length);let a,l,c,u=0;for(n=Math.ceil(n),o&&(a=o-i,n=a/Math.floor(a/n)),c=r;c<0;)u++,c=Math.round(r+u*n);for(l=Math.max(r,0);l<s;l++)l===c&&(t.push(e[l]),u++,c=Math.round(r+u*n))}ye.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ai.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),ye.route("scale.ticks","color","","color"),ye.route("scale.grid","color","","borderColor"),ye.route("scale.grid","borderColor","","borderColor"),ye.route("scale.title","color","","color"),ye.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e}),ye.describe("scales",{_fallback:"scale"}),ye.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e});const Ei=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n;function $i(e,t){const n=[],i=e.length/t,o=e.length;let r=0;for(;r<o;r+=i)n.push(e[Math.floor(r)]);return n}function Li(e,t,n){const i=e.ticks.length,o=Math.min(t,i-1),r=e._startPixel,s=e._endPixel,a=1e-6;let l,c=e.getPixelForTick(o);if(!(n&&(l=1===i?Math.max(c-r,s-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(o-1))/2,c+=o<t?l:-l,c<r-a||c>s+a)))return c}function Ri(e){return e.drawTicks?e.tickLength:0}function Pi(e,t){if(!e.display)return 0;const n=Bt(e.font,t),i=Nt(e.padding);return(G(e.text)?e.text.length:1)*n.lineHeight+i.height}function Ii(e,t,n){let o=i(e);return(n&&"right"!==t||!n&&"right"===t)&&(o=(e=>"left"===e?"right":"right"===e?"left":e)(o)),o}class Oi extends Ci{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){const t=this;t.options=e.setContext(t.getContext()),t.axis=e.axis,t._userMin=t.parse(e.min),t._userMax=t.parse(e.max),t._suggestedMin=t.parse(e.suggestedMin),t._suggestedMax=t.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:i}=this;return e=K(e,Number.POSITIVE_INFINITY),t=K(t,Number.NEGATIVE_INFINITY),n=K(n,Number.POSITIVE_INFINITY),i=K(i,Number.NEGATIVE_INFINITY),{min:K(e,n),max:K(t,i),minDefined:q(e),maxDefined:q(t)}}getMinMax(e){const t=this;let n,{min:i,max:o,minDefined:r,maxDefined:s}=t.getUserBounds();if(r&&s)return{min:i,max:o};const a=t.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)n=a[l].controller.getMinMax(t,e),r||(i=Math.min(i,n.min)),s||(o=Math.max(o,n.max));return{min:K(i,K(o,i)),max:K(o,K(i,o))}}getPadding(){const e=this;return{left:e.paddingLeft||0,top:e.paddingTop||0,right:e.paddingRight||0,bottom:e.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Q(this.options.beforeUpdate,[this])}update(e,t,n){const i=this,o=i.options.ticks,r=o.sampleSize;i.beforeUpdate(),i.maxWidth=e,i.maxHeight=t,i._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),i.ticks=null,i._labelSizes=null,i._gridLineItems=null,i._labelItems=null,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i._maxLength=i.isHorizontal()?i.width+n.left+n.right:i.height+n.top+n.bottom,i._dataLimitsCached||(i.beforeDataLimits(),i.determineDataLimits(),i.afterDataLimits(),i._range=Ht(i,i.options.grace),i._dataLimitsCached=!0),i.beforeBuildTicks(),i.ticks=i.buildTicks()||[],i.afterBuildTicks();const s=r<i.ticks.length;i._convertTicksToLabels(s?$i(i.ticks,r):i.ticks),i.configure(),i.beforeCalculateLabelRotation(),i.calculateLabelRotation(),i.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(i.ticks=Mi(i,i.ticks),i._labelSizes=null),s&&i._convertTicksToLabels(i.ticks),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate()}configure(){const e=this;let t,n,i=e.options.reverse;e.isHorizontal()?(t=e.left,n=e.right):(t=e.top,n=e.bottom,i=!i),e._startPixel=t,e._endPixel=n,e._reversePixels=i,e._length=n-t,e._alignToPixels=e.options.alignToPixels}afterUpdate(){Q(this.options.afterUpdate,[this])}beforeSetDimensions(){Q(this.options.beforeSetDimensions,[this])}setDimensions(){const e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0}afterSetDimensions(){Q(this.options.afterSetDimensions,[this])}_callHooks(e){const t=this;t.chart.notifyPlugins(e,t.getContext()),Q(t.options[e],[t])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Q(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this,n=t.options.ticks;let i,o,r;for(i=0,o=e.length;i<o;i++)r=e[i],r.label=Q(n.callback,[r.value,i,e],t)}afterTickToLabelConversion(){Q(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Q(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this,t=e.options,n=t.ticks,i=e.ticks.length,o=n.minRotation||0,r=n.maxRotation;let s,a,l,c=o;if(!e._isVisible()||!n.display||o>=r||i<=1||!e.isHorizontal())return void(e.labelRotation=o);const u=e._getLabelSizes(),h=u.widest.width,d=u.highest.height,p=We(e.chart.width-h,0,e.maxWidth);s=t.offset?e.maxWidth/i:p/(i-1),h+6>s&&(s=p/(i-(t.offset?.5:1)),a=e.maxHeight-Ri(t.grid)-n.padding-Pi(t.title,e.chart.options.font),l=Math.sqrt(h*h+d*d),c=Oe(Math.min(Math.asin(We((u.highest.height+6)/s,-1,1)),Math.asin(We(a/l,-1,1))-Math.asin(We(d/l,-1,1)))),c=Math.max(o,Math.min(r,c))),e.labelRotation=c}afterCalculateLabelRotation(){Q(this.options.afterCalculateLabelRotation,[this])}beforeFit(){Q(this.options.beforeFit,[this])}fit(){const e=this,t={width:0,height:0},{chart:n,options:{ticks:i,title:o,grid:r}}=e,s=e._isVisible(),a=e.isHorizontal();if(s){const s=Pi(o,n.options.font);if(a?(t.width=e.maxWidth,t.height=Ri(r)+s):(t.height=e.maxHeight,t.width=Ri(r)+s),i.display&&e.ticks.length){const{first:n,last:o,widest:r,highest:s}=e._getLabelSizes(),l=2*i.padding,c=Ie(e.labelRotation),u=Math.cos(c),h=Math.sin(c);if(a){const n=i.mirror?0:h*r.width+u*s.height;t.height=Math.min(e.maxHeight,t.height+n+l)}else{const n=i.mirror?0:u*r.width+h*s.height;t.width=Math.min(e.maxWidth,t.width+n+l)}e._calculatePadding(n,o,h,u)}}e._handleMargins(),a?(e.width=e._length=n.width-e._margins.left-e._margins.right,e.height=t.height):(e.width=t.width,e.height=e._length=n.height-e._margins.top-e._margins.bottom)}_calculatePadding(e,t,n,i){const o=this,{ticks:{align:r,padding:s},position:a}=o.options,l=0!==o.labelRotation,c="top"!==a&&"x"===o.axis;if(o.isHorizontal()){const a=o.getPixelForTick(0)-o.left,u=o.right-o.getPixelForTick(o.ticks.length-1);let h=0,d=0;l?c?(h=i*e.width,d=n*t.height):(h=n*e.height,d=i*t.width):"start"===r?d=t.width:"end"===r?h=e.width:(h=e.width/2,d=t.width/2),o.paddingLeft=Math.max((h-a+s)*o.width/(o.width-a),0),o.paddingRight=Math.max((d-u+s)*o.width/(o.width-u),0)}else{let n=t.height/2,i=e.height/2;"start"===r?(n=0,i=e.height):"end"===r&&(n=t.height,i=0),o.paddingTop=n+s,o.paddingBottom=i+s}}_handleMargins(){const e=this;e._margins&&(e._margins.left=Math.max(e.paddingLeft,e._margins.left),e._margins.top=Math.max(e.paddingTop,e._margins.top),e._margins.right=Math.max(e.paddingRight,e._margins.right),e._margins.bottom=Math.max(e.paddingBottom,e._margins.bottom))}afterFit(){Q(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){const t=this;let n,i;for(t.beforeTickToLabelConversion(),t.generateTickLabels(e),n=0,i=e.length;n<i;n++)V(e[n].label)&&(e.splice(n,1),i--,n--);t.afterTickToLabelConversion()}_getLabelSizes(){const e=this;let t=e._labelSizes;if(!t){const n=e.options.ticks.sampleSize;let i=e.ticks;n<i.length&&(i=$i(i,n)),e._labelSizes=t=e._computeLabelSizes(i,i.length)}return t}_computeLabelSizes(e,t){const{ctx:n,_longestTextCache:i}=this,o=[],r=[];let s,a,l,c,u,h,d,p,f,g,m,y=0,v=0;for(s=0;s<t;++s){if(c=e[s].label,u=this._resolveTickFontOptions(s),n.font=h=u.string,d=i[h]=i[h]||{data:{},gc:[]},p=u.lineHeight,f=g=0,V(c)||G(c)){if(G(c))for(a=0,l=c.length;a<l;++a)m=c[a],V(m)||G(m)||(f=Ge(n,d.data,d.gc,f,m),g+=p)}else f=Ge(n,d.data,d.gc,f,c),g=p;o.push(f),r.push(g),y=Math.max(f,y),v=Math.max(g,v)}!function(e,t){Z(e,(e=>{const n=e.gc,i=n.length/2;let o;if(i>t){for(o=0;o<i;++o)delete e.data[n[o]];n.splice(0,i)}}))}(i,t);const b=o.indexOf(y),x=r.indexOf(v),w=e=>({width:o[e]||0,height:r[e]||0});return{first:w(0),last:w(t-1),widest:w(b),highest:w(x),widths:o,heights:r}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){const t=this;t._reversePixels&&(e=1-e);const n=t._startPixel+e*t._length;return ze(t._alignToPixels?qe(t.chart,n,0):n)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this,n=t.ticks||[];if(e>=0&&e<n.length){const i=n[e];return i.$context||(i.$context=function(e,t,n){return Object.assign(Object.create(e),{tick:n,index:t,type:"tick"})}(t.getContext(),e,i))}return t.$context||(t.$context=(i=t.chart.getContext(),o=t,Object.assign(Object.create(i),{scale:o,type:"scale"})));var i,o}_tickSize(){const e=this,t=e.options.ticks,n=Ie(e.labelRotation),i=Math.abs(Math.cos(n)),o=Math.abs(Math.sin(n)),r=e._getLabelSizes(),s=t.autoSkipPadding||0,a=r?r.widest.width+s:0,l=r?r.highest.height+s:0;return e.isHorizontal()?l*i>a*o?a/i:l/o:l*o<a*i?l/i:a/o}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this,n=t.axis,i=t.chart,o=t.options,{grid:r,position:s}=o,a=r.offset,l=t.isHorizontal(),c=t.ticks.length+(a?1:0),u=Ri(r),h=[],d=r.setContext(t.getContext()),p=d.drawBorder?d.borderWidth:0,f=p/2,g=function(e){return qe(i,e,p)};let m,y,v,b,x,w,_,S,C,k,A,M;if("top"===s)m=g(t.bottom),w=t.bottom-u,S=m-f,k=g(e.top)+f,M=e.bottom;else if("bottom"===s)m=g(t.top),k=e.top,M=g(e.bottom)-f,w=m+f,S=t.top+u;else if("left"===s)m=g(t.right),x=t.right-u,_=m-f,C=g(e.left)+f,A=e.right;else if("right"===s)m=g(t.left),C=e.left,A=g(e.right)-f,x=m+f,_=t.left+u;else if("x"===n){if("center"===s)m=g((e.top+e.bottom)/2+.5);else if(U(s)){const e=Object.keys(s)[0],n=s[e];m=g(t.chart.scales[e].getPixelForValue(n))}k=e.top,M=e.bottom,w=m+f,S=w+u}else if("y"===n){if("center"===s)m=g((e.left+e.right)/2);else if(U(s)){const e=Object.keys(s)[0],n=s[e];m=g(t.chart.scales[e].getPixelForValue(n))}x=m-f,_=x-u,C=e.left,A=e.right}const T=Y(o.ticks.maxTicksLimit,c),E=Math.max(1,Math.ceil(c/T));for(y=0;y<c;y+=E){const e=r.setContext(t.getContext(y)),n=e.lineWidth,o=e.color,s=r.borderDash||[],c=e.borderDashOffset,u=e.tickWidth,d=e.tickColor,p=e.tickBorderDash||[],f=e.tickBorderDashOffset;v=Li(t,y,a),void 0!==v&&(b=qe(i,v,n),l?x=_=C=A=b:w=S=k=M=b,h.push({tx1:x,ty1:w,tx2:_,ty2:S,x1:C,y1:k,x2:A,y2:M,width:n,color:o,borderDash:s,borderDashOffset:c,tickWidth:u,tickColor:d,tickBorderDash:p,tickBorderDashOffset:f}))}return t._ticksLength=c,t._borderValue=m,h}_computeLabelItems(e){const t=this,n=t.axis,i=t.options,{position:o,ticks:r}=i,s=t.isHorizontal(),a=t.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=r,d=Ri(i.grid),p=d+u,f=h?-u:p,g=-Ie(t.labelRotation),m=[];let y,v,b,x,w,_,S,C,k,A,M,T,E="middle";if("top"===o)_=t.bottom-f,S=t._getXAxisLabelAlignment();else if("bottom"===o)_=t.top+f,S=t._getXAxisLabelAlignment();else if("left"===o){const e=t._getYAxisLabelAlignment(d);S=e.textAlign,w=e.x}else if("right"===o){const e=t._getYAxisLabelAlignment(d);S=e.textAlign,w=e.x}else if("x"===n){if("center"===o)_=(e.top+e.bottom)/2+p;else if(U(o)){const e=Object.keys(o)[0],n=o[e];_=t.chart.scales[e].getPixelForValue(n)+p}S=t._getXAxisLabelAlignment()}else if("y"===n){if("center"===o)w=(e.left+e.right)/2-p;else if(U(o)){const e=Object.keys(o)[0],n=o[e];w=t.chart.scales[e].getPixelForValue(n)}S=t._getYAxisLabelAlignment(d).textAlign}"y"===n&&("start"===l?E="top":"end"===l&&(E="bottom"));const $=t._getLabelSizes();for(y=0,v=a.length;y<v;++y){b=a[y],x=b.label;const e=r.setContext(t.getContext(y));C=t.getPixelForTick(y)+r.labelOffset,k=t._resolveTickFontOptions(y),A=k.lineHeight,M=G(x)?x.length:1;const n=M/2,i=e.color,l=e.textStrokeColor,u=e.textStrokeWidth;let d;if(s?(w=C,T="top"===o?"near"===c||0!==g?-M*A+A/2:"center"===c?-$.highest.height/2-n*A+A:-$.highest.height+A/2:"near"===c||0!==g?A/2:"center"===c?$.highest.height/2-n*A:$.highest.height-M*A,h&&(T*=-1)):(_=C,T=(1-M)*A/2),e.showLabelBackdrop){const t=Nt(e.backdropPadding),n=$.heights[y],i=$.widths[y];let o=_+T-t.top,r=w-t.left;switch(E){case"middle":o-=n/2;break;case"bottom":o-=n}switch(S){case"center":r-=i/2;break;case"right":r-=i}d={left:r,top:o,width:i+t.width,height:n+t.height,color:e.backdropColor}}m.push({rotation:g,label:x,font:k,color:i,strokeColor:l,strokeWidth:u,textOffset:T,textAlign:S,textBaseline:E,translation:[w,_],backdrop:d})}return m}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Ie(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align&&(n="right"),n}_getYAxisLabelAlignment(e){const t=this,{position:n,ticks:{crossAlign:i,mirror:o,padding:r}}=t.options,s=e+r,a=t._getLabelSizes().widest.width;let l,c;return"left"===n?o?(l="left",c=t.right+r):(c=t.right-s,"near"===i?l="right":"center"===i?(l="center",c-=a/2):(l="left",c=t.left)):"right"===n?o?(l="right",c=t.left+r):(c=t.left+s,"near"===i?l="left":"center"===i?(l="center",c+=a/2):(l="right",c=t.right)):l="right",{textAlign:l,x:c}}_computeLabelArea(){const e=this;if(e.options.ticks.mirror)return;const t=e.chart,n=e.options.position;return"left"===n||"right"===n?{top:0,left:e.left,bottom:t.height,right:e.right}:"top"===n||"bottom"===n?{top:e.top,left:0,bottom:e.bottom,right:t.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:i,width:o,height:r}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,o,r),e.restore())}getLineWidthForValue(e){const t=this,n=t.options.grid;if(!t._isVisible()||!n.display)return 0;const i=t.ticks.findIndex((t=>t.value===e));if(i>=0){return n.setContext(t.getContext(i)).lineWidth}return 0}drawGrid(e){const t=this,n=t.options.grid,i=t.ctx,o=t._gridLineItems||(t._gridLineItems=t._computeGridLineItems(e));let r,s;const a=(e,t,n)=>{n.width&&n.color&&(i.save(),i.lineWidth=n.width,i.strokeStyle=n.color,i.setLineDash(n.borderDash||[]),i.lineDashOffset=n.borderDashOffset,i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(t.x,t.y),i.stroke(),i.restore())};if(n.display)for(r=0,s=o.length;r<s;++r){const e=o[r];n.drawOnChartArea&&a({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),n.drawTicks&&a({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const e=this,{chart:t,ctx:n,options:{grid:i}}=e,o=i.setContext(e.getContext()),r=i.drawBorder?o.borderWidth:0;if(!r)return;const s=i.setContext(e.getContext(0)).lineWidth,a=e._borderValue;let l,c,u,h;e.isHorizontal()?(l=qe(t,e.left,r)-r/2,c=qe(t,e.right,s)+s/2,u=h=a):(u=qe(t,e.top,r)-r/2,h=qe(t,e.bottom,s)+s/2,l=c=a),n.save(),n.lineWidth=o.borderWidth,n.strokeStyle=o.borderColor,n.beginPath(),n.moveTo(l,u),n.lineTo(c,h),n.stroke(),n.restore()}drawLabels(e){const t=this;if(!t.options.ticks.display)return;const n=t.ctx,i=t._computeLabelArea();i&&Je(n,i);const o=t._labelItems||(t._labelItems=t._computeLabelItems(e));let r,s;for(r=0,s=o.length;r<s;++r){const e=o[r],t=e.font,i=e.label;e.backdrop&&(n.fillStyle=e.backdrop.color,n.fillRect(e.backdrop.left,e.backdrop.top,e.backdrop.width,e.backdrop.height)),tt(n,i,0,e.textOffset,t,e)}i&&Qe(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:i}}=this;if(!n.display)return;const r=Bt(n.font),s=Nt(n.padding),a=n.align;let l=r.lineHeight/2;"bottom"===t||"center"===t||U(t)?(l+=s.bottom,G(n.text)&&(l+=r.lineHeight*(n.text.length-1))):l+=s.top;const{titleX:c,titleY:u,maxWidth:h,rotation:d}=function(e,t,n,i){const{top:r,left:s,bottom:a,right:l,chart:c}=e,{chartArea:u,scales:h}=c;let d,p,f,g=0;const m=a-r,y=l-s;if(e.isHorizontal()){if(p=o(i,s,l),U(n)){const e=Object.keys(n)[0],i=n[e];f=h[e].getPixelForValue(i)+m-t}else f="center"===n?(u.bottom+u.top)/2+m-t:Ei(e,n,t);d=l-s}else{if(U(n)){const e=Object.keys(n)[0],i=n[e];p=h[e].getPixelForValue(i)-y+t}else p="center"===n?(u.left+u.right)/2-y+t:Ei(e,n,t);f=o(i,a,r),g="left"===n?-Se:Se}return{titleX:p,titleY:f,maxWidth:d,rotation:g}}(this,l,t,a);tt(e,n.text,0,0,r,{color:n.color,maxWidth:h,rotation:d,textAlign:Ii(a,t,i),textBaseline:"middle",translation:[c,u]})}draw(e){const t=this;t._isVisible()&&(t.drawBackground(),t.drawGrid(e),t.drawBorder(),t.drawTitle(),t.drawLabels(e))}_layers(){const e=this,t=e.options,n=t.ticks&&t.ticks.z||0,i=Y(t.grid&&t.grid.z,-1);return e._isVisible()&&e.draw===Oi.prototype.draw?[{z:i,draw(t){e.drawBackground(),e.drawGrid(t),e.drawTitle()}},{z:i+1,draw(){e.drawBorder()}},{z:n,draw(t){e.drawLabels(t)}}]:[{z:n,draw(t){e.draw(t)}}]}getMatchingVisibleMetas(e){const t=this,n=t.chart.getSortedVisibleDatasetMetas(),i=t.axis+"AxisID",o=[];let r,s;for(r=0,s=n.length;r<s;++r){const s=n[r];s[i]!==t.id||e&&s.type!==e||o.push(s)}return o}_resolveTickFontOptions(e){return Bt(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this,t=e._resolveTickFontOptions(0).lineHeight;return(e.isHorizontal()?e.width:e.height)/t}}class Di{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=this,n=Object.getPrototypeOf(e);let i;(function(e){return"id"in e&&"defaults"in e})(n)&&(i=t.register(n));const o=t.items,r=e.id,s=t.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in o||(o[r]=e,function(e,t,n){const i=oe(Object.create(null),[n?ye.get(n):{},ye.get(t),e.defaults]);ye.set(t,i),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((n=>{const i=n.split("."),o=i.pop(),r=[e].concat(i).join("."),s=t[n].split("."),a=s.pop(),l=s.join(".");ye.route(r,o,l,a)}))}(t,e.defaultRoutes);e.descriptors&&ye.describe(t,e.descriptors)}(e,s,i),t.override&&ye.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in ye[i]&&(delete ye[i][n],this.override&&delete pe[n])}}var Fi=new class{constructor(){this.controllers=new Di(Si,"datasets",!0),this.elements=new Di(Ci,"elements"),this.plugins=new Di(Object,"plugins"),this.scales=new Di(Oi,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){const i=this;[...t].forEach((t=>{const o=n||i._getRegistryForType(t);n||o.isForType(t)||o===i.plugins&&t.id?i._exec(e,o,t):Z(t,(t=>{const o=n||i._getRegistryForType(t);i._exec(e,o,t)}))}))}_exec(e,t,n){const i=ce(e);Q(n["before"+i],[],n),t[e](n),Q(n["after"+i],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const i=t.get(e);if(void 0===i)throw new Error('"'+e+'" is not a registered '+n+".");return i}};class Ni{constructor(){this._init=[]}notify(e,t,n,i){const o=this;"beforeInit"===t&&(o._init=o._createDescriptors(e,!0),o._notify(o._init,e,"install"));const r=i?o._descriptors(e).filter(i):o._descriptors(e),s=o._notify(r,e,t,n);return"destroy"===t&&(o._notify(r,e,"stop"),o._notify(o._init,e,"uninstall")),s}_notify(e,t,n,i){i=i||{};for(const o of e){const e=o.plugin;if(!1===Q(e[n],[t,i,o.options],e)&&i.cancelable)return!1}return!0}invalidate(){V(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,i=Y(n.options&&n.options.plugins,{}),o=function(e){const t=[],n=Object.keys(Fi.plugins.items);for(let e=0;e<n.length;e++)t.push(Fi.getPlugin(n[e]));const i=e.plugins||[];for(let e=0;e<i.length;e++){const n=i[e];-1===t.indexOf(n)&&t.push(n)}return t}(n);return!1!==i||t?function(e,t,n,i){const o=[],r=e.getContext();for(let s=0;s<t.length;s++){const a=t[s],l=Bi(n[a.id],i);null!==l&&o.push({plugin:a,options:ji(e.config,a,l,r)})}return o}(e,o,i,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,i=(e,t)=>e.filter((e=>!t.some((t=>e.plugin.id===t.plugin.id))));this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}function Bi(e,t){return t||!1!==e?!0===e?{}:e:null}function ji(e,t,n,i){const o=e.pluginScopeKeys(t),r=e.getOptionScopes(n,o);return e.createResolver(r,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Hi(e,t){const n=ye.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function Wi(e,t){return"x"===e||"y"===e?e:t.axis||("top"===(n=t.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||e.charAt(0).toLowerCase();var n}function zi(e){const t=e.options||(e.options={});t.plugins=Y(t.plugins,{}),t.scales=function(e,t){const n=pe[e.type]||{scales:{}},i=t.scales||{},o=Hi(e.type,t),r=Object.create(null),s=Object.create(null);return Object.keys(i).forEach((e=>{const t=i[e],a=Wi(e,t),l=function(e,t){return e===t?"_index_":"_value_"}(a,o),c=n.scales||{};r[a]=r[a]||e,s[e]=re(Object.create(null),[{axis:a},t,c[a],c[l]])})),e.data.datasets.forEach((n=>{const o=n.type||e.type,a=n.indexAxis||Hi(o,t),l=(pe[o]||{}).scales||{};Object.keys(l).forEach((e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,a),o=n[t+"AxisID"]||r[t]||t;s[o]=s[o]||Object.create(null),re(s[o],[{axis:t},i[o],l[e]])}))})),Object.keys(s).forEach((e=>{const t=s[e];re(t,[ye.scales[t.type],ye.scale])})),s}(e,t)}function Vi(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Gi=new Map,Ui=new Set;function qi(e,t){let n=Gi.get(e);return n||(n=t(),Gi.set(e,n),Ui.add(n)),n}const Ki=(e,t,n)=>{const i=le(t,n);void 0!==i&&e.add(i)};class Yi{constructor(e){this._config=function(e){return(e=e||{}).data=Vi(e.data),zi(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Vi(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),zi(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return qi(e,(()=>[[`datasets.${e}`,""]]))}datasetAnimationScopeKeys(e,t){return qi(`${e}.transition.${t}`,(()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]]))}datasetElementScopeKeys(e,t){return qi(`${e}-${t}`,(()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]]))}pluginScopeKeys(e){const t=e.id;return qi(`${this.type}-plugin-${t}`,(()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]]))}_cachedScopes(e,t){const n=this._scopeCache;let i=n.get(e);return i&&!t||(i=new Map,n.set(e,i)),i}getOptionScopes(e,t,n){const{options:i,type:o}=this,r=this._cachedScopes(e,n),s=r.get(t);if(s)return s;const a=new Set;t.forEach((t=>{e&&(a.add(e),t.forEach((t=>Ki(a,e,t)))),t.forEach((e=>Ki(a,i,e))),t.forEach((e=>Ki(a,pe[o]||{},e))),t.forEach((e=>Ki(a,ye,e))),t.forEach((e=>Ki(a,fe,e)))}));const l=Array.from(a);return 0===l.length&&l.push(Object.create(null)),Ui.has(t)&&r.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,pe[t]||{},ye.datasets[t]||{},{type:t},ye,fe]}resolveNamedOptions(e,t,n,i=[""]){const o={$shared:!0},{resolver:r,subPrefixes:s}=Xi(this._resolverCache,e,i);let a=r;if(function(e,t){const{isScriptable:n,isIndexable:i}=on(e);for(const o of t)if(n(o)&&he(e[o])||i(o)&&G(e[o]))return!0;return!1}(r,t)){o.$shared=!1;a=nn(r,n=he(n)?n():n,this.createResolver(e,n,s))}for(const e of t)o[e]=a[e];return o}createResolver(e,t,n=[""],i){const{resolver:o}=Xi(this._resolverCache,e,n);return U(t)?nn(o,t,void 0,i):o}}function Xi(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const o=n.join();let r=i.get(o);if(!r){r={resolver:tn(t,n),subPrefixes:n.filter((e=>!e.toLowerCase().includes("hover")))},i.set(o,r)}return r}const Ji=["top","bottom","left","right","chartArea"];function Qi(e,t){return"top"===e||"bottom"===e||-1===Ji.indexOf(e)&&"x"===t}function Zi(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function eo(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Q(n&&n.onComplete,[e],t)}function to(e){const t=e.chart,n=t.options.animation;Q(n&&n.onProgress,[e],t)}function no(e){return dt()&&"string"==typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const io={},oo=e=>{const t=no(e);return Object.values(io).filter((e=>e.canvas===t)).pop()};class ro{constructor(e,t){const i=this,o=this.config=new Yi(t),r=no(e),a=oo(r);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas can be reused.");const l=o.createResolver(o.chartOptionScopes(),i.getContext());this.platform=new(o.platform||ri(r));const c=i.platform.acquireContext(r,l.aspectRatio),u=c&&c.canvas,h=u&&u.height,d=u&&u.width;this.id=z(),this.ctx=c,this.canvas=u,this.width=d,this.height=h,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this.scale=void 0,this._plugins=new Ni,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=n((()=>this.update("resize")),l.resizeDelay||0),io[i.id]=i,c&&u?(s.listen(i,"complete",eo),s.listen(i,"progress",to),i._initialize(),i.attached&&i.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:i,_aspectRatio:o}=this;return V(e)?t&&o?o:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}_initialize(){const e=this;return e.notifyPlugins("beforeInit"),e.options.responsive?e.resize():_t(e,e.options.devicePixelRatio),e.bindEvents(),e.notifyPlugins("afterInit"),e}clear(){return Ke(this.canvas,this.ctx),this}stop(){return s.stop(this),this}resize(e,t){s.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this,i=n.options,o=n.canvas,r=i.maintainAspectRatio&&n.aspectRatio,s=n.platform.getMaximumSize(o,e,t,r),a=i.devicePixelRatio||n.platform.getDevicePixelRatio();n.width=s.width,n.height=s.height,n._aspectRatio=n.aspectRatio,_t(n,a,!0)&&(n.notifyPlugins("resize",{size:s}),Q(i.onResize,[n,s],n),n.attached&&n._doResize()&&n.render())}ensureScalesHaveIDs(){Z(this.options.scales||{},((e,t)=>{e.id=t}))}buildOrUpdateScales(){const e=this,t=e.options,n=t.scales,i=e.scales,o=Object.keys(i).reduce(((e,t)=>(e[t]=!1,e)),{});let r=[];n&&(r=r.concat(Object.keys(n).map((e=>{const t=n[e],i=Wi(e,t),o="r"===i,r="x"===i;return{options:t,dposition:o?"chartArea":r?"bottom":"left",dtype:o?"radialLinear":r?"category":"linear"}})))),Z(r,(n=>{const r=n.options,s=r.id,a=Wi(s,r),l=Y(r.type,n.dtype);void 0!==r.position&&Qi(r.position,a)===Qi(n.dposition)||(r.position=n.dposition),o[s]=!0;let c=null;if(s in i&&i[s].type===l)c=i[s];else{c=new(Fi.getScale(l))({id:s,type:l,ctx:e.ctx,chart:e}),i[c.id]=c}c.init(r,t)})),Z(o,((e,t)=>{e||delete i[t]})),Z(i,(t=>{en.configure(e,t,t.options),en.addBox(e,t)}))}_updateMetasets(){const e=this,t=e._metasets,n=e.data.datasets.length,i=t.length;if(t.sort(((e,t)=>e.index-t.index)),i>n){for(let t=n;t<i;++t)e._destroyDatasetMeta(t);t.splice(n,i-n)}e._sortedMetasets=t.slice(0).sort(Zi("order","index"))}_removeUnreferencedMetasets(){const e=this,{_metasets:t,data:{datasets:n}}=e;t.length>n.length&&delete e._stacks,t.forEach(((t,i)=>{0===n.filter((e=>e===t._dataset)).length&&e._destroyDatasetMeta(i)}))}buildOrUpdateControllers(){const e=this,t=[],n=e.data.datasets;let i,o;for(e._removeUnreferencedMetasets(),i=0,o=n.length;i<o;i++){const o=n[i];let r=e.getDatasetMeta(i);const s=o.type||e.config.type;if(r.type&&r.type!==s&&(e._destroyDatasetMeta(i),r=e.getDatasetMeta(i)),r.type=s,r.indexAxis=o.indexAxis||Hi(s,e.options),r.order=o.order||0,r.index=i,r.label=""+o.label,r.visible=e.isDatasetVisible(i),r.controller)r.controller.updateIndex(i),r.controller.linkScales();else{const n=Fi.getController(s),{datasetElementType:o,dataElementType:a}=ye.datasets[s];Object.assign(n.prototype,{dataElementType:Fi.getElement(a),datasetElementType:o&&Fi.getElement(o)}),r.controller=new n(e,i),t.push(r.controller)}}return e._updateMetasets(),t}_resetElements(){const e=this;Z(e.data.datasets,((t,n)=>{e.getDatasetMeta(n).controller.reset()}),e)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this,n=t.config;n.update(),t._options=n.createResolver(n.chartOptionScopes(),t.getContext()),Z(t.scales,(e=>{en.removeBox(t,e)}));const i=t._animationsDisabled=!t.options.animation;t.ensureScalesHaveIDs(),t.buildOrUpdateScales();const o=new Set(Object.keys(t._listeners)),r=new Set(t.options.events);if(de(o,r)&&!!this._responsiveListeners===t.options.responsive||(t.unbindEvents(),t.bindEvents()),t._plugins.invalidate(),!1===t.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const s=t.buildOrUpdateControllers();t.notifyPlugins("beforeElementsUpdate");let a=0;for(let e=0,n=t.data.datasets.length;e<n;e++){const{controller:n}=t.getDatasetMeta(e),o=!i&&-1===s.indexOf(n);n.buildOrUpdateElements(o),a=Math.max(+n.getMaxOverflow(),a)}t._minPadding=a,t._updateLayout(a),i||Z(s,(e=>{e.reset()})),t._updateDatasets(e),t.notifyPlugins("afterUpdate",{mode:e}),t._layers.sort(Zi("z","_idx")),t._lastEvent&&t._eventHandler(t._lastEvent,!0),t.render()}_updateLayout(e){const t=this;if(!1===t.notifyPlugins("beforeLayout",{cancelable:!0}))return;en.update(t,t.width,t.height,e);const n=t.chartArea,i=n.width<=0||n.height<=0;t._layers=[],Z(t.boxes,(e=>{i&&"chartArea"===e.position||(e.configure&&e.configure(),t._layers.push(...e._layers()))}),t),t._layers.forEach(((e,t)=>{e._idx=t})),t.notifyPlugins("afterLayout")}_updateDatasets(e){const t=this,n="function"==typeof e;if(!1!==t.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let i=0,o=t.data.datasets.length;i<o;++i)t._updateDataset(i,n?e({datasetIndex:i}):e);t.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this,i=n.getDatasetMeta(e),o={meta:i,index:e,mode:t,cancelable:!0};!1!==n.notifyPlugins("beforeDatasetUpdate",o)&&(i.controller._update(t),o.cancelable=!1,n.notifyPlugins("afterDatasetUpdate",o))}render(){const e=this;!1!==e.notifyPlugins("beforeRender",{cancelable:!0})&&(s.has(e)?e.attached&&!s.running(e)&&s.start(e):(e.draw(),eo({chart:e})))}draw(){const e=this;let t;if(e._resizeBeforeDraw){const{width:t,height:n}=e._resizeBeforeDraw;e._resize(t,n),e._resizeBeforeDraw=null}if(e.clear(),e.width<=0||e.height<=0)return;if(!1===e.notifyPlugins("beforeDraw",{cancelable:!0}))return;const n=e._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(e.chartArea);for(e._drawDatasets();t<n.length;++t)n[t].draw(e.chartArea);e.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let i,o;for(i=0,o=t.length;i<o;++i){const o=t[i];e&&!o.visible||n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){const e=this;if(!1===e.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=e.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)e._drawDataset(t[n]);e.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this,n=t.ctx,i=e._clip,o=!i.disabled,r=t.chartArea,s={meta:e,index:e.index,cancelable:!0};!1!==t.notifyPlugins("beforeDatasetDraw",s)&&(o&&Je(n,{left:!1===i.left?0:r.left-i.left,right:!1===i.right?t.width:r.right+i.right,top:!1===i.top?0:r.top-i.top,bottom:!1===i.bottom?t.height:r.bottom+i.bottom}),e.controller.draw(),o&&Qe(n),s.cancelable=!1,t.notifyPlugins("afterDatasetDraw",s))}getElementsAtEventForMode(e,t,n,i){const o=Lt.modes[t];return"function"==typeof o?o(this,e,n,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let i=n.filter((e=>e&&e._dataset===t)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context={chart:this,type:"chart"})}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"==typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const i=this,o=n?"show":"hide",r=i.getDatasetMeta(e),s=r.controller._resolveAnimations(void 0,o);ue(t)?(r.data[t].hidden=!n,i.update()):(i.setDatasetVisibility(e,n),s.update(r,{visible:n}),i.update((t=>t.datasetIndex===e?o:void 0)))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this,n=t._metasets&&t._metasets[e];n&&n.controller&&(n.controller._destroy(),delete t._metasets[e])}destroy(){const e=this,{canvas:t,ctx:n}=e;let i,o;for(e.stop(),s.remove(e),i=0,o=e.data.datasets.length;i<o;++i)e._destroyDatasetMeta(i);e.config.clearCache(),t&&(e.unbindEvents(),Ke(t,n),e.platform.releaseContext(n),e.canvas=null,e.ctx=null),e.notifyPlugins("destroy"),delete io[e.id]}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this,t=e._listeners,n=e.platform,i=function(t,n,i){t.offsetX=n,t.offsetY=i,e._eventHandler(t)};Z(e.options.events,(o=>((i,o)=>{n.addEventListener(e,i,o),t[i]=o})(o,i)))}bindResponsiveEvents(){const e=this;e._responsiveListeners||(e._responsiveListeners={});const t=e._responsiveListeners,n=e.platform,i=(i,o)=>{n.addEventListener(e,i,o),t[i]=o},o=(i,o)=>{t[i]&&(n.removeEventListener(e,i,o),delete t[i])},r=(t,n)=>{e.canvas&&e.resize(t,n)};let s;const a=()=>{o("attach",a),e.attached=!0,e.resize(),i("resize",r),i("detach",s)};s=()=>{e.attached=!1,o("resize",r),i("attach",a)},n.isAttached(e.canvas)?a():s()}unbindEvents(){const e=this;Z(e._listeners,((t,n)=>{e.platform.removeEventListener(e,n,t)})),e._listeners={},Z(e._responsiveListeners,((t,n)=>{e.platform.removeEventListener(e,n,t)})),e._responsiveListeners=void 0}updateHoverStyle(e,t,n){const i=n?"set":"remove";let o,r,s,a;for("dataset"===t&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+i+"DatasetHoverStyle"]()),s=0,a=e.length;s<a;++s){r=e[s];const t=r&&this.getDatasetMeta(r.datasetIndex).controller;t&&t[i+"HoverStyle"](r.element,r.datasetIndex,r.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this,n=t._active||[],i=e.map((({datasetIndex:e,index:n})=>{const i=t.getDatasetMeta(e);if(!i)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:i.data[n],index:n}}));!ee(i,n)&&(t._active=i,t._updateHoverStyles(i,n))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}_updateHoverStyles(e,t,n){const i=this,o=i.options.hover,r=(e,t)=>e.filter((e=>!t.some((t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)))),s=r(t,e),a=n?e:r(e,t);s.length&&i.updateHoverStyle(s,o.mode,!1),a.length&&o.mode&&i.updateHoverStyle(a,o.mode,!0)}_eventHandler(e,t){const n=this,i={event:e,replay:t,cancelable:!0},o=t=>(t.options.events||this.options.events).includes(e.type);if(!1===n.notifyPlugins("beforeEvent",i,o))return;const r=n._handleEvent(e,t);return i.cancelable=!1,n.notifyPlugins("afterEvent",i,o),(r||i.changed)&&n.render(),n}_handleEvent(e,t){const n=this,{_active:i=[],options:o}=n,r=o.hover,s=t;let a=[],l=!1,c=null;return"mouseout"!==e.type&&(a=n.getElementsAtEventForMode(e,r.mode,r,s),c="click"===e.type?n._lastEvent:e),n._lastEvent=null,Xe(e,n.chartArea,n._minPadding)&&(Q(o.onHover,[e,a,n],n),"mouseup"!==e.type&&"click"!==e.type&&"contextmenu"!==e.type||Q(o.onClick,[e,a,n],n)),l=!ee(a,i),(l||t)&&(n._active=a,n._updateHoverStyles(a,i,t)),n._lastEvent=c,l}}const so=()=>Z(ro.instances,(e=>e._plugins.invalidate())),ao=!0;function lo(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}Object.defineProperties(ro,{defaults:{enumerable:ao,value:ye},instances:{enumerable:ao,value:io},overrides:{enumerable:ao,value:pe},registry:{enumerable:ao,value:Fi},version:{enumerable:ao,value:"3.5.0"},getChart:{enumerable:ao,value:oo},register:{enumerable:ao,value:(...e)=>{Fi.add(...e),so()}},unregister:{enumerable:ao,value:(...e)=>{Fi.remove(...e),so()}}});class co{constructor(e){this.options=e||{}}formats(){return lo()}parse(e,t){return lo()}format(e,t){return lo()}add(e,t,n){return lo()}diff(e,t,n){return lo()}startOf(e,t,n){return lo()}endOf(e,t){return lo()}}co.override=function(e){Object.assign(co.prototype,e)};var uo={_date:co};function ho(e){const t=function(e){if(!e._cache.$bar){const t=e.getMatchingVisibleMetas("bar");let n=[];for(let i=0,o=t.length;i<o;i++)n=n.concat(t[i].controller.getAllParsedValues(e));e._cache.$bar=ht(n.sort(((e,t)=>e-t)))}return e._cache.$bar}(e);let n,i,o,r,s=e._length;const a=()=>{32767!==o&&-32768!==o&&(ue(r)&&(s=Math.min(s,Math.abs(o-r)||s)),r=o)};for(n=0,i=t.length;n<i;++n)o=e.getPixelForValue(t[n]),a();for(r=void 0,n=0,i=e.ticks.length;n<i;++n)o=e.getPixelForTick(n),a();return s}function po(e,t,n,i){return G(e)?function(e,t,n,i){const o=n.parse(e[0],i),r=n.parse(e[1],i),s=Math.min(o,r),a=Math.max(o,r);let l=s,c=a;Math.abs(s)>Math.abs(a)&&(l=a,c=s),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:o,end:r,min:s,max:a}}(e,t,n,i):t[n.axis]=n.parse(e,i),t}function fo(e,t,n,i){const o=e.iScale,r=e.vScale,s=o.getLabels(),a=o===r,l=[];let c,u,h,d;for(c=n,u=n+i;c<u;++c)d=t[c],h={},h[o.axis]=a||o.parse(s[c],c),l.push(po(d,h,r,c));return l}function go(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function mo(e,t,n,i){let o=t.borderSkipped;const r={};if(!o)return void(e.borderSkipped=r);const{start:s,end:a,reverse:l,top:c,bottom:u}=function(e){let t,n,i,o,r;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(o="end",r="start"):(o="start",r="end"),{start:n,end:i,reverse:t,top:o,bottom:r}}(e);"middle"===o&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?o=c:(n._bottom||0)===i?o=u:(r[yo(u,s,a,l)]=!0,o=c)),r[yo(o,s,a,l)]=!0,e.borderSkipped=r}function yo(e,t,n,i){var o,r,s;return i?(s=n,e=vo(e=(o=e)===(r=t)?s:o===s?r:o,n,t)):e=vo(e,t,n),e}function vo(e,t,n){return"start"===e?t:"end"===e?n:e}class bo extends Si{parsePrimitiveData(e,t,n,i){return fo(e,t,n,i)}parseArrayData(e,t,n,i){return fo(e,t,n,i)}parseObjectData(e,t,n,i){const{iScale:o,vScale:r}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l="x"===o.axis?s:a,c="x"===r.axis?s:a,u=[];let h,d,p,f;for(h=n,d=n+i;h<d;++h)f=t[h],p={},p[o.axis]=o.parse(le(f,l),h),u.push(po(le(f,c),p,r,h));return u}updateRangeFromParsed(e,t,n,i){super.updateRangeFromParsed(e,t,n,i);const o=n._custom;o&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:i}=t,o=this.getParsed(e),r=o._custom,s=go(r)?"["+r.start+", "+r.end+"]":""+i.getLabelForValue(o[i.axis]);return{label:""+n.getLabelForValue(o[n.axis]),value:s}}initialize(){const e=this;e.enableOptionSharing=!0,super.initialize();e._cachedMeta.stack=e.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,i){const o=this,r="reset"===i,{index:s,_cachedMeta:{vScale:a}}=o,l=a.getBasePixel(),c=a.isHorizontal(),u=o._getRuler(),h=o.resolveDataElementOptions(t,i),d=o.getSharedOptions(h),p=o.includeOptions(i,d);o.updateSharedOptions(d,i,h);for(let h=t;h<t+n;h++){const t=o.getParsed(h),n=r||V(t[a.axis])?{base:l,head:l}:o._calculateBarValuePixels(h),f=o._calculateBarIndexPixels(h,u),g=(t._stacks||{})[a.axis],m={horizontal:c,base:n.base,enableBorderRadius:!g||go(t._custom)||s===g._top||s===g._bottom,x:c?n.head:f.center,y:c?f.center:n.head,height:c?f.size:Math.abs(n.size),width:c?Math.abs(n.size):f.size};p&&(m.options=d||o.resolveDataElementOptions(h,e[h].active?"active":i)),mo(m,m.options||e[h].options,g,s),o.updateElement(e[h],h,m,i)}}_getStacks(e,t){const n=this._cachedMeta.iScale,i=n.getMatchingVisibleMetas(this._type),o=n.options.stacked,r=i.length,s=[];let a,l;for(a=0;a<r;++a)if(l=i[a],l.controller.options.grouped){if(void 0!==t){const e=l.controller.getParsed(t)[l.controller._cachedMeta.vScale.axis];if(V(e)||isNaN(e))continue}if((!1===o||-1===s.indexOf(l.stack)||void 0===o&&void 0===l.stack)&&s.push(l.stack),l.index===e)break}return s.length||s.push(void 0),s}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,n){const i=this._getStacks(e,n),o=void 0!==t?i.indexOf(t):-1;return-1===o?i.length-1:o}_getRuler(){const e=this,t=e.options,n=e._cachedMeta,i=n.iScale,o=[];let r,s;for(r=0,s=n.data.length;r<s;++r)o.push(i.getPixelForValue(e.getParsed(r)[i.axis],r));const a=t.barThickness;return{min:a||ho(i),pixels:o,start:i._startPixel,end:i._endPixel,stackCount:e._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(e){const t=this,{_cachedMeta:{vScale:n,_stacked:i},options:{base:o,minBarLength:r}}=t,s=o||0,a=t.getParsed(e),l=a._custom,c=go(l);let u,h,d=a[n.axis],p=0,f=i?t.applyStack(n,a,i):d;f!==d&&(p=f-d,f=d),c&&(d=l.barStart,f=l.barEnd-l.barStart,0!==d&&Me(d)!==Me(l.barEnd)&&(p=0),p+=d);const g=V(o)||c?p:o;let m=n.getPixelForValue(g);if(u=t.chart.getDataVisibility(e)?n.getPixelForValue(p+f):m,h=u-m,Math.abs(h)<r&&(h=function(e,t,n){return 0!==e?Me(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(h,n,s)*r,d===s&&(m-=h/2),u=m+h),m===n.getPixelForValue(s)){const e=Me(h)*n.getLineWidthForValue(s)/2;m+=e,h-=e}return{size:h,base:m,head:u,center:u+h/2}}_calculateBarIndexPixels(e,t){const n=this,i=t.scale,o=n.options,r=o.skipNull,s=Y(o.maxBarThickness,1/0);let a,l;if(t.grouped){const i=r?n._getStackCount(e):t.stackCount,c="flex"===o.barThickness?function(e,t,n,i){const o=t.pixels,r=o[e];let s=e>0?o[e-1]:null,a=e<o.length-1?o[e+1]:null;const l=n.categoryPercentage;null===s&&(s=r-(null===a?t.end-t.start:a-r)),null===a&&(a=r+r-s);const c=r-(r-Math.min(s,a))/2*l;return{chunk:Math.abs(a-s)/2*l/i,ratio:n.barPercentage,start:c}}(e,t,o,i):function(e,t,n,i){const o=n.barThickness;let r,s;return V(o)?(r=t.min*n.categoryPercentage,s=n.barPercentage):(r=o*i,s=1),{chunk:r/i,ratio:s,start:t.pixels[e]-r/2}}(e,t,o,i),u=n._getStackIndex(n.index,n._cachedMeta.stack,r?e:void 0);a=c.start+c.chunk*u+c.chunk/2,l=Math.min(s,c.chunk*c.ratio)}else a=i.getPixelForValue(n.getParsed(e)[i.axis],e),l=Math.min(s,t.min*t.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this,t=e._cachedMeta,n=t.vScale,i=t.data,o=i.length;let r=0;for(;r<o;++r)null!==e.getParsed(r)[n.axis]&&i[r].draw(e._ctx)}}bo.id="bar",bo.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},bo.overrides={interaction:{mode:"index"},scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class xo extends Si{initialize(){this.enableOptionSharing=!0,super.initialize()}parseObjectData(e,t,n,i){const{xScale:o,yScale:r}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l=[];let c,u,h;for(c=n,u=n+i;c<u;++c)h=t[c],l.push({x:o.parse(le(h,s),c),y:r.parse(le(h,a),c),_custom:h&&h.r&&+h.r});return l}getMaxOverflow(){const{data:e,_parsed:t}=this._cachedMeta;let n=0;for(let i=e.length-1;i>=0;--i)n=Math.max(n,e[i].size()/2,t[i]._custom);return n>0&&n}getLabelAndValue(e){const t=this._cachedMeta,{xScale:n,yScale:i}=t,o=this.getParsed(e),r=n.getLabelForValue(o.x),s=i.getLabelForValue(o.y),a=o._custom;return{label:t.label,value:"("+r+", "+s+(a?", "+a:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,n,i){const o=this,r="reset"===i,{iScale:s,vScale:a}=o._cachedMeta,l=o.resolveDataElementOptions(t,i),c=o.getSharedOptions(l),u=o.includeOptions(i,c),h=s.axis,d=a.axis;for(let l=t;l<t+n;l++){const t=e[l],n=!r&&o.getParsed(l),c={},p=c[h]=r?s.getPixelForDecimal(.5):s.getPixelForValue(n[h]),f=c[d]=r?a.getBasePixel():a.getPixelForValue(n[d]);c.skip=isNaN(p)||isNaN(f),u&&(c.options=o.resolveDataElementOptions(l,t.active?"active":i),r&&(c.options.radius=0)),o.updateElement(t,l,c,i)}o.updateSharedOptions(c,i,l)}resolveDataElementOptions(e,t){const n=this.getParsed(e);let i=super.resolveDataElementOptions(e,t);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const o=i.radius;return"active"!==t&&(i.radius=0),i.radius+=Y(n&&n._custom,o),i}}xo.id="bubble",xo.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},xo.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title:()=>""}}}};class wo extends Si{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,i=this._cachedMeta;let o,r;for(o=e,r=e+t;o<r;++o)i._parsed[o]=+n[o]}_getRotation(){return Ie(this.options.rotation-90)}_getCircumference(){return Ie(this.options.circumference)}_getRotationExtents(){let e=be,t=-be;const n=this;for(let i=0;i<n.chart.data.datasets.length;++i)if(n.chart.isDatasetVisible(i)){const o=n.chart.getDatasetMeta(i).controller,r=o._getRotation(),s=o._getCircumference();e=Math.min(e,r),t=Math.max(t,r+s)}return{rotation:e,circumference:t-e}}update(e){const t=this,n=t.chart,{chartArea:i}=n,o=t._cachedMeta,r=o.data,s=t.getMaxBorderWidth()+t.getMaxOffset(r)+t.options.spacing,a=Math.max((Math.min(i.width,i.height)-s)/2,0),l=Math.min(X(t.options.cutout,a),1),c=t._getRingWeight(t.index),{circumference:u,rotation:h}=t._getRotationExtents(),{ratioX:d,ratioY:p,offsetX:f,offsetY:g}=function(e,t,n){let i=1,o=1,r=0,s=0;if(t<be){const a=e,l=a+t,c=Math.cos(a),u=Math.sin(a),h=Math.cos(l),d=Math.sin(l),p=(e,t,i)=>He(e,a,l,!0)?1:Math.max(t,t*n,i,i*n),f=(e,t,i)=>He(e,a,l,!0)?-1:Math.min(t,t*n,i,i*n),g=p(0,c,h),m=p(Se,u,d),y=f(ve,c,h),v=f(ve+Se,u,d);i=(g-y)/2,o=(m-v)/2,r=-(g+y)/2,s=-(m+v)/2}return{ratioX:i,ratioY:o,offsetX:r,offsetY:s}}(h,u,l),m=(i.width-s)/d,y=(i.height-s)/p,v=Math.max(Math.min(m,y)/2,0),b=J(t.options.radius,v),x=(b-Math.max(b*l,0))/t._getVisibleDatasetWeightTotal();t.offsetX=f*b,t.offsetY=g*b,o.total=t.calculateTotal(),t.outerRadius=b-x*t._getRingWeightOffset(t.index),t.innerRadius=Math.max(t.outerRadius-x*c,0),t.updateElements(r,0,r.length,e)}_circumference(e,t){const n=this,i=n.options,o=n._cachedMeta,r=n._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||null===o._parsed[e]||o.data[e].hidden?0:n.calculateCircumference(o._parsed[e]*r/be)}updateElements(e,t,n,i){const o=this,r="reset"===i,s=o.chart,a=s.chartArea,l=s.options.animation,c=(a.left+a.right)/2,u=(a.top+a.bottom)/2,h=r&&l.animateScale,d=h?0:o.innerRadius,p=h?0:o.outerRadius,f=o.resolveDataElementOptions(t,i),g=o.getSharedOptions(f),m=o.includeOptions(i,g);let y,v=o._getRotation();for(y=0;y<t;++y)v+=o._circumference(y,r);for(y=t;y<t+n;++y){const t=o._circumference(y,r),n=e[y],s={x:c+o.offsetX,y:u+o.offsetY,startAngle:v,endAngle:v+t,circumference:t,outerRadius:p,innerRadius:d};m&&(s.options=g||o.resolveDataElementOptions(y,n.active?"active":i)),v+=t,o.updateElement(n,y,s,i)}o.updateSharedOptions(g,i,f)}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,i=0;for(n=0;n<t.length;n++){const o=e._parsed[n];null===o||isNaN(o)||!this.chart.getDataVisibility(n)||t[n].hidden||(i+=Math.abs(o))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?be*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],o=$n(t._parsed[e],n.options.locale);return{label:i[e]||"",value:o}}getMaxBorderWidth(e){const t=this;let n=0;const i=t.chart;let o,r,s,a,l;if(!e)for(o=0,r=i.data.datasets.length;o<r;++o)if(i.isDatasetVisible(o)){s=i.getDatasetMeta(o),e=s.data,a=s.controller,a!==t&&a.configure();break}if(!e)return 0;for(o=0,r=e.length;o<r;++o)l=a.resolveDataElementOptions(o),"inner"!==l.borderAlign&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let t=0;for(let n=0,i=e.length;n<i;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(Y(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}wo.id="doughnut",wo.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},wo.descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e},wo.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map(((t,i)=>{const o=e.getDatasetMeta(0).controller.getStyle(i);return{text:t,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,lineWidth:o.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(i),index:i}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label(e){let t=e.label;const n=": "+e.formattedValue;return G(t)?(t=t.slice(),t[0]+=n):t+=n,t}}}}};class _o extends Si{initialize(){this.enableOptionSharing=!0,super.initialize()}update(e){const t=this,n=t._cachedMeta,{dataset:i,data:o=[],_dataset:r}=n,s=t.chart._animationsDisabled;let{start:a,count:l}=function(e,t,n){const i=t.length;let o=0,r=i;if(e._sorted){const{iScale:s,_parsed:a}=e,l=s.axis,{min:c,max:u,minDefined:h,maxDefined:d}=s.getUserBounds();h&&(o=We(Math.min(rt(a,s.axis,c).lo,n?i:rt(t,l,s.getPixelForValue(c)).lo),0,i-1)),r=d?We(Math.max(rt(a,s.axis,u).hi+1,n?0:rt(t,l,s.getPixelForValue(u)).hi+1),o,i)-o:i-o}return{start:o,count:r}}(n,o,s);t._drawStart=a,t._drawCount=l,function(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,o={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=o,!0;const r=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,o),r}(n)&&(a=0,l=o.length),i._datasetIndex=t.index,i._decimated=!!r._decimated,i.points=o;const c=t.resolveDatasetElementOptions(e);t.options.showLine||(c.borderWidth=0),c.segment=t.options.segment,t.updateElement(i,void 0,{animated:!s,options:c},e),t.updateElements(o,a,l,e)}updateElements(e,t,n,i){const o=this,r="reset"===i,{iScale:s,vScale:a,_stacked:l}=o._cachedMeta,c=o.resolveDataElementOptions(t,i),u=o.getSharedOptions(c),h=o.includeOptions(i,u),d=s.axis,p=a.axis,f=o.options.spanGaps,g=$e(f)?f:Number.POSITIVE_INFINITY,m=o.chart._animationsDisabled||r||"none"===i;let y=t>0&&o.getParsed(t-1);for(let c=t;c<t+n;++c){const t=e[c],n=o.getParsed(c),f=m?t:{},v=V(n[p]),b=f[d]=s.getPixelForValue(n[d],c),x=f[p]=r||v?a.getBasePixel():a.getPixelForValue(l?o.applyStack(a,n,l):n[p],c);f.skip=isNaN(b)||isNaN(x)||v,f.stop=c>0&&n[d]-y[d]>g,f.parsed=n,h&&(f.options=u||o.resolveDataElementOptions(c,t.active?"active":i)),m||o.updateElement(t,c,f,i),y=n}o.updateSharedOptions(u,i,c)}getMaxOverflow(){const e=this,t=e._cachedMeta,n=t.dataset,i=n.options&&n.options.borderWidth||0,o=t.data||[];if(!o.length)return i;const r=o[0].size(e.resolveDataElementOptions(0)),s=o[o.length-1].size(e.resolveDataElementOptions(o.length-1));return Math.max(i,r,s)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}_o.id="line",_o.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},_o.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class So extends Si{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],o=$n(t._parsed[e].r,n.options.locale);return{label:i[e]||"",value:o}}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}_updateRadius(){const e=this,t=e.chart,n=t.chartArea,i=t.options,o=Math.min(n.right-n.left,n.bottom-n.top),r=Math.max(o/2,0),s=(r-Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0))/t.getVisibleDatasetCount();e.outerRadius=r-s*e.index,e.innerRadius=e.outerRadius-s}updateElements(e,t,n,i){const o=this,r="reset"===i,s=o.chart,a=o.getDataset(),l=s.options.animation,c=o._cachedMeta.rScale,u=c.xCenter,h=c.yCenter,d=c.getIndexAngle(0)-.5*ve;let p,f=d;const g=360/o.countVisibleElements();for(p=0;p<t;++p)f+=o._computeAngle(p,i,g);for(p=t;p<t+n;p++){const t=e[p];let n=f,m=f+o._computeAngle(p,i,g),y=s.getDataVisibility(p)?c.getDistanceFromCenterForValue(a.data[p]):0;f=m,r&&(l.animateScale&&(y=0),l.animateRotate&&(n=m=d));const v={x:u,y:h,innerRadius:0,outerRadius:y,startAngle:n,endAngle:m,options:o.resolveDataElementOptions(p,t.active?"active":i)};o.updateElement(t,p,v,i)}}countVisibleElements(){const e=this.getDataset(),t=this._cachedMeta;let n=0;return t.data.forEach(((t,i)=>{!isNaN(e.data[i])&&this.chart.getDataVisibility(i)&&n++})),n}_computeAngle(e,t,n){return this.chart.getDataVisibility(e)?Ie(this.resolveDataElementOptions(e,t).angle||n):0}}So.id="polarArea",So.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},So.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map(((t,i)=>{const o=e.getDatasetMeta(0).controller.getStyle(i);return{text:t,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,lineWidth:o.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(i),index:i}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label:e=>e.chart.data.labels[e.dataIndex]+": "+e.formattedValue}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class Co extends wo{}Co.id="pie",Co.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class ko extends Si{getLabelAndValue(e){const t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}update(e){const t=this,n=t._cachedMeta,i=n.dataset,o=n.data||[],r=n.iScale.getLabels();if(i.points=o,"resize"!==e){const n=t.resolveDatasetElementOptions(e);t.options.showLine||(n.borderWidth=0);const s={_loop:!0,_fullLoop:r.length===o.length,options:n};t.updateElement(i,void 0,s,e)}t.updateElements(o,0,o.length,e)}updateElements(e,t,n,i){const o=this,r=o.getDataset(),s=o._cachedMeta.rScale,a="reset"===i;for(let l=t;l<t+n;l++){const t=e[l],n=o.resolveDataElementOptions(l,t.active?"active":i),c=s.getPointPositionForValue(l,r.data[l]),u=a?s.xCenter:c.x,h=a?s.yCenter:c.y,d={x:u,y:h,angle:c.angle,skip:isNaN(u)||isNaN(h),options:n};o.updateElement(t,l,d,i)}}}ko.id="radar",ko.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},ko.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class Ao extends _o{}Ao.id="scatter",Ao.defaults={showLine:!1,fill:!1},Ao.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title:()=>"",label:e=>"("+e.label+", "+e.formattedValue+")"}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var Mo=Object.freeze({__proto__:null,BarController:bo,BubbleController:xo,DoughnutController:wo,LineController:_o,PolarAreaController:So,PieController:Co,RadarController:ko,ScatterController:Ao});function To(e,t,n){const{startAngle:i,pixelMargin:o,x:r,y:s,outerRadius:a,innerRadius:l}=t;let c=o/a;e.beginPath(),e.arc(r,s,a,i-c,n+c),l>o?(c=o/l,e.arc(r,s,l,n+c,i-c,!0)):e.arc(r,s,o,n+Se,i-Se),e.closePath(),e.clip()}function Eo(e,t,n,i){const o=Ot(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const r=(n-t)/2,s=Math.min(r,i*t/2),a=e=>{const t=(n-Math.min(r,e))*i/2;return We(e,0,Math.min(r,t))};return{outerStart:a(o.outerStart),outerEnd:a(o.outerEnd),innerStart:We(o.innerStart,0,s),innerEnd:We(o.innerEnd,0,s)}}function $o(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function Lo(e,t,n,i,o){const{x:r,y:s,startAngle:a,pixelMargin:l,innerRadius:c}=t,u=Math.max(t.outerRadius+i+n-l,0),h=c>0?c+i+n+l:0;let d=0;const p=o-a;if(i){const e=((c>0?c-i:0)+(u>0?u-i:0))/2;d=(p-(0!==e?p*e/(e+i):p))/2}const f=(p-Math.max(.001,p*u-n/ve)/u)/2,g=a+f+d,m=o-f-d,{outerStart:y,outerEnd:v,innerStart:b,innerEnd:x}=Eo(t,h,u,m-g),w=u-y,_=u-v,S=g+y/w,C=m-v/_,k=h+b,A=h+x,M=g+b/k,T=m-x/A;if(e.beginPath(),e.arc(r,s,u,S,C),v>0){const t=$o(_,C,r,s);e.arc(t.x,t.y,v,C,m+Se)}const E=$o(A,m,r,s);if(e.lineTo(E.x,E.y),x>0){const t=$o(A,T,r,s);e.arc(t.x,t.y,x,m+Se,T+Math.PI)}if(e.arc(r,s,h,m-x/h,g+b/h,!0),b>0){const t=$o(k,M,r,s);e.arc(t.x,t.y,b,M+Math.PI,g-Se)}const $=$o(w,g,r,s);if(e.lineTo($.x,$.y),y>0){const t=$o(w,S,r,s);e.arc(t.x,t.y,y,g-Se,S)}e.closePath()}function Ro(e,t,n,i,o){const{options:r}=t,s="inner"===r.borderAlign;r.borderWidth&&(s?(e.lineWidth=2*r.borderWidth,e.lineJoin="round"):(e.lineWidth=r.borderWidth,e.lineJoin="bevel"),t.fullCircles&&function(e,t,n){const{x:i,y:o,startAngle:r,pixelMargin:s,fullCircles:a}=t,l=Math.max(t.outerRadius-s,0),c=t.innerRadius+s;let u;for(n&&To(e,t,r+be),e.beginPath(),e.arc(i,o,c,r+be,r,!0),u=0;u<a;++u)e.stroke();for(e.beginPath(),e.arc(i,o,l,r,r+be),u=0;u<a;++u)e.stroke()}(e,t,s),s&&To(e,t,o),Lo(e,t,n,i,o),e.stroke())}class Po extends Ci{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.getProps(["x","y"],n),{angle:o,distance:r}=Fe(i,{x:e,y:t}),{startAngle:s,endAngle:a,innerRadius:l,outerRadius:c,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=this.options.spacing/2;return(u>=be||He(o,s,a))&&(r>=l+h&&r<=c+h)}getCenterPoint(e){const{x:t,y:n,startAngle:i,endAngle:o,innerRadius:r,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:a,spacing:l}=this.options,c=(i+o)/2,u=(r+s+l+a)/2;return{x:t+Math.cos(c)*u,y:n+Math.sin(c)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const t=this,{options:n,circumference:i}=t,o=(n.offset||0)/2,r=(n.spacing||0)/2;if(t.pixelMargin="inner"===n.borderAlign?.33:0,t.fullCircles=i>be?Math.floor(i/be):0,0===i||t.innerRadius<0||t.outerRadius<0)return;e.save();let s=0;if(o){s=o/2;const n=(t.startAngle+t.endAngle)/2;e.translate(Math.cos(n)*s,Math.sin(n)*s),t.circumference>=ve&&(s=o)}e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor;const a=function(e,t,n,i){const{fullCircles:o,startAngle:r,circumference:s}=t;let a=t.endAngle;if(o){Lo(e,t,n,i,r+be);for(let t=0;t<o;++t)e.fill();isNaN(s)||(a=r+s%be,s%be==0&&(a+=be))}return Lo(e,t,n,i,a),e.fill(),a}(e,t,s,r);Ro(e,t,s,r,a),e.restore()}}function Io(e,t,n=t){e.lineCap=Y(n.borderCapStyle,t.borderCapStyle),e.setLineDash(Y(n.borderDash,t.borderDash)),e.lineDashOffset=Y(n.borderDashOffset,t.borderDashOffset),e.lineJoin=Y(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Y(n.borderWidth,t.borderWidth),e.strokeStyle=Y(n.borderColor,t.borderColor)}function Oo(e,t,n){e.lineTo(n.x,n.y)}function Do(e,t,n={}){const i=e.length,{start:o=0,end:r=i-1}=n,{start:s,end:a}=t,l=Math.max(o,s),c=Math.min(r,a),u=o<s&&r<s||o>a&&r>a;return{count:i,start:l,loop:t.loop,ilen:c<l&&!u?i+c-l:c-l}}function Fo(e,t,n,i){const{points:o,options:r}=t,{count:s,start:a,loop:l,ilen:c}=Do(o,n,i),u=function(e){return e.stepped?Ze:e.tension||"monotone"===e.cubicInterpolationMode?et:Oo}(r);let h,d,p,{move:f=!0,reverse:g}=i||{};for(h=0;h<=c;++h)d=o[(a+(g?c-h:h))%s],d.skip||(f?(e.moveTo(d.x,d.y),f=!1):u(e,p,d,g,r.stepped),p=d);return l&&(d=o[(a+(g?c:0))%s],u(e,p,d,g,r.stepped)),!!l}function No(e,t,n,i){const o=t.points,{count:r,start:s,ilen:a}=Do(o,n,i),{move:l=!0,reverse:c}=i||{};let u,h,d,p,f,g,m=0,y=0;const v=e=>(s+(c?a-e:e))%r,b=()=>{p!==f&&(e.lineTo(m,f),e.lineTo(m,p),e.lineTo(m,g))};for(l&&(h=o[v(0)],e.moveTo(h.x,h.y)),u=0;u<=a;++u){if(h=o[v(u)],h.skip)continue;const t=h.x,n=h.y,i=0|t;i===d?(n<p?p=n:n>f&&(f=n),m=(y*m+t)/++y):(b(),e.lineTo(t,n),d=i,y=0,p=f=n),g=n}b()}function Bo(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!(e._decimated||e._loop||t.tension||"monotone"===t.cubicInterpolationMode||t.stepped||n)?No:Fo}Po.id="arc",Po.defaults={borderAlign:"center",borderColor:"#fff",borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},Po.defaultRoutes={backgroundColor:"backgroundColor"};const jo="function"==typeof Path2D;function Ho(e,t,n,i){jo&&1===t.segments.length?function(e,t,n,i){let o=t._path;o||(o=t._path=new Path2D,t.path(o,n,i)&&o.closePath()),Io(e,t.options),e.stroke(o)}(e,t,n,i):function(e,t,n,i){const{segments:o,options:r}=t,s=Bo(t);for(const a of o)Io(e,r,a.style),e.beginPath(),s(e,t,a,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}(e,t,n,i)}class Wo extends Ci{constructor(e){super(),this.animated=!0,this.options=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this,i=n.options;if((i.tension||"monotone"===i.cubicInterpolationMode)&&!i.stepped&&!n._pointsUpdated){const o=i.spanGaps?n._loop:n._fullLoop;wn(n._points,i,e,o,t),n._pointsUpdated=!0}}set points(e){const t=this;t._points=e,delete t._segments,delete t._path,t._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Nn(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this,i=n.options,o=e[t],r=n.points,s=Fn(n,{property:t,start:o,end:o});if(!s.length)return;const a=[],l=function(e){return e.stepped?Mn:e.tension||"monotone"===e.cubicInterpolationMode?Tn:An}(i);let c,u;for(c=0,u=s.length;c<u;++c){const{start:n,end:u}=s[c],h=r[n],d=r[u];if(h===d){a.push(h);continue}const p=l(h,d,Math.abs((o-h[t])/(d[t]-h[t])),i.stepped);p[t]=e[t],a.push(p)}return 1===a.length?a[0]:a}pathSegment(e,t,n){return Bo(this)(e,this,t,n)}path(e,t,n){const i=this,o=i.segments,r=Bo(i);let s=i._loop;t=t||0,n=n||i.points.length-t;for(const a of o)s&=r(e,i,a,{start:t,end:t+n-1});return!!s}draw(e,t,n,i){const o=this,r=o.options||{};(o.points||[]).length&&r.borderWidth&&(e.save(),Ho(e,o,n,i),e.restore(),o.animated&&(o._pointsUpdated=!1,o._path=void 0))}}function zo(e,t,n,i){const o=e.options,{[n]:r}=e.getProps([n],i);return Math.abs(t-r)<o.radius+o.hitRadius}Wo.id="line",Wo.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},Wo.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},Wo.descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};class Vo extends Ci{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.options,{x:o,y:r}=this.getProps(["x","y"],n);return Math.pow(e-o,2)+Math.pow(t-r,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(e,t){return zo(this,e,"x",t)}inYRange(e,t){return zo(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this,i=n.options;n.skip||i.radius<.1||!Xe(n,t,n.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Ye(e,i,n.x,n.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Go(e,t){const{x:n,y:i,base:o,width:r,height:s}=e.getProps(["x","y","base","width","height"],t);let a,l,c,u,h;return e.horizontal?(h=s/2,a=Math.min(n,o),l=Math.max(n,o),c=i-h,u=i+h):(h=r/2,a=n-h,l=n+h,c=Math.min(i,o),u=Math.max(i,o)),{left:a,top:c,right:l,bottom:u}}function Uo(e,t,n,i){return e?0:We(t,n,i)}function qo(e){const t=Go(e),n=t.right-t.left,i=t.bottom-t.top,o=function(e,t,n){const i=e.options.borderWidth,o=e.borderSkipped,r=Dt(i);return{t:Uo(o.top,r.top,0,n),r:Uo(o.right,r.right,0,t),b:Uo(o.bottom,r.bottom,0,n),l:Uo(o.left,r.left,0,t)}}(e,n/2,i/2),r=function(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),o=e.options.borderRadius,r=Ft(o),s=Math.min(t,n),a=e.borderSkipped,l=i||U(o);return{topLeft:Uo(!l||a.top||a.left,r.topLeft,0,s),topRight:Uo(!l||a.top||a.right,r.topRight,0,s),bottomLeft:Uo(!l||a.bottom||a.left,r.bottomLeft,0,s),bottomRight:Uo(!l||a.bottom||a.right,r.bottomRight,0,s)}}(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:r},inner:{x:t.left+o.l,y:t.top+o.t,w:n-o.l-o.r,h:i-o.t-o.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(o.t,o.l)),topRight:Math.max(0,r.topRight-Math.max(o.t,o.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(o.b,o.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(o.b,o.r))}}}}function Ko(e,t,n,i){const o=null===t,r=null===n,s=e&&!(o&&r)&&Go(e,i);return s&&(o||t>=s.left&&t<=s.right)&&(r||n>=s.top&&n<=s.bottom)}function Yo(e,t){e.rect(t.x,t.y,t.w,t.h)}function Xo(e,t,n={}){const i=e.x!==n.x?-t:0,o=e.y!==n.y?-t:0,r=(e.x+e.w!==n.x+n.w?t:0)-i,s=(e.y+e.h!==n.y+n.h?t:0)-o;return{x:e.x+i,y:e.y+o,w:e.w+r,h:e.h+s,radius:e.radius}}Vo.id="point",Vo.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},Vo.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};class Jo extends Ci{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,e&&Object.assign(this,e)}draw(e){const t=this.options,{inner:n,outer:i}=qo(this),o=(r=i.radius).topLeft||r.topRight||r.bottomLeft||r.bottomRight?it:Yo;var r;const s=.33;e.save(),i.w===n.w&&i.h===n.h||(e.beginPath(),o(e,Xo(i,s,n)),e.clip(),o(e,Xo(n,-.33,i)),e.fillStyle=t.borderColor,e.fill("evenodd")),e.beginPath(),o(e,Xo(n,s,i)),e.fillStyle=t.backgroundColor,e.fill(),e.restore()}inRange(e,t,n){return Ko(this,e,t,n)}inXRange(e,t){return Ko(this,e,null,t)}inYRange(e,t){return Ko(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:i,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(t+i)/2:t,y:o?n:(n+i)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}Jo.id="bar",Jo.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,enableBorderRadius:!0,pointStyle:void 0},Jo.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var Qo=Object.freeze({__proto__:null,ArcElement:Po,LineElement:Wo,PointElement:Vo,BarElement:Jo});function Zo(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{value:t})}}function er(e){e.data.datasets.forEach((e=>{Zo(e)}))}var tr={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled)return void er(e);const i=e.width;e.data.datasets.forEach(((t,o)=>{const{_data:r,indexAxis:s}=t,a=e.getDatasetMeta(o),l=r||t.data;if("y"===jt([s,e.options.indexAxis]))return;if("line"!==a.type)return;const c=e.scales[a.xAxisID];if("linear"!==c.type&&"time"!==c.type)return;if(e.options.parsing)return;let{start:u,count:h}=function(e,t){const n=t.length;let i,o=0;const{iScale:r}=e,{min:s,max:a,minDefined:l,maxDefined:c}=r.getUserBounds();return l&&(o=We(rt(t,r.axis,s).lo,0,n-1)),i=c?We(rt(t,r.axis,a).hi+1,o,n)-o:n-o,{start:o,count:i}}(a,l);if(h<=(n.threshold||4*i))return void Zo(t);let d;switch(V(r)&&(t._data=l,delete t.data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(e){this._data=e}})),n.algorithm){case"lttb":d=function(e,t,n,i,o){const r=o.samples||i;if(r>=n)return e.slice(t,t+n);const s=[],a=(n-2)/(r-2);let l=0;const c=t+n-1;let u,h,d,p,f,g=t;for(s[l++]=e[g],u=0;u<r-2;u++){let i,o=0,r=0;const c=Math.floor((u+1)*a)+1+t,m=Math.min(Math.floor((u+2)*a)+1,n)+t,y=m-c;for(i=c;i<m;i++)o+=e[i].x,r+=e[i].y;o/=y,r/=y;const v=Math.floor(u*a)+1+t,b=Math.min(Math.floor((u+1)*a)+1,n)+t,{x:x,y:w}=e[g];for(d=p=-1,i=v;i<b;i++)p=.5*Math.abs((x-o)*(e[i].y-w)-(x-e[i].x)*(r-w)),p>d&&(d=p,h=e[i],f=i);s[l++]=h,g=f}return s[l++]=e[c],s}(l,u,h,i,n);break;case"min-max":d=function(e,t,n,i){let o,r,s,a,l,c,u,h,d,p,f=0,g=0;const m=[],y=t+n-1,v=e[t].x,b=e[y].x-v;for(o=t;o<t+n;++o){r=e[o],s=(r.x-v)/b*i,a=r.y;const t=0|s;if(t===l)a<d?(d=a,c=o):a>p&&(p=a,u=o),f=(g*f+r.x)/++g;else{const n=o-1;if(!V(c)&&!V(u)){const t=Math.min(c,u),i=Math.max(c,u);t!==h&&t!==n&&m.push({...e[t],x:f}),i!==h&&i!==n&&m.push({...e[i],x:f})}o>0&&n!==h&&m.push(e[n]),m.push(r),l=t,g=0,d=p=a,c=u=h=o}}return m}(l,u,h,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}t._decimated=d}))},destroy(e){er(e)}};function nr(e,t,n){const i=function(e){const t=e.options,n=t.fill;let i=Y(n&&n.target,n);return void 0===i&&(i=!!t.backgroundColor),!1!==i&&null!==i&&(!0===i?"origin":i)}(e);if(U(i))return!isNaN(i.value)&&i;let o=parseFloat(i);return q(o)&&Math.floor(o)===o?("-"!==i[0]&&"+"!==i[0]||(o=t+o),!(o===t||o<0||o>=n)&&o):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}class ir{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,n){const{x:i,y:o,radius:r}=this;return t=t||{start:0,end:be},e.arc(i,o,r,t.end,t.start,!0),!n.bounds}interpolate(e){const{x:t,y:n,radius:i}=this,o=e.angle;return{x:t+Math.cos(o)*i,y:n+Math.sin(o)*i,angle:o}}}function or(e){return(e.scale||{}).getPointPositionForValue?function(e){const{scale:t,fill:n}=e,i=t.options,o=t.getLabels().length,r=[],s=i.reverse?t.max:t.min,a=i.reverse?t.min:t.max;let l,c,u;if(u="start"===n?s:"end"===n?a:U(n)?n.value:t.getBaseValue(),i.grid.circular)return c=t.getPointPositionForValue(0,s),new ir({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(u)});for(l=0;l<o;++l)r.push(t.getPointPositionForValue(l,u));return r}(e):function(e){const{scale:t={},fill:n}=e;let i,o=null;return"start"===n?o=t.bottom:"end"===n?o=t.top:U(n)?o=t.getPixelForValue(n.value):t.getBasePixel&&(o=t.getBasePixel()),q(o)?(i=t.isHorizontal(),{x:i?o:null,y:i?null:o}):null}(e)}function rr(e,t,n){for(;t>e;t--){const e=n[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function sr(e){const{chart:t,scale:n,index:i,line:o}=e,r=[],s=o.segments,a=o.points,l=function(e,t){const n=[],i=e.getSortedVisibleDatasetMetas();for(let e=0;e<i.length;e++){const o=i[e];if(o.index===t)break;ar(o)&&n.unshift(o.dataset)}return n}(t,i);l.push(ur({x:null,y:n.bottom},o));for(let e=0;e<s.length;e++){const t=s[e];for(let e=t.start;e<=t.end;e++)lr(r,a[e],l)}return new Wo({points:r,options:{}})}const ar=e=>"line"===e.type&&!e.hidden;function lr(e,t,n){const i=[];for(let o=0;o<n.length;o++){const r=n[o],{first:s,last:a,point:l}=cr(r,t,"x");if(!(!l||s&&a))if(s)i.unshift(l);else if(e.push(l),!a)break}e.push(...i)}function cr(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const o=i[n],r=e.segments,s=e.points;let a=!1,l=!1;for(let e=0;e<r.length;e++){const t=r[e],i=s[t.start][n],c=s[t.end][n];if(o>=i&&o<=c){a=o===i,l=o===c;break}}return{first:a,last:l,point:i}}function ur(e,t){let n=[],i=!1;return G(e)?(i=!0,n=e):n=function(e,t){const{x:n=null,y:i=null}=e||{},o=t.points,r=[];return t.segments.forEach((({start:e,end:t})=>{t=rr(e,t,o);const s=o[e],a=o[t];null!==i?(r.push({x:s.x,y:i}),r.push({x:a.x,y:i})):null!==n&&(r.push({x:n,y:s.y}),r.push({x:n,y:a.y}))})),r}(e,t),n.length?new Wo({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function hr(e,t,n){let i=e[t].fill;const o=[t];let r;if(!n)return i;for(;!1!==i&&-1===o.indexOf(i);){if(!q(i))return i;if(r=e[i],!r)return!1;if(r.visible)return i;o.push(i),i=r.fill}return!1}function dr(e,t,n){e.beginPath(),t.path(e),e.lineTo(t.last().x,n),e.lineTo(t.first().x,n),e.closePath(),e.clip()}function pr(e,t,n,i){if(i)return;let o=t[e],r=n[e];return"angle"===e&&(o=je(o),r=je(r)),{property:e,start:o,end:r}}function fr(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function gr(e,t,n){const{top:i,bottom:o}=t.chart.chartArea,{property:r,start:s,end:a}=n||{};"x"===r&&(e.beginPath(),e.rect(s,i,a-s,o-i),e.clip())}function mr(e,t,n,i){const o=t.interpolate(n,i);o&&e.lineTo(o.x,o.y)}function yr(e,t){const{line:n,target:i,property:o,color:r,scale:s}=t,a=function(e,t,n){const i=e.segments,o=e.points,r=t.points,s=[];for(const e of i){let{start:i,end:a}=e;a=rr(i,a,o);const l=pr(n,o[i],o[a],e.loop);if(!t.segments){s.push({source:e,target:l,start:o[i],end:o[a]});continue}const c=Fn(t,l);for(const t of c){const i=pr(n,r[t.start],r[t.end],t.loop),a=Dn(e,o,i);for(const e of a)s.push({source:e,target:t,start:{[n]:fr(l,i,"start",Math.max)},end:{[n]:fr(l,i,"end",Math.min)}})}}return s}(n,i,o);for(const{source:t,target:l,start:c,end:u}of a){const{style:{backgroundColor:a=r}={}}=t,h=!0!==i;e.save(),e.fillStyle=a,gr(e,s,h&&pr(o,c,u)),e.beginPath();const d=!!n.pathSegment(e,t);let p;if(h){d?e.closePath():mr(e,i,u,o);const t=!!i.pathSegment(e,l,{move:d,reverse:!0});p=d&&t,p||mr(e,i,c,o)}e.closePath(),e.fill(p?"evenodd":"nonzero"),e.restore()}}function vr(e,t,n){const i=function(e){const{chart:t,fill:n,line:i}=e;if(q(n))return function(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}(t,n);if("stack"===n)return sr(e);if("shape"===n)return!0;const o=or(e);return o instanceof ir?o:ur(o,i)}(t),{line:o,scale:r,axis:s}=t,a=o.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:h=c}=l||{};i&&o.points.length&&(Je(e,n),function(e,t){const{line:n,target:i,above:o,below:r,area:s,scale:a}=t,l=n._loop?"angle":t.axis;e.save(),"x"===l&&r!==o&&(dr(e,i,s.top),yr(e,{line:n,target:i,color:o,scale:a,property:l}),e.restore(),e.save(),dr(e,i,s.bottom)),yr(e,{line:n,target:i,color:r,scale:a,property:l}),e.restore()}(e,{line:o,target:i,above:u,below:h,area:n,scale:r,axis:s}),Qe(e))}var br={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,o=[];let r,s,a,l;for(s=0;s<i;++s)r=e.getDatasetMeta(s),a=r.dataset,l=null,a&&a.options&&a instanceof Wo&&(l={visible:e.isDatasetVisible(s),index:s,fill:nr(a,s,i),chart:e,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=l,o.push(l);for(s=0;s<i;++s)l=o[s],l&&!1!==l.fill&&(l.fill=hr(o,s,n.propagate))},beforeDraw(e,t,n){const i="beforeDraw"===n.drawTime,o=e.getSortedVisibleDatasetMetas(),r=e.chartArea;for(let t=o.length-1;t>=0;--t){const n=o[t].$filler;n&&(n.line.updateControlPoints(r,n.axis),i&&vr(e.ctx,n,r))}},beforeDatasetsDraw(e,t,n){if("beforeDatasetsDraw"!==n.drawTime)return;const i=e.getSortedVisibleDatasetMetas();for(let t=i.length-1;t>=0;--t){const n=i[t].$filler;n&&vr(e.ctx,n,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;i&&!1!==i.fill&&"beforeDatasetDraw"===n.drawTime&&vr(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const xr=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}};class wr extends Ci{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){const i=this;i.maxWidth=e,i.maxHeight=t,i._margins=n,i.setDimensions(),i.buildLabels(),i.fit()}setDimensions(){const e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=e._margins.left,e.right=e.width):(e.height=e.maxHeight,e.top=e._margins.top,e.bottom=e.height)}buildLabels(){const e=this,t=e.options.labels||{};let n=Q(t.generateLabels,[e.chart],e)||[];t.filter&&(n=n.filter((n=>t.filter(n,e.chart.data)))),t.sort&&(n=n.sort(((n,i)=>t.sort(n,i,e.chart.data)))),e.options.reverse&&n.reverse(),e.legendItems=n}fit(){const e=this,{options:t,ctx:n}=e;if(!t.display)return void(e.width=e.height=0);const i=t.labels,o=Bt(i.font),r=o.size,s=e._computeTitleHeight(),{boxWidth:a,itemHeight:l}=xr(i,r);let c,u;n.font=o.string,e.isHorizontal()?(c=e.maxWidth,u=e._fitRows(s,r,a,l)+10):(u=e.maxHeight,c=e._fitCols(s,r,a,l)+10),e.width=Math.min(c,t.maxWidth||e.maxWidth),e.height=Math.min(u,t.maxHeight||e.maxHeight)}_fitRows(e,t,n,i){const o=this,{ctx:r,maxWidth:s,options:{labels:{padding:a}}}=o,l=o.legendHitBoxes=[],c=o.lineWidths=[0],u=i+a;let h=e;r.textAlign="left",r.textBaseline="middle";let d=-1,p=-u;return o.legendItems.forEach(((e,o)=>{const f=n+t/2+r.measureText(e.text).width;(0===o||c[c.length-1]+f+2*a>s)&&(h+=u,c[c.length-(o>0?0:1)]=0,p+=u,d++),l[o]={left:0,top:p,row:d,width:f,height:i},c[c.length-1]+=f+a})),h}_fitCols(e,t,n,i){const o=this,{ctx:r,maxHeight:s,options:{labels:{padding:a}}}=o,l=o.legendHitBoxes=[],c=o.columnSizes=[],u=s-e;let h=a,d=0,p=0,f=0,g=0;return o.legendItems.forEach(((e,o)=>{const s=n+t/2+r.measureText(e.text).width;o>0&&p+i+2*a>u&&(h+=d+a,c.push({width:d,height:p}),f+=d+a,g++,d=p=0),l[o]={left:f,top:p,col:g,width:s,height:i},d=Math.max(d,s),p+=i+a})),h+=d,c.push({width:d,height:p}),h}adjustHitBoxes(){const e=this;if(!e.options.display)return;const t=e._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:r},rtl:s}}=e,a=Ln(s,e.left,e.width);if(this.isHorizontal()){let s=0,l=o(i,e.left+r,e.right-e.lineWidths[s]);for(const c of n)s!==c.row&&(s=c.row,l=o(i,e.left+r,e.right-e.lineWidths[s])),c.top+=e.top+t+r,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+r}else{let s=0,l=o(i,e.top+t+r,e.bottom-e.columnSizes[s].height);for(const c of n)c.col!==s&&(s=c.col,l=o(i,e.top+t+r,e.bottom-e.columnSizes[s].height)),c.top=l,c.left+=e.left+r,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){const e=this;if(e.options.display){const t=e.ctx;Je(t,e),e._draw(),Qe(t)}}_draw(){const e=this,{options:t,columnSizes:n,lineWidths:i,ctx:s}=e,{align:a,labels:l}=t,c=ye.color,u=Ln(t.rtl,e.left,e.width),h=Bt(l.font),{color:d,padding:p}=l,f=h.size,g=f/2;let m;e.drawTitle(),s.textAlign=u.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=h.string;const{boxWidth:y,boxHeight:v,itemHeight:b}=xr(l,f),x=e.isHorizontal(),w=this._computeTitleHeight();m=x?{x:o(a,e.left+p,e.right-i[0]),y:e.top+p+w,line:0}:{x:e.left+p,y:o(a,e.top+w+p,e.bottom-n[0].height),line:0},Rn(e.ctx,t.textDirection);const _=b+p;e.legendItems.forEach(((S,C)=>{s.strokeStyle=S.fontColor||d,s.fillStyle=S.fontColor||d;const k=s.measureText(S.text).width,A=u.textAlign(S.textAlign||(S.textAlign=l.textAlign)),M=y+g+k;let T=m.x,E=m.y;u.setWidth(e.width),x?C>0&&T+M+p>e.right&&(E=m.y+=_,m.line++,T=m.x=o(a,e.left+p,e.right-i[m.line])):C>0&&E+_>e.bottom&&(T=m.x=T+n[m.line].width+p,m.line++,E=m.y=o(a,e.top+w+p,e.bottom-n[m.line].height));!function(e,t,n){if(isNaN(y)||y<=0||isNaN(v)||v<0)return;s.save();const i=Y(n.lineWidth,1);if(s.fillStyle=Y(n.fillStyle,c),s.lineCap=Y(n.lineCap,"butt"),s.lineDashOffset=Y(n.lineDashOffset,0),s.lineJoin=Y(n.lineJoin,"miter"),s.lineWidth=i,s.strokeStyle=Y(n.strokeStyle,c),s.setLineDash(Y(n.lineDash,[])),l.usePointStyle){const o={radius:y*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:i},r=u.xPlus(e,y/2);Ye(s,o,r,t+g)}else{const o=t+Math.max((f-v)/2,0),r=u.leftForLtr(e,y),a=Ft(n.borderRadius);s.beginPath(),Object.values(a).some((e=>0!==e))?it(s,{x:r,y:o,w:y,h:v,radius:a}):s.rect(r,o,y,v),s.fill(),0!==i&&s.stroke()}s.restore()}(u.x(T),E,S),T=r(A,T+y+g,x?T+M:e.right,t.rtl),function(e,t,n){tt(s,n.text,e,t+b/2,h,{strikethrough:n.hidden,textAlign:u.textAlign(n.textAlign)})}(u.x(T),E,S),x?m.x+=M+p:m.y+=_})),Pn(e.ctx,t.textDirection)}drawTitle(){const e=this,t=e.options,n=t.title,r=Bt(n.font),s=Nt(n.padding);if(!n.display)return;const a=Ln(t.rtl,e.left,e.width),l=e.ctx,c=n.position,u=r.size/2,h=s.top+u;let d,p=e.left,f=e.width;if(this.isHorizontal())f=Math.max(...e.lineWidths),d=e.top+h,p=o(t.align,p,e.right-f);else{const n=e.columnSizes.reduce(((e,t)=>Math.max(e,t.height)),0);d=h+o(t.align,e.top,e.bottom-n-t.labels.padding-e._computeTitleHeight())}const g=o(c,p,p+f);l.textAlign=a.textAlign(i(c)),l.textBaseline="middle",l.strokeStyle=n.color,l.fillStyle=n.color,l.font=r.string,tt(l,n.text,g,d,r)}_computeTitleHeight(){const e=this.options.title,t=Bt(e.font),n=Nt(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){const n=this;let i,o,r;if(e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom)for(r=n.legendHitBoxes,i=0;i<r.length;++i)if(o=r[i],e>=o.left&&e<=o.left+o.width&&t>=o.top&&t<=o.top+o.height)return n.legendItems[i];return null}handleEvent(e){const t=this,n=t.options;if(!function(e,t){if("mousemove"===e&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,n))return;const i=t._getLegendItemAt(e.x,e.y);if("mousemove"===e.type){const s=t._hoveredItem,a=(r=i,null!==(o=s)&&null!==r&&o.datasetIndex===r.datasetIndex&&o.index===r.index);s&&!a&&Q(n.onLeave,[e,s,t],t),t._hoveredItem=i,i&&!a&&Q(n.onHover,[e,i,t],t)}else i&&Q(n.onClick,[e,i,t],t);var o,r}}var _r={id:"legend",_element:wr,start(e,t,n){const i=e.legend=new wr({ctx:e.ctx,options:n,chart:e});en.configure(e,i,n),en.addBox(e,i)},stop(e){en.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;en.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,o=n.chart;o.isDatasetVisible(i)?(o.hide(i),t.hidden=!0):(o.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:o,color:r}}=e.legend.options;return e._getSortedDatasetMetas().map((e=>{const s=e.controller.getStyle(n?0:void 0),a=Nt(s.borderWidth);return{text:t[e.index].label,fillStyle:s.backgroundColor,fontColor:r,hidden:!e.visible,lineCap:s.borderCapStyle,lineDash:s.borderDash,lineDashOffset:s.borderDashOffset,lineJoin:s.borderJoinStyle,lineWidth:(a.width+a.height)/4,strokeStyle:s.borderColor,pointStyle:i||s.pointStyle,rotation:s.rotation,textAlign:o||s.textAlign,borderRadius:0,datasetIndex:e.index}}),this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Sr extends Ci{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this,i=n.options;if(n.left=0,n.top=0,!i.display)return void(n.width=n.height=n.right=n.bottom=0);n.width=n.right=e,n.height=n.bottom=t;const o=G(i.text)?i.text.length:1;n._padding=Nt(i.padding);const r=o*Bt(i.font).lineHeight+n._padding.height;n.isHorizontal()?n.height=r:n.width=r}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:n,bottom:i,right:r,options:s}=this,a=s.align;let l,c,u,h=0;return this.isHorizontal()?(c=o(a,n,r),u=t+e,l=r-n):("left"===s.position?(c=n+e,u=o(a,i,t),h=-.5*ve):(c=r-e,u=o(a,t,i),h=.5*ve),l=i-t),{titleX:c,titleY:u,maxWidth:l,rotation:h}}draw(){const e=this,t=e.ctx,n=e.options;if(!n.display)return;const o=Bt(n.font),r=o.lineHeight/2+e._padding.top,{titleX:s,titleY:a,maxWidth:l,rotation:c}=e._drawArgs(r);tt(t,n.text,0,0,o,{color:n.color,maxWidth:l,rotation:c,textAlign:i(n.align),textBaseline:"middle",translation:[s,a]})}}var Cr={id:"title",_element:Sr,start(e,t,n){!function(e,t){const n=new Sr({ctx:e.ctx,options:t,chart:e});en.configure(e,n,t),en.addBox(e,n),e.titleBlock=n}(e,n)},stop(e){const t=e.titleBlock;en.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;en.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const kr=new WeakMap;var Ar={id:"subtitle",start(e,t,n){const i=new Sr({ctx:e.ctx,options:n,chart:e});en.configure(e,i,n),en.addBox(e,i),kr.set(e,i)},stop(e){en.removeBox(e,kr.get(e)),kr.delete(e)},beforeUpdate(e,t,n){const i=kr.get(e);en.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Mr={average(e){if(!e.length)return!1;let t,n,i=0,o=0,r=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();i+=e.x,o+=e.y,++r}}return{x:i/r,y:o/r}},nearest(e,t){if(!e.length)return!1;let n,i,o,r=t.x,s=t.y,a=Number.POSITIVE_INFINITY;for(n=0,i=e.length;n<i;++n){const i=e[n].element;if(i&&i.hasValue()){const e=Ne(t,i.getCenterPoint());e<a&&(a=e,o=i)}}if(o){const e=o.tooltipPosition();r=e.x,s=e.y}return{x:r,y:s}}};function Tr(e,t){return t&&(G(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Er(e){return("string"==typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function $r(e,t){const{element:n,datasetIndex:i,index:o}=t,r=e.getDatasetMeta(i).controller,{label:s,value:a}=r.getLabelAndValue(o);return{chart:e,label:s,parsed:r.getParsed(o),raw:e.data.datasets[i].data[o],formattedValue:a,dataset:r.getDataset(),dataIndex:o,datasetIndex:i,element:n}}function Lr(e,t){const n=e._chart.ctx,{body:i,footer:o,title:r}=e,{boxWidth:s,boxHeight:a}=t,l=Bt(t.bodyFont),c=Bt(t.titleFont),u=Bt(t.footerFont),h=r.length,d=o.length,p=i.length,f=Nt(t.padding);let g=f.height,m=0,y=i.reduce(((e,t)=>e+t.before.length+t.lines.length+t.after.length),0);if(y+=e.beforeBody.length+e.afterBody.length,h&&(g+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),y){g+=p*(t.displayColors?Math.max(a,l.lineHeight):l.lineHeight)+(y-p)*l.lineHeight+(y-1)*t.bodySpacing}d&&(g+=t.footerMarginTop+d*u.lineHeight+(d-1)*t.footerSpacing);let v=0;const b=function(e){m=Math.max(m,n.measureText(e).width+v)};return n.save(),n.font=c.string,Z(e.title,b),n.font=l.string,Z(e.beforeBody.concat(e.afterBody),b),v=t.displayColors?s+2:0,Z(i,(e=>{Z(e.before,b),Z(e.lines,b),Z(e.after,b)})),v=0,n.font=u.string,Z(e.footer,b),n.restore(),m+=f.width,{width:m,height:g}}function Rr(e,t,n,i){const{x:o,width:r}=n,{width:s,chartArea:{left:a,right:l}}=e;let c="center";return"center"===i?c=o<=(a+l)/2?"left":"right":o<=r/2?c="left":o>=s-r/2&&(c="right"),function(e,t,n,i){const{x:o,width:r}=i,s=n.caretSize+n.caretPadding;return"left"===e&&o+r+s>t.width||"right"===e&&o-r-s<0||void 0}(c,e,t,n)&&(c="center"),c}function Pr(e,t,n){const i=t.yAlign||function(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}(e,n);return{xAlign:t.xAlign||Rr(e,t,n,i),yAlign:i}}function Ir(e,t,n,i){const{caretSize:o,caretPadding:r,cornerRadius:s}=e,{xAlign:a,yAlign:l}=n,c=o+r,u=s+r;let h=function(e,t){let{x:n,width:i}=e;return"right"===t?n-=i:"center"===t&&(n-=i/2),n}(t,a);const d=function(e,t,n){let{y:i,height:o}=e;return"top"===t?i+=n:i-="bottom"===t?o+n:o/2,i}(t,l,c);return"center"===l?"left"===a?h+=c:"right"===a&&(h-=c):"left"===a?h-=u:"right"===a&&(h+=u),{x:We(h,0,i.width-t.width),y:We(d,0,i.height-t.height)}}function Or(e,t,n){const i=Nt(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-i.right:e.x+i.left}function Dr(e){return Tr([],Er(e))}function Fr(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}class Nr extends Ci{constructor(e){super(),this.opacity=0,this._active=[],this._chart=e._chart,this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this,t=e._cachedAnimations;if(t)return t;const n=e._chart,i=e.options.setContext(e.getContext()),o=i.enabled&&n.options.animation&&i.animations,r=new hi(e._chart,o);return o._cacheable&&(e._cachedAnimations=Object.freeze(r)),r}getContext(){const e=this;return e.$context||(e.$context=(t=e._chart.getContext(),n=e,i=e._tooltipItems,Object.assign(Object.create(t),{tooltip:n,tooltipItems:i,type:"tooltip"})));var t,n,i}getTitle(e,t){const n=this,{callbacks:i}=t,o=i.beforeTitle.apply(n,[e]),r=i.title.apply(n,[e]),s=i.afterTitle.apply(n,[e]);let a=[];return a=Tr(a,Er(o)),a=Tr(a,Er(r)),a=Tr(a,Er(s)),a}getBeforeBody(e,t){return Dr(t.callbacks.beforeBody.apply(this,[e]))}getBody(e,t){const n=this,{callbacks:i}=t,o=[];return Z(e,(e=>{const t={before:[],lines:[],after:[]},r=Fr(i,e);Tr(t.before,Er(r.beforeLabel.call(n,e))),Tr(t.lines,r.label.call(n,e)),Tr(t.after,Er(r.afterLabel.call(n,e))),o.push(t)})),o}getAfterBody(e,t){return Dr(t.callbacks.afterBody.apply(this,[e]))}getFooter(e,t){const n=this,{callbacks:i}=t,o=i.beforeFooter.apply(n,[e]),r=i.footer.apply(n,[e]),s=i.afterFooter.apply(n,[e]);let a=[];return a=Tr(a,Er(o)),a=Tr(a,Er(r)),a=Tr(a,Er(s)),a}_createItems(e){const t=this,n=t._active,i=t._chart.data,o=[],r=[],s=[];let a,l,c=[];for(a=0,l=n.length;a<l;++a)c.push($r(t._chart,n[a]));return e.filter&&(c=c.filter(((t,n,o)=>e.filter(t,n,o,i)))),e.itemSort&&(c=c.sort(((t,n)=>e.itemSort(t,n,i)))),Z(c,(n=>{const i=Fr(e.callbacks,n);o.push(i.labelColor.call(t,n)),r.push(i.labelPointStyle.call(t,n)),s.push(i.labelTextColor.call(t,n))})),t.labelColors=o,t.labelPointStyles=r,t.labelTextColors=s,t.dataPoints=c,c}update(e,t){const n=this,i=n.options.setContext(n.getContext()),o=n._active;let r,s=[];if(o.length){const e=Mr[i.position].call(n,o,n._eventPosition);s=n._createItems(i),n.title=n.getTitle(s,i),n.beforeBody=n.getBeforeBody(s,i),n.body=n.getBody(s,i),n.afterBody=n.getAfterBody(s,i),n.footer=n.getFooter(s,i);const t=n._size=Lr(n,i),a=Object.assign({},e,t),l=Pr(n._chart,i,a),c=Ir(i,a,l,n._chart);n.xAlign=l.xAlign,n.yAlign=l.yAlign,r={opacity:1,x:c.x,y:c.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==n.opacity&&(r={opacity:0});n._tooltipItems=s,n.$context=void 0,r&&n._resolveAnimations().update(n,r),e&&i.external&&i.external.call(n,{chart:n._chart,tooltip:n,replay:t})}drawCaret(e,t,n,i){const o=this.getCaretPosition(e,n,i);t.lineTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.lineTo(o.x3,o.y3)}getCaretPosition(e,t,n){const{xAlign:i,yAlign:o}=this,{cornerRadius:r,caretSize:s}=n,{x:a,y:l}=e,{width:c,height:u}=t;let h,d,p,f,g,m;return"center"===o?(g=l+u/2,"left"===i?(h=a,d=h-s,f=g+s,m=g-s):(h=a+c,d=h+s,f=g-s,m=g+s),p=h):(d="left"===i?a+r+s:"right"===i?a+c-r-s:this.caretX,"top"===o?(f=l,g=f-s,h=d-s,p=d+s):(f=l+u,g=f+s,h=d+s,p=d-s),m=f),{x1:h,x2:d,x3:p,y1:f,y2:g,y3:m}}drawTitle(e,t,n){const i=this,o=i.title,r=o.length;let s,a,l;if(r){const c=Ln(n.rtl,i.x,i.width);for(e.x=Or(i,n.titleAlign,n),t.textAlign=c.textAlign(n.titleAlign),t.textBaseline="middle",s=Bt(n.titleFont),a=n.titleSpacing,t.fillStyle=n.titleColor,t.font=s.string,l=0;l<r;++l)t.fillText(o[l],c.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+a,l+1===r&&(e.y+=n.titleMarginBottom-a)}}_drawColorBox(e,t,n,i,o){const r=this,s=r.labelColors[n],a=r.labelPointStyles[n],{boxHeight:l,boxWidth:c}=o,u=Bt(o.bodyFont),h=Or(r,"left",o),d=i.x(h),p=l<u.lineHeight?(u.lineHeight-l)/2:0,f=t.y+p;if(o.usePointStyle){const t={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},n=i.leftForLtr(d,c)+c/2,r=f+l/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,Ye(e,t,n,r),e.strokeStyle=s.borderColor,e.fillStyle=s.backgroundColor,Ye(e,t,n,r)}else{e.lineWidth=s.borderWidth||1,e.strokeStyle=s.borderColor,e.setLineDash(s.borderDash||[]),e.lineDashOffset=s.borderDashOffset||0;const t=i.leftForLtr(d,c),n=i.leftForLtr(i.xPlus(d,1),c-2),r=Ft(s.borderRadius);Object.values(r).some((e=>0!==e))?(e.beginPath(),e.fillStyle=o.multiKeyBackground,it(e,{x:t,y:f,w:c,h:l,radius:r}),e.fill(),e.stroke(),e.fillStyle=s.backgroundColor,e.beginPath(),it(e,{x:n,y:f+1,w:c-2,h:l-2,radius:r}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(t,f,c,l),e.strokeRect(t,f,c,l),e.fillStyle=s.backgroundColor,e.fillRect(n,f+1,c-2,l-2))}e.fillStyle=r.labelTextColors[n]}drawBody(e,t,n){const i=this,{body:o}=i,{bodySpacing:r,bodyAlign:s,displayColors:a,boxHeight:l,boxWidth:c}=n,u=Bt(n.bodyFont);let h=u.lineHeight,d=0;const p=Ln(n.rtl,i.x,i.width),f=function(n){t.fillText(n,p.x(e.x+d),e.y+h/2),e.y+=h+r},g=p.textAlign(s);let m,y,v,b,x,w,_;for(t.textAlign=s,t.textBaseline="middle",t.font=u.string,e.x=Or(i,g,n),t.fillStyle=n.bodyColor,Z(i.beforeBody,f),d=a&&"right"!==g?"center"===s?c/2+1:c+2:0,b=0,w=o.length;b<w;++b){for(m=o[b],y=i.labelTextColors[b],t.fillStyle=y,Z(m.before,f),v=m.lines,a&&v.length&&(i._drawColorBox(t,e,b,p,n),h=Math.max(u.lineHeight,l)),x=0,_=v.length;x<_;++x)f(v[x]),h=u.lineHeight;Z(m.after,f)}d=0,h=u.lineHeight,Z(i.afterBody,f),e.y-=r}drawFooter(e,t,n){const i=this,o=i.footer,r=o.length;let s,a;if(r){const l=Ln(n.rtl,i.x,i.width);for(e.x=Or(i,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=l.textAlign(n.footerAlign),t.textBaseline="middle",s=Bt(n.footerFont),t.fillStyle=n.footerColor,t.font=s.string,a=0;a<r;++a)t.fillText(o[a],l.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+n.footerSpacing}}drawBackground(e,t,n,i){const{xAlign:o,yAlign:r}=this,{x:s,y:a}=e,{width:l,height:c}=n,u=i.cornerRadius;t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(s+u,a),"top"===r&&this.drawCaret(e,t,n,i),t.lineTo(s+l-u,a),t.quadraticCurveTo(s+l,a,s+l,a+u),"center"===r&&"right"===o&&this.drawCaret(e,t,n,i),t.lineTo(s+l,a+c-u),t.quadraticCurveTo(s+l,a+c,s+l-u,a+c),"bottom"===r&&this.drawCaret(e,t,n,i),t.lineTo(s+u,a+c),t.quadraticCurveTo(s,a+c,s,a+c-u),"center"===r&&"left"===o&&this.drawCaret(e,t,n,i),t.lineTo(s,a+u),t.quadraticCurveTo(s,a,s+u,a),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this,n=t._chart,i=t.$animations,o=i&&i.x,r=i&&i.y;if(o||r){const i=Mr[e.position].call(t,t._active,t._eventPosition);if(!i)return;const s=t._size=Lr(t,e),a=Object.assign({},i,t._size),l=Pr(n,e,a),c=Ir(e,a,l,n);o._to===c.x&&r._to===c.y||(t.xAlign=l.xAlign,t.yAlign=l.yAlign,t.width=s.width,t.height=s.height,t.caretX=i.x,t.caretY=i.y,t._resolveAnimations().update(t,c))}}draw(e){const t=this,n=t.options.setContext(t.getContext());let i=t.opacity;if(!i)return;t._updateAnimationTarget(n);const o={width:t.width,height:t.height},r={x:t.x,y:t.y};i=Math.abs(i)<.001?0:i;const s=Nt(n.padding),a=t.title.length||t.beforeBody.length||t.body.length||t.afterBody.length||t.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=i,t.drawBackground(r,e,o,n),Rn(e,n.textDirection),r.y+=s.top,t.drawTitle(r,e,n),t.drawBody(r,e,n),t.drawFooter(r,e,n),Pn(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this,i=n._active,o=e.map((({datasetIndex:e,index:t})=>{const i=n._chart.getDatasetMeta(e);if(!i)throw new Error("Cannot find a dataset at index "+e);return{datasetIndex:e,element:i.data[t],index:t}})),r=!ee(i,o),s=n._positionChanged(o,t);(r||s)&&(n._active=o,n._eventPosition=t,n.update(!0))}handleEvent(e,t){const n=this,i=n.options,o=n._active||[];let r=!1,s=[];"mouseout"!==e.type&&(s=n._chart.getElementsAtEventForMode(e,i.mode,i,t),i.reverse&&s.reverse());const a=n._positionChanged(s,e);return r=t||!ee(s,o)||a,r&&(n._active=s,(i.enabled||i.external)&&(n._eventPosition={x:e.x,y:e.y},n.update(!0,t))),r}_positionChanged(e,t){const{caretX:n,caretY:i,options:o}=this,r=Mr[o.position].call(this,e,t);return!1!==r&&(n!==r.x||i!==r.y)}}Nr.positioners=Mr;var Br={id:"tooltip",_element:Nr,positioners:Mr,afterInit(e,t,n){n&&(e.tooltip=new Nr({_chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip,n={tooltip:t};!1!==e.notifyPlugins("beforeTooltipDraw",n)&&(t&&t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n))},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:W,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:W,beforeBody:W,beforeLabel:W,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return V(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:W,afterBody:W,beforeFooter:W,footer:W,afterFooter:W}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},jr=Object.freeze({__proto__:null,Decimation:tr,Filler:br,Legend:_r,SubTitle:Ar,Title:Cr,Tooltip:Br});function Hr(e,t,n){const i=e.indexOf(t);if(-1===i)return((e,t,n)=>"string"==typeof t?e.push(t)-1:isNaN(t)?null:n)(e,t,n);return i!==e.lastIndexOf(t)?n:i}class Wr extends Oi{constructor(e){super(e),this._startValue=void 0,this._valueRange=0}parse(e,t){if(V(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:We(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:Hr(n,e,Y(t,e)),n.length-1)}determineDataLimits(){const e=this,{minDefined:t,maxDefined:n}=e.getUserBounds();let{min:i,max:o}=e.getMinMax(!0);"ticks"===e.options.bounds&&(t||(i=0),n||(o=e.getLabels().length-1)),e.min=i,e.max=o}buildTicks(){const e=this,t=e.min,n=e.max,i=e.options.offset,o=[];let r=e.getLabels();r=0===t&&n===r.length-1?r:r.slice(t,n+1),e._valueRange=Math.max(r.length-(i?0:1),1),e._startValue=e.min-(i?.5:0);for(let e=t;e<=n;e++)o.push({value:e});return o}getLabelForValue(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}configure(){const e=this;super.configure(),e.isHorizontal()||(e._reversePixels=!e._reversePixels)}getPixelForValue(e){const t=this;return"number"!=typeof e&&(e=t.parse(e)),null===e?NaN:t.getPixelForDecimal((e-t._startValue)/t._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){const t=this;return Math.round(t._startValue+t.getDecimalForPixel(e)*t._valueRange)}getBasePixel(){return this.bottom}}function zr(e,t,{horizontal:n,minRotation:i}){const o=Ie(i),r=(n?Math.sin(o):Math.cos(o))||.001,s=.75*t*(""+e).length;return Math.min(t/r,s)}Wr.id="category",Wr.defaults={ticks:{callback:Wr.prototype.getLabelForValue}};class Vr extends Oi{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return V(e)||("number"==typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const e=this,{beginAtZero:t}=e.options,{minDefined:n,maxDefined:i}=e.getUserBounds();let{min:o,max:r}=e;const s=e=>o=n?o:e,a=e=>r=i?r:e;if(t){const e=Me(o),t=Me(r);e<0&&t<0?a(0):e>0&&t>0&&s(0)}if(o===r){let e=1;(r>=Number.MAX_SAFE_INTEGER||o<=Number.MIN_SAFE_INTEGER)&&(e=Math.abs(.05*r)),a(r+e),t||s(o-e)}e.min=o,e.max=r}getTickLimit(){const e=this,t=e.options.ticks;let n,{maxTicksLimit:i,stepSize:o}=t;return o?n=Math.ceil(e.max/o)-Math.floor(e.min/o)+1:(n=e.computeTickLimit(),i=i||11),i&&(n=Math.min(i,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this,t=e.options,n=t.ticks;let i=e.getTickLimit();i=Math.max(2,i);const o=function(e,t){const n=[],{bounds:i,step:o,min:r,max:s,precision:a,count:l,maxTicks:c,maxDigits:u,includeBounds:h}=e,d=o||1,p=c-1,{min:f,max:g}=t,m=!V(r),y=!V(s),v=!V(l),b=(g-f)/(u+1);let x,w,_,S,C=Te((g-f)/p/d)*d;if(C<1e-14&&!m&&!y)return[{value:f},{value:g}];S=Math.ceil(g/C)-Math.floor(f/C),S>p&&(C=Te(S*C/p/d)*d),V(a)||(x=Math.pow(10,a),C=Math.ceil(C*x)/x),"ticks"===i?(w=Math.floor(f/C)*C,_=Math.ceil(g/C)*C):(w=f,_=g),m&&y&&o&&Re((s-r)/o,C/1e3)?(S=Math.round(Math.min((s-r)/C,c)),C=(s-r)/S,w=r,_=s):v?(w=m?r:w,_=y?s:_,S=l-1,C=(_-w)/S):(S=(_-w)/C,S=Le(S,Math.round(S),C/1e3)?Math.round(S):Math.ceil(S));const k=Math.max(De(C),De(w));x=Math.pow(10,V(a)?k:a),w=Math.round(w*x)/x,_=Math.round(_*x)/x;let A=0;for(m&&(h&&w!==r?(n.push({value:r}),w<r&&A++,Le(Math.round((w+A*C)*x)/x,r,zr(r,b,e))&&A++):w<r&&A++);A<S;++A)n.push({value:Math.round((w+A*C)*x)/x});return y&&h&&_!==s?Le(n[n.length-1].value,s,zr(s,b,e))?n[n.length-1].value=s:n.push({value:s}):y&&_!==s||n.push({value:_}),n}({maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:e._maxDigits(),horizontal:e.isHorizontal(),minRotation:n.minRotation||0,includeBounds:!1!==n.includeBounds},e._range||e);return"ticks"===t.bounds&&Pe(o,e,"value"),t.reverse?(o.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),o}configure(){const e=this,t=e.ticks;let n=e.min,i=e.max;if(super.configure(),e.options.offset&&t.length){const e=(i-n)/Math.max(t.length-1,1)/2;n-=e,i+=e}e._startValue=n,e._endValue=i,e._valueRange=i-n}getLabelForValue(e){return $n(e,this.chart.options.locale)}}class Gr extends Vr{determineDataLimits(){const e=this,{min:t,max:n}=e.getMinMax(!0);e.min=q(t)?t:0,e.max=q(n)?n:1,e.handleTickRangeOptions()}computeTickLimit(){const e=this,t=e.isHorizontal(),n=t?e.width:e.height,i=Ie(e.options.ticks.minRotation),o=(t?Math.sin(i):Math.cos(i))||.001,r=e._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,r.lineHeight/o))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}function Ur(e){return 1===e/Math.pow(10,Math.floor(Ae(e)))}Gr.id="linear",Gr.defaults={ticks:{callback:Ai.formatters.numeric}};class qr extends Oi{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const n=Vr.prototype.parse.apply(this,[e,t]);if(0!==n)return q(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const e=this,{min:t,max:n}=e.getMinMax(!0);e.min=q(t)?Math.max(0,t):null,e.max=q(n)?Math.max(0,n):null,e.options.beginAtZero&&(e._zero=!0),e.handleTickRangeOptions()}handleTickRangeOptions(){const e=this,{minDefined:t,maxDefined:n}=e.getUserBounds();let i=e.min,o=e.max;const r=e=>i=t?i:e,s=e=>o=n?o:e,a=(e,t)=>Math.pow(10,Math.floor(Ae(e))+t);i===o&&(i<=0?(r(1),s(10)):(r(a(i,-1)),s(a(o,1)))),i<=0&&r(a(o,-1)),o<=0&&s(a(i,1)),e._zero&&e.min!==e._suggestedMin&&i===a(e.min,0)&&r(a(i,-1)),e.min=i,e.max=o}buildTicks(){const e=this,t=e.options,n=function(e,t){const n=Math.floor(Ae(t.max)),i=Math.ceil(t.max/Math.pow(10,n)),o=[];let r=K(e.min,Math.pow(10,Math.floor(Ae(t.min)))),s=Math.floor(Ae(r)),a=Math.floor(r/Math.pow(10,s)),l=s<0?Math.pow(10,Math.abs(s)):1;do{o.push({value:r,major:Ur(r)}),++a,10===a&&(a=1,++s,l=s>=0?1:l),r=Math.round(a*Math.pow(10,s)*l)/l}while(s<n||s===n&&a<i);const c=K(e.max,r);return o.push({value:c,major:Ur(r)}),o}({min:e._userMin,max:e._userMax},e);return"ticks"===t.bounds&&Pe(n,e,"value"),t.reverse?(n.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),n}getLabelForValue(e){return void 0===e?"0":$n(e,this.chart.options.locale)}configure(){const e=this,t=e.min;super.configure(),e._startValue=Ae(t),e._valueRange=Ae(e.max)-Ae(t)}getPixelForValue(e){const t=this;return void 0!==e&&0!==e||(e=t.min),null===e||isNaN(e)?NaN:t.getPixelForDecimal(e===t.min?0:(Ae(e)-t._startValue)/t._valueRange)}getValueForPixel(e){const t=this,n=t.getDecimalForPixel(e);return Math.pow(10,t._startValue+n*t._valueRange)}}function Kr(e){const t=e.ticks;if(t.display&&e.display){const e=Nt(t.backdropPadding);return Y(t.font&&t.font.size,ye.font.size)+e.height}return 0}function Yr(e,t,n,i,o){return e===i||e===o?{start:t-n/2,end:t+n/2}:e<i||e>o?{start:t-n,end:t}:{start:t,end:t+n}}function Xr(e){const t={l:0,r:e.width,t:0,b:e.height-e.paddingTop},n={},i=[],o=[],r=e.getLabels().length;for(let c=0;c<r;c++){const r=e.options.pointLabels.setContext(e.getPointLabelContext(c));o[c]=r.padding;const u=e.getPointPosition(c,e.drawingArea+o[c]),h=Bt(r.font),d=(s=e.ctx,a=h,l=G(l=e._pointLabels[c])?l:[l],{w:Ue(s,a.string,l),h:l.length*a.lineHeight});i[c]=d;const p=e.getIndexAngle(c),f=Oe(p),g=Yr(f,u.x,d.w,0,180),m=Yr(f,u.y,d.h,90,270);g.start<t.l&&(t.l=g.start,n.l=p),g.end>t.r&&(t.r=g.end,n.r=p),m.start<t.t&&(t.t=m.start,n.t=p),m.end>t.b&&(t.b=m.end,n.b=p)}var s,a,l;e._setReductions(e.drawingArea,t,n),e._pointLabelItems=function(e,t,n){const i=[],o=e.getLabels().length,r=e.options,s=Kr(r),a=e.getDistanceFromCenterForValue(r.ticks.reverse?e.min:e.max);for(let r=0;r<o;r++){const o=0===r?s/2:0,l=e.getPointPosition(r,a+o+n[r]),c=Oe(e.getIndexAngle(r)),u=t[r],h=Zr(l.y,u.h,c),d=Jr(c),p=Qr(l.x,u.w,d);i.push({x:l.x,y:h,textAlign:d,left:p,top:h,right:p+u.w,bottom:h+u.h})}return i}(e,i,o)}function Jr(e){return 0===e||180===e?"center":e<180?"left":"right"}function Qr(e,t,n){return"right"===n?e-=t:"center"===n&&(e-=t/2),e}function Zr(e,t,n){return 90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t),e}function es(e,t,n,i){const{ctx:o}=e;if(n)o.arc(e.xCenter,e.yCenter,t,0,be);else{let n=e.getPointPosition(0,t);o.moveTo(n.x,n.y);for(let r=1;r<i;r++)n=e.getPointPosition(r,t),o.lineTo(n.x,n.y)}}function ts(e){return $e(e)?e:0}qr.id="logarithmic",qr.defaults={ticks:{callback:Ai.formatters.logarithmic,major:{enabled:!0}}};class ns extends Vr{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this;e.width=e.maxWidth,e.height=e.maxHeight,e.paddingTop=Kr(e.options)/2,e.xCenter=Math.floor(e.width/2),e.yCenter=Math.floor((e.height-e.paddingTop)/2),e.drawingArea=Math.min(e.height-e.paddingTop,e.width)/2}determineDataLimits(){const e=this,{min:t,max:n}=e.getMinMax(!1);e.min=q(t)&&!isNaN(t)?t:0,e.max=q(n)&&!isNaN(n)?n:0,e.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Kr(this.options))}generateTickLabels(e){const t=this;Vr.prototype.generateTickLabels.call(t,e),t._pointLabels=t.getLabels().map(((e,n)=>{const i=Q(t.options.pointLabels.callback,[e,n],t);return i||0===i?i:""}))}fit(){const e=this,t=e.options;t.display&&t.pointLabels.display?Xr(e):e.setCenterPoint(0,0,0,0)}_setReductions(e,t,n){const i=this;let o=t.l/Math.sin(n.l),r=Math.max(t.r-i.width,0)/Math.sin(n.r),s=-t.t/Math.cos(n.t),a=-Math.max(t.b-(i.height-i.paddingTop),0)/Math.cos(n.b);o=ts(o),r=ts(r),s=ts(s),a=ts(a),i.drawingArea=Math.max(e/2,Math.min(Math.floor(e-(o+r)/2),Math.floor(e-(s+a)/2))),i.setCenterPoint(o,r,s,a)}setCenterPoint(e,t,n,i){const o=this,r=o.width-t-o.drawingArea,s=e+o.drawingArea,a=n+o.drawingArea,l=o.height-o.paddingTop-i-o.drawingArea;o.xCenter=Math.floor((s+r)/2+o.left),o.yCenter=Math.floor((a+l)/2+o.top+o.paddingTop)}getIndexAngle(e){return je(e*(be/this.getLabels().length)+Ie(this.options.startAngle||0))}getDistanceFromCenterForValue(e){const t=this;if(V(e))return NaN;const n=t.drawingArea/(t.max-t.min);return t.options.reverse?(t.max-e)*n:(e-t.min)*n}getValueForDistanceFromCenter(e){if(V(e))return NaN;const t=this,n=e/(t.drawingArea/(t.max-t.min));return t.options.reverse?t.max-n:t.min+n}getPointLabelContext(e){const t=this,n=t._pointLabels||[];if(e>=0&&e<n.length){const i=n[e];return function(e,t,n){return Object.assign(Object.create(e),{label:n,index:t,type:"pointLabel"})}(t.getContext(),e,i)}}getPointPosition(e,t){const n=this,i=n.getIndexAngle(e)-Se;return{x:Math.cos(i)*t+n.xCenter,y:Math.sin(i)*t+n.yCenter,angle:i}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:n,right:i,bottom:o}=this._pointLabelItems[e];return{left:t,top:n,right:i,bottom:o}}drawBackground(){const e=this,{backgroundColor:t,grid:{circular:n}}=e.options;if(t){const i=e.ctx;i.save(),i.beginPath(),es(e,e.getDistanceFromCenterForValue(e._endValue),n,e.getLabels().length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const e=this,t=e.ctx,n=e.options,{angleLines:i,grid:o}=n,r=e.getLabels().length;let s,a,l;if(n.pointLabels.display&&function(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let o=t-1;o>=0;o--){const t=i.setContext(e.getPointLabelContext(o)),r=Bt(t.font),{x:s,y:a,textAlign:l,left:c,top:u,right:h,bottom:d}=e._pointLabelItems[o],{backdropColor:p}=t;if(!V(p)){const e=Nt(t.backdropPadding);n.fillStyle=p,n.fillRect(c-e.left,u-e.top,h-c+e.width,d-u+e.height)}tt(n,e._pointLabels[o],s,a+r.lineHeight/2,r,{color:t.color,textAlign:l,textBaseline:"middle"})}}(e,r),o.display&&e.ticks.forEach(((t,n)=>{if(0!==n){a=e.getDistanceFromCenterForValue(t.value);const i=o.setContext(e.getContext(n-1));!function(e,t,n,i){const o=e.ctx,r=t.circular,{color:s,lineWidth:a}=t;!r&&!i||!s||!a||n<0||(o.save(),o.strokeStyle=s,o.lineWidth=a,o.setLineDash(t.borderDash),o.lineDashOffset=t.borderDashOffset,o.beginPath(),es(e,n,r,i),o.closePath(),o.stroke(),o.restore())}(e,i,a,r)}})),i.display){for(t.save(),s=e.getLabels().length-1;s>=0;s--){const o=i.setContext(e.getPointLabelContext(s)),{color:r,lineWidth:c}=o;c&&r&&(t.lineWidth=c,t.strokeStyle=r,t.setLineDash(o.borderDash),t.lineDashOffset=o.borderDashOffset,a=e.getDistanceFromCenterForValue(n.ticks.reverse?e.min:e.max),l=e.getPointPosition(s,a),t.beginPath(),t.moveTo(e.xCenter,e.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const e=this,t=e.ctx,n=e.options,i=n.ticks;if(!i.display)return;const o=e.getIndexAngle(0);let r,s;t.save(),t.translate(e.xCenter,e.yCenter),t.rotate(o),t.textAlign="center",t.textBaseline="middle",e.ticks.forEach(((o,a)=>{if(0===a&&!n.reverse)return;const l=i.setContext(e.getContext(a)),c=Bt(l.font);if(r=e.getDistanceFromCenterForValue(e.ticks[a].value),l.showLabelBackdrop){t.font=c.string,s=t.measureText(o.label).width,t.fillStyle=l.backdropColor;const e=Nt(l.backdropPadding);t.fillRect(-s/2-e.left,-r-c.size/2-e.top,s+e.width,c.size+e.height)}tt(t,o.label,0,-r,c,{color:l.color})})),t.restore()}drawTitle(){}}ns.id="radialLinear",ns.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ai.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5}},ns.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},ns.descriptors={angleLines:{_fallback:"grid"}};const is={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},os=Object.keys(is);function rs(e,t){return e-t}function ss(e,t){if(V(t))return null;const n=e._adapter,{parser:i,round:o,isoWeekday:r}=e._parseOpts;let s=t;return"function"==typeof i&&(s=i(s)),q(s)||(s="string"==typeof i?n.parse(s,i):n.parse(s)),null===s?null:(o&&(s="week"!==o||!$e(r)&&!0!==r?n.startOf(s,o):n.startOf(s,"isoWeek",r)),+s)}function as(e,t,n,i){const o=os.length;for(let r=os.indexOf(e);r<o-1;++r){const e=is[os[r]],o=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(o*e.size))<=i)return os[r]}return os[o-1]}function ls(e,t,n){if(n){if(n.length){const{lo:i,hi:o}=ot(n,t);e[n[i]>=t?n[i]:n[o]]=!0}}else e[t]=!0}function cs(e,t,n){const i=[],o={},r=t.length;let s,a;for(s=0;s<r;++s)a=t[s],o[a]=s,i.push({value:a,major:!1});return 0!==r&&n?function(e,t,n,i){const o=e._adapter,r=+o.startOf(t[0].value,i),s=t[t.length-1].value;let a,l;for(a=r;a<=s;a=+o.add(a,1,i))l=n[a],l>=0&&(t[l].major=!0);return t}(e,i,o,n):i}class us extends Oi{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t){const n=e.time||(e.time={}),i=this._adapter=new uo._date(e.adapters.date);re(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:ss(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this,t=e.options,n=e._adapter,i=t.time.unit||"day";let{min:o,max:r,minDefined:s,maxDefined:a}=e.getUserBounds();function l(e){s||isNaN(e.min)||(o=Math.min(o,e.min)),a||isNaN(e.max)||(r=Math.max(r,e.max))}s&&a||(l(e._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||l(e.getMinMax(!1))),o=q(o)&&!isNaN(o)?o:+n.startOf(Date.now(),i),r=q(r)&&!isNaN(r)?r:+n.endOf(Date.now(),i)+1,e.min=Math.min(o,r-1),e.max=Math.max(o+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this,t=e.options,n=t.time,i=t.ticks,o="labels"===i.source?e.getLabelTimestamps():e._generate();"ticks"===t.bounds&&o.length&&(e.min=e._userMin||o[0],e.max=e._userMax||o[o.length-1]);const r=e.min,s=at(o,r,e.max);return e._unit=n.unit||(i.autoSkip?as(n.minUnit,e.min,e.max,e._getLabelCapacity(r)):function(e,t,n,i,o){for(let r=os.length-1;r>=os.indexOf(n);r--){const n=os[r];if(is[n].common&&e._adapter.diff(o,i,n)>=t-1)return n}return os[n?os.indexOf(n):0]}(e,s.length,n.minUnit,e.min,e.max)),e._majorUnit=i.major.enabled&&"year"!==e._unit?function(e){for(let t=os.indexOf(e)+1,n=os.length;t<n;++t)if(is[os[t]].common)return os[t]}(e._unit):void 0,e.initOffsets(o),t.reverse&&s.reverse(),cs(e,s,e._majorUnit)}initOffsets(e){const t=this;let n,i,o=0,r=0;t.options.offset&&e.length&&(n=t.getDecimalForValue(e[0]),o=1===e.length?1-n:(t.getDecimalForValue(e[1])-n)/2,i=t.getDecimalForValue(e[e.length-1]),r=1===e.length?i:(i-t.getDecimalForValue(e[e.length-2]))/2);const s=e.length<3?.5:.25;o=We(o,0,s),r=We(r,0,s),t._offsets={start:o,end:r,factor:1/(o+1+r)}}_generate(){const e=this,t=e._adapter,n=e.min,i=e.max,o=e.options,r=o.time,s=r.unit||as(r.minUnit,n,i,e._getLabelCapacity(n)),a=Y(r.stepSize,1),l="week"===s&&r.isoWeekday,c=$e(l)||!0===l,u={};let h,d,p=n;if(c&&(p=+t.startOf(p,"isoWeek",l)),p=+t.startOf(p,c?"day":s),t.diff(i,n,s)>1e5*a)throw new Error(n+" and "+i+" are too far apart with stepSize of "+a+" "+s);const f="data"===o.ticks.source&&e.getDataTimestamps();for(h=p,d=0;h<i;h=+t.add(h,a,s),d++)ls(u,h,f);return h!==i&&"ticks"!==o.bounds&&1!==d||ls(u,h,f),Object.keys(u).sort(((e,t)=>e-t)).map((e=>+e))}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}_tickFormatFunction(e,t,n,i){const o=this,r=o.options,s=r.time.displayFormats,a=o._unit,l=o._majorUnit,c=a&&s[a],u=l&&s[l],h=n[t],d=l&&u&&h&&h.major,p=o._adapter.format(e,i||(d?u:c)),f=r.ticks.callback;return f?Q(f,[p,t,n],o):p}generateTickLabels(e){let t,n,i;for(t=0,n=e.length;t<n;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){const t=this;return null===e?NaN:(e-t.min)/(t.max-t.min)}getPixelForValue(e){const t=this,n=t._offsets,i=t.getDecimalForValue(e);return t.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(e){const t=this,n=t._offsets,i=t.getDecimalForPixel(e)/n.factor-n.end;return t.min+i*(t.max-t.min)}_getLabelSize(e){const t=this,n=t.options.ticks,i=t.ctx.measureText(e).width,o=Ie(t.isHorizontal()?n.maxRotation:n.minRotation),r=Math.cos(o),s=Math.sin(o),a=t._resolveTickFontOptions(0).size;return{w:i*r+a*s,h:i*s+a*r}}_getLabelCapacity(e){const t=this,n=t.options.time,i=n.displayFormats,o=i[n.unit]||i.millisecond,r=t._tickFormatFunction(e,0,cs(t,[e],t._majorUnit),o),s=t._getLabelSize(r),a=Math.floor(t.isHorizontal()?t.width/s.w:t.height/s.h)-1;return a>0?a:1}getDataTimestamps(){const e=this;let t,n,i=e._cache.data||[];if(i.length)return i;const o=e.getMatchingVisibleMetas();if(e._normalized&&o.length)return e._cache.data=o[0].controller.getAllParsedValues(e);for(t=0,n=o.length;t<n;++t)i=i.concat(o[t].controller.getAllParsedValues(e));return e._cache.data=e.normalize(i)}getLabelTimestamps(){const e=this,t=e._cache.labels||[];let n,i;if(t.length)return t;const o=e.getLabels();for(n=0,i=o.length;n<i;++n)t.push(ss(e,o[n]));return e._cache.labels=e._normalized?t:e.normalize(t)}normalize(e){return ht(e.sort(rs))}}function hs(e,t,n){let i,o,r,s,a=0,l=e.length-1;n?(t>=e[a].pos&&t<=e[l].pos&&({lo:a,hi:l}=rt(e,"pos",t)),({pos:i,time:r}=e[a]),({pos:o,time:s}=e[l])):(t>=e[a].time&&t<=e[l].time&&({lo:a,hi:l}=rt(e,"time",t)),({time:i,pos:r}=e[a]),({time:o,pos:s}=e[l]));const c=o-i;return c?r+(s-r)*(t-i)/c:r}us.id="time",us.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};class ds extends us{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this,t=e._getTimestampsForTable(),n=e._table=e.buildLookupTable(t);e._minPos=hs(n,e.min),e._tableRange=hs(n,e.max)-e._minPos,super.initOffsets(t)}buildLookupTable(e){const{min:t,max:n}=this,i=[],o=[];let r,s,a,l,c;for(r=0,s=e.length;r<s;++r)l=e[r],l>=t&&l<=n&&i.push(l);if(i.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(r=0,s=i.length;r<s;++r)c=i[r+1],a=i[r-1],l=i[r],Math.round((c+a)/2)!==l&&o.push({time:l,pos:r/(s-1)});return o}_getTimestampsForTable(){const e=this;let t=e._cache.all||[];if(t.length)return t;const n=e.getDataTimestamps(),i=e.getLabelTimestamps();return t=n.length&&i.length?e.normalize(n.concat(i)):n.length?n:i,t=e._cache.all=t,t}getDecimalForValue(e){return(hs(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this,n=t._offsets,i=t.getDecimalForPixel(e)/n.factor-n.end;return hs(t._table,i*t._tableRange+t._minPos,!0)}}ds.id="timeseries",ds.defaults=us.defaults;var ps=Object.freeze({__proto__:null,CategoryScale:Wr,LinearScale:Gr,LogarithmicScale:qr,RadialLinearScale:ns,TimeScale:us,TimeSeriesScale:ds});return ro.register(Mo,ps,Qo,jr),ro.helpers={...Wn},ro._adapters=uo,ro.Animation=ci,ro.Animations=hi,ro.animator=s,ro.controllers=Fi.controllers.items,ro.DatasetController=Si,ro.Element=Ci,ro.elements=Qo,ro.Interaction=Lt,ro.layouts=en,ro.platforms=si,ro.Scale=Oi,ro.Ticks=Ai,Object.assign(ro,Mo,ps,Qo,jr,si),ro.Chart=ro,"undefined"!=typeof window&&(window.Chart=ro),ro})),define("render/graph",["toxilibs/extlibs/chart-3.5.0"],(function(e){function t(t){!function(e,{title:t="Graph",data:n=[],function:i,maxValue:o,type:r,limit:s,height:a=200,width:l=350}){e.title=t,e.data=n,e.maxX=o,e.type=r,e.limit=s,e.height=a,e.width=l,i&&(e.data=i)}(this,t);let n=t.canvas[0].getContext("2d"),r=function({limit:e,xLabel:t,yLabel:n,beginAtZero:o=!0,displayLegend:r=!0}){let s="rgba(98, 104, 110, 0.7)",a="#bbc7d2";return{animation:!1,scales:{x:{ticks:{maxRotation:e?0:50,color:a,callback:i},grid:{color:s,zeroLineColor:s},title:{display:"string"==typeof t,text:t,color:a}},y:{beginAtZero:o,ticks:{color:a},grid:{color:s,zeroLineColor:s},title:{display:"string"==typeof n,text:n,color:a}}},plugins:{legend:{display:r,labels:{color:a}}}}}(t);"function"==typeof this.data&&function(e,t,n){e.data=function(e,{xMin:t=0,xMax:n=10,steps:i=100}){let o=[],r=(n-t)/i;for(let i=t;i<n;i+=r)o.push({x:i,y:e(i)});return o}(e.data,n),e.type=e.type||"line","line"===e.type&&(t.pointRadius=0);t.scales.x.grid.zeroLineColor="#FA0",t.scales.y.grid.zeroLineColor="#FA0";let i=t.scales.x.grid.color;function o(e){return 0===e.tick.value?"#FA0":i}t.scales.x.grid.color=o,t.scales.y.grid.color=o}(this,r,t);let s="line"===this.type,a="number"==typeof this.data[0];if(this.dataOptions={},"bar"===this.type){if(!a)throw new Error("Bar charts must have data formatted like : [23, 2, 4.5, 90, ...]");this.chartType="bar"}else a?(this.chartType="line",this.dataOptions.showLine=s):(this.chartType="scatter",this.dataOptions.showLine=s);r.maintainAspectRatio=!1,this.chart=new e(n,{type:this.chartType,data:o(this,this.dataOptions),options:r}),this.resize()}function n(e,t){let n=e[t];return"number"==typeof n?t:n.x}function i(e,t,n){if(n.length<3)return e;if("string"!=typeof n[0]&&0!==n[0]){let i=n[2].value-n[1].value;if(0===t&&e%i!=0)return"";if(t===n.length-1&&e%i!=0)return""}return e}function o(e,t=e.dataOptions){let{chartType:n}=e;return"bar"===n?function({data:e}){let t,n,i;"number"==typeof e[0]?(t=r(e),n=e,i="#FFF"):(t=[],n=[],i=[],e.forEach((function({label:e,value:o,backgroundColor:r="#FFF"}){t.push(e),n.push(o),i.push(r)})));return{labels:t,datasets:[{data:n,backgroundColor:i}]}}(e):"scatter"===n?function(e,{showLine:t}={}){let{data:n,title:i}=e;return{datasets:[{label:i,showLine:t,data:n,borderColor:"#FFF",backgroundColor:"rgba(255, 255, 255, 0.3)",lineTension:0}]}}(e,t):"line"===n?function(e,{showLine:t}={}){let{data:n,title:i,labels:o}=e;return{labels:o||r(n),datasets:[{label:i,data:n,showLine:t,borderColor:"#FFF",backgroundColor:"rgba(255, 255, 255, 0.3)",lineTension:0}]}}(e,t):null}function r(e){let t=[];for(let n=0;n<e.length;n++)t.push(n);return t}return t.prototype.resize=function({height:e=this.height,width:t=this.width}={}){this.height=e,this.width=t;let{style:n}=this.chart.canvas.parentNode;n.height=e,n.width=t},t.prototype.addValue=function(e,{decrementation:t}={}){let{chart:n}=this;var i,r;t&&(i=this.data,r=t,i.map((e=>(e.x-=r,e)))),this.data.push(e),this.limit&&this.data.length>this.limit&&(this.data=this.data.splice(this.data.length-this.limit)),n.data=o(this),n.update()},t.prototype.decrementValues=function(e){let{chart:t}=this;const i=e.x;e.x=0,this.data.map((function(e){return e.x-=i,e})),this.data.push(e),this.limit&&this.data.length>this.limit&&(this.data=this.data.splice(this.data.length-this.limit),t.options.scales.x.min=n(this.data,0)),t.data=o(this),t.options.scales.x.max=n(this.data,this.data.length-1),t.update()},t})),define("render/graph_api",["jquery","toxilibs/object_utils","./graph"],(function(e,t,n){const{clone:i}=t;return function(t,o){function r(t){t=i(t);const r=e("<canvas>");t.content=r;const s=o.addBox(t);t.canvas=r,"title"in t||(t.displayLegend=!1);return function(e,t){let n={update:function(n){!function(e,t,n){n.title&&(e.title=n.title);t.update(n)}(e,t,n)},addValue:function(t,n){e.addValue(t,n)},resize:function(t){e.resize(t)}};return t.addValue=n.addValue,t.resize=n.resize,t.updateGraph=n.update,t}(new n(t),s)}return{addGraph:r,addTimeGraph:function(e){let t=r(e),n=t.addValue,i=Date.now(),o=0,s=0;return t.addValue=function(e){o=(Date.now()-i)/1e3;let t=o-s;s=o,n({x:0,y:e},{decrementation:t})},t}}}}));var getJasmineRequireObj=function(e){var t;function n(){return t}return"undefined"!=typeof module&&module.exports&&"undefined"!=typeof exports?(e="undefined"!=typeof global?global:{},t=exports):("undefined"!=typeof window&&"function"==typeof window.toString&&"[object GjsGlobal]"===window.toString()&&(e=window),t=e.jasmineRequire={}),n().core=function(t){var n={};return t.base(n,e),n.util=t.util(n),n.errors=t.errors(),n.formatErrorMsg=t.formatErrorMsg(),n.Any=t.Any(n),n.Anything=t.Anything(n),n.CallTracker=t.CallTracker(n),n.MockDate=t.MockDate(n),n.getClearStack=t.clearStack(n),n.Clock=t.Clock(),n.DelayedFunctionScheduler=t.DelayedFunctionScheduler(n),n.Deprecator=t.Deprecator(n),n.Env=t.Env(n),n.StackTrace=t.StackTrace(n),n.ExceptionFormatter=t.ExceptionFormatter(n),n.ExpectationFilterChain=t.ExpectationFilterChain(),n.Expector=t.Expector(n),n.Expectation=t.Expectation(n),n.buildExpectationResult=t.buildExpectationResult(n),n.JsApiReporter=t.JsApiReporter(n),n.makePrettyPrinter=t.makePrettyPrinter(n),n.basicPrettyPrinter_=n.makePrettyPrinter(),n.MatchersUtil=t.MatchersUtil(n),n.ObjectContaining=t.ObjectContaining(n),n.ArrayContaining=t.ArrayContaining(n),n.ArrayWithExactContents=t.ArrayWithExactContents(n),n.MapContaining=t.MapContaining(n),n.SetContaining=t.SetContaining(n),n.QueueRunner=t.QueueRunner(n),n.NeverSkipPolicy=t.NeverSkipPolicy(n),n.SkipAfterBeforeAllErrorPolicy=t.SkipAfterBeforeAllErrorPolicy(n),n.CompleteOnFirstErrorSkipPolicy=t.CompleteOnFirstErrorSkipPolicy(n),n.ReportDispatcher=t.ReportDispatcher(n),n.Spec=t.Spec(n),n.Spy=t.Spy(n),n.SpyFactory=t.SpyFactory(n),n.SpyRegistry=t.SpyRegistry(n),n.SpyStrategy=t.SpyStrategy(n),n.StringMatching=t.StringMatching(n),n.StringContaining=t.StringContaining(n),n.UserContext=t.UserContext(n),n.Suite=t.Suite(n),n.Timer=t.Timer(),n.TreeProcessor=t.TreeProcessor(),n.version=t.version(),n.Order=t.Order(),n.DiffBuilder=t.DiffBuilder(n),n.NullDiffBuilder=t.NullDiffBuilder(n),n.ObjectPath=t.ObjectPath(n),n.MismatchTree=t.MismatchTree(n),n.GlobalErrors=t.GlobalErrors(n),n.Truthy=t.Truthy(n),n.Falsy=t.Falsy(n),n.Empty=t.Empty(n),n.NotEmpty=t.NotEmpty(n),n.Is=t.Is(n),n.matchers=t.requireMatchers(t,n),n.asyncMatchers=t.requireAsyncMatchers(t,n),n},n}(this);getJasmineRequireObj().requireMatchers=function(e,t){for(var n=["nothing","toBe","toBeCloseTo","toBeDefined","toBeInstanceOf","toBeFalse","toBeFalsy","toBeGreaterThan","toBeGreaterThanOrEqual","toBeLessThan","toBeLessThanOrEqual","toBeNaN","toBeNegativeInfinity","toBeNull","toBePositiveInfinity","toBeTrue","toBeTruthy","toBeUndefined","toContain","toEqual","toHaveSize","toHaveBeenCalled","toHaveBeenCalledBefore","toHaveBeenCalledOnceWith","toHaveBeenCalledTimes","toHaveBeenCalledWith","toHaveClass","toHaveSpyInteractions","toMatch","toThrow","toThrowError","toThrowMatching"],i={},o=0;o<n.length;o++){var r=n[o];i[r]=e[r](t)}return i},getJasmineRequireObj().base=function(e,t){e.unimplementedMethod_=function(){throw new Error("unimplemented method")},e.MAX_PRETTY_PRINT_DEPTH=8,e.MAX_PRETTY_PRINT_ARRAY_LENGTH=50,e.MAX_PRETTY_PRINT_CHARS=1e3;var n=5e3;Object.defineProperty(e,"DEFAULT_TIMEOUT_INTERVAL",{get:function(){return n},set:function(t){e.util.validateTimeout(t,"jasmine.DEFAULT_TIMEOUT_INTERVAL"),n=t}}),e.getGlobal=function(){return t},e.getEnv=function(t){return e.currentEnv_=e.currentEnv_||new e.Env(t)},e.isArray_=function(t){return e.isA_("Array",t)},e.isObject_=function(t){return!e.util.isUndefined(t)&&null!==t&&e.isA_("Object",t)},e.isString_=function(t){return e.isA_("String",t)},e.isNumber_=function(t){return e.isA_("Number",t)},e.isFunction_=function(t){return e.isA_("Function",t)},e.isAsyncFunction_=function(t){return e.isA_("AsyncFunction",t)},e.isGeneratorFunction_=function(t){return e.isA_("GeneratorFunction",t)},e.isTypedArray_=function(t){return e.isA_("Float32Array",t)||e.isA_("Float64Array",t)||e.isA_("Int16Array",t)||e.isA_("Int32Array",t)||e.isA_("Int8Array",t)||e.isA_("Uint16Array",t)||e.isA_("Uint32Array",t)||e.isA_("Uint8Array",t)||e.isA_("Uint8ClampedArray",t)},e.isA_=function(t,n){return e.getType_(n)==="[object "+t+"]"},e.isError_=function(e){return!!e&&(e instanceof Error||"string"==typeof e.stack&&"string"==typeof e.message)},e.isAsymmetricEqualityTester_=function(t){return!!t&&e.isA_("Function",t.asymmetricMatch)},e.getType_=function(e){return Object.prototype.toString.apply(e)},e.isDomNode=function(e){return void 0!==t.Node?e instanceof t.Node:null!==e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},e.isMap=function(e){return null!=e&&e.constructor===t.Map},e.isSet=function(e){return null!=e&&e.constructor===t.Set},e.isWeakMap=function(e){return null!=e&&e.constructor===t.WeakMap},e.isURL=function(e){return null!=e&&e.constructor===t.URL},e.isIterable_=function(e){return e&&!!e[Symbol.iterator]},e.isDataView=function(e){return null!=e&&e.constructor===t.DataView},e.isPromise=function(e){return!!e&&e.constructor===t.Promise},e.isPromiseLike=function(t){return!!t&&e.isFunction_(t.then)},e.fnNameFor=function(e){if(e.name)return e.name;var t=e.toString().match(/^\s*function\s*(\w+)\s*\(/)||e.toString().match(/^\s*\[object\s*(\w+)Constructor\]/);return t?t[1]:"<anonymous>"},e.isPending_=function(e){var t={};return Promise.race([e,Promise.resolve(t)]).then((function(e){return e===t}),(function(){return!1}))},e.any=function(t){return new e.Any(t)},e.anything=function(){return new e.Anything},e.truthy=function(){return new e.Truthy},e.falsy=function(){return new e.Falsy},e.empty=function(){return new e.Empty},e.is=function(t){return new e.Is(t)},e.notEmpty=function(){return new e.NotEmpty},e.objectContaining=function(t){return new e.ObjectContaining(t)},e.stringMatching=function(t){return new e.StringMatching(t)},e.stringContaining=function(t){return new e.StringContaining(t)},e.arrayContaining=function(t){return new e.ArrayContaining(t)},e.arrayWithExactContents=function(t){return new e.ArrayWithExactContents(t)},e.mapContaining=function(t){return new e.MapContaining(t)},e.setContaining=function(t){return new e.SetContaining(t)},e.isSpy=function(t){return!!t&&(t.and instanceof e.SpyStrategy&&t.calls instanceof e.CallTracker)},e.debugLog=function(t){e.getEnv().debugLog(t)}},getJasmineRequireObj().util=function(e){var t,n={};function i(){}return n.inherit=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},n.argsToArray=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},n.isUndefined=function(e){return void 0===e},n.arrayContains=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},n.clone=function(e){if("[object Array]"===Object.prototype.toString.apply(e))return e.slice();var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},n.cloneArgs=function(t){for(var n=[],i=e.util.argsToArray(t),o=0;o<i.length;o++){var r=Object.prototype.toString.apply(i[o]);!i[o]||r.match(/^\[object (Boolean|String|RegExp|Number)/)?n.push(i[o]):"[object Date]"===r?n.push(new Date(i[o].valueOf())):n.push(e.util.clone(i[o]))}return n},n.getPropertyDescriptor=function(e,t){var n,i=e;do{n=Object.getOwnPropertyDescriptor(i,t),i=Object.getPrototypeOf(i)}while(!n&&i);return n},n.has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.errorWithStack=function(){return new Error},n.jasmineFile=function(){return t||(t=new e.StackTrace(n.errorWithStack()).frames[2].file),t},i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,n.validateTimeout=function(e,t){var n=2147483647;if(e>n)throw new Error((t||"Timeout value")+" cannot be greater than "+n)},n},getJasmineRequireObj().Spec=function(e){function t(t){this.expectationFactory=t.expectationFactory,this.asyncExpectationFactory=t.asyncExpectationFactory,this.resultCallback=t.resultCallback||function(){},this.id=t.id,this.description=t.description||"",this.queueableFn=t.queueableFn,this.beforeAndAfterFns=t.beforeAndAfterFns||function(){return{befores:[],afters:[]}},this.userContext=t.userContext||function(){return{}},this.onStart=t.onStart||function(){},this.autoCleanClosures=void 0===t.autoCleanClosures||!!t.autoCleanClosures,this.getSpecName=t.getSpecName||function(){return""},this.onLateError=t.onLateError||function(){},this.queueRunnerFactory=t.queueRunnerFactory||function(){},this.catchingExceptions=t.catchingExceptions||function(){return!0},this.throwOnExpectationFailure=!!t.throwOnExpectationFailure,this.timer=t.timer||new e.Timer,this.queueableFn.fn||this.exclude(),this.result={id:this.id,description:this.description,fullName:this.getFullName(),failedExpectations:[],passedExpectations:[],deprecationWarnings:[],pendingReason:"",duration:null,properties:null,debugLogs:null},this.reportedDone=!1}t.prototype.addExpectationResult=function(t,n,i){const o=e.buildExpectationResult(n);if(t)this.result.passedExpectations.push(o);else if(this.reportedDone?this.onLateError(o):this.result.failedExpectations.push(o),this.throwOnExpectationFailure&&!i)throw new e.errors.ExpectationFailed},t.prototype.setSpecProperty=function(e,t){this.result.properties=this.result.properties||{},this.result.properties[e]=t},t.prototype.expect=function(e){return this.expectationFactory(e,this)},t.prototype.expectAsync=function(e){return this.asyncExpectationFactory(e,this)},t.prototype.execute=function(t,n,i){var o=this,r={fn:function(e){o.timer.start(),o.onStart(o,e)}},s={fn:function(e){o.autoCleanClosures&&(o.queueableFn.fn=null),o.result.status=o.status(n,i),o.result.duration=o.timer.elapsed(),"failed"!==o.result.status&&(o.result.debugLogs=null),o.resultCallback(o.result,e)},type:"specCleanup"},a=this.beforeAndAfterFns(),l={isLeaf:!0,queueableFns:[...a.befores,this.queueableFn,...a.afters],onException:function(){o.handleException.apply(o,arguments)},onMultipleDone:function(){o.onLateError(new Error("An asynchronous spec, beforeEach, or afterEach function called its 'done' callback more than once.\n(in spec: "+o.getFullName()+")"))},onComplete:function(){"failed"===o.result.status?t(new e.StopExecutionError("spec failed")):t()},userContext:this.userContext(),runnableName:this.getFullName.bind(this)};(this.markedPending||!0===n)&&(l.queueableFns=[]),l.queueableFns.unshift(r),l.queueableFns.push(s),this.queueRunnerFactory(l)},t.prototype.reset=function(){this.result={id:this.id,description:this.description,fullName:this.getFullName(),failedExpectations:[],passedExpectations:[],deprecationWarnings:[],pendingReason:this.excludeMessage,duration:null,properties:null,debugLogs:null},this.markedPending=this.markedExcluding,this.reportedDone=!1},t.prototype.handleException=function(i){t.isPendingSpecException(i)?this.pend(n(i)):i instanceof e.errors.ExpectationFailed||this.addExpectationResult(!1,{matcherName:"",passed:!1,expected:"",actual:"",error:i},!0)},t.prototype.pend=function(e){this.markedPending=!0,e&&(this.result.pendingReason=e)},t.prototype.exclude=function(e){this.markedExcluding=!0,this.message&&(this.excludeMessage=e),this.pend(e)},t.prototype.getResult=function(){return this.result.status=this.status(),this.result},t.prototype.status=function(e,t){return!0===e?"excluded":this.markedPending?"pending":this.result.failedExpectations.length>0||t&&this.result.failedExpectations.length+this.result.passedExpectations.length===0?"failed":"passed"},t.prototype.getFullName=function(){return this.getSpecName(this)},t.prototype.addDeprecationWarning=function(t){"string"==typeof t&&(t={message:t}),this.result.deprecationWarnings.push(e.buildExpectationResult(t))},t.prototype.debugLog=function(e){this.result.debugLogs||(this.result.debugLogs=[]),this.result.debugLogs.push({message:e,timestamp:this.timer.elapsed()})};var n=function(e){var n=e.toString(),i=n.indexOf(t.pendingSpecExceptionMessage)+t.pendingSpecExceptionMessage.length;return n.slice(i)};return t.pendingSpecExceptionMessage="=> marked Pending",t.isPendingSpecException=function(e){return!(!e||!e.toString||-1===e.toString().indexOf(t.pendingSpecExceptionMessage))},Object.defineProperty(t.prototype,"metadata",{get:function(){return this.metadata_||(this.metadata_={id:this.id,description:this.description,getFullName:this.getFullName.bind(this)}),this.metadata_}}),t},getJasmineRequireObj().Order=function(){return function(e){this.random=!("random"in e)||e.random;var t=this.seed=e.seed||String(Math.random()).slice(-5);function n(e){var t,n;for(t=n=0;n<e.length;++n)t+=e.charCodeAt(n),t+=t<<10,t^=t>>6;return t+=t<<3,t^=t>>11,t+=t<<15}this.sort=this.random?function(e){var i=e.slice();return i.sort((function(e,i){return n(t+e.id)-n(t+i.id)})),i}:function(e){return e}}},getJasmineRequireObj().Env=function(e){return function(t){var n=this,i=(t=t||{}).global||e.getGlobal(),o=0,r=i.setTimeout,s=i.clearTimeout,a=e.getClearStack(i);this.clock=new e.Clock(i,(function(){return new e.DelayedFunctionScheduler}),new e.MockDate(i));var l={},c=null,u=[],h=null,d=!1,p={random:!0,seed:null,stopOnSpecFailure:!1,failSpecWithNoExpectations:!1,stopSpecOnExpectationFailure:!1,specFilter:function(){return!0},hideDisabled:!1,autoCleanClosures:!0,verboseDeprecations:!1},f=function(){return u[u.length-1]},g=function(){return c||f()},m=null,y=function(){m||(m=new e.GlobalErrors).install()};t.suppressLoadErrors||(y(),m.pushListener((function(e,t,n,i,o){L.result.failedExpectations.push({passed:!1,globalErrorType:"load",message:e,stack:o&&o.stack,filename:t,lineno:n})}))),this.configure=function(e){["random","failSpecWithNoExpectations","hideDisabled","stopOnSpecFailure","stopSpecOnExpectationFailure","autoCleanClosures"].forEach((function(t){void 0!==e[t]&&(p[t]=!!e[t])})),e.specFilter&&(p.specFilter=e.specFilter),void 0!==e.seed&&(p.seed=e.seed),e.hasOwnProperty("verboseDeprecations")&&(p.verboseDeprecations=e.verboseDeprecations,R.verboseDeprecations(p.verboseDeprecations))},this.configuration=function(){var e={};for(var t in p)e[t]=p[t];return e},this.setDefaultSpyStrategy=function(e){if(!g())throw new Error("Default spy strategy must be set in a before function or a spec");l[g().id].defaultStrategyFn=e},this.addSpyStrategy=function(e,t){if(!g())throw new Error("Custom spy strategies must be added in a before function or a spec");l[g().id].customSpyStrategies[e]=t},this.addCustomEqualityTester=function(e){if(!g())throw new Error("Custom Equalities must be added in a before function or a spec");l[g().id].customEqualityTesters.push(e)},this.addMatchers=function(e){if(!g())throw new Error("Matchers must be added in a before function or a spec");var t=l[g().id].customMatchers;for(var n in e)t[n]=e[n]},this.addAsyncMatchers=function(e){if(!g())throw new Error("Async Matchers must be added in a before function or a spec");var t=l[g().id].customAsyncMatchers;for(var n in e)t[n]=e[n]},this.addCustomObjectFormatter=function(e){if(!g())throw new Error("Custom object formatters must be added in a before function or a spec");l[g().id].customObjectFormatters.push(e)},e.Expectation.addCoreMatchers(e.matchers),e.Expectation.addAsyncCoreMatchers(e.asyncMatchers);var v=0,b=0,x=function(){return"suite"+b++},w=function(){var t=l[g().id].customObjectFormatters;return e.makePrettyPrinter(t)},_=function(){const t=g();if(t){const n=l[t.id].customEqualityTesters;return new e.MatchersUtil({customTesters:n,pp:w()})}return new e.MatchersUtil({pp:e.basicPrettyPrinter_})};const S=function(t,n){return e.Expectation.factory({matchersUtil:_(),customMatchers:l[n.id].customMatchers,actual:t,addExpectationResult:function(e,t){return n.addExpectationResult(e,t)}})};function C(t){!function(e){for(let t=g();t;t=t.parentSuite)if(!t.reportedDone)return t===L&&(e.globalErrorType="lateError"),void t.result.failedExpectations.push(e);console.error("Jasmine received a result after the suite finished:"),console.error(e)}(void 0!==t.matcherName&&void 0!==t.passed?t:e.buildExpectationResult({error:t,passed:!1,matcherName:"",expected:"",actual:""}))}const k=function(t,n,i){return e.Expectation.asyncFactory({matchersUtil:_(),customAsyncMatchers:l[n.id].customAsyncMatchers,actual:t,addExpectationResult:function(e,t){g()!==n&&function(e,t,n){var i={};Object.keys(n).forEach((function(e){i[e]=n[e]})),i.passed=!1,i.globalErrorType="lateExpectation",i.message=t+' "'+e.getFullName()+'" ran a "'+n.matcherName+'" expectation after it finished.\n',n.message&&(i.message+='Message: "'+n.message+'"\n'),i.message+="1. Did you forget to return or await the result of expectAsync?\n2. Was done() invoked before an async operation completed?\n3. Did an expectation follow a call to done()?",L.result.failedExpectations.push(i)}(n,i,t);return n.addExpectationResult(e,t)}})},A=function(e,t){return k(e,t,"Suite")},M=function(e,t){return k(e,t,"Spec")};var T=function(t,n){var i={spies:[],customEqualityTesters:[],customMatchers:{},customAsyncMatchers:{},customSpyStrategies:{},defaultStrategyFn:void 0,customObjectFormatters:[]};l[n]&&(i.customEqualityTesters=e.util.clone(l[n].customEqualityTesters),i.customMatchers=e.util.clone(l[n].customMatchers),i.customAsyncMatchers=e.util.clone(l[n].customAsyncMatchers),i.customObjectFormatters=e.util.clone(l[n].customObjectFormatters),i.customSpyStrategies=e.util.clone(l[n].customSpyStrategies),i.defaultStrategyFn=l[n].defaultStrategyFn),l[t]=i},E=function(e){O.clearSpies(),delete l[e]};this.deprecated=function(e,t){var n=g()||L;R.addDeprecationWarning(n,e,t)};var $=function(t,i){t.isLeaf?t.SkipPolicy=e.CompleteOnFirstErrorSkipPolicy:t.isReporter?t.SkipPolicy=e.NeverSkipPolicy:p.stopOnSpecFailure?t.SkipPolicy=e.CompleteOnFirstErrorSkipPolicy:t.SkipPolicy=e.SkipAfterBeforeAllErrorPolicy,t.clearStack=t.clearStack||a,t.timeout={setTimeout:r,clearTimeout:s},t.fail=n.fail,t.globalErrors=m,t.onException=t.onException||function(e){(g()||L).handleException(e)},t.deprecated=n.deprecated,new e.QueueRunner(t).execute(i)},L=new e.Suite({id:x(),description:"Jasmine__TopLevel__Suite",expectationFactory:S,asyncExpectationFactory:A,autoCleanClosures:p.autoCleanClosures,onLateError:C}),R=new e.Deprecator(L);h=L,this.topSuite=function(){return L.metadata};var P=new e.ReportDispatcher(["jasmineStarted","jasmineDone","suiteStarted","suiteDone","specStarted","specDone"],$,C);this.execute=function(t,n){this._executedBefore&&L.reset(),this._executedBefore=!0,T(L.id),y(),t||(t=j.length?j:[L.id]);var i=new e.Order({random:p.random,seed:p.seed}),r=new e.TreeProcessor({tree:L,runnableIds:t,queueRunnerFactory:$,failSpecWithNoExpectations:p.failSpecWithNoExpectations,nodeStart:function(e,t){u.push(e),T(e.id,e.parentSuite.id),P.suiteStarted(e.result,t),e.startTimer()},nodeComplete:function(e,t,n){if(e!==f())throw new Error("Tried to complete the wrong suite");E(e.id),u.pop(),"failed"===t.status&&(d=!0),e.endTimer(),e.hadBeforeAllFailure?a(e).then((function(){G(e,t,n)})):G(e,t,n)},orderChildren:function(e){return i.sort(e.children)},excludeNode:function(e){return!p.specFilter(e)}});if(!r.processTree().valid)throw new Error("Invalid order: would cause a beforeAll or afterAll to be run multiple times");var s=new e.Timer;return s.start(),new Promise((function(e){var t;t=function(t){n&&n(),e(t)},P.jasmineStarted({totalSpecsDefined:o,order:i},(function(){u.push(L),r.execute((function(){!async function(){var e,n;L.hadBeforeAllFailure&&await a(L),E(L.id),u.pop(),d||L.result.failedExpectations.length>0?e="failed":j.length>0?(e="incomplete",n="fit() or fdescribe() was found"):0===o?(e="incomplete",n="No specs found"):e="passed";const r={overallStatus:e,totalTime:s.elapsed(),incompleteReason:n,order:i,failedExpectations:L.result.failedExpectations,deprecationWarnings:L.result.deprecationWarnings};L.reportedDone=!0,P.jasmineDone(r,(function(){t(r)}))}()}))}))}));async function a(t){for(const n of t.children)n instanceof e.Suite?(await new Promise((function(e){P.suiteStarted(n.result,e)})),await a(n),n.result.status="passed",await new Promise((function(e){P.suiteDone(n.result,e)}))):(await new Promise((function(e){P.specStarted(n.result,e)})),n.addExpectationResult(!1,{passed:!1,message:"Not run because a beforeAll function failed. The beforeAll failure will be reported on the suite that caused it."},!0),n.result.status="failed",await new Promise((function(e){V(n,n.result,e)})))}},this.addReporter=function(e){P.addReporter(e)},this.provideFallbackReporter=function(e){P.provideFallbackReporter(e)},this.clearReporters=function(){P.clearReporters()};var I=new e.SpyFactory((function(){var e=g();return e?l[e.id].customSpyStrategies:{}}),(function(){var e=g();if(e)return l[e.id].defaultStrategyFn}),_),O=new e.SpyRegistry({currentSpies:function(){if(!g())throw new Error("Spies must be created in a before function or a spec");return l[g().id].spies},createSpy:function(e,t){return n.createSpy(e,t)}});this.allowRespy=function(e){O.allowRespy(e)},this.spyOn=function(){return O.spyOn.apply(O,arguments)},this.spyOnProperty=function(){return O.spyOnProperty.apply(O,arguments)},this.spyOnAllFunctions=function(){return O.spyOnAllFunctions.apply(O,arguments)},this.createSpy=function(t,n){return 1===arguments.length&&e.isFunction_(t)&&(t=(n=t).name),I.createSpy(t,n)},this.createSpyObj=function(e,t,n){return I.createSpyObj(e,t,n)};var D=function(t,n){if(!e.isFunction_(t))throw new Error(n+" expects a function argument; received "+e.getType_(t))},F=function(t,n){if(!e.isFunction_(t)&&!e.isAsyncFunction_(t))throw new Error(n+" expects a function argument; received "+e.getType_(t))};function N(e){var t=g();if(null!=t)throw new Error("'"+e+"' should only be used in 'describe' function")}var B=function(t){return new e.Suite({id:x(),description:t,parentSuite:h,timer:new e.Timer,expectationFactory:S,asyncExpectationFactory:A,throwOnExpectationFailure:p.stopSpecOnExpectationFailure,autoCleanClosures:p.autoCleanClosures,onLateError:C})};this.describe=function(e,t){N("describe"),D(t,"describe");var n=B(e);if(t.length>0)throw new Error("describe does not expect any arguments");if(h.markedExcluding&&n.exclude(),H(n,t),n.parentSuite&&!n.children.length)throw new Error("describe with no children (describe() or it()): "+n.getFullName());return n.metadata},this.xdescribe=function(e,t){N("xdescribe"),D(t,"xdescribe");var n=B(e);return n.exclude(),H(n,t),n.metadata};var j=[];function H(e,t){var n=h;n.addChild(e),h=e;var i=null;try{t()}catch(e){i=e}i&&e.handleException(i),h=n}function W(){var e=function(e){for(;e;){if(e.isFocused)return e.id;e=e.parentSuite}return null}(h);if(e)for(var t=0;t<j.length;t++)if(j[t]===e){j.splice(t,1);break}}this.fdescribe=function(e,t){N("fdescribe"),D(t,"fdescribe");var n=B(e);return n.isFocused=!0,j.push(n.id),W(),H(n,t),n.metadata};var z=function(t,n,i,r){o++;var s,a=new e.Spec({id:"spec"+v++,beforeAndAfterFns:(s=i,function(){for(var e=[],t=[],n=s;n;)e=e.concat(n.beforeFns),t=t.concat(n.afterFns),n=n.parentSuite;return{befores:e.reverse(),afters:t}}),expectationFactory:S,asyncExpectationFactory:M,onLateError:C,resultCallback:function(e,t){E(a.id),c=null,"failed"===e.status&&(d=!0);V(a,e,t)},getSpecName:function(e){return function(e,t){var n=[e.description],i=t.getFullName();return""!==i&&n.unshift(i),n.join(" ")}(e,i)},onStart:function(e,t){c=e,T(e.id,i.id),P.specStarted(e.result,t)},description:t,queueRunnerFactory:$,userContext:function(){return i.clonedSharedUserContext()},queueableFn:{fn:n,timeout:r||0},throwOnExpectationFailure:p.stopSpecOnExpectationFailure,autoCleanClosures:p.autoCleanClosures,timer:new e.Timer});return a};function V(e,t,n){e.reportedDone=!0,P.specDone(t,n)}function G(e,t,n){e.reportedDone=!0,P.suiteDone(t,n)}this.it_=function(t,n,i){N("it"),arguments.length>1&&void 0!==n&&F(n,"it"),i&&e.util.validateTimeout(i);var o=z(t,n,h,i);return h.markedExcluding&&o.exclude(),h.addChild(o),o},this.it=function(e,t,n){return this.it_(e,t,n).metadata},this.xit=function(e,t,n){N("xit"),arguments.length>1&&void 0!==t&&F(t,"xit");var i=this.it_.apply(this,arguments);return i.exclude("Temporarily disabled with xit"),i.metadata},this.fit=function(t,n,i){N("fit"),F(n,"fit"),i&&e.util.validateTimeout(i);var o=z(t,n,h,i);return h.addChild(o),j.push(o.id),W(),o.metadata},this.setSpecProperty=function(e,t){if(!g()||g()==f())throw new Error("'setSpecProperty' was used when there was no current spec");g().setSpecProperty(e,t)},this.setSuiteProperty=function(e,t){if(!f())throw new Error("'setSuiteProperty' was used when there was no current suite");f().setSuiteProperty(e,t)},this.debugLog=function(e){var t=g();if(!t||!t.debugLog)throw new Error("'debugLog' was called when there was no current spec");t.debugLog(e)},this.expect=function(e){if(!g())throw new Error("'expect' was used when there was no current spec, this could be because an asynchronous test timed out");return g().expect(e)},this.expectAsync=function(e){if(!g())throw new Error("'expectAsync' was used when there was no current spec, this could be because an asynchronous test timed out");return g().expectAsync(e)},this.beforeEach=function(t,n){N("beforeEach"),F(t,"beforeEach"),n&&e.util.validateTimeout(n),h.beforeEach({fn:t,timeout:n||0})},this.beforeAll=function(t,n){N("beforeAll"),F(t,"beforeAll"),n&&e.util.validateTimeout(n),h.beforeAll({fn:t,timeout:n||0})},this.afterEach=function(t,n){N("afterEach"),F(t,"afterEach"),n&&e.util.validateTimeout(n),t.isCleanup=!0,h.afterEach({fn:t,timeout:n||0})},this.afterAll=function(t,n){N("afterAll"),F(t,"afterAll"),n&&e.util.validateTimeout(n),h.afterAll({fn:t,timeout:n||0})},this.pending=function(t){var n=e.Spec.pendingSpecExceptionMessage;throw t&&(n+=t),n},this.fail=function(t){if(!g())throw new Error("'fail' was used when there was no current spec, this could be because an asynchronous test timed out");var n="Failed";if(t&&(n+=": ",t.message?n+=t.message:e.isString_(t)?n+=t:n+=w()(t)),g().addExpectationResult(!1,{matcherName:"",passed:!1,expected:"",actual:"",message:n,error:t&&t.message?t:null}),p.stopSpecOnExpectationFailure)throw new Error(n)},this.cleanup_=function(){m&&m.uninstall()}}},getJasmineRequireObj().JsApiReporter=function(e){return function(t){var n,i=t.timer||new e.Timer,o="loaded";this.started=!1,this.finished=!1,this.runDetails={},this.jasmineStarted=function(){this.started=!0,o="started",i.start()},this.jasmineDone=function(e){this.finished=!0,this.runDetails=e,n=i.elapsed(),o="done"},this.status=function(){return o};var r=[],s={};this.suiteStarted=function(e){s[e.id]=e},this.suiteDone=function(e){!function(e){r.push(e),s[e.id]=e}(e)},this.suiteResults=function(e,t){return r.slice(e,e+t)},this.suites=function(){return s};var a=[];this.specDone=function(e){a.push(e)},this.specResults=function(e,t){return a.slice(e,e+t)},this.specs=function(){return a},this.executionTime=function(){return n}}},getJasmineRequireObj().Any=function(e){function t(e){if(void 0===e)throw new TypeError("jasmine.any() expects to be passed a constructor function. Please pass one or use jasmine.anything() to match any object.");this.expectedObject=e}return t.prototype.asymmetricMatch=function(e){return this.expectedObject==String?"string"==typeof e||e instanceof String:this.expectedObject==Number?"number"==typeof e||e instanceof Number:this.expectedObject==Function?"function"==typeof e||e instanceof Function:this.expectedObject==Object?null!==e&&"object"==typeof e:this.expectedObject==Boolean?"boolean"==typeof e:"undefined"!=typeof Symbol&&this.expectedObject==Symbol?"symbol"==typeof e:e instanceof this.expectedObject},t.prototype.jasmineToString=function(){return"<jasmine.any("+e.fnNameFor(this.expectedObject)+")>"},t},getJasmineRequireObj().Anything=function(e){function t(){}return t.prototype.asymmetricMatch=function(t){return!e.util.isUndefined(t)&&null!==t},t.prototype.jasmineToString=function(){return"<jasmine.anything>"},t},getJasmineRequireObj().ArrayContaining=function(e){function t(e){this.sample=e}return t.prototype.asymmetricMatch=function(t,n){if(!e.isArray_(this.sample))throw new Error("You must provide an array to arrayContaining, not "+e.basicPrettyPrinter_(this.sample)+".");if(!e.isArray_(t)&&this.sample.length>0)return!1;for(var i=0;i<this.sample.length;i++){var o=this.sample[i];if(!n.contains(t,o))return!1}return!0},t.prototype.jasmineToString=function(e){return"<jasmine.arrayContaining("+e(this.sample)+")>"},t},getJasmineRequireObj().ArrayWithExactContents=function(e){function t(e){this.sample=e}return t.prototype.asymmetricMatch=function(t,n){if(!e.isArray_(this.sample))throw new Error("You must provide an array to arrayWithExactContents, not "+e.basicPrettyPrinter_(this.sample)+".");if(this.sample.length!==t.length)return!1;for(var i=0;i<this.sample.length;i++){var o=this.sample[i];if(!n.contains(t,o))return!1}return!0},t.prototype.jasmineToString=function(e){return"<jasmine.arrayWithExactContents("+e(this.sample)+")>"},t},getJasmineRequireObj().Empty=function(e){function t(){}return t.prototype.asymmetricMatch=function(t){return e.isString_(t)||e.isArray_(t)||e.isTypedArray_(t)?0===t.length:e.isMap(t)||e.isSet(t)?0===t.size:!!e.isObject_(t)&&0===Object.keys(t).length},t.prototype.jasmineToString=function(){return"<jasmine.empty>"},t},getJasmineRequireObj().Falsy=function(e){function t(){}return t.prototype.asymmetricMatch=function(e){return!e},t.prototype.jasmineToString=function(){return"<jasmine.falsy>"},t},getJasmineRequireObj().Is=function(e){return class{constructor(e){this.expected_=e}asymmetricMatch(e){return e===this.expected_}jasmineToString(e){return`<jasmine.is(${e(this.expected_)})>`}}},getJasmineRequireObj().MapContaining=function(e){function t(t){if(!e.isMap(t))throw new Error("You must provide a map to `mapContaining`, not "+e.basicPrettyPrinter_(t));this.sample=t}return t.prototype.asymmetricMatch=function(t,n){if(!e.isMap(t))return!1;for(const[e,o]of this.sample){var i=!1;for(const[r,s]of t)if(n.equals(r,e)&&n.equals(s,o)){i=!0;break}if(!i)return!1}return!0},t.prototype.jasmineToString=function(e){return"<jasmine.mapContaining("+e(this.sample)+")>"},t},getJasmineRequireObj().NotEmpty=function(e){function t(){}return t.prototype.asymmetricMatch=function(t){return e.isString_(t)||e.isArray_(t)||e.isTypedArray_(t)?0!==t.length:e.isMap(t)||e.isSet(t)?0!==t.size:!!e.isObject_(t)&&0!==Object.keys(t).length},t.prototype.jasmineToString=function(){return"<jasmine.notEmpty>"},t},getJasmineRequireObj().ObjectContaining=function(e){function t(e){this.sample=e}function n(e,t){return!(!e||"object"!=typeof e)&&(!!Object.prototype.hasOwnProperty.call(e,t)||n(Object.getPrototypeOf(e),t))}return t.prototype.asymmetricMatch=function(e,t){if("object"!=typeof this.sample)throw new Error("You must provide an object to objectContaining, not '"+this.sample+"'.");if("object"!=typeof e)return!1;for(var i in this.sample)if(!n(e,i)||!t.equals(this.sample[i],e[i]))return!1;return!0},t.prototype.valuesForDiff_=function(t,n){if(!e.isObject_(t))return{self:this.jasmineToString(n),other:t};var i={};return Object.keys(this.sample).forEach((function(e){i[e]=t[e]})),{self:this.sample,other:i}},t.prototype.jasmineToString=function(e){return"<jasmine.objectContaining("+e(this.sample)+")>"},t},getJasmineRequireObj().SetContaining=function(e){function t(t){if(!e.isSet(t))throw new Error("You must provide a set to `setContaining`, not "+e.basicPrettyPrinter_(t));this.sample=t}return t.prototype.asymmetricMatch=function(t,n){if(!e.isSet(t))return!1;for(const e of this.sample){var i=!1;for(const o of t)if(n.equals(o,e)){i=!0;break}if(!i)return!1}return!0},t.prototype.jasmineToString=function(e){return"<jasmine.setContaining("+e(this.sample)+")>"},t},getJasmineRequireObj().StringContaining=function(e){function t(t){if(!e.isString_(t))throw new Error("Expected is not a String");this.expected=t}return t.prototype.asymmetricMatch=function(t){return!!e.isString_(t)&&-1!==t.indexOf(this.expected)},t.prototype.jasmineToString=function(){return'<jasmine.stringContaining("'+this.expected+'")>'},t},getJasmineRequireObj().StringMatching=function(e){function t(t){if(!e.isString_(t)&&!e.isA_("RegExp",t))throw new Error("Expected is not a String or a RegExp");this.regexp=new RegExp(t)}return t.prototype.asymmetricMatch=function(e){return this.regexp.test(e)},t.prototype.jasmineToString=function(){return"<jasmine.stringMatching("+this.regexp+")>"},t},getJasmineRequireObj().Truthy=function(e){function t(){}return t.prototype.asymmetricMatch=function(e){return!!e},t.prototype.jasmineToString=function(){return"<jasmine.truthy>"},t},getJasmineRequireObj().buildExpectationResult=function(e){return function(t){const n=new e.ExceptionFormatter,i={matcherName:t.matcherName,message:o(),stack:t.omitStackTrace?"":function(){if(t.passed)return"";let e=t.error;if(!e)if(t.errorForStack)e=t.errorForStack;else if(t.stack)e=t;else try{throw new Error(o())}catch(t){e=t}return n.stack(e,{omitMessage:!0})}(),passed:t.passed};return i.passed||(i.expected=t.expected,i.actual=t.actual,t.error&&!e.isString_(t.error)&&("code"in t.error&&(i.code=t.error.code),"ERR_ASSERTION"===t.error.code&&""===t.expected&&""===t.actual&&(i.expected=t.error.expected,i.actual=t.error.actual,i.matcherName="assert "+t.error.operator))),i;function o(){return t.passed?"Passed.":t.message?t.message:t.error?n.message(t.error):""}}},getJasmineRequireObj().CallTracker=function(e){return function(){var t=[],n={};this.track=function(i){n.cloneArgs&&(i.args=e.util.cloneArgs(i.args)),t.push(i)},this.any=function(){return!!t.length},this.count=function(){return t.length},this.argsFor=function(e){var n=t[e];return n?n.args:[]},this.thisFor=function(e){var n=t[e];return n?n.object:void 0},this.all=function(){return t},this.allArgs=function(){for(var e=[],n=0;n<t.length;n++)e.push(t[n].args);return e},this.first=function(){return t[0]},this.mostRecent=function(){return t[t.length-1]},this.reset=function(){t=[]},this.saveArgumentsByValue=function(){n.cloneArgs=!0}}},getJasmineRequireObj().clearStack=function(e){return function(t){var n=0,i=t.setTimeout,o=function(e){Function.prototype.apply.apply(i,[t,[e,0]])};if(e.isFunction_(t.setImmediate)){var r=t.setImmediate;return function(e){++n<10?r(e):(n=0,o(e))}}return e.util.isUndefined(t.MessageChannel)?o:function(e,t){var n=new e.MessageChannel,i={},o=i,r=!1;n.port1.onmessage=function(){var t=(i=i.next).task;if(delete i.task,r)e.setTimeout(t,0);else try{r=!0,t()}finally{r=!1}};var s=0;return function(e){++s<10?(o=o.next={task:e},n.port2.postMessage(0)):(s=0,t(e))}}(t,o)}},getJasmineRequireObj().Clock=function(){var e="undefined"!=typeof process&&process.versions&&"string"==typeof process.versions.node;function t(){}return t.prototype.ref=function(){return this},t.prototype.unref=function(){return this},function(n,i,o){var r,s,a=this,l={setTimeout:n.setTimeout,clearTimeout:n.clearTimeout,setInterval:n.setInterval,clearInterval:n.clearInterval},c={setTimeout:function(n,i){if(!e)return r.scheduleFunction(n,i,d(arguments,2));var o=new t;return r.scheduleFunction(n,i,d(arguments,2),!1,o),o},clearTimeout:function(e){return r.removeFunctionWithId(e)},setInterval:function(n,i){if(!e)return r.scheduleFunction(n,i,d(arguments,2),!0);var o=new t;return r.scheduleFunction(n,i,d(arguments,2),!0,o),o},clearInterval:function(e){return r.removeFunctionWithId(e)}},u=!1;return a.FakeTimeout=t,a.install=function(){if(n.setTimeout!==l.setTimeout||n.clearTimeout!==l.clearTimeout||n.setInterval!==l.setInterval||n.clearInterval!==l.clearInterval)throw new Error("Jasmine Clock was unable to install over custom global timer functions. Is the clock already installed?");return h(n,c),s=c,r=i(),u=!0,a},a.uninstall=function(){r=null,o.uninstall(),h(n,l),s=l,u=!1},a.withMock=function(e){this.install();try{e()}finally{this.uninstall()}},a.mockDate=function(e){o.install(e)},a.setTimeout=function(e,t,i){return Function.prototype.apply.apply(s.setTimeout,[n,arguments])},a.setInterval=function(e,t,i){return Function.prototype.apply.apply(s.setInterval,[n,arguments])},a.clearTimeout=function(e){return Function.prototype.call.apply(s.clearTimeout,[n,e])},a.clearInterval=function(e){return Function.prototype.call.apply(s.clearInterval,[n,e])},a.tick=function(e){if(!u)throw new Error("Mock clock is not installed, use jasmine.clock().install()");r.tick(e,(function(e){o.tick(e)}))},a;function h(e,t){for(var n in t)e[n]=t[n]}function d(e,t){return Array.prototype.slice.call(e,t)}}},getJasmineRequireObj().CompleteOnFirstErrorSkipPolicy=function(e){function t(e){this.queueableFns_=e,this.erroredFnIx_=null}function n(e,t){return!!e.parentSuite&&(e.parentSuite===t||n(e.parentSuite,t))}return t.prototype.skipTo=function(e){let t;for(t=e+1;t<this.queueableFns_.length&&this.shouldSkip_(t);t++);return t},t.prototype.fnErrored=function(e){this.erroredFnIx_=e},t.prototype.shouldSkip_=function(e){if(null===this.erroredFnIx_)return!1;const t=this.queueableFns_[e],i=t.suite,o=this.queueableFns_[this.erroredFnIx_].suite;return!("afterEach"===t.type||"afterAll"===t.type||"specCleanup"===t.type)||i&&n(i,o)},t},getJasmineRequireObj().DelayedFunctionScheduler=function(j$){function DelayedFunctionScheduler(){var self=this,scheduledLookup=[],scheduledFunctions={},currentTime=0,delayedFnCount=0,deletedKeys=[];return self.tick=function(e,t){runScheduledFunctions(currentTime+(e=e||0),t)},self.scheduleFunction=function(funcToCall,millis,params,recurring,timeoutKey,runAtMillis){var f;f="string"==typeof funcToCall?function(){return eval(funcToCall)}:funcToCall,millis=millis||0,timeoutKey=timeoutKey||++delayedFnCount,runAtMillis=runAtMillis||currentTime+millis;var funcToSchedule={runAtMillis:runAtMillis,funcToCall:f,recurring:recurring,params:params,timeoutKey:timeoutKey,millis:millis};return runAtMillis in scheduledFunctions?scheduledFunctions[runAtMillis].push(funcToSchedule):(scheduledFunctions[runAtMillis]=[funcToSchedule],scheduledLookup.push(runAtMillis),scheduledLookup.sort((function(e,t){return e-t}))),timeoutKey},self.removeFunctionWithId=function(e){for(var t in deletedKeys.push(e),scheduledFunctions){var n=scheduledFunctions[t],i=indexOfFirstToPass(n,(function(t){return t.timeoutKey===e}));if(i>-1){1===n.length?(delete scheduledFunctions[t],deleteFromLookup(t)):n.splice(i,1);break}}},self;function indexOfFirstToPass(e,t){for(var n=-1,i=0;i<e.length;++i)if(t(e[i])){n=i;break}return n}function deleteFromLookup(e){var t=Number(e),n=indexOfFirstToPass(scheduledLookup,(function(e){return e===t}));n>-1&&scheduledLookup.splice(n,1)}function reschedule(e){self.scheduleFunction(e.funcToCall,e.millis,e.params,!0,e.timeoutKey,e.runAtMillis+e.millis)}function forEachFunction(e,t){for(var n=0;n<e.length;++n)t(e[n])}function runScheduledFunctions(e,t){if(t=t||function(){},0===scheduledLookup.length||scheduledLookup[0]>e)e>=currentTime&&(t(e-currentTime),currentTime=e);else{do{deletedKeys=[];var n=scheduledLookup.shift();n>=currentTime&&(t(n-currentTime),currentTime=n);var i=scheduledFunctions[currentTime];delete scheduledFunctions[currentTime],forEachFunction(i,(function(e){e.recurring&&reschedule(e)})),forEachFunction(i,(function(e){j$.util.arrayContains(deletedKeys,e.timeoutKey)||e.funcToCall.apply(null,e.params||[])})),deletedKeys=[]}while(scheduledLookup.length>0&&currentTime!==e&&scheduledLookup[0]<=e);e>=currentTime&&(t(e-currentTime),currentTime=e)}}}return DelayedFunctionScheduler},getJasmineRequireObj().Deprecator=function(e){function t(e){this.topSuite_=e,this.verbose_=!1,this.toSuppress_=[]}var n="Note: This message will be shown only once. Set the verboseDeprecations config property to true to see every occurrence.";return t.prototype.verboseDeprecations=function(e){this.verbose_=e},t.prototype.addDeprecationWarning=function(t,n,i){if(i=i||{},!this.verbose_&&!e.isError_(n)){if(-1!==this.toSuppress_.indexOf(n))return;this.toSuppress_.push(n)}this.log_(t,n,i),this.report_(t,n,i)},t.prototype.log_=function(t,i,o){var r;e.isError_(i)?console.error(i):(r=t===this.topSuite_||o.ignoreRunnable?"":t.children?" (in suite: "+t.getFullName()+")":" (in spec: "+t.getFullName()+")",o.omitStackTrace||(r+="\n"+this.stackTrace_()),this.verbose_||(r+="\n"+n),console.error("DEPRECATION: "+i+r))},t.prototype.stackTrace_=function(){return(new e.ExceptionFormatter).stack(e.util.errorWithStack()).replace(/^Error\n/m,"")},t.prototype.report_=function(t,i,o){o.ignoreRunnable&&(t=this.topSuite_),e.isError_(i)?t.addDeprecationWarning(i):(this.verbose_||(i+="\n"+n),t.addDeprecationWarning({message:i,omitStackTrace:o.omitStackTrace||!1}))},t},getJasmineRequireObj().errors=function(){function e(){}return e.prototype=new Error,e.prototype.constructor=e,{ExpectationFailed:e}},getJasmineRequireObj().ExceptionFormatter=function(e){const t=["name","message","stack","fileName","sourceURL","line","lineNumber","column","description","jasmineMessage"];return function(n){const i=n&&n.jasmineFile||e.util.jasmineFile();this.message=function(e){let t="";return e.jasmineMessage?t+=e.jasmineMessage:e.name&&e.message?t+=e.name+": "+e.message:e.message?t+=e.message:t+=e.toString()+" thrown",(e.fileName||e.sourceURL)&&(t+=" in "+(e.fileName||e.sourceURL)),(e.line||e.lineNumber)&&(t+=" (line "+(e.line||e.lineNumber)+")"),t},this.stack=function(n,{omitMessage:o}={}){if(!n||!n.stack)return null;const r=new e.StackTrace(n),s=function(e){const t=[],n="webkit"===e.style?"<Jasmine>":"    at <Jasmine>";return e.frames.forEach((function(e){e.file!==i?t.push(e.raw):t[t.length-1]!==n&&t.push(n)})),t}(r);let a="";return r.message&&!o&&s.unshift(r.message),a+=function(n){if(!(n instanceof Object))return;const i={};let o=!0;for(const r in n)e.util.arrayContains(t,r)||(i[r]=n[r],o=!1);if(!o)return"error properties: "+e.basicPrettyPrinter_(i)+"\n";return""}(n),a+=s.join("\n"),a}}},getJasmineRequireObj().Expectation=function(e){function t(t){this.expector=new e.Expector(t);const n=t.customMatchers||{};for(const e in n)this[e]=i(e,n[e])}function n(t){this.expector=new e.Expector(t);const n=t.customAsyncMatchers||{};for(const e in n)this[e]=o(e,n[e])}function i(e,t){return function(){const n=this.expector.compare(e,t,arguments);this.expector.processResult(n)}}function o(t,n){return function(){const i=e.util.errorWithStack();return this.expector.compare(t,n,arguments).then((e=>{this.expector.processResult(e,i)}))}}function r(e,t,n){for(const i in t){const o=t[i];e[i]=n(i,o)}}function s(e,t){const n=Object.create(e);return n.expector=e.expector.addFilter(t),n}function a(t,n,i,o){return t.message?e.isFunction_(t.message)?t.message():t.message:((i=i.slice()).unshift(!0),i.unshift(n),o.buildFailureMessage.apply(o,i))}function l(e){return e.pass=!e.pass,e}t.prototype.withContext=function(e){return s(this,new d(e))},Object.defineProperty(t.prototype,"not",{get:function(){return s(this,c)}}),n.prototype.withContext=function(e){return s(this,new d(e))},Object.defineProperty(n.prototype,"not",{get:function(){return s(this,u)}}),Object.defineProperty(n.prototype,"already",{get:function(){return s(this,h)}});const c={selectComparisonFunc:function(e){return e.negativeCompare||function(){return l(e.compare.apply(null,arguments))}},buildFailureMessage:a},u={selectComparisonFunc:function(e){return e.negativeCompare||function(){return e.compare.apply(this,arguments).then(l)}},buildFailureMessage:a},h={selectComparisonFunc:function(t){return function(n){const i=arguments;return e.isPending_(n).then((function(e){return e?{pass:!1,message:"Expected a promise to be settled (via expectAsync(...).already) but it was pending."}:t.compare.apply(null,i)}))}}};function d(e){this.message=e}return d.prototype.modifyFailureMessage=function(e){return-1===e.indexOf("\n")?this.message+": "+e:this.message+":\n"+e.replace(/^/gm,"    ")},{factory:function(e){return new t(e||{})},addCoreMatchers:function(e){r(t.prototype,e,i)},asyncFactory:function(e){return new n(e||{})},addAsyncCoreMatchers:function(e){r(n.prototype,e,o)}}},getJasmineRequireObj().ExpectationFilterChain=function(){function e(e,t){this.filter_=e,this.prev_=t}return e.prototype.addFilter=function(t){return new e(t,this)},e.prototype.selectComparisonFunc=function(e){return this.callFirst_("selectComparisonFunc",arguments).result},e.prototype.buildFailureMessage=function(e,t,n,i){return this.callFirst_("buildFailureMessage",arguments).result},e.prototype.modifyFailureMessage=function(e){return this.callFirst_("modifyFailureMessage",arguments).result||e},e.prototype.callFirst_=function(e,t){var n;return this.prev_&&(n=this.prev_.callFirst_(e,t)).found?n:this.filter_&&this.filter_[e]?{found:!0,result:this.filter_[e].apply(this.filter_,t)}:{found:!1}},e},getJasmineRequireObj().Expector=function(e){function t(t){this.matchersUtil=t.matchersUtil||{buildFailureMessage:function(){}},this.actual=t.actual,this.addExpectationResult=t.addExpectationResult||function(){},this.filters=new e.ExpectationFilterChain}return t.prototype.instantiateMatcher=function(e,t,n){this.matcherName=e,this.args=Array.prototype.slice.call(n,0),this.expected=this.args.slice(0),this.args.unshift(this.actual);var i=t(this.matchersUtil);return this.filters.selectComparisonFunc(i)||i.compare},t.prototype.buildMessage=function(t){var n=this;if(t.pass)return"";var i=this.filters.buildFailureMessage(t,this.matcherName,this.args,this.matchersUtil,o);return this.filters.modifyFailureMessage(i||o());function o(){if(t.message)return e.isFunction_(t.message)?t.message():t.message;var i=n.args.slice();return i.unshift(!1),i.unshift(n.matcherName),n.matchersUtil.buildFailureMessage.apply(n.matchersUtil,i)}},t.prototype.compare=function(e,t,n){return this.instantiateMatcher(e,t,n).apply(null,this.args)},t.prototype.addFilter=function(e){var t=Object.create(this);return t.filters=this.filters.addFilter(e),t},t.prototype.processResult=function(e,t){var n=this.buildMessage(e);1===this.expected.length&&(this.expected=this.expected[0]),this.addExpectationResult(e.pass,{matcherName:this.matcherName,passed:e.pass,message:n,error:t?void 0:e.error,errorForStack:t||void 0,actual:this.actual,expected:this.expected})},t},getJasmineRequireObj().formatErrorMsg=function(){return function(e,t){var n=t?"\nUsage: "+t:"";return function(t){return e+" : "+t+n}}},getJasmineRequireObj().GlobalErrors=function(e){return function(t){var n=[];t=t||e.getGlobal();var i=function(){var e=n[n.length-1];if(!e)throw arguments[0];e.apply(null,Array.prototype.slice.call(arguments,0))};this.originalHandlers={},this.jasmineHandlers={},this.installOne_=function(i,o){function r(t){var r;e.isError_(t)?t.jasmineMessage=o+": "+t:(r=t?o+": "+t:o+" with no error or message","unhandledRejection"===i&&(r+="\n(Tip: to get a useful stack trace, use Promise.reject(new Error(...)) instead of Promise.reject("+(t?"...":"")+").)"),t=new Error(r));var s=n[n.length-1];if(!s)throw t;s(t)}this.originalHandlers[i]=t.process.listeners(i),this.jasmineHandlers[i]=r,t.process.removeAllListeners(i),t.process.on(i,r),this.uninstall=function(){for(var e=Object.keys(this.originalHandlers),n=0;n<e.length;n++){var i=e[n];t.process.removeListener(i,this.jasmineHandlers[i]);for(var o=0;o<this.originalHandlers[i].length;o++)t.process.on(i,this.originalHandlers[i][o]);delete this.originalHandlers[i],delete this.jasmineHandlers[i]}}},this.install=function(){if(t.process&&t.process.listeners&&e.isFunction_(t.process.on))this.installOne_("uncaughtException","Uncaught exception"),this.installOne_("unhandledRejection","Unhandled promise rejection");else{var n=t.onerror;t.onerror=i;var o=function(n){e.isError_(n.reason)?(n.reason.jasmineMessage="Unhandled promise rejection: "+n.reason,t.onerror(n.reason)):t.onerror("Unhandled promise rejection: "+n.reason)};t.addEventListener&&t.addEventListener("unhandledrejection",o),this.uninstall=function(){t.onerror=n,t.removeEventListener&&t.removeEventListener("unhandledrejection",o)}}},this.pushListener=function(e){n.push(e)},this.popListener=function(e){if(!e)throw new Error("popListener expects a listener");n.pop()}}},getJasmineRequireObj().toBePending=function(e){return function(){return{compare:function(t){if(!e.isPromiseLike(t))throw new Error("Expected toBePending to be called on a promise.");var n={};return Promise.race([t,Promise.resolve(n)]).then((function(e){return{pass:n===e}}),(function(){return{pass:!1}}))}}}},getJasmineRequireObj().toBeRejected=function(e){return function(){return{compare:function(t){if(!e.isPromiseLike(t))throw new Error("Expected toBeRejected to be called on a promise.");return t.then((function(){return{pass:!1}}),(function(){return{pass:!0}}))}}}},getJasmineRequireObj().toBeRejectedWith=function(e){return function(t){return{compare:function(n,i){if(!e.isPromiseLike(n))throw new Error("Expected toBeRejectedWith to be called on a promise.");function o(e){return"Expected a promise "+(e?"not ":"")+"to be rejected with "+t.pp(i)}return n.then((function(){return{pass:!1,message:o(!1)+" but it was resolved."}}),(function(e){return t.equals(e,i)?{pass:!0,message:o(!0)+"."}:{pass:!1,message:o(!1)+" but it was rejected with "+t.pp(e)+"."}}))}}}},getJasmineRequireObj().toBeRejectedWithError=function(e){return function(i){return{compare:function(o,r,s){if(!e.isPromiseLike(o))throw new Error("Expected toBeRejectedWithError to be called on a promise.");var a=function(t,n,i){var o,r;s=t,"function"!=typeof s||s!==Error&&!e.isError_(s.prototype)?(o=Error,r=t):(o=t,r=n);var s;return{error:o,message:r,printValue:e.fnNameFor(o)+(void 0===r?"":": "+i.pp(r))}}(r,s,i);return o.then((function(){return{pass:!1,message:"Expected a promise to be rejected but it was resolved."}}),(function(o){return function(i,o,r){if(!e.isError_(i))return n(o,"rejected with "+r.pp(i));if(!(i instanceof o.error))return n(o,"rejected with type "+e.fnNameFor(i.constructor));var s=i.message;if(s===o.message||void 0===o.message)return t(o);if(o.message instanceof RegExp&&o.message.test(s))return t(o);return n(o,"rejected with "+r.pp(i))}(o,a,i)}))}}};function t(e){return{pass:!0,message:"Expected a promise not to be rejected with "+e.printValue+", but it was."}}function n(e,t){return{pass:!1,message:"Expected a promise to be rejected with "+e.printValue+" but it was "+t+"."}}},getJasmineRequireObj().toBeResolved=function(e){return function(t){return{compare:function(n){if(!e.isPromiseLike(n))throw new Error("Expected toBeResolved to be called on a promise.");return n.then((function(){return{pass:!0}}),(function(e){return{pass:!1,message:"Expected a promise to be resolved but it was rejected with "+t.pp(e)+"."}}))}}}},getJasmineRequireObj().toBeResolvedTo=function(e){return function(t){return{compare:function(n,i){if(!e.isPromiseLike(n))throw new Error("Expected toBeResolvedTo to be called on a promise.");function o(e){return"Expected a promise "+(e?"not ":"")+"to be resolved to "+t.pp(i)}return n.then((function(e){return t.equals(e,i)?{pass:!0,message:o(!0)+"."}:{pass:!1,message:o(!1)+" but it was resolved to "+t.pp(e)+"."}}),(function(e){return{pass:!1,message:o(!1)+" but it was rejected with "+t.pp(e)+"."}}))}}}},getJasmineRequireObj().DiffBuilder=function(e){function t(e,t,n){return"Expected "+n+(n.depth()?" = ":"")+e+" to equal "+t+"."}return class{constructor(t){this.prettyPrinter_=(t||{}).prettyPrinter||e.makePrettyPrinter(),this.mismatches_=new e.MismatchTree,this.path_=new e.ObjectPath,this.actualRoot_=void 0,this.expectedRoot_=void 0}setRoots(e,t){this.actualRoot_=e,this.expectedRoot_=t}recordMismatch(e){this.mismatches_.add(this.path_,e)}getMessage(){const n=[];return this.mismatches_.traverse(((i,o,r)=>{const{actual:s,expected:a}=this.dereferencePath_(i);if(r)return n.push(r(s,a,i,this.prettyPrinter_)),!0;const l=this.prettyPrinter_.customFormat_(s),c=this.prettyPrinter_.customFormat_(a);return e.util.isUndefined(l)&&e.util.isUndefined(c)?(o&&n.push(this.defaultFormatter_(s,a,i)),!0):(n.push(t(l,c,i)),!1)})),n.join("\n")}withPath(e,t){const n=this.path_;this.path_=this.path_.add(e),t(),this.path_=n}dereferencePath_(t){let n=this.actualRoot_,i=this.expectedRoot_;const o=()=>{if(e.isAsymmetricEqualityTester_(i)&&e.isFunction_(i.valuesForDiff_)){const e=i.valuesForDiff_(n,this.prettyPrinter_);i=e.self,n=e.other}};o();for(const e of t.components)n=n[e],i=i[e],o();return{actual:n,expected:i}}defaultFormatter_(e,n,i){return t(this.prettyPrinter_(e),this.prettyPrinter_(n),i)}}},getJasmineRequireObj().MatchersUtil=function(e){function t(e){e=e||{},this.customTesters_=e.customTesters||[],this.pp=e.pp||function(){}}function n(e){return"function"==typeof e}function i(n,i){return t.keys(n).filter((t=>!e.util.has(i,t))).map((e=>[e,n[e]]))}function o(e,t,n,o){var r=i(n,t),s=i(t,n),l=a(e,r),c=a(e,s),u=[];return o.depth()||(o="object"),l.length&&u.push("Expected "+o+" to have properties"+l),c.length&&u.push("Expected "+o+" not to have properties"+c),u.join("\n")}function r(t,n,i,o){return o.depth()||(o="object"),"Expected "+o+" to be a kind of "+e.fnNameFor(i.constructor)+", but was "+t(n)+"."}function s(e,t,n,i){return"Unexpected "+i+(i.depth()?" = ":"")+e(t)+" in array."}function a(e,t){let n="";for(const[i,o]of t)n+="\n    "+i.toString()+": "+e(o);return n}return t.prototype.contains=function(t,n){if(!t)return!1;if(e.isSet(t)&&t.has(n))return!0;if(e.isIterable_(t)&&!e.isString_(t)){for(const e of t)if(this.equals(e,n))return!0;return!1}if(t.indexOf)return t.indexOf(n)>=0;if(e.isNumber_(t.length))for(var i=0;i<t.length;i++)if(this.equals(t[i],n))return!0;return!1},t.prototype.buildFailureMessage=function(){var e=Array.prototype.slice.call(arguments,0),t=e[0],n=e[1],i=e[2],o=e.slice(3),r=t.replace(/[A-Z]/g,(function(e){return" "+e.toLowerCase()})),s="Expected "+this.pp(i)+(n?" not ":" ")+r;if(o.length>0)for(var a=0;a<o.length;a++)a>0&&(s+=","),s+=" "+this.pp(o[a]);return s+"."},t.prototype.asymmetricDiff_=function(t,n,i,o,r){if(e.isFunction_(n.valuesForDiff_)){var s=n.valuesForDiff_(t,this.pp);this.eq_(s.other,s.self,i,o,r)}else r.recordMismatch()},t.prototype.asymmetricMatch_=function(t,n,i,o,r){var s,a=e.isAsymmetricEqualityTester_(t),l=e.isAsymmetricEqualityTester_(n);if(a!==l)return a?((s=t.asymmetricMatch(n,this))||r.recordMismatch(),s):l?((s=n.asymmetricMatch(t,this))||this.asymmetricDiff_(t,n,i,o,r),s):void 0},t.prototype.equals=function(t,n,i){return(i=i||e.NullDiffBuilder()).setRoots(t,n),this.eq_(t,n,[],[],i)},t.prototype.eq_=function(i,a,l,c,u){var h,d=!0,p=this,f=this.asymmetricMatch_(i,a,l,c,u);if(!e.util.isUndefined(f))return f;for(h=0;h<this.customTesters_.length;h++){var g=this.customTesters_[h](i,a);if(!e.util.isUndefined(g))return g||u.recordMismatch(),g}if(i instanceof Error&&a instanceof Error)return(d=i.message==a.message)||u.recordMismatch(),d;if(i===a)return(d=0!==i||1/i==1/a)||u.recordMismatch(),d;if(null===i||null===a)return(d=i===a)||u.recordMismatch(),d;var m=Object.prototype.toString.call(i);if(m!=Object.prototype.toString.call(a))return u.recordMismatch(),!1;switch(m){case"[object String]":return(d=i==String(a))||u.recordMismatch(),d;case"[object Number]":return(d=i!=+i?a!=+a:0===i&&0===a?1/i==1/a:i==+a)||u.recordMismatch(),d;case"[object Date]":case"[object Boolean]":return(d=+i==+a)||u.recordMismatch(),d;case"[object ArrayBuffer]":return p.eq_(new Uint8Array(i),new Uint8Array(a),l,c,u);case"[object RegExp]":return i.source==a.source&&i.global==a.global&&i.multiline==a.multiline&&i.ignoreCase==a.ignoreCase}if("object"!=typeof i||"object"!=typeof a)return u.recordMismatch(),!1;var y=e.isDomNode(i),v=e.isDomNode(a);if(y&&v)return(d=i.isEqualNode(a))||u.recordMismatch(),d;if(y||v)return u.recordMismatch(),!1;var b=e.isPromise(i),x=e.isPromise(a);if(b&&x)return i===a;for(var w=l.length;w--;)if(l[w]==i)return c[w]==a;l.push(i),c.push(a);var _;if("[object Array]"==m){var S=i.length,C=a.length;for(u.withPath("length",(function(){S!==C&&(u.recordMismatch(),d=!1)})),h=0;h<S||h<C;h++)u.withPath(h,(function(){h>=C?(u.recordMismatch(s.bind(null,p.pp)),d=!1):d=p.eq_(h<S?i[h]:void 0,h<C?a[h]:void 0,l,c,u)&&d}));if(!d)return!1}else if(e.isMap(i)&&e.isMap(a)){if(i.size!=a.size)return u.recordMismatch(),!1;var k=[],A=[];i.forEach((function(e,t){k.push(t)})),a.forEach((function(e,t){A.push(t)}));var M,T,E,$,L,R,P=[k,A],I=[A,k];for(h=0;d&&h<P.length;h++){M=P[h],L=I[h];for(var O=0;d&&O<M.length;O++)T=M[O],R=L[O],E=i.get(T),$=e.isAsymmetricEqualityTester_(T)||e.isAsymmetricEqualityTester_(R)&&this.eq_(T,R,l,c,e.NullDiffBuilder())?a.get(R):a.get(T),d=this.eq_(E,$,l,c,e.NullDiffBuilder())}if(!d)return u.recordMismatch(),!1}else if(e.isSet(i)&&e.isSet(a)){if(i.size!=a.size)return u.recordMismatch(),!1;var D=[];i.forEach((function(e){D.push(e)}));var F=[];a.forEach((function(e){F.push(e)}));var N,B,j,H,W,z,V,G,U=[[D,F],[F,D]],q=[[l,c],[c,l]];for(h=0;d&&h<U.length;h++){N=U[h][0],H=U[h][1],j=q[h][0],z=q[h][1];for(var K=0;d&&K<N.length;K++){B=N[K],V=!1;for(var Y=0;!V&&Y<H.length;Y++)W=H[Y],G=j.length,(V=this.eq_(B,W,j,z,e.NullDiffBuilder()))||G===j.length||(j.splice(G),z.splice(G));d=d&&V}}if(!d)return u.recordMismatch(),!1}else{if(e.isURL(i)&&e.isURL(a))return i.toString()===a.toString();var X=i.constructor,J=a.constructor;if(X!==J&&n(X)&&n(J)&&i instanceof X&&a instanceof J&&!(X instanceof X&&J instanceof J))return u.recordMismatch(r.bind(null,this.pp)),!1}var Q,Z=t.keys(i,"[object Array]"==m);if(_=Z.length,t.keys(a,"[object Array]"==m).length!==_)return u.recordMismatch(o.bind(null,this.pp)),!1;for(h=0;h<_;h++)Q=Z[h],e.util.has(a,Q)?u.withPath(Q,(function(){p.eq_(i[Q],a[Q],l,c,u)||(d=!1)})):(u.recordMismatch(o.bind(null,this.pp)),d=!1);return!!d&&(l.pop(),c.pop(),d)},t.keys=function(t,n){var i=function(t){var n=[];for(var i in t)e.util.has(t,i)&&n.push(i);for(var o=Object.getOwnPropertySymbols(t),r=0;r<o.length;r++)t.propertyIsEnumerable(o[r])&&n.push(o[r]);return n}(t);if(!n)return i;if(0===i.length)return i;for(var o=[],r=0;r<i.length;r++)"symbol"!=typeof i[r]&&/^[0-9]+$/.test(i[r])||o.push(i[r]);return o},t},getJasmineRequireObj().MismatchTree=function(e){class t{constructor(t){this.path=t||new e.ObjectPath([]),this.formatter=void 0,this.children=[],this.isMismatch=!1}add(e,n){if(0===e.depth())this.formatter=n,this.isMismatch=!0;else{const i=e.components[0];e=e.shift();let o=this.child(i);o||(o=new t(this.path.add(i)),this.children.push(o)),o.add(e,n)}}traverse(e){const t=this.children.length>0;if((this.isMismatch||t)&&e(this.path,!t,this.formatter))for(const t of this.children)t.traverse(e)}child(e){return this.children.find((t=>{const n=t.path.components;return n[n.length-1]===e}))}}return t},getJasmineRequireObj().nothing=function(){return function(){return{compare:function(){return{pass:!0}}}}},getJasmineRequireObj().NullDiffBuilder=function(e){return function(){return{withPath:function(e,t){t()},setRoots:function(){},recordMismatch:function(){}}}},getJasmineRequireObj().ObjectPath=function(e){class t{constructor(e){this.components=e||[]}toString(){return this.components.length?"$"+this.components.map(n).join(""):""}add(e){return new t(this.components.concat([e]))}shift(){return new t(this.components.slice(1))}depth(){return this.components.length}}function n(e){return"number"==typeof e||"symbol"==typeof e?"["+e.toString()+"]":/^[A-Za-z\$_][A-Za-z0-9\$_]*$/.test(e)?"."+e:`['${e}']`}return t},getJasmineRequireObj().requireAsyncMatchers=function(e,t){for(var n=["toBePending","toBeResolved","toBeRejected","toBeResolvedTo","toBeRejectedWith","toBeRejectedWithError"],i={},o=0;o<n.length;o++){var r=n[o];i[r]=e[r](t)}return i},getJasmineRequireObj().toBe=function(e){return function(e){return{compare:function(t,n){var i={pass:t===n};return"object"==typeof n&&(i.message=e.buildFailureMessage("toBe",i.pass,t,n)+" Tip: To check for deep equality, use .toEqual() instead of .toBe()."),i}}}},getJasmineRequireObj().toBeCloseTo=function(){return function(){return{compare:function(e,t,n){if(0!==n&&(n=n||2),null===t||null===e)throw new Error("Cannot use toBeCloseTo with null. Arguments evaluated to: expect("+e+").toBeCloseTo("+t+").");if(t===1/0||t===-1/0)return{pass:e===t};var i=Math.pow(10,n+1),o=Math.abs(t-e),r=Math.pow(10,-n)/2;return{pass:Math.round(o*i)<=r*i}}}}},getJasmineRequireObj().toBeDefined=function(){return function(){return{compare:function(e){return{pass:void 0!==e}}}}},getJasmineRequireObj().toBeFalse=function(){return function(){return{compare:function(e){return{pass:!1===e}}}}},getJasmineRequireObj().toBeFalsy=function(){return function(){return{compare:function(e){return{pass:!e}}}}},getJasmineRequireObj().toBeGreaterThan=function(){return function(){return{compare:function(e,t){return{pass:e>t}}}}},getJasmineRequireObj().toBeGreaterThanOrEqual=function(){return function(){return{compare:function(e,t){return{pass:e>=t}}}}},getJasmineRequireObj().toBeInstanceOf=function(e){var t=e.formatErrorMsg("<toBeInstanceOf>","expect(value).toBeInstanceOf(<ConstructorFunction>)");return function(n){return{compare:function(i,o){var r,s=i&&i.constructor?e.fnNameFor(i.constructor):n.pp(i),a=o?e.fnNameFor(o):n.pp(o);try{r=new e.Any(o).asymmetricMatch(i)}catch(e){throw new Error(t("Expected value is not a constructor function"))}return r?{pass:!0,message:"Expected instance of "+s+" not to be an instance of "+a}:{pass:!1,message:"Expected instance of "+s+" to be an instance of "+a}}}}},getJasmineRequireObj().toBeLessThan=function(){return function(){return{compare:function(e,t){return{pass:e<t}}}}},getJasmineRequireObj().toBeLessThanOrEqual=function(){return function(){return{compare:function(e,t){return{pass:e<=t}}}}},getJasmineRequireObj().toBeNaN=function(e){return function(e){return{compare:function(t){var n={pass:t!=t};return n.pass?n.message="Expected actual not to be NaN.":n.message=function(){return"Expected "+e.pp(t)+" to be NaN."},n}}}},getJasmineRequireObj().toBeNegativeInfinity=function(e){return function(e){return{compare:function(t){var n={pass:t===Number.NEGATIVE_INFINITY};return n.pass?n.message="Expected actual not to be -Infinity.":n.message=function(){return"Expected "+e.pp(t)+" to be -Infinity."},n}}}},getJasmineRequireObj().toBeNull=function(){return function(){return{compare:function(e){return{pass:null===e}}}}},getJasmineRequireObj().toBePositiveInfinity=function(e){return function(e){return{compare:function(t){var n={pass:t===Number.POSITIVE_INFINITY};return n.pass?n.message="Expected actual not to be Infinity.":n.message=function(){return"Expected "+e.pp(t)+" to be Infinity."},n}}}},getJasmineRequireObj().toBeTrue=function(){return function(){return{compare:function(e){return{pass:!0===e}}}}},getJasmineRequireObj().toBeTruthy=function(){return function(){return{compare:function(e){return{pass:!!e}}}}},getJasmineRequireObj().toBeUndefined=function(){return function(){return{compare:function(e){return{pass:void 0===e}}}}},getJasmineRequireObj().toContain=function(){return function(e){return{compare:function(t,n){return{pass:e.contains(t,n)}}}}},getJasmineRequireObj().toEqual=function(e){return function(t){return{compare:function(n,i){var o={pass:!1},r=new e.DiffBuilder({prettyPrinter:t.pp});return o.pass=t.equals(n,i,r),o.message=r.getMessage(),o}}}},getJasmineRequireObj().toHaveBeenCalled=function(e){var t=e.formatErrorMsg("<toHaveBeenCalled>","expect(<spyObj>).toHaveBeenCalled()");return function(n){return{compare:function(i){var o={};if(!e.isSpy(i))throw new Error(t("Expected a spy, but got "+n.pp(i)+"."));if(arguments.length>1)throw new Error(t("Does not take arguments, use toHaveBeenCalledWith"));return o.pass=i.calls.any(),o.message=o.pass?"Expected spy "+i.and.identity+" not to have been called.":"Expected spy "+i.and.identity+" to have been called.",o}}}},getJasmineRequireObj().toHaveBeenCalledBefore=function(e){var t=e.formatErrorMsg("<toHaveBeenCalledBefore>","expect(<spyObj>).toHaveBeenCalledBefore(<spyObj>)");return function(n){return{compare:function(i,o){if(!e.isSpy(i))throw new Error(t("Expected a spy, but got "+n.pp(i)+"."));if(!e.isSpy(o))throw new Error(t("Expected a spy, but got "+n.pp(o)+"."));var r={pass:!1};if(!i.calls.count())return r.message="Expected spy "+i.and.identity+" to have been called.",r;if(!o.calls.count())return r.message="Expected spy "+o.and.identity+" to have been called.",r;var s=i.calls.mostRecent().invocationOrder,a=o.calls.first().invocationOrder;if(r.pass=s<a,r.pass)r.message="Expected spy "+i.and.identity+" to not have been called before spy "+o.and.identity+", but it was";else{var l=i.calls.first().invocationOrder,c=o.calls.mostRecent().invocationOrder;r.message=l<a?"Expected latest call to spy "+i.and.identity+" to have been called before first call to spy "+o.and.identity+" (no interleaved calls)":c>s?"Expected first call to spy "+o.and.identity+" to have been called after latest call to spy "+i.and.identity+" (no interleaved calls)":"Expected spy "+i.and.identity+" to have been called before spy "+o.and.identity}return r}}}},getJasmineRequireObj().toHaveBeenCalledOnceWith=function(e){var t=e.formatErrorMsg("<toHaveBeenCalledOnceWith>","expect(<spyObj>).toHaveBeenCalledOnceWith(...arguments)");return function(n){return{compare:function(){var i=Array.prototype.slice.call(arguments,0),o=i[0],r=i.slice(1);if(!e.isSpy(o))throw new Error(t("Expected a spy, but got "+n.pp(o)+"."));var s=o.calls.allArgs().map((function(e){return"  "+n.pp(e)}));if(1===o.calls.count()&&n.contains(o.calls.allArgs(),r))return{pass:!0,message:"Expected spy "+o.and.identity+" to have been called 0 times, multiple times, or once, but with arguments different from:\n  "+n.pp(r)+"\nBut the actual call was:\n"+s.join(",\n")+".\n\n"};return{pass:!1,message:"Expected spy "+o.and.identity+" to have been called only once, and with given args:\n  "+n.pp(r)+"\n"+function(){switch(o.calls.count()){case 0:return"But it was never called.\n\n";case 1:return"But the actual call was:\n"+s.join(",\n")+".\n"+o.calls.allArgs().map((function(t,i){var o=new e.DiffBuilder;return n.equals(t,r,o),o.getMessage()})).join("\n")+"\n\n";default:return"But the actual calls were:\n"+s.join(",\n")+".\n\n"}}()}}}}},getJasmineRequireObj().toHaveBeenCalledTimes=function(e){var t=e.formatErrorMsg("<toHaveBeenCalledTimes>","expect(<spyObj>).toHaveBeenCalledTimes(<Number>)");return function(n){return{compare:function(i,o){if(!e.isSpy(i))throw new Error(t("Expected a spy, but got "+n.pp(i)+"."));var r=Array.prototype.slice.call(arguments,0),s={pass:!1};if(!e.isNumber_(o))throw new Error(t("The expected times failed is a required argument and must be a number."));var a=(i=r[0]).calls.count(),l=1===o?"once":o+" times";return s.pass=a===o,s.message=s.pass?"Expected spy "+i.and.identity+" not to have been called "+l+". It was called "+a+" times.":"Expected spy "+i.and.identity+" to have been called "+l+". It was called "+a+" times.",s}}}},getJasmineRequireObj().toHaveBeenCalledWith=function(e){var t=e.formatErrorMsg("<toHaveBeenCalledWith>","expect(<spyObj>).toHaveBeenCalledWith(...arguments)");return function(n){return{compare:function(){var i=Array.prototype.slice.call(arguments,0),o=i[0],r=i.slice(1),s={pass:!1};if(!e.isSpy(o))throw new Error(t("Expected a spy, but got "+n.pp(o)+"."));return o.calls.any()?(n.contains(o.calls.allArgs(),r)?(s.pass=!0,s.message=function(){return"Expected spy "+o.and.identity+" not to have been called with:\n  "+n.pp(r)+"\nbut it was."}):s.message=function(){var t=o.calls.allArgs().map((function(e){return"  "+n.pp(e)})),i=o.calls.allArgs().map((function(t,i){var o=new e.DiffBuilder;return n.equals(t,r,o),"Call "+i+":\n"+o.getMessage().replace(/^/gm,"  ")}));return"Expected spy "+o.and.identity+" to have been called with:\n  "+n.pp(r)+"\nbut actual calls were:\n"+t.join(",\n")+".\n\n"+i.join("\n")},s):(s.message=function(){return"Expected spy "+o.and.identity+" to have been called with:\n  "+n.pp(r)+"\nbut it was never called."},s)}}}},getJasmineRequireObj().toHaveClass=function(e){return function(t){return{compare:function(n,i){if(!((o=n)&&o.classList&&e.isFunction_(o.classList.contains)))throw new Error(t.pp(n)+" is not a DOM element");var o;return{pass:n.classList.contains(i)}}}}},getJasmineRequireObj().toHaveSize=function(e){var t=Number.MAX_SAFE_INTEGER||9007199254740991;return function(){return{compare:function(n,i){var o,r={pass:!1};if(e.isA_("WeakSet",n)||e.isWeakMap(n)||e.isDataView(n))throw new Error("Cannot get size of "+n+".");return e.isSet(n)||e.isMap(n)?r.pass=n.size===i:(o=n.length,r.pass="number"==typeof o&&o>-1&&o%1==0&&o<=t?n.length===i:Object.keys(n).length===i),r}}}},getJasmineRequireObj().toHaveSpyInteractions=function(e){var t=e.formatErrorMsg("<toHaveSpyInteractions>","expect(<spyObj>).toHaveSpyInteractions()");return function(n){return{compare:function(n){var i={};if(!e.isObject_(n))throw new Error(t("Expected a spy object, but got "+typeof n+"."));if(arguments.length>1)throw new Error(t("Does not take arguments"));i.pass=!1;let o=!1;const r=[];for(const t of Object.values(n))e.isSpy(t)&&(o=!0,t.calls.any()&&(i.pass=!0,r.push([t.and.identity,t.calls.count()])));if(!o)throw new Error(t("Expected a spy object with spies, but object has no spies."));let s;return i.pass?(s="Expected spy object spies not to have been called, but the following spies were called: ",s+=r.map((([e,t])=>`${e} called ${t} time(s)`)).join(", ")):s="Expected spy object spies to have been called, but no spies were called.",i.message=s,i}}}},getJasmineRequireObj().toMatch=function(e){var t=e.formatErrorMsg("<toMatch>","expect(<expectation>).toMatch(<string> || <regexp>)");return function(){return{compare:function(n,i){if(!e.isString_(i)&&!e.isA_("RegExp",i))throw new Error(t("Expected is not a String or a RegExp"));return{pass:new RegExp(i).test(n)}}}}},getJasmineRequireObj().toThrow=function(e){var t=e.formatErrorMsg("<toThrow>","expect(function() {<expectation>}).toThrow()");return function(e){return{compare:function(n,i){var o,r={pass:!1},s=!1;if("function"!=typeof n)throw new Error(t("Actual is not a Function"));try{n()}catch(e){s=!0,o=e}return s?1==arguments.length?(r.pass=!0,r.message=function(){return"Expected function not to throw, but it threw "+e.pp(o)+"."},r):(e.equals(o,i)?(r.pass=!0,r.message=function(){return"Expected function not to throw "+e.pp(i)+"."}):r.message=function(){return"Expected function to throw "+e.pp(i)+", but it threw "+e.pp(o)+"."},r):(r.message="Expected function to throw an exception.",r)}}}},getJasmineRequireObj().toThrowError=function(e){var t=e.formatErrorMsg("<toThrowError>","expect(function() {<expectation>}).toThrowError(<ErrorConstructor>, <message>)");function n(e){return{pass:!0,message:e}}function i(e){return{pass:!1,message:e}}return function(o){return{compare:function(n){var s,a=r.apply(null,arguments);if("function"!=typeof n)throw new Error(t("Actual is not a Function"));try{return n(),i("Expected function to throw an Error.")}catch(e){s=e}return e.isError_(s)?a.match(s):i((function(){return"Expected function to throw an Error, but it threw "+o.pp(s)+"."}))}};function r(){var i,o;if(arguments[2]){if(i=arguments[2],!a(o=arguments[1]))throw new Error(t("Expected error type is not an Error."));return s(i,o)}return arguments[1]?(i=arguments[1],a(arguments[1])?s(null,arguments[1]):s(arguments[1],null)):{match:function(t){return n("Expected function not to throw an Error, but it threw "+e.fnNameFor(t)+".")}}}function s(r,s){if(r&&!((a=r)instanceof RegExp||"string"==typeof a))throw s?new Error(t("Expected error message is not a string or RegExp.")):new Error(t("Expected is not an Error, string, or RegExp."));var a;var l=s?e.fnNameFor(s):"an exception";function c(){return null===r?"":r instanceof RegExp?" with a message matching "+o.pp(r):" with message "+o.pp(r)}function u(e){return(null===s||e instanceof s)&&(null===r||(t=e.message,"string"==typeof r?r==t:r.test(t)));var t}return{match:function(t){return u(t)?n((function(){return"Expected function not to throw "+l+c()+"."})):i((function(){return"Expected function to throw "+l+c()+", but it threw "+function(t){var n=s?e.fnNameFor(t.constructor):"an exception",i="";return r&&(i=" with message "+o.pp(t.message)),n+i}(t)+"."}))}}}function a(t){if("function"!=typeof t)return!1;var n=function(){};return n.prototype=t.prototype,e.isError_(new n)}}},getJasmineRequireObj().toThrowMatching=function(e){var t=e.formatErrorMsg("<toThrowMatching>","expect(function() {<expectation>}).toThrowMatching(<Predicate>)");function n(e){return{pass:!1,message:e}}return function(i){return{compare:function(o,r){var s;if("function"!=typeof o)throw new Error(t("Actual is not a Function"));if("function"!=typeof r)throw new Error(t("Predicate is not a Function"));try{return o(),n("Expected function to throw an exception.")}catch(e){s=e}return r(s)?{pass:!0,message:"Expected function not to throw an exception matching a predicate."}:n((function(){return"Expected function to throw an exception matching a predicate, but it threw "+function(t){return t&&t.constructor?e.fnNameFor(t.constructor)+" with message "+i.pp(t.message):i.pp(t)}(s)+"."}))}}}},getJasmineRequireObj().MockDate=function(e){return function(t){var n=this,i=0;if(!t||!t.Date)return n.install=function(){},n.tick=function(){},n.uninstall=function(){},n;var o=t.Date;return n.install=function(n){if(n instanceof o)i=n.getTime();else{if(!e.util.isUndefined(n))throw new Error("The argument to jasmine.clock().mockDate(), if specified, should be a Date instance.");i=(new o).getTime()}t.Date=r},n.tick=function(e){i+=e=e||0},n.uninstall=function(){i=0,t.Date=o},r.prototype=o.prototype,r.now=function(){return i},r.toSource=o.toSource,r.toString=o.toString,r.parse=o.parse,r.UTC=o.UTC,n;function r(){switch(arguments.length){case 0:return new o(i);case 1:return new o(arguments[0]);case 2:return new o(arguments[0],arguments[1]);case 3:return new o(arguments[0],arguments[1],arguments[2]);case 4:return new o(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);case 6:return new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);default:return new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6])}}}},getJasmineRequireObj().NeverSkipPolicy=function(e){function t(e){}return t.prototype.skipTo=function(e){return e+1},t.prototype.fnErrored=function(e){},t},getJasmineRequireObj().makePrettyPrinter=function(e){class t{constructor(e,t){this.customObjectFormatters_=e,this.ppNestLevel_=0,this.seen=[],this.length=0,this.stringParts=[],this.pp_=t}format(t){this.ppNestLevel_++;try{const n=this.applyCustomFormatters_(t);if(n)this.emitScalar(n);else if(e.util.isUndefined(t))this.emitScalar("undefined");else if(null===t)this.emitScalar("null");else if(0===t&&1/t==-1/0)this.emitScalar("-0");else if(t===e.getGlobal())this.emitScalar("<global>");else if(t.jasmineToString)this.emitScalar(t.jasmineToString(this.pp_));else if(e.isString_(t))this.emitString(t);else if(e.isSpy(t))this.emitScalar("spy on "+t.and.identity);else if(e.isSpy(t.toString))this.emitScalar("spy on "+t.toString.and.identity);else if(t instanceof RegExp)this.emitScalar(t.toString());else if("function"==typeof t)this.emitScalar("Function");else if(e.isDomNode(t))t.tagName?this.emitDomElement(t):this.emitScalar("HTMLNode");else if(t instanceof Date)this.emitScalar("Date("+t+")");else if(e.isSet(t))this.emitSet(t);else if(e.isMap(t))this.emitMap(t);else if(e.isTypedArray_(t))this.emitTypedArray(t);else if(t.toString&&"object"==typeof t&&!e.isArray_(t)&&function(t){try{return e.isFunction_(t.toString)&&t.toString!==Object.prototype.toString&&t.toString()!==Object.prototype.toString.call(t)}catch(e){return!0}}(t))try{this.emitScalar(t.toString())}catch(e){this.emitScalar("has-invalid-toString-method")}else e.util.arrayContains(this.seen,t)?this.emitScalar("<circular reference: "+(e.isArray_(t)?"Array":"Object")+">"):e.isArray_(t)||e.isA_("Object",t)?(this.seen.push(t),e.isArray_(t)?this.emitArray(t):this.emitObject(t),this.seen.pop()):this.emitScalar(t.toString())}catch(e){if(this.ppNestLevel_>1||!(e instanceof n))throw e}finally{this.ppNestLevel_--}}applyCustomFormatters_(e){return i(e,this.customObjectFormatters_)}iterateObject(t,n){const i=e.MatchersUtil.keys(t,e.isArray_(t)),o=Math.min(i.length,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);for(let e=0;e<o;e++)n(i[e]);return i.length>o}emitScalar(e){this.append(e)}emitString(e){this.append("'"+e+"'")}emitArray(t){if(this.ppNestLevel_>e.MAX_PRETTY_PRINT_DEPTH)return void this.append("Array");const n=Math.min(t.length,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);this.append("[ ");for(let e=0;e<n;e++)e>0&&this.append(", "),this.format(t[e]);t.length>n&&this.append(", ...");let i=0===t.length;this.iterateObject(t,(e=>{i?i=!1:this.append(", "),this.formatProperty(t,e)}))&&this.append(", ..."),this.append(" ]")}emitSet(t){if(this.ppNestLevel_>e.MAX_PRETTY_PRINT_DEPTH)return void this.append("Set");this.append("Set( ");const n=Math.min(t.size,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);let i=0;t.forEach((function(e,t){i>=n||(i>0&&this.append(", "),this.format(e),i++)}),this),t.size>n&&this.append(", ..."),this.append(" )")}emitMap(t){if(this.ppNestLevel_>e.MAX_PRETTY_PRINT_DEPTH)return void this.append("Map");this.append("Map( ");const n=Math.min(t.size,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);let i=0;t.forEach((function(e,t){i>=n||(i>0&&this.append(", "),this.format([t,e]),i++)}),this),t.size>n&&this.append(", ..."),this.append(" )")}emitObject(t){const n=t.constructor,i="function"==typeof n&&t instanceof n?e.fnNameFor(t.constructor):"null";if(this.append(i),this.ppNestLevel_>e.MAX_PRETTY_PRINT_DEPTH)return;this.append("({ ");let o=!0;this.iterateObject(t,(e=>{o?o=!1:this.append(", "),this.formatProperty(t,e)}))&&this.append(", ..."),this.append(" })")}emitTypedArray(t){const n=e.fnNameFor(t.constructor),i=Array.prototype.slice.call(t,0,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);let o=Array.prototype.join.call(i,", ");i.length!==t.length&&(o+=", ..."),this.append(n+" [ "+o+" ]")}emitDomElement(e){const t=e.tagName.toLowerCase();let n="<"+t;for(const t of e.attributes)n+=" "+t.name,""!==t.value&&(n+='="'+t.value+'"');n+=">",0===e.childElementCount&&""===e.textContent||(n+="...</"+t+">"),this.append(n)}formatProperty(e,t){"symbol"==typeof t?this.append(t.toString()):this.append(t),this.append(": "),this.format(e[t])}append(t){"string"!=typeof t&&(t=Object.prototype.toString.call(t));const i=function(e,t){if(e.length<=t)return{value:e,truncated:!1};return{value:e=e.substring(0,t-4)+" ...",truncated:!0}}(t,e.MAX_PRETTY_PRINT_CHARS-this.length);if(this.length+=i.value.length,this.stringParts.push(i.value),i.truncated)throw new n}}function n(){this.message="Exceeded "+e.MAX_PRETTY_PRINT_CHARS+" characters while pretty-printing a value"}function i(e,t){for(const n of t){const t=n(e);if(void 0!==t)return t}}return n.prototype=new Error,function(e){e=e||[];const n=function(i){const o=new t(e,n);return o.format(i),o.stringParts.join("")};return n.customFormat_=function(t){return i(t,e)},n}},getJasmineRequireObj().QueueRunner=function(e){var t=1;function n(){}function i(e,t){var n=!1;return function(i){return n?t&&t():(n=!0,e(i)),null}}function o(){console.error(new Error("An asynchronous function called its 'done' callback more than once, in a QueueRunner without a onMultipleDone handler."))}function r(){}function s(n){this.id_=t++,this.queueableFns=n.queueableFns||[],this.onComplete=n.onComplete||r,this.clearStack=n.clearStack||function(e){e()},this.onException=n.onException||r,this.onMultipleDone=n.onMultipleDone||o,this.userContext=n.userContext||new e.UserContext,this.timeout=n.timeout||{setTimeout:setTimeout,clearTimeout:clearTimeout},this.fail=n.fail||r,this.globalErrors=n.globalErrors||{pushListener:r,popListener:r};const i=n.SkipPolicy||e.NeverSkipPolicy;if(this.skipPolicy_=new i(this.queueableFns),this.errored_=!1,"function"!=typeof this.onComplete)throw new Error("invalid onComplete "+JSON.stringify(this.onComplete));this.deprecated=n.deprecated}return n.prototype=new Error,e.StopExecutionError=n,s.prototype.execute=function(){var e=this;this.handleFinalError=function(t,n,i,o,r){e.onException(r||t)},this.globalErrors.pushListener(this.handleFinalError),this.run(0)},s.prototype.clearTimeout=function(t){Function.prototype.apply.apply(this.timeout.clearTimeout,[e.getGlobal(),[t]])},s.prototype.setTimeout=function(t,n){return Function.prototype.apply.apply(this.timeout.setTimeout,[e.getGlobal(),[t,n]])},s.prototype.attempt=function(t){var o,r,s,a=this,l=!0,c=function(e){g(e)},u=i((function(){void 0!==o&&a.clearTimeout(o),a.globalErrors.popListener(c)})),h=i((function(e){function i(){a.run(a.nextFnIx_(t))}u(),void 0!==e&&(e instanceof n||e.jasmineMessage||a.fail(e),a.recordError_(t)),l?a.setTimeout(i):i()}),(function(){try{d||a.onMultipleDone()}catch(e){console.error(e)}})),d=!1,p=a.queueableFns[t];if(h.fail=function(){a.fail.apply(null,arguments),a.recordError_(t),h()},a.globalErrors.pushListener(c),void 0!==p.timeout){var f=p.timeout||e.DEFAULT_TIMEOUT_INTERVAL;o=a.setTimeout((function(){d=!0,g(new Error("Timeout - Async function did not complete within "+f+"ms "+(p.timeout?"(custom timeout)":"(set by jasmine.DEFAULT_TIMEOUT_INTERVAL)"))),h()}),f)}try{if(0!==p.fn.length)return r=p.fn.call(a.userContext,h),this.diagnoseConflictingAsync_(p.fn,r),l=!1,{completedSynchronously:!1};if((r=p.fn.call(a.userContext))&&e.isFunction_(r.then))return r.then((s=h,function(t){e.isError_(t)?s(t):s()}),(function(e){g(e),h()})),l=!1,{completedSynchronously:!1}}catch(e){g(e),a.recordError_(t)}return u(),{completedSynchronously:!0};function g(e){a.onException(e),a.recordError_(t)}},s.prototype.run=function(e){var t,i=this.queueableFns.length,o=this;for(t=e;t<i;t=this.nextFnIx_(t)){if(!this.attempt(t).completedSynchronously)return}this.clearStack((function(){o.globalErrors.popListener(o.handleFinalError),o.errored_?o.onComplete(new n):o.onComplete()}))},s.prototype.nextFnIx_=function(e){const t=this.skipPolicy_.skipTo(e);if(t===e)throw new Error("Can't skip to the same queueable fn that just finished");return t},s.prototype.recordError_=function(e){this.errored_=!0,this.skipPolicy_.fnErrored(e)},s.prototype.diagnoseConflictingAsync_=function(t,n){n&&e.isFunction_(n.then)&&(e.isAsyncFunction_(t)?this.onException("An asynchronous before/it/after function was defined with the async keyword but also took a done callback. Either remove the done callback (recommended) or remove the async keyword."):this.onException("An asynchronous before/it/after function took a done callback but also returned a promise. Either remove the done callback (recommended) or change the function to not return a promise."))},s},getJasmineRequireObj().ReportDispatcher=function(e){return function(t,n,i){for(var o=t||[],r=0;r<o.length;r++){var s=o[r];this[s]=function(e){return function(){c(e,arguments)}}(s)}var a=[],l=null;return this.addReporter=function(e){a.push(e)},this.provideFallbackReporter=function(e){l=e},this.clearReporters=function(){a=[]},this;function c(t,o){0===a.length&&null!==l&&a.push(l);var r=o[o.length-1];o=e.util.argsToArray(o).splice(0,o.length-1);for(var s=[],c=0;c<a.length;c++){u(s,a[c],t,o)}n({queueableFns:s,onComplete:r,isReporter:!0,onMultipleDone:function(){i(new Error("An asynchronous reporter callback called its 'done' callback more than once."))}})}function u(t,n,i,o){var r=n[i];if(r){var s=e.util.cloneArgs(o);r.length<=1?t.push({fn:function(){return r.apply(n,s)}}):t.push({fn:function(e){return r.apply(n,s.concat([e]))}})}}}},getJasmineRequireObj().interface=function(e,t){var n={describe:function(e,n){return t.describe(e,n)},xdescribe:function(e,n){return t.xdescribe(e,n)},fdescribe:function(e,n){return t.fdescribe(e,n)},it:function(){return t.it.apply(t,arguments)},xit:function(){return t.xit.apply(t,arguments)},fit:function(){return t.fit.apply(t,arguments)},beforeEach:function(){return t.beforeEach.apply(t,arguments)},afterEach:function(){return t.afterEach.apply(t,arguments)},beforeAll:function(){return t.beforeAll.apply(t,arguments)},afterAll:function(){return t.afterAll.apply(t,arguments)},setSpecProperty:function(e,n){return t.setSpecProperty(e,n)},setSuiteProperty:function(e,n){return t.setSuiteProperty(e,n)},expect:function(e){return t.expect(e)},expectAsync:function(e){return t.expectAsync(e)},pending:function(){return t.pending.apply(t,arguments)},fail:function(){return t.fail.apply(t,arguments)},spyOn:function(e,n){return t.spyOn(e,n)},spyOnProperty:function(e,n,i){return t.spyOnProperty(e,n,i)},spyOnAllFunctions:function(e,n){return t.spyOnAllFunctions(e,n)},jsApiReporter:new e.JsApiReporter({timer:new e.Timer}),jasmine:e};return e.addCustomEqualityTester=function(e){t.addCustomEqualityTester(e)},e.addMatchers=function(e){return t.addMatchers(e)},e.addAsyncMatchers=function(e){return t.addAsyncMatchers(e)},e.addCustomObjectFormatter=function(e){return t.addCustomObjectFormatter(e)},e.clock=function(){return t.clock},e.createSpy=function(e,n){return t.createSpy(e,n)},e.createSpyObj=function(e,n,i){return t.createSpyObj(e,n,i)},e.addSpyStrategy=function(e,n){return t.addSpyStrategy(e,n)},e.setDefaultSpyStrategy=function(e){return t.setDefaultSpyStrategy(e)},n},getJasmineRequireObj().SkipAfterBeforeAllErrorPolicy=function(e){function t(e){this.queueableFns_=e,this.skipping_=!1}return t.prototype.skipTo=function(e){return this.skipping_?this.nextAfterAllAfter_(e):e+1},t.prototype.nextAfterAllAfter_=function(e){for(e++;e<this.queueableFns_.length&&"afterAll"!==this.queueableFns_[e].type;e++);return e},t.prototype.fnErrored=function(e){"beforeAll"===this.queueableFns_[e].type&&(this.skipping_=!0,this.queueableFns_[e].suite.hadBeforeAllFailure=!0)},t},getJasmineRequireObj().Spy=function(e){var t,n=(t=0,function(){return t++});function i(t,n){var i=new e.SpyStrategy(t),r=new o((function(){return new e.SpyStrategy(t)}),n);this.and=i,this.exec=function(n,o,s){var a=r.get(o);if(!a){if(r.any()&&!i.isConfigured())throw new Error("Spy '"+t.name+"' received a call with arguments "+e.basicPrettyPrinter_(Array.prototype.slice.call(o))+" but all configured strategies specify other arguments.");a=i}return a.exec(n,o,s)},this.withArgs=function(){return{and:r.getOrCreate(arguments)}}}function o(e,t){this.strategies=[],this.strategyFactory=e,this.matchersUtil=t}return o.prototype.any=function(){return this.strategies.length>0},o.prototype.getOrCreate=function(e){var t=this.get(e);return t||(t=this.strategyFactory(),this.strategies.push({args:e,strategy:t})),t},o.prototype.get=function(e){var t;for(t=0;t<this.strategies.length;t++)if(this.matchersUtil.equals(e,this.strategies[t].args))return this.strategies[t].strategy},function(t,o,r){const{originalFn:s,customStrategies:a,defaultStrategyFn:l}=r||{};var c=function(e,t){switch(e){case 1:return function e(n){return t(this,arguments,this instanceof e)};case 2:return function e(n,i){return t(this,arguments,this instanceof e)};case 3:return function e(n,i,o){return t(this,arguments,this instanceof e)};case 4:return function e(n,i,o,r){return t(this,arguments,this instanceof e)};case 5:return function e(n,i,o,r,s){return t(this,arguments,this instanceof e)};case 6:return function e(n,i,o,r,s,a){return t(this,arguments,this instanceof e)};case 7:return function e(n,i,o,r,s,a,l){return t(this,arguments,this instanceof e)};case 8:return function e(n,i,o,r,s,a,l,c){return t(this,arguments,this instanceof e)};case 9:return function e(n,i,o,r,s,a,l,c,u){return t(this,arguments,this instanceof e)};default:return function e(){return t(this,arguments,this instanceof e)}}}("function"==typeof s?s.length:0,(function(e,t,n){return d(e,t,n)})),u=new i({name:t,fn:s,getSpy:function(){return c},customStrategies:a},o),h=new e.CallTracker,d=function(e,t,i){var o={object:e,invocationOrder:n(),args:Array.prototype.slice.apply(t)};h.track(o);var r=u.exec(e,t,i);return o.returnValue=r,r};for(var p in s){if("and"===p||"calls"===p)throw new Error("Jasmine spies would overwrite the 'and' and 'calls' properties on the object being spied upon");c[p]=s[p]}return c.and=u.and,c.withArgs=function(){return u.withArgs.apply(u,arguments)},c.calls=h,l&&l(c.and),c}},getJasmineRequireObj().SpyFactory=function(e){function t(t){var n=[];if(e.isArray_(t))for(var i=0;i<t.length;i++)n.push([t[i]]);else if(e.isObject_(t))for(var o in t)t.hasOwnProperty(o)&&n.push([o,t[o]]);return n}return function(n,i,o){var r=this;this.createSpy=function(t,r){return e.Spy(t,o(),{originalFn:r,customStrategies:n(),defaultStrategyFn:i()})},this.createSpyObj=function(n,i,o){(e.isObject_(n)||e.isArray_(n))&&(o=i,i=n,n="unknown");for(var s,a,l={},c=t(i),u=0;u<c.length;u++)s=l[c[u][0]]=r.createSpy(n+"."+c[u][0]),c[u].length>1&&s.and.returnValue(c[u][1]);var h=t(o);for(u=0;u<h.length;u++)a={enumerable:!0,get:r.createSpy(n+"."+h[u][0]+".get"),set:r.createSpy(n+"."+h[u][0]+".set")},h[u].length>1&&(a.get.and.returnValue(h[u][1]),a.set.and.returnValue(h[u][1])),Object.defineProperty(l,h[u][0],a);if(0===c.length&&0===h.length)throw"createSpyObj requires a non-empty array or object of method names to create spies for";return l}}},getJasmineRequireObj().SpyRegistry=function(e){var t=e.formatErrorMsg("<spyOn>","spyOn(<object>, <methodName>)"),n=e.formatErrorMsg("<spyOnProperty>","spyOnProperty(<object>, <propName>, [accessType])");function i(e,t){var n=Object.keys(e);return t?Object.getOwnPropertyNames(e).filter((function(e){return"constructor"!==e||n.indexOf("constructor")>-1})):n}function o(e,t){for(var n,i=[],o=0;o<t.length;o++)n=t[o],Object.prototype.hasOwnProperty.call(e,n)&&r(e,n)&&i.push(n);return i}function r(e,t){var n,i;try{n=e[t]}catch(e){return!1}return n instanceof Function&&(((i=Object.getOwnPropertyDescriptor(e,t)).writable||i.set)&&i.configurable)}return function(r){var s=(r=r||{}).global||e.getGlobal(),a=r.createSpy,l=r.currentSpies||function(){return[]};this.allowRespy=function(e){this.respy=e},this.spyOn=function(n,i){var o=t;if(e.util.isUndefined(n)||null===n)throw new Error(o("could not find an object to spy upon for "+i+"()"));if(e.util.isUndefined(i)||null===i)throw new Error(o("No method name supplied"));if(e.util.isUndefined(n[i]))throw new Error(o(i+"() method does not exist"));if(n[i]&&e.isSpy(n[i])){if(this.respy)return n[i];throw new Error(o(i+" has already been spied upon"))}var r=Object.getOwnPropertyDescriptor(n,i);if(r&&!r.writable&&!r.set)throw new Error(o(i+" is not declared writable or has no setter"));var c,u=n[i],h=a(i,u);return c=Object.prototype.hasOwnProperty.call(n,i)||n===s&&"onerror"===i?function(){n[i]=u}:function(){delete n[i]||(n[i]=u)},l().push({restoreObjectToOriginalState:c}),n[i]=h,h},this.spyOnProperty=function(t,i,o){var r=n;if(o=o||"get",e.util.isUndefined(t))throw new Error(r("spyOn could not find an object to spy upon for "+i));if(e.util.isUndefined(i))throw new Error(r("No property name supplied"));var s=e.util.getPropertyDescriptor(t,i);if(!s)throw new Error(r(i+" property does not exist"));if(!s.configurable)throw new Error(r(i+" is not declared configurable"));if(!s[o])throw new Error(r("Property "+i+" does not have access type "+o));if(e.isSpy(s[o])){if(this.respy)return s[o];throw new Error(r(i+"#"+o+" has already been spied upon"))}var c,u=e.util.clone(s),h=a(i,s[o]);return c=Object.prototype.hasOwnProperty.call(t,i)?function(){Object.defineProperty(t,i,u)}:function(){delete t[i]},l().push({restoreObjectToOriginalState:c}),s[o]=h,Object.defineProperty(t,i,s),h},this.spyOnAllFunctions=function(t,n){if(e.util.isUndefined(t))throw new Error("spyOnAllFunctions could not find an object to spy upon");for(var r,s=t,a=[],l=[];s&&(!n||s!==Object.prototype);)r=(r=i(s,n)).filter((function(e){return-1===l.indexOf(e)})),l=l.concat(r),a=a.concat(o(s,r)),s=Object.getPrototypeOf(s);for(var c=0;c<a.length;c++)this.spyOn(t,a[c]);return t},this.clearSpies=function(){for(var e=l(),t=e.length-1;t>=0;t--){e[t].restoreObjectToOriginalState()}}}},getJasmineRequireObj().SpyStrategy=function(e){function t(t){t=t||{};var i=this;this.identity=t.name||"unknown",this.originalFn=t.fn||function(){},this.getSpy=t.getSpy||function(){},this.plan=this._defaultPlan=function(){};var o,r=t.customStrategies||{};for(o in r)e.util.has(r,o)&&!this[o]&&(this[o]=n(r[o]));this.resolveTo=function(e){return i.plan=function(){return Promise.resolve(e)},i.getSpy()},this.rejectWith=function(e){return i.plan=function(){return Promise.reject(e)},i.getSpy()}}function n(t){return function(){var n=t.apply(null,arguments);if(!e.isFunction_(n))throw new Error("Spy strategy must return a function");return this.plan=n,this.getSpy()}}return t.prototype.exec=function(e,t,n){var i=[e].concat(t?Array.prototype.slice.call(t):[]),o=this.plan.bind.apply(this.plan,i);return n?new o:o()},t.prototype.callThrough=function(){return this.plan=this.originalFn,this.getSpy()},t.prototype.returnValue=function(e){return this.plan=function(){return e},this.getSpy()},t.prototype.returnValues=function(){var e=Array.prototype.slice.call(arguments);return this.plan=function(){return e.shift()},this.getSpy()},t.prototype.throwError=function(t){var n=e.isString_(t)?new Error(t):t;return this.plan=function(){throw n},this.getSpy()},t.prototype.callFake=function(t){if(!(e.isFunction_(t)||e.isAsyncFunction_(t)||e.isGeneratorFunction_(t)))throw new Error("Argument passed to callFake should be a function, got "+t);return this.plan=t,this.getSpy()},t.prototype.stub=function(e){return this.plan=function(){},this.getSpy()},t.prototype.isConfigured=function(){return this.plan!==this._defaultPlan},t},getJasmineRequireObj().StackTrace=function(e){var t=[{re:/^\s*at ([^\)]+) \(([^\)]+)\)$/,fnIx:1,fileLineColIx:2,style:"v8"},{re:/\s*at (.+)$/,fileLineColIx:1,style:"v8"},{re:/^(?:(([^@\s]+)@)|@)?([^\s]+)$/,fnIx:2,fileLineColIx:3,style:"webkit"}];return function(e){var n=e.stack.split("\n").filter((function(e){return""!==e})),i=function(e,t){var n=function(e,t){if(!t[0].match(/^\w*Error/))return 0;var n,i=e.split("\n");for(n=1;n<i.length;n++)if(i[n]!==t[n])return 0;return i.length}(e,t);if(n>0)return{message:t.slice(0,n).join("\n"),remainder:t.slice(n)}}(e.message,n);i&&(this.message=i.message,n=i.remainder);var o=function(e){var n=null,i=e.map((function(e){return function(e,t){var n,i;for(n=0;n<e.length;n++)if(i=t(e[n]))return i}(t,(function(t){var i,o=e.match(t.re);return o&&(i=o[t.fileLineColIx].match(/^(.*):(\d+):\d+$/))?(n=n||t.style,{raw:e,file:i[1],line:parseInt(i[2],10),func:o[t.fnIx]}):null}))||{raw:e}}));return{style:n,frames:i}}(n);this.frames=o.frames,this.style=o.style}},getJasmineRequireObj().Suite=function(e){function t(t){this.env=t.env,this.id=t.id,this.parentSuite=t.parentSuite,this.description=t.description,this.expectationFactory=t.expectationFactory,this.asyncExpectationFactory=t.asyncExpectationFactory,this.throwOnExpectationFailure=!!t.throwOnExpectationFailure,this.autoCleanClosures=void 0===t.autoCleanClosures||!!t.autoCleanClosures,this.onLateError=t.onLateError||function(){},this.beforeFns=[],this.afterFns=[],this.beforeAllFns=[],this.afterAllFns=[],this.timer=t.timer||new e.Timer,this.children=[],this.reset()}function n(e){for(var t=0;t<e.length;t++)e[t].fn=null}function i(e){this.suite_=e,this.id=e.id,this.parentSuite=e.parentSuite?e.parentSuite.metadata:null,this.description=e.description}return t.prototype.setSuiteProperty=function(e,t){this.result.properties=this.result.properties||{},this.result.properties[e]=t},t.prototype.expect=function(e){return this.expectationFactory(e,this)},t.prototype.expectAsync=function(e){return this.asyncExpectationFactory(e,this)},t.prototype.getFullName=function(){for(var e=[],t=this;t;t=t.parentSuite)t.parentSuite&&e.unshift(t.description);return e.join(" ")},t.prototype.pend=function(){this.markedPending=!0},t.prototype.exclude=function(){this.pend(),this.markedExcluding=!0},t.prototype.beforeEach=function(e){this.beforeFns.unshift({...e,suite:this})},t.prototype.beforeAll=function(e){this.beforeAllFns.push({...e,type:"beforeAll",suite:this})},t.prototype.afterEach=function(e){this.afterFns.unshift({...e,suite:this,type:"afterEach"})},t.prototype.afterAll=function(e){this.afterAllFns.unshift({...e,type:"afterAll"})},t.prototype.startTimer=function(){this.timer.start()},t.prototype.endTimer=function(){this.result.duration=this.timer.elapsed()},t.prototype.cleanupBeforeAfter=function(){this.autoCleanClosures&&(n(this.beforeAllFns),n(this.afterAllFns),n(this.beforeFns),n(this.afterFns))},t.prototype.reset=function(){this.result={id:this.id,description:this.description,fullName:this.getFullName(),failedExpectations:[],deprecationWarnings:[],duration:null,properties:null},this.markedPending=this.markedExcluding,this.children.forEach((function(e){e.reset()})),this.reportedDone=!1},t.prototype.addChild=function(e){this.children.push(e)},t.prototype.status=function(){return this.markedPending?"pending":this.result.failedExpectations.length>0?"failed":"passed"},t.prototype.canBeReentered=function(){return 0===this.beforeAllFns.length&&0===this.afterAllFns.length},t.prototype.getResult=function(){return this.result.status=this.status(),this.result},t.prototype.sharedUserContext=function(){return this.sharedContext||(this.sharedContext=this.parentSuite?this.parentSuite.clonedSharedUserContext():new e.UserContext),this.sharedContext},t.prototype.clonedSharedUserContext=function(){return e.UserContext.fromExisting(this.sharedUserContext())},t.prototype.handleException=function(){if(arguments[0]instanceof e.errors.ExpectationFailed)return;const t={matcherName:"",passed:!1,expected:"",actual:"",error:arguments[0]},n=e.buildExpectationResult(t);this.parentSuite||(n.globalErrorType="afterAll"),this.reportedDone?this.onLateError(n):this.result.failedExpectations.push(n)},t.prototype.onMultipleDone=function(){let e;e=this.parentSuite?"An asynchronous beforeAll or afterAll function called its 'done' callback more than once.\n(in suite: "+this.getFullName()+")":"A top-level beforeAll or afterAll function called its 'done' callback more than once.",this.onLateError(new Error(e))},t.prototype.addExpectationResult=function(){if(!arguments[0]){const t=arguments[1],n=e.buildExpectationResult(t);if(this.reportedDone?this.onLateError(n):this.result.failedExpectations.push(n),this.throwOnExpectationFailure)throw new e.errors.ExpectationFailed}},t.prototype.addDeprecationWarning=function(t){"string"==typeof t&&(t={message:t}),this.result.deprecationWarnings.push(e.buildExpectationResult(t))},Object.defineProperty(t.prototype,"metadata",{get:function(){return this.metadata_||(this.metadata_=new i(this)),this.metadata_}}),i.prototype.getFullName=function(){return this.suite_.getFullName()},Object.defineProperty(i.prototype,"children",{get:function(){return this.suite_.children.map((e=>e.metadata))}}),t},getJasmineRequireObj().Timer=function(){var e=function(e){return function(){return(new e).getTime()}}(Date);return function(t){var n,i=(t=t||{}).now||e;this.start=function(){n=i()},this.elapsed=function(){return i()-n}}},getJasmineRequireObj().TreeProcessor=function(){return function(e){var t=e.tree,n=e.runnableIds,i=e.queueRunnerFactory,o=e.nodeStart||function(){},r=e.nodeComplete||function(){},s=!!e.failSpecWithNoExpectations,a=e.orderChildren||function(e){return e.children},l=e.excludeNode||function(e){return!1},c={valid:!0},u=!1,h=1/0,d=-1/0;function p(e,t){var i=function(e){for(var t=0;t<n.length;t++)if(n[t]===e)return t}(e.id);if(void 0!==i&&(t=!1),e.children){for(var o=!1,r=a(e),s=0;s<r.length;s++){var u=r[s];if(p(u,t),!c.valid)return;var m=c[u.id];o=o||m.willExecute}c[e.id]={excluded:t,willExecute:o},function(e,t,n,i){var o={index:0,owner:e,nodes:[],min:f(i),max:g(i)},r=[o],s=d,a=function(e){for(var t=[],n=[],i=0;i<e.length;i++)for(var o=e[i],r=c[o.id].segments,s=0;s<r.length;s++){var a=r[s];a.min===h?n.push(a):t.push(a)}return t.sort((function(e,t){return e.min-t.min})),t.concat(n)}(t);function l(e){return s!==d&&e!==h&&s<e-1}for(var u=0;u<a.length;u++){var p=a[u],m=p.max,y=p.min;l(y)&&(o={index:r.length,owner:e,nodes:[],min:h,max:d},r.push(o)),o.nodes.push(p),o.min=Math.min(o.min,y),o.max=Math.max(o.max,m),s=m}n.segments=r}(e,r,c[e.id],i),!e.canBeReentered()&&c[e.id].segments.length>1&&(c={valid:!1})}else{var y=t||l(e);c[e.id]={excluded:y,willExecute:!y&&!e.markedPending,segments:[{index:0,owner:e,nodes:[e],min:f(i),max:g(i)}]}}}function f(e){return void 0===e?h:e}function g(e){return void 0===e?d:e}function m(e,t){return e.children?{fn:function(n){i({onComplete:function(){var t=Array.prototype.slice.call(arguments,[0]);e.cleanupBeforeAfter(),r(e,e.getResult(),(function(){n.apply(void 0,t)}))},queueableFns:[{fn:function(t){o(e,t)}}].concat(y(e,t)),userContext:e.sharedUserContext(),onException:function(){e.handleException.apply(e,arguments)},onMultipleDone:e.onMultipleDone?e.onMultipleDone.bind(e):null})}}:{fn:function(t){e.execute(t,c[e.id].excluded,s)}}}function y(e,t){for(var n=[],i=c[e.id].segments[t].nodes,o=0;o<i.length;o++)n.push(m(i[o].owner,i[o].index));return c[e.id].willExecute?e.beforeAllFns.concat(n).concat(e.afterAllFns):n}this.processTree=function(){return p(t,!0),u=!0,c},this.execute=function(e){if(u||this.processTree(),!c.valid)throw"invalid order";var n=y(t,0);i({queueableFns:n,userContext:t.sharedUserContext(),onException:function(){t.handleException.apply(t,arguments)},onComplete:e,onMultipleDone:t.onMultipleDone?t.onMultipleDone.bind(t):null})}}},getJasmineRequireObj().UserContext=function(e){function t(){}return t.fromExisting=function(e){var n=new t;for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n},t},getJasmineRequireObj().version=function(){return"4.2.0"},define("toxilibs/extlibs/jasmine-4.2.0",(function(){})),define("user_code/test_suite",["event_bus","render/screen","toxilibs/color","render/font_awesome_codes","toxilibs/extlibs/jasmine-4.2.0"],(function(e,t,n,i){e.on("execution started",g);const{jasmineRequire:o}=window,r=o.core(o);function s(e){return{pass:!1,message:e}}function a(e=""){return{pass:!0,message:e}}function l({input:e,propertyName:t,value:n,inputName:i,matchersUtil:o}){if(void 0===n)return t in e?s(`Expected${i} to have no property "${t}"`):a();if(!(t in e))return s(`Expected${i} to have a property "${t}"`);let r=e[t];if(o.equals(r,n))return a();{let e;return e=i?`${i}.${t}`:` property ${t}`,s(`Expected${e} to equal ${o.pp(n)} ,\n                but got ${o.pp(r)} instead`)}}const c={toHavePropertyEqual:function(e){return{compare:(t,n,i,o="")=>{o&&(o=` ${o}`);let r=typeof t;return"object"!==r?s(`Expected${o} to be an object, instead of ${r}`):l({input:t,propertyName:n,value:i,inputName:o,matchersUtil:e})}}},toHavePropertiesEqual:function(e){return{compare:(t,n,i="")=>{i&&(i=` ${i}`);let o=typeof t;return"object"!==o?s(`Expected${i} to be an object, instead of ${o}`):function({input:e,target:t,inputName:n,matchersUtil:i}){for(let o in t){let r=l({input:e,propertyName:o,value:t[o],inputName:n,matchersUtil:i});if(!r.pass)return r}return a()}({input:t,target:n,inputName:i,matchersUtil:e})}}},toHaveShape:function(e){return{compare:(t,n,i)=>{const{screenGroup:o}=t;if(!o)return s("Expected to have screen as an input");const r=` ${n}`,{elements:a,methods:l}=o,c=`draw${n}`;let u,h=0;for(let t=0;t<a.length;t++){const o=l[t],s=a[t];if(c!==o)continue;h+=1;let d=p({inputName:r,shapeName:n,params:s,expectedParams:i,matchersUtil:e});if(d.pass)return d;u=d}return 0===h?s(`Screen has no ${n} in it`):1===h?u:s(`Screen has no matching ${n}`)}}}};const{paramsTypes:u}=t,h={text:(e,t)=>e===(t=t.replace(/<i class="fas">(.*)<\/i>/,"$1")),textWithUSyntax:(e,t)=>e===(t=t.replace(/<i class="fas">(.*)<\/i>/,"$1")),font:(...e)=>h.text(...e),length:(e,t,n)=>Math.abs(e-t)<n+1e-8,coords:(e,t,n)=>h.length(e.x,t.x,n)&&h.length(e.y,t.y,n),vector:(...e)=>h.coords(...e),angle:(e,t)=>{let n=((180+e-t)%(i=360)+i)%i-180;var i;return Math.abs(n)<10},color:(e,t)=>("string"==typeof e&&(e=new n(e)),e.isCloseTo(t))},d=["radius","width","height","size"];function p({inputName:e,params:t,expectedParams:n,matchersUtil:o}){let r=0;d.forEach((e=>{e in n&&(r=Math.max(0,n[e]))}));let l=r/10;for(let r in n){let a=t[r],c=n[r],d=u[r],p=r;if(n.isAnIcon){if("isAnIcon"===r)continue;"name"===r&&(p="text",d=u.text,a=t.text,c=i[c]),"size"===r&&(p="font",d=u.font,a=t.font,c=`${String(c)}u FontAwesomeForScreen`)}if(!d)throw new Error(`property ${r} is unsupported by screen`);if(void 0!==c){if(!(p in t))return s(`Expected${e} to have a property "${r}"`);if(!h[d](a,c,l))return n.isAnIcon&&"name"===r&&(c=`<i class="fas">${c}</i>`,a=`<i class="fas">${a}</i>`),s(`Expected${e} ${r} to equal ${o.pp(c)} ,\n                    but got ${o.pp(a)} instead`)}else if(p in t)return s(`Expected${e} to have no property "${r}"`)}return a(`Expected${e} not to be present`)}const f=r.getEnv();function g(){f.topSuite().suite_.children.length=0}f.configure({autoCleanClosures:!0,stopOnSpecFailure:!1,stopSpecOnExpectationFailure:!0,random:!1});const m=o.interface(r,f),y=Object.assign({},m);return y.add=y.it,y.section=function(e,t){return y.describe(e,(()=>{y.beforeEach((()=>y.jasmine.addMatchers(c))),t()}))},delete y.jsApiReporter,y.resetAll=g,y.run=function(e=()=>{}){let t=new r.JsApiReporter({timer:new r.Timer});f.clearReporters(),f.addReporter(t),f.execute(!1,(()=>{e(t)}))},y})),
/*! Toxilib url_params
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/url_params",[],(function(){function e(e,n){return"#"!==e&&"all"!==e||(n=e,e=!1),e||(e=document.location.href),function(e,n){let o={},r=t(e);(function(e){return"params"===e||"all"===e})(n)&&i(o,r.regularParams);(function(e){return"#"===e||"all"===e})(n)&&i(o,r.hashParams);return o}(e=decodeURI(e.replace(/\+/g," ")),n=n||"params")}function t(e){let t=e.split("#"),n=t[0].split("?");return{mainUrl:n[0],regularParams:n[1],hashParams:t[1]}}function n(t){document.location.href!==t&&window.history.pushState(e(t),document.title,t)}function i(e,t){if(!t)return;t.split("&").forEach((function(t){let[n,i]=t.split("=");o(e,n,function(e,t){if(void 0===t)return null;t=d(t);let n=Number(t);String(n)===t&&(t=n);if("true"===t)return!0;if("false"===t)return!1;return t}(0,i))}))}function o(e,t,n){const i=t.match(/(\w+)\[(.*)\]/);if(i){const r=i[1],s=i[2];s?function(e,{keyStart:t,insideBrackets:n,value:i}){t in e||(e[t]={});n.indexOf("]")>0&&(n=`${n.replace("]","")}]`);o(e[t],n,i)}(e,{keyStart:r,insideBrackets:s,value:n}):function(e,t,n){t in e||(e[t]=[]);e[t].push(n)}(e,t,n)}else e[t]=n}function r(e,n,r={}){if(0===Object.keys(n).length)return e;let s=t(e=d(e)),l=`${encodeURI(s.mainUrl)}?`;if(s.regularParams){let e={};i(e,s.regularParams),n=function(e,t){let n={};for(let t in e)n[t]=e[t];for(let i in t){let r=t[i];`${i}[]`in e&&null===r?delete n[`${i}[]`]:o(n,i,r)}return n}(e,n)}let c=a(n,r);return c&&(l+=c),s.hashParams&&(l+=`#${s.hashParams}`),l}function s(e,n,o={}){var r;r=n,n=Array.isArray(r)?r:[r];let s=t(e=decodeURIComponent(e)),l={};i(l,s.regularParams);let c={},u=!1;for(let e in l)-1===n.indexOf(e)?c[e]=l[e]:u=!0;if(!u)return e;let h=s.mainUrl,d=a(c,o);return d&&(h+=`?${d}`),s.hashParams&&(h+=`#${s.hashParams}`),h}function a(e,t={}){let n=[];for(let i in e){let o=e[i];i.endsWith("[]")&&(i=i.substring(0,i.length-2)),l(n,{key:i,value:o},t)}return n.join("&")}function l(e,{key:t,value:n},i){let o;o=Array.isArray(n)?u:"object"==typeof n?h:c,o(e,{key:t,value:n},i)}function c(e,{key:t,value:n},{ignoreEmptyParams:i}){""===n&&i||e.push(`${p(t)}=${p(n)}`)}function u(e,{key:t,value:n},{useCommaForArrays:i}){if(i)e.push(`${p(t)}=${n.map(p).join(",")}`);else{let i=p(`${t}[]`);n.forEach((t=>{e.push(`${i}=${p(t)}`)}))}}function h(e,{key:t,value:n},i){for(let o in n){const r=n[o];o.endsWith("[]")&&(o=o.substring(0,o.length-2)),l(e,{key:`${t}[${p(o)}]`,value:r},i)}}function d(e){return decodeURIComponent(e.replace(/\+/g," "))}function p(e){return encodeURIComponent(e).replace(/%20/g,"+")}return e.pushStateAdd=function(e,t){n(r(document.location.href,e,t))},e.pushStateRemove=function(e,t){n(s(document.location.href,e,t))},e.pushStateReplace=function(e,t){n(r(window.location.pathname,e,t))},e.extendUrlWithParams=r,e.removeParamsFromUrl=s,e.paramsToUrlString=a,e.addParamsFromString=i,e.isEmpty=function(){return 0===Object.keys(e()).length},e})),
/*! Toxilib toxicode_remote_challenge
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/toxicode_remote_challenge",["./url_params"],(function(e){function t(e,t,n){let i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}let n=!1;function i(e){n&&window.parent?window.parent.location=e:window.location=e}return{goToChallenge:function({url:t,token:n,returnUrl:o}){i(e.extendUrlWithParams(t,{token:n,returnUrl:o}))},checkRemoteMode:function(){let{returnUrl:o,token:r,status:s}=e();return!(!r&&!o)&&(o?{token:r,returnUrl:o,status:s,goBack:function(e){!function({url:e,result:o,token:r}){if(!r)return void i(e);let s=document.createElement("form");s.setAttribute("method","post"),s.setAttribute("action",e),n&&s.setAttribute("target","_top"),t(s,"token",r),t(s,"result",o),document.body.appendChild(s),s.submit()}({url:o,result:e,token:r})}}:{error:"no return url has been provided"})},setRedirectOnParent:function(e){n=e}}})),define("challenge/result",["event_bus","toxilibs/toxicode_remote_challenge","logger"],(function(e,t,n){const i=t.checkRemoteMode();if(i&&(t.setRedirectOnParent(!0),i.error&&console.error(i.error),i&&"success"===i.status)){let t;e.on("execution started",(()=>{t||(n.log("Vous avez déjà validé ce challenge"),t=!0)}))}return function(e){e?(n.error("Perdu !"),e.unitTest&&(n.log("Test : "),n.log(e.unitTest)),e.error?n.error(e.error):(n.success(`Resultat demandé : ${e.expected}`),n.warn(`Resultat obtenu : ${e.result}`))):(n.success("Gagné !"),i&&("success"===i.status?n.success("Mais vous aviez déjà validé ce challenge"):(n.success("Vous allez être redirigé vers les challenges..."),setTimeout((()=>{i.goBack("win")}),2e3))))}})),define("render/render_tests",["event_bus","user_code/test_suite","challenge/result"],(function(e,t,n){let i,o=console;function r(e){o.rawLog(`<span class="error">${e}</span>`)}e.on("terminal logger api ready",(e=>{i=e}));let s=!0;return t.hideFailDetails=function(){s=!1},function(e,a){return{createTestUi:function(e){s=!0,o===console&&i&&(o=i.terminal.tests),t.resetAll(),e(),o.clear(),o.log("\n------------------------ Testing..."),t.run((e=>{setTimeout((()=>function(e){let t=e.specs(),i=0;t.forEach((e=>{"failed"===e.status?(r(`NO - ${e.fullName}`),e.failedExpectations.forEach((e=>{var t;i+=1,s&&r(`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${t=e.message,t.replace(/<jasmine\.(.*?)>/g,"$1")}`)}))):o.log(`OK - ${e.fullName}`)})),0===i?n():r(`<br>--\x3e Total of ${i} error${i>1?"s":""}`)}(e)),150)}))},winChallenge:function(){n(!1)}}}})),
/*! Toxilib vector3d
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/vector3d",[],(function(){function e(e,t,n){"number"==typeof e?(this.x=e,this.y=t,this.z=n):(this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z)}return e.prototype.isNull=function(){return 0===this.x&&0===this.y&&0===this.z},e.prototype.clone=function(){return new e(this.x,this.y,this.z)},e.prototype.plus=function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z)},e.prototype.minus=function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z)},e.prototype.multiply=function(t){return new e(this.x*t,this.y*t,this.z*t)},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},e.prototype.setLength=function(e){return this.multiply(e/this.length())},e.prototype.normalize=function(){return this.multiply(1/this.length())},e.prototype.dotProduct=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},e.prototype.projectOn=function(e){return e.multiply(this.dotProduct(e))},e.prototype.crossProduct=function(t){return new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},e})),define("render/simple_3d_api",["toxilibs/vector3d","toxilibs/object_utils"],(function(e,t){const{clone:n}=t;return function({screenGroup:t}){let i,o,r,s={x:0,y:0,z:0};function a(){let t=new e(i,s),n=t.length,a=t.normalize();o=new e(a.y,-a.x,0),o=o.setLength(1/n),r=o.crossProduct(a),r=r.setLength(1/n)}function l(t){let n=new e(i,t),s=n.length;return{x:150*n.dotProduct(o)/s,y:150*n.dotProduct(r)/s}}function c(e){return e.map(l)}return{setCamera3d:function(e){i=e,a()},setTarget3d:function(e){s=e,a()},project3d:l,rotate3d:function(e,t){return{x:t[0][0]*e.x+t[0][1]*e.y+t[0][2]*e.z,y:t[1][0]*e.x+t[1][1]*e.y+t[1][2]*e.z,z:t[2][0]*e.x+t[2][1]*e.y+t[2][2]*e.z}},drawLines3d:function(e){(e=n(e)).points=c(e.points),t.addLines(e)},drawWireFrame3d:function(e){let i=c((e=n(e)).points),{links:o}=e;delete e.links,o.forEach((function(n){e.origin=i[n[0]],e.end=i[n[1]],t.addLine(e)}))}}}})),define("render/hybrid_screen_image",["toxilibs/screen","toxilibs/screen_image"],(function(e,t){const n=["isInside","isOutside","getTextDimensions","boundingBox","pixBoundingBox","boundingBoxForPixelZone","boundingBoxForWholeView"],i=[...e.drawingMethods,"clear"];function o(e){e.screenMode&&(e.screenMode=!1,delete e.imageData,e.imageData=e._screen.toImageData(),e.imageDataData=e.imageData.data,e.addOnePixelMethods()),i.forEach((n=>{let r=n.replace("draw","add");e[r]=(...n)=>(function(e){const{_screen:n}=e;e.screenMode=!0,n.drawAdapter.cx.putImageData(e.imageData,0,0),i.forEach((t=>{let i=t.replace("draw","add");e[i]=(...e)=>n[t](...e)})),[...t.instancePixelMethods,...t.directPixelMethodsOnPrototype].forEach((t=>{e[t]=(...n)=>(o(e),e[t](...n))})),Object.defineProperty(e,"imageData",{enumerable:!0,configurable:!0,get:()=>n.toImageData()})}(e),e[r](...n))}))}return function(e){let i,r,s,a=new Promise((e=>{s=e})),l=e.whenLoaded;return e=Object.assign({},e,{whenLoaded:function(e){r=!0,function(e){const t=e.toScreen();e._screen=t,e.whenDiscretizationChanged=()=>{const{center:n,width:i}=e.getPosition();t.setCamera({center:n,scale:e.widthInPixels/i})},n.forEach((n=>{e[n]=(...e)=>t[n](...e)})),o(e)}(e),i&&s&&s(i),l&&l(e)}}),i=new t(e),r?i:a}})),define("render/webcam",[],(function(){return function(e){const t=e.createExecutionErrorHandler("Explorers - webcam.js");function n(){return c()}let i,o;n.status="off";let r,s,a=[];function l({whenStarted:e,whenError:r}={}){i=document.createElement("video"),i.addEventListener("canplay",(function(){if("on"!==n.status){let e=i.videoWidth,t=i.videoHeight;isNaN(t)&&(t=3*e/4),i.setAttribute("width",e),i.setAttribute("height",t),n.status="on",a.forEach((e=>e())),a=[]}}),!1),n.status="init",navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){e&&a.push(e),o=t,i.srcObject=o,i.play()})).catch((function(e){n.status="error",t(new Error(`Webcam - ${e}`)),r&&r(e)}))}function c(){return"off"!==n.status||r||l(),"on"===n.status?i:function(){if(!s){s=document.createElement("canvas"),s.width=4,s.height=3;let e=s.getContext("2d");e.fillStyle="black",e.fillRect(0,0,s.width,s.height)}return s}()}return n.getImage=c,n.play=l,n.stop=function(){n.status="off",r=!0,o.getTracks().forEach((e=>e.stop()))},n}})),define("render/video",["user_code/handle_execution_error"],(function(e){const t=e("Explorers - video.js");return function(e){function n(){return c()}n.status="off";const i=document.createElement("video");let o;i.crossOrigin="Anonymous",i.src=e,i.addEventListener("canplay",(()=>{o=!0,i.muted=!0,i.width=i.videoWidth,i.height=i.videoHeight}));let r,s,a=[];function l({whenStarted:r,whenError:s}={}){n.status="init",i.addEventListener("error",(()=>{let o;o=i.networkState===HTMLMediaElement.NETWORK_NO_SOURCE?new Error(`Video - could not load url ${e}`):new Error(`Video - ${i.error.message}`),n.status="error",t(o),s&&s(o)})),r&&a.push(r),i.addEventListener("timeupdate",(function(){"on"!==n.status&&(n.status="on",a.forEach((e=>e())),a=[])}),!1),o?i.play():i.addEventListener("canplay",(()=>i.play()))}function c(){return"off"!==n.status||r||l(),"on"===n.status?i:function(){if(!s){s=document.createElement("canvas"),s.width=4,s.height=3;let e=s.getContext("2d");e.fillStyle="black",e.fillRect(0,0,s.width,s.height)}return s}()}return n.getImage=c,n.play=l,n.pause=function(){r=!0,i.pause()},n}})),
/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||t;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var n=this||t;if(e=parseFloat(e),n.ctx||c(),void 0!==e&&e>=0&&e<=1){if(n._volume=e,n._muted)return n;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(e,t.ctx.currentTime);for(var i=0;i<n._howls.length;i++)if(!n._howls[i]._webAudio)for(var o=n._howls[i]._getSoundIds(),r=0;r<o.length;r++){var s=n._howls[i]._soundById(o[r]);s&&s._node&&(s._node.volume=s._volume*e)}return n}return n._volume},mute:function(e){var n=this||t;n.ctx||c(),n._muted=e,n.usingWebAudio&&n.masterGain.gain.setValueAtTime(e?0:n._volume,t.ctx.currentTime);for(var i=0;i<n._howls.length;i++)if(!n._howls[i]._webAudio)for(var o=n._howls[i]._getSoundIds(),r=0;r<o.length;r++){var s=n._howls[i]._soundById(o[r]);s&&s._node&&(s._node.muted=!!e||s._muted)}return n},stop:function(){for(var e=this||t,n=0;n<e._howls.length;n++)e._howls[n].stop();return e},unload:function(){for(var e=this||t,n=e._howls.length-1;n>=0;n--)e._howls[n].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,c()),e},codecs:function(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||t;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,n=null;try{n="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!n||"function"!=typeof n.canPlayType)return e;var i=n.canPlayType("audio/mpeg;").replace(/^no$/,""),o=e._navigator?e._navigator.userAgent:"",r=o.match(/OPR\/(\d+)/g),s=r&&parseInt(r[0].split("/")[1],10)<33,a=-1!==o.indexOf("Safari")&&-1===o.indexOf("Chrome"),l=o.match(/Version\/(.*?) /),c=a&&l&&parseInt(l[1],10)<15;return e._codecs={mp3:!(s||!i&&!n.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(n.canPlayType('audio/wav; codecs="1"')||n.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(n.canPlayType("audio/x-m4b;")||n.canPlayType("audio/m4b;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(c||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(c||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||t;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var n=function(t){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,e._releaseHtml5Audio(i)}catch(t){e.noAudio=!0;break}for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var r=e._howls[o]._getSoundIds(),s=0;s<r.length;s++){var a=e._howls[o]._soundById(r[s]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",n,!0),document.removeEventListener("touchend",n,!0),document.removeEventListener("click",n,!0),document.removeEventListener("keydown",n,!0);for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("unlock")}};return document.addEventListener("touchstart",n,!0),document.addEventListener("touchend",n,!0),document.addEventListener("click",n,!0),document.addEventListener("keydown",n,!0),e}},_obtainHtml5Audio:function(){var e=this||t;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var n=(new Audio).play();return n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)&&n.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var n=this||t;return e._unlocked&&n._html5AudioPool.push(e),n},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&t.usingWebAudio){for(var n=0;n<e._howls.length;n++)if(e._howls[n]._webAudio)for(var i=0;i<e._howls[n]._sounds.length;i++)if(!e._howls[n]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&t.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var t=new e,n=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(e){var n=this;return t.ctx||c(),n._autoplay=e.autoplay||!1,n._format="string"!=typeof e.format?e.format:[e.format],n._html5=e.html5||!1,n._muted=e.mute||!1,n._loop=e.loop||!1,n._pool=e.pool||5,n._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,n._rate=e.rate||1,n._sprite=e.sprite||{},n._src="string"!=typeof e.src?e.src:[e.src],n._volume=void 0!==e.volume?e.volume:1,n._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._playLock=!1,n._onend=e.onend?[{fn:e.onend}]:[],n._onfade=e.onfade?[{fn:e.onfade}]:[],n._onload=e.onload?[{fn:e.onload}]:[],n._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],n._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],n._onpause=e.onpause?[{fn:e.onpause}]:[],n._onplay=e.onplay?[{fn:e.onplay}]:[],n._onstop=e.onstop?[{fn:e.onstop}]:[],n._onmute=e.onmute?[{fn:e.onmute}]:[],n._onvolume=e.onvolume?[{fn:e.onvolume}]:[],n._onrate=e.onrate?[{fn:e.onrate}]:[],n._onseek=e.onseek?[{fn:e.onseek}]:[],n._onunlock=e.onunlock?[{fn:e.onunlock}]:[],n._onresume=[],n._webAudio=t.usingWebAudio&&!n._html5,void 0!==t.ctx&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&"none"!==n._preload&&n.load(),n},load:function(){var e=this,n=null;if(t.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var o=0;o<e._src.length;o++){var s,a;if(e._format&&e._format[o])s=e._format[o];else{if("string"!=typeof(a=e._src[o])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(s=/^data:audio\/([^;,]+);/i.exec(a))||(s=/\.([^.]+)$/.exec(a.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(s||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),s&&t.codecs(s)){n=e._src[o];break}}if(n)return e._src=n,e._state="loading","https:"===window.location.protocol&&"http:"===n.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new i(e),e._webAudio&&r(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,n){var i=this,o=null;if("number"==typeof e)o=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var r=0,s=0;s<i._sounds.length;s++)i._sounds[s]._paused&&!i._sounds[s]._ended&&(r++,o=i._sounds[s]._id);1===r?e=null:o=null}}var a=o?i._soundById(o):i._inactiveSound();if(!a)return null;if(o&&!e&&(e=a._sprite||"__default"),"loaded"!==i._state){a._sprite=e,a._ended=!1;var l=a._id;return i._queue.push({event:"play",action:function(){i.play(l)}}),l}if(o&&!a._paused)return n||i._loadQueue("play"),a._id;i._webAudio&&t._autoResume();var c=Math.max(0,a._seek>0?a._seek:i._sprite[e][0]/1e3),u=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-c),h=1e3*u/Math.abs(a._rate),d=i._sprite[e][0]/1e3,p=(i._sprite[e][0]+i._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var f=function(){a._paused=!1,a._seek=c,a._start=d,a._stop=p,a._loop=!(!a._loop&&!i._sprite[e][2])};if(!(c>=p)){var g=a._node;if(i._webAudio){var m=function(){i._playLock=!1,f(),i._refreshBuffer(a);var e=a._muted||i._muted?0:a._volume;g.gain.setValueAtTime(e,t.ctx.currentTime),a._playStart=t.ctx.currentTime,void 0===g.bufferSource.start?a._loop?g.bufferSource.noteGrainOn(0,c,86400):g.bufferSource.noteGrainOn(0,c,u):a._loop?g.bufferSource.start(0,c,86400):g.bufferSource.start(0,c,u),h!==1/0&&(i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),h)),n||setTimeout((function(){i._emit("play",a._id),i._loadQueue()}),0)};"running"===t.state&&"interrupted"!==t.ctx.state?m():(i._playLock=!0,i.once("resume",m),i._clearTimer(a._id))}else{var y=function(){g.currentTime=c,g.muted=a._muted||i._muted||t._muted||g.muted,g.volume=a._volume*t.volume(),g.playbackRate=a._rate;try{var o=g.play();if(o&&"undefined"!=typeof Promise&&(o instanceof Promise||"function"==typeof o.then)?(i._playLock=!0,f(),o.then((function(){i._playLock=!1,g._unlocked=!0,n?i._loadQueue():i._emit("play",a._id)})).catch((function(){i._playLock=!1,i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):n||(i._playLock=!1,f(),i._emit("play",a._id)),g.playbackRate=a._rate,g.paused)return void i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||a._loop?i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),h):(i._endTimers[a._id]=function(){i._ended(a),g.removeEventListener("ended",i._endTimers[a._id],!1)},g.addEventListener("ended",i._endTimers[a._id],!1))}catch(e){i._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=i._src,g.load());var v=window&&window.ejecta||!g.readyState&&t._navigator.isCocoonJS;if(g.readyState>=3||v)y();else{i._playLock=!0,i._state="loading";var b=function(){i._state="loaded",y(),g.removeEventListener(t._canPlayEvent,b,!1)};g.addEventListener(t._canPlayEvent,b,!1),i._clearTimer(a._id)}}return a._id}i._ended(a)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),i=0;i<n.length;i++){t._clearTimer(n[i]);var o=t._soundById(n[i]);if(o&&!o._paused&&(o._seek=t.seek(n[i]),o._rateSeek=0,o._paused=!0,t._stopFade(n[i]),o._node))if(t._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var i=n._getSoundIds(e),o=0;o<i.length;o++){n._clearTimer(i[o]);var r=n._soundById(i[o]);r&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,n._stopFade(i[o]),r._node&&(n._webAudio?r._node.bufferSource&&(void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)):isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause(),r._node.duration===1/0&&n._clearSound(r._node))),t||n._emit("stop",r._id))}return n},mute:function(e,n){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,n)}}),i;if(void 0===n){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var o=i._getSoundIds(n),r=0;r<o.length;r++){var s=i._soundById(o[r]);s&&(s._muted=e,s._interval&&i._stopFade(s._id),i._webAudio&&s._node?s._node.gain.setValueAtTime(e?0:s._volume,t.ctx.currentTime):s._node&&(s._node.muted=!!t._muted||e),i._emit("mute",s._id))}return i},volume:function(){var e,n,i,o=this,r=arguments;if(0===r.length)return o._volume;if(1===r.length||2===r.length&&void 0===r[1]?o._getSoundIds().indexOf(r[0])>=0?n=parseInt(r[0],10):e=parseFloat(r[0]):r.length>=2&&(e=parseFloat(r[0]),n=parseInt(r[1],10)),!(void 0!==e&&e>=0&&e<=1))return(i=n?o._soundById(n):o._sounds[0])?i._volume:0;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,r)}}),o;void 0===n&&(o._volume=e),n=o._getSoundIds(n);for(var s=0;s<n.length;s++)(i=o._soundById(n[s]))&&(i._volume=e,r[2]||o._stopFade(n[s]),o._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,t.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*t.volume()),o._emit("volume",i._id));return o},fade:function(e,n,i,o){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(e,n,i,o)}}),r;e=Math.min(Math.max(0,parseFloat(e)),1),n=Math.min(Math.max(0,parseFloat(n)),1),i=parseFloat(i),r.volume(e,o);for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var l=r._soundById(s[a]);if(l){if(o||r._stopFade(s[a]),r._webAudio&&!l._muted){var c=t.ctx.currentTime,u=c+i/1e3;l._volume=e,l._node.gain.setValueAtTime(e,c),l._node.gain.linearRampToValueAtTime(n,u)}r._startFadeInterval(l,e,n,i,s[a],void 0===o)}}return r},_startFadeInterval:function(e,t,n,i,o,r){var s=this,a=t,l=n-t,c=Math.abs(l/.01),u=Math.max(4,c>0?i/c:i),h=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var o=(Date.now()-h)/i;h=Date.now(),a+=l*o,a=Math.round(100*a)/100,a=l<0?Math.max(n,a):Math.min(n,a),s._webAudio?e._volume=a:s.volume(a,e._id,!0),r&&(s._volume=a),(n<t&&a<=n||n>t&&a>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,s.volume(n,e._id),s._emit("fade",e._id))}),u)},_stopFade:function(e){var n=this,i=n._soundById(e);return i&&i._interval&&(n._webAudio&&i._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(i._interval),i._interval=null,n.volume(i._fadeTo,e),i._fadeTo=null,n._emit("fade",e)),n},loop:function(){var e,t,n,i=this,o=arguments;if(0===o.length)return i._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(n=i._soundById(parseInt(o[0],10)))&&n._loop;e=o[0],i._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var r=i._getSoundIds(t),s=0;s<r.length;s++)(n=i._soundById(r[s]))&&(n._loop=e,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,i.playing(r[s])&&(i.pause(r[s],!0),i.play(r[s],!0)))));return i},rate:function(){var e,n,i,o=this,r=arguments;if(0===r.length)n=o._sounds[0]._id;else if(1===r.length){o._getSoundIds().indexOf(r[0])>=0?n=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),n=parseInt(r[1],10));if("number"!=typeof e)return(i=o._soundById(n))?i._rate:o._rate;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,r)}}),o;void 0===n&&(o._rate=e),n=o._getSoundIds(n);for(var s=0;s<n.length;s++)if(i=o._soundById(n[s])){o.playing(n[s])&&(i._rateSeek=o.seek(n[s]),i._playStart=o._webAudio?t.ctx.currentTime:i._playStart),i._rate=e,o._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,t.ctx.currentTime):i._node&&(i._node.playbackRate=e);var a=o.seek(n[s]),l=1e3*((o._sprite[i._sprite][0]+o._sprite[i._sprite][1])/1e3-a)/Math.abs(i._rate);!o._endTimers[n[s]]&&i._paused||(o._clearTimer(n[s]),o._endTimers[n[s]]=setTimeout(o._ended.bind(o,i),l)),o._emit("rate",i._id)}return o},seek:function(){var e,n,i=this,o=arguments;if(0===o.length)i._sounds.length&&(n=i._sounds[0]._id);else if(1===o.length){i._getSoundIds().indexOf(o[0])>=0?n=parseInt(o[0],10):i._sounds.length&&(n=i._sounds[0]._id,e=parseFloat(o[0]))}else 2===o.length&&(e=parseFloat(o[0]),n=parseInt(o[1],10));if(void 0===n)return 0;if("number"==typeof e&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,o)}}),i;var r=i._soundById(n);if(r){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var s=i.playing(n)?t.ctx.currentTime-r._playStart:0,a=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(a+s*Math.abs(r._rate))}return r._node.currentTime}var l=i.playing(n);l&&i.pause(n,!0),r._seek=e,r._ended=!1,i._clearTimer(n),i._webAudio||!r._node||isNaN(r._node.duration)||(r._node.currentTime=e);var c=function(){l&&i.play(n,!0),i._emit("seek",n)};if(l&&!i._webAudio){var u=function(){i._playLock?setTimeout(u,0):c()};setTimeout(u,0)}else c()}return i},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var i=0;i<t._sounds.length;i++)if(!t._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,i=t._soundById(e);return i&&(n=t._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,n=e._sounds,i=0;i<n.length;i++)n[i]._paused||e.stop(n[i]._id),e._webAudio||(e._clearSound(n[i]._node),n[i]._node.removeEventListener("error",n[i]._errorFn,!1),n[i]._node.removeEventListener(t._canPlayEvent,n[i]._loadFn,!1),n[i]._node.removeEventListener("ended",n[i]._endFn,!1),t._releaseHtml5Audio(n[i]._node)),delete n[i]._node,e._clearTimer(n[i]._id);var r=t._howls.indexOf(e);r>=0&&t._howls.splice(r,1);var s=!0;for(i=0;i<t._howls.length;i++)if(t._howls[i]._src===e._src||e._src.indexOf(t._howls[i]._src)>=0){s=!1;break}return o&&s&&delete o[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,i){var o=this["_on"+e];return"function"==typeof t&&o.push(i?{id:n,fn:t,once:i}:{id:n,fn:t}),this},off:function(e,t,n){var i=this,o=i["_on"+e],r=0;if("number"==typeof t&&(n=t,t=null),t||n)for(r=0;r<o.length;r++){var s=n===o[r].id;if(t===o[r].fn&&s||!t&&s){o.splice(r,1);break}}else if(e)i["_on"+e]=[];else{var a=Object.keys(i);for(r=0;r<a.length;r++)0===a[r].indexOf("_on")&&Array.isArray(i[a[r]])&&(i[a[r]]=[])}return i},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var i=this,o=i["_on"+e],r=o.length-1;r>=0;r--)o[r].id&&o[r].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(i,o[r].fn),0),o[r].once&&i.off(e,o[r].fn,o[r].id));return i._loadQueue(e),i},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var n=this,i=e._sprite;if(!n._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(n._ended.bind(n,e),100),n;var o=!(!e._loop&&!n._sprite[i][2]);if(n._emit("end",e._id),!n._webAudio&&o&&n.stop(e._id,!0).play(e._id),n._webAudio&&o){n._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var r=1e3*(e._stop-e._start)/Math.abs(e._rate);n._endTimers[e._id]=setTimeout(n._ended.bind(n,e),r)}return n._webAudio&&!o&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,n._clearTimer(e._id),n._cleanBuffer(e._node),t._autoSuspend()),n._webAudio||o||n.stop(e._id,!0),n},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new i(e)},_drain:function(){var e=this,t=e._pool,n=0,i=0;if(!(e._sounds.length<t)){for(i=0;i<e._sounds.length;i++)e._sounds[i]._ended&&n++;for(i=e._sounds.length-1;i>=0;i--){if(n<=t)return;e._sounds[i]._ended&&(e._webAudio&&e._sounds[i]._node&&e._sounds[i]._node.disconnect(0),e._sounds.splice(i,1),n--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=o[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,t.ctx.currentTime),this},_cleanBuffer:function(e){var n=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return this;if(t._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),n))try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(e){this._parent=e,this.init()};i.prototype={init:function(){var e=this,n=e._parent;return e._muted=n._muted,e._loop=n._loop,e._volume=n._volume,e._rate=n._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,n._sounds.push(e),e.create(),e},create:function(){var e=this,n=e._parent,i=t._muted||e._muted||e._parent._muted?0:e._volume;return n._webAudio?(e._node=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(i,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):t.noAudio||(e._node=t._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=n._src,e._node.preload=!0===n._preload?"auto":n._preload,e._node.volume=i*t.volume(),e._node.load()),e},reset:function(){var e=this,n=e._parent;return e._muted=n._muted,e._loop=n._loop,e._volume=n._volume,e._rate=n._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,n=e._parent;n._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(n._sprite).length&&(n._sprite={__default:[0,1e3*n._duration]}),"loaded"!==n._state&&(n._state="loaded",n._emit("load"),n._loadQueue()),e._node.removeEventListener(t._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var o={},r=function(e){var t=e._src;if(o[t])return e._duration=o[t].duration,void l(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),r=0;r<n.length;++r)i[r]=n.charCodeAt(r);a(i.buffer,e)}else{var c=new XMLHttpRequest;c.open(e._xhr.method,t,!0),c.withCredentials=e._xhr.withCredentials,c.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){c.setRequestHeader(t,e._xhr.headers[t])})),c.onload=function(){var t=(c.status+"")[0];"0"===t||"2"===t||"3"===t?a(c.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+c.status+".")},c.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete o[t],e.load())},s(c)}},s=function(e){try{e.send()}catch(t){e.onerror()}},a=function(e,n){var i=function(){n._emit("loaderror",null,"Decoding audio data failed.")},r=function(e){e&&n._sounds.length>0?(o[n._src]=e,l(n,e)):i()};"undefined"!=typeof Promise&&1===t.ctx.decodeAudioData.length?t.ctx.decodeAudioData(e).then(r).catch(i):t.ctx.decodeAudioData(e,r,i)},l=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},c=function(){if(t.usingWebAudio){try{"undefined"!=typeof AudioContext?t.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch(e){t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),n=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=n?parseInt(n[1],10):null;if(e&&i&&i<9){var o=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!o&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};"function"==typeof define&&define.amd&&define("toxilibs/embedded_extlibs/howler-2.2.4",[],(function(){return{Howler:t,Howl:n}})),"undefined"!=typeof exports&&(exports.Howler=t,exports.Howl=n),"undefined"!=typeof global?(global.HowlerGlobal=e,global.Howler=t,global.Howl=n,global.Sound=i):"undefined"!=typeof window&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=n,window.Sound=i)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var i=this;return i.ctx&&i.ctx.listener?(t="number"!=typeof t?i._pos[1]:t,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof e?i._pos:(i._pos=[e,t,n],void 0!==i.ctx.listener.positionX?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(e,t,n,i,o,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,i="number"!=typeof i?a[3]:i,o="number"!=typeof o?a[4]:o,r="number"!=typeof r?a[5]:r,"number"!=typeof e?a:(s._orientation=[e,t,n,i,o,r],void 0!==s.ctx.listener.forwardX?(s.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),s.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),s.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),s.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),s.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),s.ctx.listener.upZ.setTargetAtTime(r,Howler.ctx.currentTime,.1)):s.ctx.listener.setOrientation(e,t,n,i,o,r),s)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(e,n)}}),i;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return i._stereo;i._stereo=e,i._pos=[e,0,0]}for(var r=i._getSoundIds(n),s=0;s<r.length;s++){var a=i._soundById(r[s]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,o),"spatial"===o?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",a._id)}}return i},Howl.prototype.pos=function(e,n,i,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"pos",action:function(){r.pos(e,n,i,o)}}),r;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,void 0===o){if("number"!=typeof e)return r._pos;r._pos=[e,n,i]}for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var l=r._soundById(s[a]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,n,i],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setPosition(e,n,i)),r._emit("pos",l._id)}}return r},Howl.prototype.orientation=function(e,n,i,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"orientation",action:function(){r.orientation(e,n,i,o)}}),r;if(n="number"!=typeof n?r._orientation[1]:n,i="number"!=typeof i?r._orientation[2]:i,void 0===o){if("number"!=typeof e)return r._orientation;r._orientation=[e,n,i]}for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var l=r._soundById(s[a]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,n,i],l._node&&(l._panner||(l._pos||(l._pos=r._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setOrientation(e,n,i)),r._emit("orientation",l._id)}}return r},Howl.prototype.pannerAttr=function(){var e,n,i,o=this,r=arguments;if(!o._webAudio)return o;if(0===r.length)return o._pannerAttr;if(1===r.length){if("object"!=typeof r[0])return(i=o._soundById(parseInt(r[0],10)))?i._pannerAttr:o._pannerAttr;e=r[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:o._panningModel})}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var s=o._getSoundIds(n),a=0;a<s.length;a++)if(i=o._soundById(s[a])){var l=i._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var c=i._panner;c||(i._pos||(i._pos=o._pos||[0,0,-.5]),t(i,"spatial"),c=i._panner),c.coneInnerAngle=l.coneInnerAngle,c.coneOuterAngle=l.coneOuterAngle,c.coneOuterGain=l.coneOuterGain,c.distanceModel=l.distanceModel,c.maxDistance=l.maxDistance,c.refDistance=l.refDistance,c.rolloffFactor=l.rolloffFactor,c.panningModel=l.panningModel}return o},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}(),
/*! Toxilib sound_manager
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/sound_manager",["./embedded_extlibs/howler-2.2.4"],(function(e){const{Howl:t}=e,n=new WeakMap,i={},o={},r=new WeakMap;function s(){let e=1;Object.defineProperty(this,"volume",{get:()=>e,set:t=>{e=h(t);let{buses:i}=r.get(this);for(let e in i)n.get(i[e]).syncVolume()},enumerable:!0}),c(this)}let a=!1;function l(){a=!1}function c(e){r.set(e,{buses:{}}),e.volume=1}function u(e,t){let i,r={};e.sound?(i=e.sound,r=e):i=e;let s=function({howlSound:e,sound:t,bus:i},{volume:o=1,speed:r=1,loop:s=!1,pan:l=0}={}){let c,u={sound:t,play:(e={})=>(p(),f(e),g(),x(),u),goTo:t=>{p(),e.seek(t/1e3),x()},stop:()=>e.stop(c),pause:()=>e.pause(c),isPlaying:()=>e.playing(c)};function p(){a&&a();let t=c?e.play(c):e.play();t!==c&&(c=t,e.once("end",w,c),e.once("stop",w,c))}function f(e){"volume"in e&&(o=h(e.volume)),"pan"in e&&(l=d(e.pan)),"speed"in e&&(r=e.speed),"loop"in e&&(s=e.loop)}function g(){u.volume=o,u.speed=r,u.pan=l,u.loop=s}let m=1;function y(){e.volume(o*m,c)}Object.defineProperty(u,"parentVolume",{get:()=>m,set:e=>{m=h(e),y()},enumerable:!1});let v=0;function b(){var t,n;e.stereo((t=l,(n=v)+(1-Math.abs(n))*t),c)}function x(){n.get(i).registerPlayer(u)}function w(){n.get(i).removePlayer(u)}return Object.defineProperty(u,"parentPan",{get:()=>v,set:e=>{v=d(e),b()},enumerable:!1}),Object.defineProperty(u,"duration",{get:()=>e.duration(),enumerable:!0}),Object.defineProperty(u,"volume",{get:()=>o,set:e=>{o=h(e),y()},enumerable:!0}),Object.defineProperty(u,"pan",{get:()=>l,set:e=>{l=d(e),b()},enumerable:!0}),Object.defineProperty(u,"speed",{get:()=>r,set:t=>{r=t,e.rate(t,c)},enumerable:!0}),Object.defineProperty(u,"loop",{get:()=>s,set:t=>{s=t,e.loop(t,c)},enumerable:!0}),u}({howlSound:o[i.url],sound:i,bus:t},r);return s.play(r),s}function h(e){return Math.max(0,Math.min(1,e))}function d(e){return Math.max(-1,Math.min(1,e))}return s.waitForUserGesture=function(e){a=e,window.document.addEventListener("click",l,{once:!0}),window.document.addEventListener("keydown",l,{once:!0}),window.document.addEventListener("touchstart",l,{once:!0})},s.prototype.reset=function(){this.stop(),c(this)},s.load=function(e){return"string"==typeof e?s.singleLoad(e):s.multipleLoad(e)},s.multipleLoad=async function(e){const t=Object.entries(e).map((([e,t])=>{const n=s.singleLoad(t);return n instanceof Promise?n.then((t=>[e,t])):Promise.resolve([e,n])})),n=await Promise.all(t);return Object.fromEntries(n)},s.singleLoad=function(e){if(e in i)return i[e];let n=new t({src:[e],preload:!1});return new Promise((t=>{n.once("load",(()=>{let r=function(e,t){let n={url:e,duration:t.duration()};return o[e]=t,n}(e,n);i[e]=r,t(r)})),n.load()}))},s.prototype.bus=function(e){let{buses:t}=r.get(this);return e in t||(t[e]=function(e){let t=new Set,i=1,o=0,r={play:t=>{let n=u(t,r);return n.parentVolume=i*e.volume,n.bus=r,n},stop:e=>{e?t.forEach((t=>{t.sound===e&&t.stop()})):t.forEach((e=>e.stop()))}};function s(){t.forEach((t=>{t.parentVolume=i*e.volume}))}function a(){t.forEach((e=>{e.parentPan=o}))}function l(e){t.add(e)}function c(e){t.delete(e)}return n.set(r,{registerPlayer:l,removePlayer:c,syncVolume:s}),Object.defineProperty(r,"volume",{get:()=>i,set:e=>{i=h(e),s()},enumerable:!0}),Object.defineProperty(r,"pan",{get:()=>o,set:e=>{o=d(e),a()},enumerable:!0}),r}(this)),t[e]},s.prototype.play=function(e){return u(e,this.bus("default-bus"))},s.prototype.stop=function(e){let{buses:t}=r.get(this);for(let n in t)t[n].stop(e)},s})),
/*! Toxilib language_detector
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/language_detector",["./url_params"],(function(e){return function(t={}){const n=t.accepted||["fr","en"],i=t.default||"en";let o=function(e){return e.split("-")[0]}(e().lang||(navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage));return n&&!n.includes(o)&&(o=i),o}})),define("commons",["jquery","toxilibs/language_detector"],(function(e,t){const n=t();return e((function(){e("body").addClass(`enable_${n}`),e("*[data-placeholder"+n+"]").each(((t,i)=>{const o=e(i),r=o.data("placeholder"+n);o.attr("placeholder",r)}))})),{lang:n,displayConnectivityError:function(t,n){e("#loading_in_progress").remove();const i=e('<div class="browser_error" style="\n            position: fixed;\n            top: 0;\n            left: 0;\n            text-align: center;\n            padding: 1em;\n            background: red;\n            color: white;\n            "></div>');let o="";t&&"readyState"in t&&0===t.readyState?o+="Erreur : Le serveur des "+n+" n'a pas pu être contacté.":o="Une erreur est survenue lors du chargement des "+n,i.html(o),e("body").append(i)}}})),define("render/audio_api",["editor/snippet_tools","toxilibs/sound_manager","../commons"],(function(e,t,n){let{lang:i}=n;const{addMethodSnippet:o}=e;t.waitForUserGesture((()=>{let e;throw e="fr"===i?"Il n'est pas permis de jouer un son sans que l'utilisateur ait d'abord interagi\n            (clic ou utilisation du clavier).\n            Planifiez ce son plus tard, ou prévoyez un bouton de démarrage.":"Audio is not allowed to play without a user gesture first\n            (click or keyboard use).\n            Schedule this sound for later or add a start button.",new Error(e)}));const r={play:{sound:"",volume:1}};return function(e){const n=new t;let i=!0;if(n.disableResetOnRestart=()=>{i=!1},n.enableResetOnRestart=()=>{i=!0},n.destroy=function(){i?n.reset():i=!0},"generic render"===e.name){for(let e in n){let t=r[e];t&&o(n[e],e,t)}n.reset._hidden=!0}return n}})),define("user_code/pause",[],(function(){return function(e){return new Promise((t=>setTimeout(t,e)))}})),define("user_code/http",["jquery","toxilibs/sound_manager"],(function(e,t){const{useAssetsLocalCache:n}=window.serverSettings||{};let i="https://explorers-assets.toxicode.fr";function o({jqXHR:e,url:t,errorText:n}){const{status:i}=e;return n=0===i?`Server not responding at : ${t}`:404===i?`Page not found [404] : ${t}`:401===i?`Unauthorized [401] : ${t}`:500===i?`Internal Server Error [500] for : ${t}`:`Server Error [${i}] for : ${t}`,new Error(n)}n&&(console.warn("Assets local cache enabled"),i="/assets_cache");let r={},s=0;function a(e){return new Promise(((t,n)=>{s+=1;let i=r[e];if(i)return i.rejected?n(i.rejected):i.resolved?t(i.resolved):i.queues[s]={resolve:t,reject:n},void console.log("cache hit, no fetch for ",e);let o={};o[s]={resolve:t,reject:n},i={queues:o},r[e]=i,fetch(e).then((t=>(t.ok||(t.statusText||"404"!==t.status||(t.statusText="Url not found"),n(new Error(`Failed to fetch ${e} : ${t.statusText}`))),t.blob()))).then((e=>{i.resolved=e;for(let t in i.queues){let{resolve:n}=i.queues[t];delete i.queues[t],n(e)}})).catch((t=>{console.error(t);let n=new Error(`Failed to fetch ${e}. Maybe a CORS issue ?`);i.rejected=n;for(let e in i.queues){let{reject:t}=i.queues[e];delete i.queues[e],t(n)}}))}))}function l(e,{jqXHR:t}={}){return new Promise(((n,i)=>{const o=new Image;o.addEventListener("load",(()=>n(o))),o.addEventListener("error",(()=>{i(new Error("could not load image"))})),o.originalBlob=e,t&&(o.headers=function(e){const t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),n={};return t.forEach((e=>{const t=e.split(": "),i=t.shift(),o=t.join(": ");n[i]=o})),n}(t)),o.crossOrigin="Anonymous",o.src=window.URL.createObjectURL(e)}))}let c={};async function u(e){if(e in c)return c[e];let t=l(await a(e));return c[e]=t,t}const h=["aac","flac","mp4","m4a","m4b","mp3","ogg","opus","wav","webm"];return{urlFor:function(e){const t=e.match(/(.*)-([a-zA-Z0-9]{8})\.(\w*)$/);if(!t)throw new Error(`Asset name "${e}" is not correct`);const[,n,o,r]=t;return encodeURI(`${i}/${o}__${n}.${r}?bust=34`)},httpPost:function({url:t,params:n}){return new Promise(((i,r)=>{e.ajax({url:t,method:"POST",data:JSON.stringify(n),contentType:"application/json",processData:!1,cache:!1,success:i,error:(e,n,i)=>{r(o({jqXHR:e,errorText:i,url:t}))}})}))},httpPostForImage:function({url:t,params:n}){let i=new FormData;for(let e in n)i.append(e,n[e]);return new Promise(((n,r)=>{e.ajax({headers:{Accept:"image/*"},url:t,method:"POST",data:i,processData:!1,contentType:!1,cache:!1,xhr:function(){let e=new XMLHttpRequest;return e.responseType="blob",e},success:(e,t,i)=>{l(e,{jqXHR:i}).then(n).catch(r)},error:(e,n,i)=>{r(o({jqXHR:e,errorText:i,url:t}))}})}))},fetchBlob:a,fetchImageSource:u,fetchSound:t.singleLoad,fetchSounds:t.multipleLoad,fetchAssets:async function(e){const n=Object.entries(e).map((([e,n])=>{let i=function(e){if(!e)return!1;const t=e.split("?")[0],n=t.split("/"),i=n[n.length-1].split(".");if(i.length<=1)return!1;return i[i.length-1].toLowerCase()}(n);if(h.includes(i)){const i=t.singleLoad(n);return i instanceof Promise?i.then((t=>[e,t])):Promise.resolve([e,i])}return u(n).then((t=>[e,t]))})),i=await Promise.all(n);return Object.fromEntries(i)}}})),define("render/imagine",["event_bus","toxilibs/url_params","toxilibs/random","toxilibs/screen_image","toxilibs/download","user_code/pause","user_code/http","logger"],(function(e,t,n,i,o,r,s,a){const{blobToBase64:l}=o,{urlFor:c,httpPostForImage:u,httpPost:h,fetchImageSource:d}=s,{pushStateRemove:p}=t,f=t();let g,m,y,v=!1;e.on("renderView shown",(e=>{g=e,v&&setTimeout((()=>{D({},e)}),300)}));let b=1e3,x=Date.now()-b;const w={A:{suffix:", intricate, elegant, highly detailed, digital painting, artstation, concept art, smooth, sharp focus, illustration, art by artgerm and Greg Rutkowski and Alphonse Mucha, 8k",guidance:13,steps:150},B:{suffix:", artstation, elegant, highly detailed, digital painting, concept art, smooth, sharp focus, illustration, art by Studio Ghibli, Fujita Goro, Atey Ghailan, Tom Whalen, Jean Giraud 8k",guidance:13,steps:150},C:{suffix:", artstation, elegant, highly detailed, digital painting, concept art, smooth, sharp focus, illustration, art by Don Bluth and Michel Ocelot and Makoto Shinkai and Tom Whalen and Atey Ghailan and Akihiko Yoshida",guidance:13,steps:150},D:{suffix:", path traced,  highly detailed, high quality, digital painting, alena aenami, lilia alvarado, shinji aramaki, karol bak, alphonse mucha, tom bagshaw",guidance:14,steps:150},E:{suffix:", behance hd by jesper ejsing, by rhads, makoto shinkai and lois van baarle, ilya kuvshinov, rossdraws global illumination",guidance:13,steps:150}};if("imagineServer"in f){const{imagineServer:e}=f;!0===e||"true"===e?v=!0:C(e),p("imagineServer"),delete f.imagineServer}async function _(e,{renderView:t=g,noUi:n}={}){return m||function(){if(m=localStorage.imagineServer,m){let e=new URL(m);m=k(e)}y=localStorage.imagineToken}(),m||n||await D({},t),m||R({message:'"imagine" server adress is not set',renderView:t,noUi:n}),m+e}function S({url:e,token:t},{renderView:n=g,noUi:i}={}){e?C(e):R({message:"Server undefined",renderView:n,noUi:i}),t&&(y=t,localStorage.imagineToken=t)}function C(e){const t=(e=new URL(e)).searchParams.get("token");t&&(y=t,localStorage.imagineToken=t),m=k(e),localStorage.imagineServer=m}function k(e){return(e.origin+e.pathname).replace(/\/$/,"")}"imagineToken"in f&&(localStorage.imagineToken=f.imagineToken,p("imagineToken"),delete f.imagineToken);const A=/\[style-(.*?)\]/g;async function M({prompt:e,mode:t,model:n,steps:o=10,seed:r,guidance:s=3,width:l=1024,height:c=1024,imageGuide:u,strength:h,maskForBlend:d,maskBlur:p=10,returnChangesOnly:f=!1,style:m,noUi:v=!1,noThrottle:S=!1,mock:C,url:k},M=g){let O,D,F=Date.now();if(!S&&F<x+b)return R({message:"Imagine request made less than 1000ms ago",renderView:M,noUi:v}),{};x=F,k=k||await _("/run"),u&&!d&&l<512&&c<512&&R({message:"image guide must be at least 512px in width or in height",renderView:M,noUi:v}),"blob"===(k.includes("ask_imagine")?"base64":"blob")?(D=await P(u),d=await P(d)):(D=await I(u),d=await I(d));let N=e;!function({prompt:e,mode:t,imageGuide:n,maskForBlend:i,steps:o,guidance:r,strength:s,maskBlur:l,seed:c,styleName:u}){a.log(`=> prompt:   ${e}`),u&&a.log(`   style:    ${u}`);t&&a.log(`   mode:     ${t}`);c&&a.log(`   seed:     ${c}`);a.log(`   steps:    ${o}`),a.log(`   guidance: ${r}`),n&&(i?a.log(`   image guide + mask and maskBlur: ${l}`):a.log(`   image guide with prompt strength: ${s}`))}({prompt:e,mode:t,imageGuide:u,maskForBlend:d,guidance:s,steps:o,seed:r,styleName:m,strength:h,maskBlur:p});let B=[];if(e=e.replace(A,((e,t)=>{B.push(t);let n=w[t];return n?n.suffix:""})),m){let t=w[m];t&&(e+=t.suffix)}l%64!=0&&R({message:"Imagine width should be a multiple of 64",renderView:M,noUi:v}),c%64!=0&&R({message:"Imagine height should be a multiple of 64",renderView:M,noUi:v});const j={prompt:e,steps:o,seed:r,guidance:s,imageGuide:D,strength:h,width:l,height:c,samples:1,maskForBlend:d,maskBlur:p,returnChangesOnly:f};y&&(j.token=y),t&&(j.mode=t),n&&(j.model=n);let H=Date.now();if($({renderView:M,noUi:v}),O=C?await T():await E({url:k,params:j},{renderView:M,noUi:v}),L({renderView:M,noUi:v}),!O)return{};r=O.seed;let W=Date.now()-H;a.log(`Time : ${Math.round(W/10)/100}s`);const z={prompt:N,guidance:s,steps:o,seed:r};m&&(z.style=m),O.imagineParams=z;const V=new i({source:O});return V.imagineParams=z,{imageSource:O,image:V,params:z}}async function T(){await r(500);let e=n.pick("medieval_old_king-SpzlcIXf.png","kitchen-B1ARB7q2.png"),t=await d(c(e));return t.seed=345,t}async function E({url:e,params:t},{renderView:n,noUi:i}){let o,s;try{if(e.includes("ask_imagine")){s=await h({url:e,params:t});let{imageBase64:n,url:i,contentType:r}=s;if(i)o=await d(i);else{const e=`data:${r};base64,${n}`;o=window.document.createElement("img"),o.src=e}}else{o=await u({url:e,params:t});const{headers:n}=o;s={error:n["imagine-error"],seed:n["imagine-seed"],taskId:n["imagine-taskid"],fileId:n["imagine-fileid"]}}}catch(e){return console.error(e),R({message:e.message,renderView:n,noUi:i}),null}if(s.error)return R({message:decodeURIComponent(s.error),renderView:n,noUi:i}),null;if(s.seed&&a.log(`seed : ${s.seed}`),s.taskId){const{taskId:e,fileId:t}=s;a.log(`job id : ${e}`),o=await async function(e){let t=null,n=4e3;for(;!t;)await r(n),a.log("checking queue..."),t=await O(e),n=2e3;return t}({taskId:e,fileId:t})}return o.seed=s,o}function $({renderView:e,noUi:t}){if(!t){const{storageForThisLaunch:t,api:n}=e;t.imagineSpinner=n.ui.addSpinner()}}function L({renderView:e,noUi:t}){if(!t){const{storageForThisLaunch:t}=e,{imagineSpinner:n}=t;n&&(n.remove(),delete t.imagineSpinner)}}function R({message:e,renderView:t,noUi:n}){let i=new Error(e);n&&t.handleImagineError(i);const{api:o,storageForThisLaunch:r}=t;e=function(e){if("job too long for a guest"===e)return'Job too long to process (as a guest user).<br>Try reducing image size or number of steps.<br>Or you can host your own server to have no limits :<br>see <a href="https://explorers.toxicode.fr/imagine_faq.html">this faq</a>';if("job too soon for a guest"===e)return"Your last request was too recent.<br>Retry in a few seconds";if("quota expired"===e)return'Your quota expired.<br>You should consider hosting your own server<br>and using it with this interface :<br>see <a href="https://explorers.toxicode.fr/imagine_faq.html">this faq</a>';if("unauthenticated"===e)return"You need to have a token to be able to run this";return e}(e),o.ui.showPopup({title:"Error !",content:e});const{imagineSpinner:s}=r;s&&(s.remove(),delete r.imagineSpinner),t.handleImagineError(i)}async function P(e){if(e)return e instanceof Blob?e:e.originalBlob?e.originalBlob:(e.cachedBlob||("toBlob"in e?e.cachedBlob=await e.toBlob():(e=new i({source:e})).cachedBlob=await e.toBlob()),e.cachedBlob)}async function I(e){if(e)return e instanceof Blob?l(e):"string"==typeof e?e:e.originalBlob?l(e.originalBlob):(e.cachedBase64||("toBase64"in e?e.cachedBase64=await e.toBase64():(e=new i({source:e})).cachedBase64=await e.toBase64()),e.cachedBase64)}async function O({taskId:e,fileId:t}){try{let n=await _(`/result?taskId=${e}&fileId=${t}`);return await d(n)}catch(e){return!1}}async function D({whenClosed:e}={},t=g){await t.api.ui.showForm({fields:{url:{label:"Paste your Imagine server url here :",type:"text",value:localStorage.imagineServer},token:{label:"Access token (if you have one) :",type:"text",value:localStorage.imagineToken||""}},whenReplied:e=>S(e,{renderView:t}),whenClosed:e})}return function(e){return e.handleImagineError=e.createExecutionErrorHandler("Explorers - imagine.js"),{generateImage:t=>M(t,e),inpaint:t=>async function({image:e,mask:t,noUi:n=!1,mock:i,url:o},r=g){let s,l;return s=(o=o||await _("/inpaint")).includes("ask_imagine")?{image:I(e),mask:I(t)}:{file:await P(e)},y&&(s.token=y),a.log("=> inpainting"),$({renderView:r,noUi:n}),l=i?await T():await E({url:o,params:s},{renderView:r,noUi:n}),L({renderView:r,noUi:n}),{imageSource:l}}(t,e),openServerConfig:t=>D(t,e),setServer:t=>S(t,{renderView:e})}}})),
/*! Toxilib handle_system
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/handle_system",["./screen_group"],(function(e){function t({snap:e,whenDragStarted:t=()=>{},whenDropped:n=()=>{}}){this.snap=e,this.whenDragStarted=t,this.whenDropped=n,this.handlers=[]}t.prototype.addShapes=function(e){e.forEach((e=>this.addShape(e)))},t.prototype.addShape=function(e){const t=new i({system:this,shape:e});this.handlers.push(t),n(this)},t.prototype.setKeepRatioMode=function(e){this.keepRatio=e};function n(e){const{screenGroup:t,handlers:n}=e;t.reset(),n.forEach((n=>{n.addShapeToScreenGroup(t),n===e.currentHandler&&n.addHandlesToScreenGroup(t)}))}function i({system:e,shape:t}){this.system=e,this.shape=t,this.handles={},p.forEach((e=>{const t=new s({position:e,parent:this});this.handles[e]=t})),c(this)}function o(e){const{drawShapeParams:t,shape:n}=e;if(!t)return;const{width:i,height:o,orientation:r}=n;t.forEach((e=>{e.width=i,e.height=o,e.orientation=r}))}function r(e){e.shapeBeforeDrag=Object.assign({},e.shape),e.shapeBeforeDrag.center=Object.assign({},e.shape.center)}function s({position:e,parent:t}){this.parent=t,this.shape=t.shape,this.coefs=d[e],"orientation"===e&&(this.drag=l)}t.prototype.snapOrientations=function(e){!0===e&&(e=45),this.snapOrientationsValue=e},t.prototype.createScreenGroup=function(){return this.screenGroup=new e({dynamic:!0}),n(this),this.screenGroup},t.prototype.plugToHybridScreen=function(e){e.when("mouseButtonPressed",((e,t)=>this.triggerMouseButtonPressed(e,t))),e.when("mouseMoved",((e,t)=>this.moveCurrentHandle(e,t))),e.when("mouseButtonReleased",(()=>this.stopDrag()))},t.prototype.triggerMouseButtonPressed=function(e,t){this.screenGroup.shapesAt({x:e,y:t}).forEach((({handler:i,target:o})=>{i!==this.currentHandler&&(this.currentHandler=i,n(this)),this.dragging=!0,i.startDrag(e,t,o)}))},t.prototype.moveCurrentHandle=function(e,t){this.dragging&&this.currentHandler.moveCurrentHandle(e,t)},t.prototype.stopDrag=function(){this.currentHandler&&(this.currentHandler.stopDrag(),delete this.dragging,this.whenDropped())},t.prototype.export=function(){let e=[];return this.handlers.forEach((({shape:t})=>{const{id:n,center:i,width:o,height:r,orientation:s}=t,{x:a,y:l}=i;e.push({id:n,center:{x:a,y:l},width:o,height:r,orientation:s})})),e},i.prototype.addShapeToScreenGroup=function(e){const{shape:t}=this,{image:n}=t;this.drawShapeParams=n?[{image:n,center:t.center,watch:!0},{handler:this,target:t,center:t.center,watch:!0,strokeColor:"white"}]:[{handler:this,target:t,center:t.center,watch:!0,strokeColor:"white",color:"rgba(255, 255, 255, 0.2)"}],o(this),n?(e.addImage(this.drawShapeParams[0]),e.addRectangle(this.drawShapeParams[1])):e.addRectangle(this.drawShapeParams[0]),e.addText({text:t.id||"shape",center:t.center,font:"20px serif",color:"white"})},i.prototype.addHandlesToScreenGroup=function(e){const{handles:t}=this;for(let n in t){const i=t[n];e.addCircle({handler:this,target:i,center:i,radius:.2,color:"#da9540",strokeColor:"#292B36",watch:!0})}},i.prototype.startDrag=function(e,t,n){this.dragStartedAt={x:e,y:t},n instanceof s?(this.currentHandle=n,n.startDrag()):this.currentHandle||r(this),this.system.whenDragStarted()},i.prototype.moveCurrentHandle=function(e,t){const{dragStartedAt:n}=this;if(n){const i=e-n.x,o=t-n.y;this.currentHandle?this.currentHandle.drag(i,o):function(e,t,n){const{shape:i,shapeBeforeDrag:o,system:r}=e,{snap:s}=r,{center:a}=o;let{x:l,y:u}=a;if(s){const e=s(a);l=e.x,u=e.y}let d=l+t,p=u+n;if(s){const e=s({x:d,y:p});d=e.x,p=e.y}i.center.x=h(d),i.center.y=h(p),c(e)}(this,i,o)}},i.prototype.stopDrag=function(){const{whenChanged:e}=this.shape;e&&e(this.shape),delete this.currentHandle,delete this.dragStartedAt},s.prototype.startDrag=function(){this.coordsBeforeDrag={x:this.x,y:this.y},r(this.parent)},s.prototype.drag=function(e,t){const{cosOrientation:n=1,sinOrientation:i=0,shape:o,shapeBeforeDrag:r,system:s}=this.parent,{keepRatio:a,snap:l}=s;if(l){let{x:n,y:i}=this.coordsBeforeDrag;const o=l({x:n+e,y:i+t});e=o.x-n,t=o.y-i}let u=e*n+t*i,d=-e*i+t*n,[p,f,g,m]=this.coefs;if(p&&(o.width=r.width+u*p,!f&&a&&(o.height=o.width*r.height/r.width)),f&&(o.height=r.height+d*f,!p&&a&&(o.width=o.height*r.width/r.height)),p&&f&&a){let e=r.width/r.height;o.height=Math.min(o.height,o.width/e),o.width=Math.min(o.width,o.height*e),u=(o.width-r.width)/p,d=(o.height-r.height)/f}o.width=h(o.width),o.height=h(o.height),function(e,t,n){const{shapeBeforeDrag:i,shape:o,cosOrientation:r=1,sinOrientation:s=0}=e;let{x:a,y:l}=i.center;a+=r*(t/2)-s*(n/2),l+=s*(t/2)+r*(n/2),o.center.x=h(a),o.center.y=h(l)}(this.parent,u*g,d*m),c(this.parent)};const a=90;function l(e,t){const{shape:n,system:i}=this.parent,{snapOrientationsValue:o}=i;let{x:r,y:s}=this.coordsBeforeDrag,l=Math.atan2(s+t-n.center.y,r+e-n.center.x)/u;o&&(l=Math.round(l/o)*o),n.orientation=Math.round(100*(l-a))/100,c(this.parent)}function c(e){!function(e){const{orientation:t}=e.shape;if(t){const n=t*u;e.cosOrientation=Math.cos(n),e.sinOrientation=Math.sin(n)}else e.cosOrientation&&(delete e.cosOrientation,delete e.sinOrientation)}(e),o(e);const{handles:t,shape:n,cosOrientation:i=1,sinOrientation:r=0}=e,{x:s,y:a}=n.center,l=n.height/2,c=n.width/2,h=i*c,d=r*c,p=-r*l,f=i*l,{left:g,right:m,top:y,bottom:v,topLeft:b,topRight:x,bottomLeft:w,bottomRight:_,orientation:S}=t;g.x=s-h,g.y=a-d,m.x=s+h,m.y=a+d,y.x=s+p,y.y=a+f,v.x=s-p,v.y=a-f,b.x=s-h+p,b.y=a-d+f,x.x=s+h+p,x.y=a+d+f,w.x=s-h-p,w.y=a-d-f,_.x=s+h-p,_.y=a+d-f,S.x=s+2*p,S.y=a+2*f}const u=Math.PI/180;function h(e){return Number(e.toPrecision(10))}const d={left:[-1,0,1,0],right:[1,0,1,0],top:[0,1,0,1],bottom:[0,-1,0,1],topLeft:[-1,1,1,1],topRight:[1,1,1,1],bottomLeft:[-1,-1,1,1],bottomRight:[1,-1,1,1]},p=[...Object.keys(d),"orientation"];return t})),
/*! Toxilib vector
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/vector",[],(function(){let e=Math.PI/180;function t(e,t=!1){if(this._private={},!1!==t)this.x=e,this.y=t;else if("x"in e)this.x=e.x,this.y=e.y;else if("from"in e){const{from:t,to:n}=e;this.x=n.x-t.x,this.y=n.y-t.y,"length"in e&&this.setLength$(e.length)}else if("direction"in e||"angle"in e){const{length:t=1,angle:n=0,direction:i=n}=e;this.direction=i,this.length=t}}function n(){return this._private.radialOutdated&&a(this._private),this._private.direction}function i(){return this.direction/e}function o(e){const{_private:t}=this;if(t.radialOutdated){const{x:e,y:n}=t;t.length=Math.sqrt(e*e+n*n),t.radialOutdated=!1}return t.direction=e,t.xyOutdated=!0,this}function r(t){return this.setDirection$(t/e)}function s(t){const n=e*t.direction,{length:i=1}=t;t.x=i*Math.cos(n),t.y=i*Math.sin(n),t.xyOutdated=!1}function a(t){const{x:n,y:i}=t;t.length=Math.sqrt(n*n+i*i),t.length>0?t.direction=Math.atan2(i,n)/e:t.direction||(t.direction=0),t.radialOutdated=!1}return Object.defineProperty(t.prototype,"length",{enumerable:!0,get:function(){return this._private.radialOutdated&&a(this._private),this._private.length},set:function(e){this.setLength$(e)}}),Object.defineProperty(t.prototype,"x",{enumerable:!0,get:function(){return this._private.xyOutdated&&s(this._private),this._private.x},set:function(t){const{_private:n}=this;if(n.xyOutdated){const t=e*n.direction,{length:i=1}=n;n.y=i*Math.sin(t),n.xyOutdated=!1}n.radialOutdated=!0,n.x=t}}),Object.defineProperty(t.prototype,"y",{enumerable:!0,get:function(){return this._private.xyOutdated&&s(this._private),this._private.y},set:function(t){const{_private:n}=this;if(n.xyOutdated){const t=e*n.direction,{length:i=1}=n;n.x=i*Math.cos(t),n.xyOutdated=!1}n.radialOutdated=!0,n.y=t}}),Object.defineProperty(t.prototype,"angle",{enumerable:!1,get:n,set:o}),Object.defineProperty(t.prototype,"angleRad",{enumerable:!1,get:i,set:r}),Object.defineProperty(t.prototype,"direction",{enumerable:!0,get:n,set:o}),Object.defineProperty(t.prototype,"directionRad",{enumerable:!1,get:i,set:r}),t.prototype.isNull=function(){return this._private.radialOutdated?0===this.x&&0===this.y:0===this.length},t.prototype.clone=function(){return new t(this)},t.prototype.plus=function({x:e,y:n}){return new t(this.x+e,this.y+n)},t.prototype.add=function({x:e,y:t}){return this.x+=e,this.y+=t,this},t.prototype.plus$=t.prototype.add,t.prototype.minus=function({x:e,y:n}){return new t(this.x-e,this.y-n)},t.prototype.substract=function({x:e,y:t}){return this.x-=e,this.y-=t,this},t.prototype.minus$=t.prototype.substract,t.prototype.multiply=function(e){return this._private.radialOutdated?new t(this.x*e,this.y*e):new t({length:this.length*e,direction:this.direction})},t.prototype.multiply$=function(e){return this._private.radialOutdated?(this.x*=e,this.y*=e):this.length*=e,this},t.prototype.setLength=function(e){return new t({length:e,direction:this.direction})},t.prototype.setLength$=function(t){if(this._private.radialOutdated){let{x:t,y:n}=this._private;0===t&&0===n||(this._private.direction=Math.atan2(n,t)/e),this._private.radialOutdated=!1}return this._private.xyOutdated=!0,t<0?(this._private.length=-t,this._private.direction+=180):this._private.length=t,this},t.prototype.normalize=function(){return this.setLength(1)},t.prototype.normalize$=function(){return this.setLength$(1)},t.prototype.addToLength=function(e){return this.setLength(this.length+e)},t.prototype.addToLength$=function(e){return this.setLength$(this.length+e)},t.prototype.rotate90=function(){return new t(-this.y,this.x)},t.prototype.rotate90$=function(){const e=this.x;return this.x=-this.y,this.y=e,this},t.prototype.rotate=function(t){return this.rotateRad(t*e)},t.prototype.rotate$=function(e){return this.direction+=e,this},t.prototype.rotateRad=function(e){const n=Math.sin(e),i=Math.cos(e);return new t(this.x*i-this.y*n,this.x*n+this.y*i)},t.prototype.rotateRad$=function(t){return this.direction+=t/e,this},t.prototype.setDirection=function(e){return new t({length:this.length,direction:e})},t.prototype.setDirection$=o,t.prototype.setDirectionRad$=r,t.prototype.dotProduct=function({x:e,y:t}){return this.x*e+this.y*t},t.prototype.crossProduct=function({x:e,y:t}){return this.x*t-this.y*e},t.prototype.projectOn=function(e){return e.multiply(this.dotProduct(e))},t})),
/*! Toxilib screen_object
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/screen_object",["./screen_group","./smart_smooth_state","./vector","./local_2D"],(function(e,t,n,i){const{localPointInReferenceFrame:o,globalPointFromReferenceFrame:r}=i;function s(i={}){let{x:s=0,y:a=0,orientation:l=0,scale:c=1,opacity:u=1,delay:h=0}=i;i.children=[];let d,p,f={x:s,y:a,orientation:l,scale:c,opacity:u},g={x:0,y:0};function m(e){return e.x+=g.x,e.y+=g.y,e}h?(d=t(f,{currentHook:m}),d.futureDelay=h,p=d):p=f;let y={velocity:new n({length:0,direction:0}),position:f,modifiers:g};i._private=y,i.viewPosition=p;let v={};i._private.lastTransitionalStates=v;let b,x,w=new e({watch:!0,dynamic:!0});i.view=w,Object.defineProperty(i,"interactive",{value:i});for(let e in f)v[e]={ended:!0},Object.defineProperty(i,e,{get:()=>f[e],set:t=>{if(f[e]=t,p!==f){let n={};n[e]=t,v[e]=p.change(n,h)}},enumerable:!0});return Object.defineProperty(i,"delay",{get:()=>h,set:e=>{b?x=e:(h=e,0===e||d||(d=t(f,{currentHook:m}),p=d,i.viewPosition=d),d&&(d.futureDelay=h))},enumerable:!0}),i.isChanging=function(){return d&&d.isChanging()},i._handleDragStart=()=>{y.dragging=!0,i.disableDelay()},i._handleDragStop=()=>{y.dragging=!1,i.enableDelay()},i.disableDelay=function(){if(b)return;if(b=!0,!d)return;let e=d.isChanging();if(x=d.futureDelay,h=0,d.futureDelay=0,e){d.freeze();for(let e in f)f[e]=d[e]}},i.enableDelay=function(){b&&(b=!1,d&&(i.delay=x))},Object.defineProperty(i,"velocity",{get:()=>y.velocity,set:e=>{e instanceof n?y.velocity=e:(y.velocity.x=e.x,y.velocity.y=e.y)},enumerable:!0}),Object.defineProperty(i,"speed",{get:()=>y.velocity.length,set:e=>{y.velocity.length=e},enumerable:!0}),Object.defineProperty(i,"direction",{get:()=>y.velocity.direction,set:e=>{y.velocity.direction=e},enumerable:!0}),i.addChild=function(e){i.children.push(e),e.parent&&e.parent.removeChild(e),e.parent=i,w.addObject(e)},i.removeChild=function(e){const t=i.children.indexOf(e);t>=0&&(i.children.splice(t,1),w.remove(e),delete e.parent)},i.forEach=function(e){return w.elements.forEach(e)},i.localPoint=function(e){return i.parent&&(e=i.parent.localPoint(e)),o(f,e.x,e.y)},i.globalPoint=function(e){return e=r(f,e.x,e.y),i.parent&&(e=i.parent.globalPoint(e)),e},i}return s.applyMotion=function(e,t){e.forEach((e=>{const{_private:n}=e,{velocity:i,modifiers:o,dragging:r}=n;if(i.length>0&&!r){const{position:r}=n;let s=i.x*t,a=i.y*t;if(r.x+=s,r.y+=a,!e.delay)return;const{lastTransitionalStates:l}=n,{x:c,y:u}=l;let h={};if(c.ended?(h.x=r.x,o.x=0):o.x+=s,u.ended?(h.y=r.y,o.y=0):o.y+=a,Object.keys(h).length>0){let t=e.viewPosition.change(h,0);c.ended&&(l.x=t),u.ended&&(l.y=t)}}else o.x=0,o.y=0}))},s})),define("render/screen_object",["event_bus","toxilibs/screen_object","editor/snippet_tools"],(function(e,t,n){const{addMethodSnippet:i}=n;e.on("all scripts loaded",(function(){e.emit("renderView add-on added",r),e.emit("renderView beforeExecutionHook added",s),e.emit("renderView beforeRenderHook added",a)}));let o=0;function r(e){let n=[];function o(e={}){return t(e),n.push(e),e}return e.screenObjects=n,e.api.createScreenObject=o,i(o,"createScreenObject","simpleFunctionNoArg"),o}function s(e){e.screenObjects.length=0}function a(e){t.applyMotion(e.screenObjects,o)}e.on("drawing frame reached",(e=>{o=e/1e3}))})),define("render/render_api",["user_code/api_manager","user_code/executable_api","user_code/handle_execution_error","user_code/deprecate","toxilibs/event_capabilities_queued","toxilibs/auto_dimensions","toxilibs/webgl_image","user_code/webgl_errors_handler","./dom_api","./graph_api","./render_tests","./simple_3d_api","./font_awesome_codes","./hybrid_screen","./hybrid_screen_image","./webcam","./video","./audio_api","./imagine","editor/snippet_tools","toxilibs/handle_system","./screen_object"],(function(e,t,n,i,o,r,s,a,l,c,u,h,d,p,f,g,m,y,v,b,x,w=()=>({})){const{addMethodSnippet:_,addCompletions:S}=b,C=n("Explorers - render_api.js"),k=["screen","screenGroup","toImageData","isEmpty","eventToCoords","eventToSmartTrimmedCoords","mouseEventToCoords","mouseEventToSmartTrimmedCoords","touchEventToCoords","touchEventToSmartTrimmedCoords","smartTrimCoords","onCameraMoved","on"];function A(e){const{hybridScreen:t}=e;if("generic render"===e.name){T(t),t.when._snippet='when("${1}", ${2})';let e=["clicked","leftClicked","rightClicked","mouseMoved","mouseButtonPressed","leftMouseButtonPressed","rightMouseButtonPressed","mouseButtonReleased","leftMouseButtonReleased","rightMouseButtonReleased","keyPressed","keyReleased","camera moved","resized"].map((e=>({caption:'when("'+e+'", ...)',snippet:'when("'+e+'", ${1})'})));e.push({caption:'when("x pressed", ...)',snippet:'when("${1} pressed", ${2})'}),e.push({caption:'when("x released", ...)',snippet:'when("${1} released", ${2})'}),S({screen:e}),t.setOptimalCamera._snippet="setOptimalCamera([\n\t{x: 0, y: 0},\n\t{x: 10, y: 10}\n])",function(e){for(let t in e){const n=e[t];"function"!=typeof n&&"object"!=typeof n&&delete e[t]}}(t),k.forEach((e=>{t[e]._hidden=!0}))}return i(t,{addPolygon:"addFreeShape",addLines:"addCurve",saveAsImage:"downloadAsImage",setOptimalView:"setOptimalCamera"}),t}const M={addCircle:{center:{x:0,y:0},radius:1,color:'"white"'},addGrid:{color:'"grey"',step:1},addPointsGrid:{color:'"grey"',step:1},addAxes:{color:'"orange"',lineWidth:.2},addRectangle:{center:{x:0,y:0},width:1,height:1,color:'"white"'},addLine:{origin:{x:0,y:0},end:{x:1,y:1},color:'"white"',lineWidth:.2},addCurve:{points:"[]",color:'"white"',lineWidth:.2},addFreeShape:{points:"[]",color:'"white"'},addGroup:{group:"",x:0,y:0},addText:{text:'"Explorers"',center:{x:0,y:0},font:'"2u Nasalization"',color:'"white"'},addIcon:{name:'"heart"',center:{x:0,y:0},size:1,color:'"white"'},addImage:{image:'""',center:{x:0,y:0},width:6},addArrow:{origin:{x:0,y:0},vector:{x:1,y:1},color:'"white"'},setCamera:{center:{x:0,y:0},scale:10},setCameraMouseControls:{minScale:10,maxScale:500,scaleVelocity:1},generateImage:{prompt:'"astronaut on an alien planet"',guidance:7,steps:20,seed:"false"},createFullScreenImage:{pixelRatio:1,whenCameraMoved:()=>{}},createFullScreenWebGLImage:{pixelRatio:1,shader:'""',data:{},whenCameraMoved:()=>{}}};function T(e){for(let t in e){let n=M[t];n?_(e[t],t,n):t.startsWith("add")&&(e[t]._snippet=`${t}({\n\t\${1}\n})`)}}function E(e){return`<i class="fas">${d[e]}</i>`}function $(...e){return new x(...e)}E.list=Object.keys(d);let L=1;function R(e){let{center:t}=e,{widthInPixels:n,heightInPixels:i,scale:o}=function(e){let t,{widthInPixels:n,heightInPixels:i}=e;"widthInPixels"in e||"heightInPixels"in e||(n=200);try{let{width:o,height:s}=r({width:e.width,height:e.height,sourceWidth:n,sourceHeight:i,preventConflict:!0});void 0===n&&(n=Math.round(i*o/s)),void 0===i&&(i=Math.round(n*s/o)),t=n/o}catch(e){const t=new Error("Mismatched dimensions : you should specify only width or height... or they should have the same ratio as the pixel dimensions");t.toxiTrace=t.toxiTrace||[],t.toxiTrace.unshift("Explorers - render_api.js - createScreen"),C(t)}return{widthInPixels:n,heightInPixels:i,scale:t}}(e);const s=window.document.createElement("canvas");s.width=n,s.height=i;const a=new p({name:`screen_${L}`,canvas:s,directScreenMode:!0});return L+=1,a.setCamera({center:t,scale:o}),a}function P(e){const{hybridScreen:t}=e;function n(e){const{screen:n=t,pixelRatio:i=1,whenLoaded:o}=e;let{center:r,width:s,height:l}=n.boundingBoxForWholeView();return e=Object.assign({screen:n,widthInPixels:n.widthInPixels/i,heightInPixels:n.heightInPixels/i,center:r,width:s,height:l},e,{whenLoaded:t=>{!function(e,{screen:t,whenCameraMoved:n}){n&&(e.whenCameraMoved=n);t.when("camera moved",(()=>function(e,t){e.batchUpdatePosition(t.boundingBoxForWholeView()),"whenCameraMoved"in e&&e.whenCameraMoved(e)}(e,t)))}(t,e),o&&o(t)},handleErrorsAndWarnings:a}),e}return{createFullScreenImage:function(e={}){return e=n(e),f(e)},createFullScreenWebGLImage:function(e){return e=n(e),new s(e)}}}return function(n){let i=l(n);const r=Object.assign({},i,c(n,i)),{name:s}=n,a=v(n);"generic render"===n.name&&T(a);const d=y(n),p=w(n),f={};o(f,{onError:n.createExecutionErrorHandler("Explorers - render_api.js - global event error")});return e({namespace:s,include:[{when:(...e)=>f.when(...e),send:(...e)=>f.emit(...e)},t(n),n.timers,h(n),u(n,r),P(n),{ui:r,audio:d,imagine:a,nodeSystem:p,icon:E,createHandleSystem:$,webcam:g(n),createVideo:m,createScreen:R,screen:A(n),hideMouse:()=>{n.hideMouse()},showMouse:()=>{n.showMouse()},simulateViewport:e=>n.simulateViewport(e),setDirectScreenMode:(e=!0)=>{e?(n.disableMouseDrag(),n.disableMouseZoom(),n.hybridScreen.setDirectScreenMode()):n.hybridScreen.setDirectScreenMode(!1)}}],snippetParams:M,onDestroy:()=>{d.destroy(),f.removeAllListeners()}})}})),define("render/drag",["toxilibs/topleft_and_pivot","toxilibs/collision_detector","toxilibs/vector"],(function(e,t,n){const{containsPositionParam:i}=e,{pointInLocalShapeReference:o}=t;function r(e,{shapes:t,shapeIndex:n,x:r,y:s}){let a=t[n],{positionModifier:l,beforeDrag:c}=a.interactive||{},u=t.slice(n+1),{objectToMove:h,positionParam:d,startPosition:p}=function(e){let t,n=i(e),o=e;n||("x"in e&&"y"in e?(n="root",t={x:e.x,y:e.y}):e.image?(n=i(e.image),o=e.image):e.points&&(n="points"));if(!e.points&&!t){let{x:e,y:i}=o[n];t={x:e,y:i}}if(!n)throw new Error("can not drag shape without position param");return{objectToMove:o,positionParam:n,startPosition:t}}(a);if(c)try{if("deny"===c({x:p.x,y:p.y,shape:a}))return}catch(t){e.handleMouseShapeEventError(t)}a._handleDragStart&&a._handleDragStart();let{dragEnabled:f}=e.cameraMouseControlsConfig,g=o({x:r,y:s},{shape:a,parents:u});e.storageForThisLaunch.dragData={shape:a,parents:u,objectToMove:h,positionParam:d,startPosition:p,mouseStart:{x:r,y:s},mouseStartInLocal:g,lastMouseInLocal:g,positionModifier:l,globalDragWasOn:f},f&&e.disableMouseDrag()}function s(e,{x:t,y:n}){const{mouse:i,hybridScreen:r}=e;!1!==i.movesSincePressed&&(i.movesSincePressed+=1);let{movesSincePressed:s}=i;if(s<3)return;let{x:u,y:h}=i.lastPress;r.emit("mouseDragged",t,n,{x:t-u,y:n-h});const{dragData:d}=e.storageForThisLaunch;if(!d)return;const{shape:p,parents:f,mouseStart:g}=d;3===s&&(!function(e,t){const{shape:n}=t;let{whenDragStarted:i}=n.interactive||{};if(i)try{const{startPosition:e}=t,o={shape:n};e&&(o.x=e.x,o.y=e.y),i(o)}catch(t){e.handleMouseShapeEventError(t)}}(e,d),d.started=!0);let m=o({x:t,y:n},{shape:p,parents:f}),y=function(e,{dragData:t,localMouse:n}){const{positionModifier:i}=t;if(!i)return!0;let o,r,s=a({dragData:t,localMouse:n});try{r=i(s)}catch(t){e.handleMouseShapeEventError(t)}if(!r)return!0;if("deny"===r){let{x:i,y:o}=function(e,{dragData:t,localMouse:n}){const{positionModifier:i}=t;let{x:o,y:r}=t.lastMouseInLocal,{x:s,y:l}=n;try{for(let e=0;e<5;e++){let e={x:(o+s)/2,y:(r+l)/2};"deny"===i(a({dragData:t,localMouse:e}))?(s=e.x,l=e.y):(o=e.x,r=e.y)}}catch(t){e.handleMouseShapeEventError(t)}return{x:o,y:r}}(e,{dragData:t,localMouse:n});return n.x=i,n.y=o,!0}"revert"===r?(r={shift:{x:0,y:0}},o="revert"):"drop"===r?(r={shift:s.shift},o="drop"):r.drop&&(o="drop");return function({dragData:e,localMouse:t,modifier:n}){let{mouseStartInLocal:i,startPosition:o}=e;if("shift"in n){let{x:e,y:o}=n.shift;t.x=i.x+e,t.y=i.y+o}else"x"in n&&o&&(t.x=i.x+n.x-o.x),"y"in n&&o&&(t.y=i.y+n.y-o.y)}({dragData:t,localMouse:n,modifier:r}),o}(e,{dragData:d,localMouse:m});l({dragData:d,localMouse:m}),d.lastMouseInLocal=m;const{whenDragged:v}=p.interactive||{};if(v)try{v(a({dragData:d,localMouse:m}))}catch(t){e.handleMouseShapeEventError(t)}e.forceRender(),"revert"===y?c(e,{x:g.x,y:g.y,dragData:d}):"drop"===y&&c(e,{x:t,y:n,dragData:d})}function a({dragData:e,localMouse:t}){const{shape:i,mouseStartInLocal:o,startPosition:r}=e;let s=t.x-o.x,a=t.y-o.y,l={shift:new n({x:s,y:a}),shape:i};return r&&(l.origin={x:r.x,y:r.y},l.x=r.x+s,l.y=r.y+a),l}function l({dragData:e,localMouse:t}){const{objectToMove:n,positionParam:i,lastMouseInLocal:o}=e;let r,s=t.x-o.x,a=t.y-o.y;"root"===i?(n.x+=s,n.y+=a):"points"===i?n.points.forEach((e=>{e.x+=s,e.y+=a})):(r=n[i],r.x+=s,r.y+=a)}function c(e,{dragData:t}){const{started:n,globalDragWasOn:i,shape:o}=t;n&&function(e,t){const{shape:n}=t,{beforeDrop:i,whenDropped:o}=n.interactive||{};if(!i&&!o)return;let r=t.lastMouseInLocal,s=a({dragData:t,localMouse:r});if(i)try{if("revert"===i(s)){let{mouseStart:n}=t;l({dragData:t,localMouse:n}),e.forceRender()}}catch(t){e.handleMouseShapeEventError(t)}if(o)try{o(s)}catch(t){e.handleMouseShapeEventError(t)}}(e,t),o._handleDragStop&&o._handleDragStop(),i&&e.enableMouseDrag(),delete e.storageForThisLaunch.dragData}return{triggerDragStart:function(e,{shapes:t,x:n,y:i}){if(!t)return;let o=function(e,t,n){for(let i=e.length-1;i>=0;i--){let o=e[i],r=o.interactive&&o.interactive.draggable;if(r&&("function"!=typeof r||r({x:t,y:n,shape:o})))return i}return-1}(t,n,i);o>=0&&r(e,{shapes:t,shapeIndex:o,x:n,y:i})},triggerDragStartOnShape:r,triggerDrag:s,triggerDragStop:function(e,{x:t,y:n}){s(e,{x:t,y:n});const{dragData:i}=e.storageForThisLaunch;i&&c(e,{x:t,y:n,dragData:i})}}})),define("render/render_view_mouse_events",["event_bus","toxilibs/collision_detector","./drag"],(function(e,t,n){const{triggerDragStart:i,triggerDragStartOnShape:o,triggerDrag:r,triggerDragStop:s}=n;function a(e,t,n,i){const{screenGroup:o}=e.hybridScreen;if(o)try{o.triggerCoordMethodOnShapes(t,{x:n,y:i})}catch(t){e.handleMouseShapeEventError(t)}}function l(e,{x:t,y:n,outOfScreen:i}){const{screenGroup:o}=e.hybridScreen;if(!o)return;let r=!i&&o.shapesAt({x:t,y:n})||[];const{lastHovered:s}=e.mouse;s[0]!==r[0]&&(s.forEach((i=>{const{whenMouseMovedOut:o}=i;if(o&&!r.includes(i))try{o(t,n,i)}catch(t){e.handleMouseShapeEventError(t)}})),r.forEach((i=>{const{whenMouseMovedIn:o}=i;if(o&&!s.includes(i))try{o(t,n,i)}catch(t){e.handleMouseShapeEventError(t)}}))),o.triggerCoordMethodOnShapes("whenMouseMoved",{x:t,y:n}),e.mouse.lastHovered=r}function c(e,t,{x:n,y:i,button:o}){t.x=n,t.y=i,t.button=o,t.time=(Date.now()-e.executedAt)/1e3}return{initMouseProperties:function(e){const{x:t=0,y:n=0}=e.persistingOnRestart.mouse||{},i={x:t,y:n,lastClick:{x:1/0,y:1/0,time:-1/0},lastPress:{x:1/0,y:1/0,time:-1/0},lastRelease:{x:1/0,y:1/0,time:-1/0},lastMove:{x:1/0,y:1/0,time:-1/0},movesSincePressed:!1};Object.defineProperty(i,"lastHovered",{value:[],writable:!0,enumerable:!1}),e.mouse=i},initMouseEventsErrorHandler:function(e){e.handleMouseShapeEventError=e.createExecutionErrorHandler("Explorers - render_view_mouse_event.js - shape mouse method error")},addMouseEventsMethods:function(t){t.prototype.mouseMoved=function(t){const{mouse:n,hybridScreen:i,persistingOnRestart:o}=this;let{x:s,y:a}=i.eventToSmartTrimmedCoords(t);n.x=s,n.y=a,o.mouse={x:s,y:a},this.restartWhenMouseMoved?e.emit("wants to restart"):(r(this,{x:s,y:a}),l(this,{x:s,y:a}),c(this,n.lastMove,{x:s,y:a}),e.emit("mouse moved on screen",{renderView:this,event:t,x:s,y:a}),i.emit("mouseMoved",s,a))},t.prototype.mouseMovedOut=function(e){const{x:t,y:n}=this.hybridScreen.mouseEventToSmartTrimmedCoords(e);this.mouse.movesSincePressed=!1,l(this,{x:t,y:n,outOfScreen:!0})},t.prototype.mouseButtonPressed=function(e,{button:t}){const{mouse:n,hybridScreen:o}=this,{x:r,y:s}=o.mouseEventToSmartTrimmedCoords(e);n.pressed=!0,n.movesSincePressed=0,c(this,n.lastPress,{x:r,y:s,button:t});const a=function(e,{x:t,y:n}){const{screenGroup:i}=e.hybridScreen;if(!i)return null;return i.shapesAt({x:t,y:n})}(this,{x:r,y:s});!function(e,{shapes:t,x:n,y:i}){t&&t.forEach((t=>{if("whenMouseButtonPressed"in t)try{t.whenMouseButtonPressed(n,i,t)}catch(t){e.handleMouseShapeEventError(t)}}))}(this,{shapes:a,x:r,y:s}),i(this,{shapes:a,x:r,y:s}),o.emit("mouseButtonPressed",r,s,t),o.emit(`${t}MouseButtonPressed`,r,s,t)},t.prototype.mouseButtonReleased=function(e,{button:t}){const{mouse:n,hybridScreen:i}=this,{x:o,y:r}=i.mouseEventToSmartTrimmedCoords(e);n.pressed=!1,n.movesSincePressed=!1,c(this,n.lastRelease,{x:o,y:r,button:t}),a(this,"whenMouseButtonReleased",o,r),s(this,{x:o,y:r}),i.emit("mouseButtonReleased",o,r,t),i.emit(`${t}MouseButtonReleased`,o,r,t)},t.prototype.mouseClicked=function(t,{button:n}){const{mouse:i,hybridScreen:o}=this,{x:r,y:s}=o.mouseEventToSmartTrimmedCoords(t);c(this,i.lastClick,{x:r,y:s,button:n}),e.emit("mouse clicked on screen",{renderView:this,event:t,x:r,y:s,button:n}),a(this,"whenClicked",r,s),o.emit("clicked",r,s,n),o.emit(`${n}Clicked`,r,s,n)}},addMouseControlMethods:function(e,t){t.stopDrag=function(){s(e,e.mouse)},t.startShapeDrag=function(t){const{x:n,y:i}=e.mouse;o(e,{shape:t,x:n,y:i})}}}})),define("render/simulate_viewport",["event_bus","jquery","editor/snippet_tools","./background_css"],(function(e,t,n,i){const{addMethodSnippet:o}=n;function r(e){function t(t){let n=e.uiContainer.width(),i=e.uiContainer.height(),o=n/i,{widthInPixels:r=n,heightInPixels:s=i,aspectRatio:a,outerBackground:l,screenSmoothing:c=!0,screenScaling:h=!0}=t||{};a&&(a>o?s=Math.round(n/a):r=Math.round(i*a)),e._currentViewportSimulator=t&&{widthInPixels:r,heightInPixels:s,aspectRatio:a,outerBackground:l,screenSmoothing:c,screenScaling:h};let d,p=0,f=0;o>r/s?(d=i/s,p=(n-d*r)/2):(d=n/r,f=(i-d*s)/2);let g=function(e){let t;(!e||"string"==typeof e||"image"in e||"color"in e)&&(t=e,e=e||{});let n={};return["left","right","top","bottom"].forEach((i=>{n[i]=t||e[i]})),n}(l);u(e,{widthInPixels:r,heightInPixels:s,scale:d,edgeHorizontal:p,edgeVertical:f,backgrounds:g,screenSmoothing:c,screenScaling:h})}e.simulateViewport=t,e.api.simulateViewport=t,o(t,"simulateViewport","simpleFunctionNoArg")}function s(e){e._simulateViewportConfig?u(e,e._simulateViewportConfig):e.renderZone._currentSimulateViewportConfig&&c(e)}function a(e){delete e._currentViewportSimulator,delete e._simulateViewportConfig,c(e),"$uiOuterEdges"in e?Object.values(e.$uiOuterEdges).forEach((e=>e.removeAttr("style"))):(e.$uiOuterEdges={top:t('<div class="ui_outer_edge ui_outer_edge_top">'),bottom:t('<div class="ui_outer_edge ui_outer_edge_bottom">'),left:t('<div class="ui_outer_edge ui_outer_edge_left">'),right:t('<div class="ui_outer_edge ui_outer_edge_right">')},Object.values(e.$uiOuterEdges).forEach((t=>e.$ui.append(t))))}function l(e){e.visible&&e._currentViewportSimulator&&e.simulateViewport(e._currentViewportSimulator)}function c(e){let{renderZone:t}=e;t._currentSimulateViewportConfig&&(delete t._currentSimulateViewportConfig,t.$screenContainer.removeAttr("style"),t.$screenContainer.find(".render_canvas").removeAttr("style"),t.adjustSize())}function u(e,t){!function(e,t){let{edgeHorizontal:n,edgeVertical:o,backgrounds:r}=t;["left","right","top","bottom"].forEach((t=>{let s=i(r[t],{position:t})||{};"left"===t||"right"===t?s.width=`${n}px`:s.height=`${o}px`,e.$uiOuterEdges[t].css(s)}))}(e,t);let n,{scale:o,widthInPixels:r,heightInPixels:s,edgeHorizontal:a,edgeVertical:l,screenSmoothing:c,screenScaling:u}=t;n=1===o?{width:`${r}px`,height:`${s}px`,transform:`translate(${a}px, ${l}px)`}:{width:`${r}px`,height:`${s}px`,transform:`translate(${a}px, ${l}px) scale(${o}, ${o})`},e._simulateViewportConfig=t;let{renderZone:h}=e,d=h._currentSimulateViewportConfig||{screenSmoothing:!0,screenScaling:!0};if(r!==d.widthInPixels||s!==d.heightInPixels||a!==d.edgeHorizontal||l!==d.edgeVertical||o!==d.scale||u!==d.screenScaling||c!==d.screenSmoothing){if(e.$uiBody.css(n),u||(n={width:`${Math.round(r*o)}px`,height:`${Math.round(s*o)}px`,transform:`translate(${a}px, ${l*o}px)`}),c!==d.screenSmoothing){let e=c?"auto":"pixelated";h.$screenContainer.find(".render_canvas").css({imageRendering:e})}h.$screenContainer.css(n),h._currentSimulateViewportConfig=t,h.adjustSize()}}e.on("all scripts loaded",(function(){e.emit("renderView add-on added",r),e.emit("renderView beforeExecutionHook added",a),e.emit("renderView beforeShowHook added",s),e.emit("renderView resizeHook added",l)}))})),define("render/render_view",["event_bus","jquery","toxilibs/alias","./hybrid_screen","./render_api","./render_view_mouse_events","./simulate_viewport"],(function(e,t,n,i,o,r){let s;e.on("app initialized",(e=>{s=e.workspaceId}));const{initMouseProperties:a,addMouseEventsMethods:l,addMouseControlMethods:c,initMouseEventsErrorHandler:u}=r,h=[];e.on("renderView add-on added",(e=>h.push(e)));const d=[];e.on("renderView beforeExecutionHook added",(e=>d.push(e)));const p=[];e.on("renderView beforeShowHook added",(e=>p.push(e)));const f=[];e.on("renderView beforeRenderHook added",(e=>f.push(e)));const g=[];function m({name:n,renderZone:r,document:l,container:c,backgroundContainer:p,uiContainer:f,editorDisplay:g,cameraControl:m,skipExecuteCapabilities:b,skipHelperScreen:w,autoResize:_=!0}){var S;this.name=n,this.renderZone=r,Object.defineProperty(this,"fullId",{get:()=>`${s}:${this.name}`}),this.storageForThisLaunch={},this.persistingOnRestart={},this.cameraControl=m,a(this),this.cameraMouseControlsConfig={zoomEnabled:!0,dragEnabled:!0,scaleVelocity:1,minScale:.01,maxScale:1e5},this.mouseCursorHidden=!1,this.container=c,this.backgroundContainer=p,this.$background=t('<div class="ui_background">'),this.uiContainer=f,this.brightBackground=!1,v(this),w||function(e){const{container:t}=e,n=t.find(".helper_canvas")[0];if(!n)return;e.helperScreen=new i({name:"helper screen",canvas:n,setOptimalCamera:y})}(this),_&&e.on("renderZone resized",(()=>{this.visible?this.resize():this.resizeMaybeNeeded=!0})),this.displayed=!1,this.editorDisplay=g,(S=this).$ui=t('<div class="ui_parent">'),S.$uiBody=t('<div class="ui_body transmit_mouse_to_screen">'),S.$ui.append(S.$uiBody),S.$ui.hide(),S.uiContainer.append(S.$ui),S.setTheme({theme:"classic"}),this.document=l,!x||b||g?(!function(e){e.editorDisplay?(e.start=()=>{},e.stop=()=>{}):(e.start=()=>{console.log("start requested, but is empty")},e.stop=()=>{console.log("stop requested, but is empty")});e.restart=()=>{console.log("restart requested, but is empty")}}(this),this.createExecutionErrorHandler=()=>{}):x(this,{beforeExecutionStarted:()=>{d.forEach((e=>e(this)))},onExecutionStarted:()=>e.emit("render execution started",{name:this.name,screenStateParams:this.screenStateParams()}),onExecutionStopped:e.emitter("render execution stopped")}),u(this);let{api:C,destroy:k}=o(this);this.api=C,this.destroyApi=k,h.forEach((e=>e(this)))}e.on("renderView resizeHook added",(e=>g.push(e))),l(m),m.prototype.updateParams=function({editorDisplay:e=null}){null!==e&&(this.editorDisplay=e,this.displayed&&_(this))},m.prototype.screenStateParams=function(){const{name:e,hybridScreen:t}=this,{xMin:n,xMax:i,yMin:o,yMax:r}=t.boundingBoxForWholeView();return{xMin:n,xMax:i,yMin:o,yMax:r,path:e}},m.prototype.hide=function(){this.clear(),this.visible=!1,this.$background.detach(),this.$ui.hide(),this.disableStyles(),this.pauseRequestAnimationFrames&&this.pauseRequestAnimationFrames(),e.emit("renderView hidden",this)},m.prototype.show=function(){this.visible||(this.visible=!0,this.hybridScreen.screenGroupLastChange=0,this.resumeRequestAnimationFrames&&this.resumeRequestAnimationFrames(),this.backgroundContainer.append(this.$background),this.enableStyles(),p.forEach((e=>e(this))),this.resizeMaybeNeeded&&this.resize(),this.render(),this.$ui.show(),this.synchronizeClasses(),this.editorDisplay&&_(this),this.cameraControl.screen=this.hybridScreen.screen,this.updateCameraControl(),e.emit("renderView shown",this),e.emit("main execution context changed",this))},m.prototype.clear=function(){this.visible&&this.hybridScreen.screen.clear()},m.prototype.setTheme=function({theme:e}={}){this.$ui.removeClass(this.theme),this.$ui.addClass(e),this.theme=e,"visual-novel"===e&&(this.storageForThisLaunch.disableDefaultPopupBlur=!0)},m.prototype.synchronizeClasses=function(){this.blurredScreen?this.container.addClass("blurry"):this.container.removeClass("blurry"),this.mouseCursorHidden?this.$ui.addClass("no_mouse_cursor"):this.$ui.removeClass("no_mouse_cursor"),this.setBrightBackgroundMode(this.brightBackground)},m.prototype.hideMouse=function(){this.mouseCursorHidden=!0,this.$ui.addClass("no_mouse_cursor")},m.prototype.showMouse=function(){this.mouseCursorHidden=!1,this.$ui.removeClass("no_mouse_cursor")},m.prototype.setBrightBackgroundMode=function(e=!0){this.brightBackground=e,e?this.$ui.addClass("bright_background"):this.$ui.removeClass("bright_background")},m.prototype.showMouse=function(){this.mouseCursorHidden=!1,this.$ui.removeClass("no_mouse_cursor")},m.prototype.blur=function(e){"ui"!==e&&this.blurScreen(),"screen"!==e&&this.blurUi()},m.prototype.blurScreen=function(){this.blurredScreen=!0,this.visible&&this.container.addClass("blurry")},m.prototype.blurUi=function(){this.$uiBody.addClass("blurry_children")},m.prototype.unblur=function(){delete this.blurredScreen,this.visible&&this.container.removeClass("blurry"),this.$uiBody.removeClass("blurry_children")},m.prototype.render=function(e=!1){this.visible&&(f.forEach((e=>e(this))),this.forceNextRender&&(e=!0,delete this.forceNextRender),this.hybridScreen.render(e||this.continuousRefresh))},m.prototype.forceRender=function(){this.forceNextRender=!0},m.prototype.reset=function(){a(this),this.setTheme({theme:"classic"}),this.storageForThisLaunch={},this.hybridScreen.reset(),this.destroyApi(),this.$uiBody.empty(),this.$uiBody.removeAttr("style"),this.$background.empty(),this.$background.removeAttr("style"),this.resetStyles(),this.unblur(),this.showMouse(),this.enableMouseDrag(),this.enableMouseZoom(),this.disableContinuousRefresh(),this.render()},m.prototype.resetAndRestart=function(){this.reset(),this.restart()},m.prototype.enableContinuousRefresh=function(){this.continuousRefresh=!0},m.prototype.disableContinuousRefresh=function(){this.continuousRefresh=!1},m.prototype.enableRestartWhenMouseMoved=function(){this.restartWhenMouseMoved=!0},m.prototype.enableMouseDrag=function(){this.cameraMouseControlsConfig.dragEnabled=!0,this.visible&&this.updateCameraControl()},m.prototype.disableMouseDrag=function(){this.cameraMouseControlsConfig.dragEnabled=!1,this.visible&&this.updateCameraControl()},m.prototype.enableMouseZoom=function(){this.cameraMouseControlsConfig.zoomEnabled=!0,this.visible&&this.updateCameraControl()},m.prototype.disableMouseZoom=function(){this.cameraMouseControlsConfig.zoomEnabled=!1,this.visible&&this.updateCameraControl()},m.prototype.setCameraMouseControls=function(e){Object.assign(this.cameraMouseControlsConfig,e),this.visible&&this.updateCameraControl()},m.prototype.updateCameraControl=function(){const{zoomEnabled:e,dragEnabled:t,minScale:n,maxScale:i,scaleVelocity:o}=this.cameraMouseControlsConfig;e?this.cameraControl.enableZoom():this.cameraControl.disableZoom(),t?this.cameraControl.enableDrag():this.cameraControl.disableDrag(),this.cameraControl.minScale=n,this.cameraControl.maxScale=i,this.cameraControl.scaleVelocity=o};["getCamera","setCamera","freezeCamera","setOptimalView","setOptimalCamera","zoom","rotate","translateCenter","downloadAsImage"].forEach((e=>{m.prototype[e]=function(...t){return this.hybridScreen[e](...t)}})),m.prototype.setDirectScreenMode=function(e){this.directScreenMode!==e&&(this.directScreenMode=e,v(this))},m.prototype.synchronizeCamera=function(){const e=this.hybridScreen.screen.getCamera();this.hybridScreen.screenCamera.change(e)},m.prototype.synchronizeHelperScreenCamera=function(){if(!this.helperScreen)return;const e=this.hybridScreen.screen.getCamera();this.helperScreen.setCamera(e),this.helperScreen.isEmpty()||this.helperScreen.forceRender()},m.prototype.resize=function(){if(delete this.resizeMaybeNeeded,this.hybridScreen.updateCanvasSize()){if(g.forEach((e=>e(this))),this.hybridScreen.lastDisplayedBoundingBox){let{xMin:e,xMax:t,yMin:n,yMax:i}=this.hybridScreen.lastDisplayedBoundingBox;this.hybridScreen.setOptimalCamera([{x:e,y:n},{x:t,y:i}],{delay:0})}this.hybridScreen.emit("resized")}};const y=[{x:-8.7,y:-6.2},{x:8.7,y:6.2}];function v(t){const{container:o,directScreenMode:r}=t;t.hybridScreen=new i({name:(t.name||"explorers")+(r?"_direct":""),canvas:o.find(".render_canvas"),directScreenMode:r,onCameraMoved:()=>{e.emit("camera moved",t),t.hybridScreen.emit("camera moved")},setOptimalCamera:y,onBackgroundBrightnessChanged:e=>t.setBrightBackgroundMode("bright"===e)}),function(e,t){n({target:e,proxy:t,key:"renderTime",fastMode:!0}),n({target:e,proxy:t,keys:b,fastMode:!0,writable:!1})}(t,t.hybridScreen),c(t,t.hybridScreen)}const b=["mouse","enableContinuousRefresh","enableRestartWhenMouseMoved","disableContinuousRefresh","enableMouseDrag","disableMouseDrag","enableMouseZoom","disableMouseZoom","setCameraMouseControls"];let x,w;function _(t){if(!w)return void console.error("showEditor feature is not supported");const{content:n,line:i,column:o}=t.editorDisplay;e.emit("render wants to show viewOnlyEditor",{content:n,line:i,column:o})}return e.on("execution_capabilities added",(function(e){x=e})),e.on("viewOnlyEditor added",(function(){w=!0})),m})),
/*! Toxilib dom_mouse_events
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/dom_mouse_events",["jquery"],(function(e){return function({container:t,eventBus:n,namespace:i,data:o,contextMenuHook:r}){const s=e(t);let a,l=!1,c="";i&&(c=` on ${i}`);const u=["left","middle","right"];function h(e){return u[e.button]||"unkownButton"}function d(e,t,i){n.emit(e+c,t,i)}r&&s.contextmenu(r),s.on("pointerdown",(function(e){let t=h(e);l=0,a=e,d("mousedown",e,{button:t,data:o}),d(`${t} mousedown`,e,o)})),s.on("pointerup",(function(e){let t=h(e);d("mouseup",e,{button:t,data:o}),d(`${t} mouseup`,e,o),!1!==l&&(l<4?(d("click",a,{button:t,data:o}),d(`${t} click`,a,o)):d("end drag",e,o),l=!1)})),s.on("pointerleave",(function(e){l=!1,d("mouse left",e,o)})),s.on("pointermove",(function(e){d("mousemove",e),!1!==l&&(l+=1),l>=4&&d("mousedrag",e,o)}))}})),define("render/mouse_events",["jquery","toxilibs/event_capabilities_queued","toxilibs/dom_mouse_events"],(function(e,t,n){const i={mousedown:"mouseButtonPressed",mousemove:"mouseMoved",mouseup:"mouseButtonReleased",click:"mouseClicked","mouse left":"mouseMovedOut"};return function({container:o,renderViews:r}){const s={};let a;t(s),n({eventBus:s,container:o,contextMenuHook:t=>{let n=e(t.target);return n.hasClass("enable_context_menu")||n.parents(".enable_context_menu").length>0}});for(let e in i){let t=i[e];s.on(e,(function(n,i){if(!n.target.classList.contains("transmit_mouse_to_screen")&&!a)return;n.preventDefault(),"mousedown"===e&&(a=!0),"mouseup"===e&&(a=!1);let{currentView:o}=r;o&&o[t](n,i)}))}}})),define("render/keys",["event_bus","jquery"],(function(e,t){let{document:n}=window;function i(e){e.pressedKeys={},e.api.pressedKeys=e.pressedKeys}function o({shiftKey:e,ctrlKey:t,metaKey:n,altKey:i,key:o,keyCode:r}){return{shiftKey:e,ctrlKey:t,metaKey:n,altKey:i,key:o,keyCode:r}}return e.on("all scripts loaded",(function(){e.emit("renderView add-on added",i)})),e.on("renderView hidden",(function(e){let{pressedKeys:t}=e;for(let e in t)delete t[e]})),function(e){t(window).on("keydown",(function(t){if(t.target!==n.body)return;const{currentRenderView:i}=e;if(!i)return;let{key:r}=t;"Tab"===r&&t.preventDefault();const{pressedKeys:s,hybridScreen:a}=i;if(r in s)return;s[r]=!0;let l=o(t);a.emit("keyPressed",l)," "===r&&(r="Space",s[r]=!0),a.emit(`${r} pressed`,l)})),t(window).on("keyup",(function(t){const{currentRenderView:i}=e;if(!i)return;let{key:r,target:s}=t;delete i.pressedKeys[r]," "===r&&delete i.pressedKeys.Space;const{hybridScreen:a}=i;if(s===n.body){let e=o(t);" "===r&&(r="Space"),a.emit(`${r} released`,e),a.emit("keyReleased",e)}}))}})),define("render/render_zone",["event_bus","jquery","toxilibs/dom_resize_listener","libs/collection","libs/swap_view_capabilities","./camera_control","./render_view","./mouse_events","./keys"],(function(e,t,n,i,o,r,s,a,l){let c;function u({$container:e}={}){this.renderViews=new i({name:"renderViews",Constructor:s,indexedKey:"name",uniqueness:!0,existence:!0}),o(this.renderViews),Object.defineProperty(this,"currentRenderView",{get:()=>this.renderViews.currentView}),e&&this.init(e)}e.on("code directory ready",(function(e){c=e}));let h=1;u.prototype.init=function(t){const i=t.find(".render_ui"),{renderViews:o}=this;this.$container=t,this.$screenContainer=t.find(".render_layers"),this.$backgroundContainer=t.find(".render_background"),this.$uiContainer=i,e.on("editor pageMoved",(function(e,t){let n=o.find(e);n&&(c.moveChild(n.document,t),n.name=t,delete o.items[e],o.items[t]=n)})),t.attr("id")||(t.attr("id",`discovery_render_${h}`),h+=1),n(this.$container[0],(()=>this.adjustSize())),a({renderViews:o,container:i}),l(this),this.cameraControl=r({$uiContainer:i,renderViews:o}),this.followScreenState=this.cameraControl.followScreenState,e.on("coords recorder enabled",(()=>i.addClass("coords_recorder"))),e.on("coords recorder disabled",(()=>i.removeClass("coords_recorder"))),e.on("camera moved",(e=>{e.synchronizeHelperScreenCamera(),o.currentView===e&&m(this)})),g(this),e.on("drawing frame reached",(()=>function({renderViews:e}){e.currentView&&e.currentView.render()}(this)));for(let e in p)f(this,e,...p[e]),delete p[e]};let d,p={};function f(e,t,{editorDisplay:n},i){if(!e.$screenContainer)return void(p[t]=[{editorDisplay:n},i]);let o=c&&c.find(t);i(e.renderViews.create({name:t,renderZone:e,document:o,container:e.$screenContainer,backgroundContainer:e.$backgroundContainer,uiContainer:e.$uiContainer,editorDisplay:n,cameraControl:e.cameraControl}))}function g(e){let{$screenContainer:t}=e;const n=t[0].clientWidth,i=t[0].clientHeight,o=t.find(".render_canvas")[0];o.width=n,o.height=i,o.style.width=`${n}px`,o.style.height=`${i}px`;const r=t.find(".helper_canvas")[0];r&&(r.width=n,r.height=i,r.style.width=`${n}px`,r.style.height=`${i}px`)}function m({renderViews:e}){e.currentView&&(e.currentView.hybridScreen.screenGroupLastChange=0)}return u.prototype.openRenderView=function(e,t={}){const{renderViews:n}=this;let i=n.find(e);const{restart:o}=t;async function r(t){d||await function(e){let{cx:t}=e.hybridScreen.directScreen.drawAdapter,n=Date.now();return new Promise((e=>{function i(){t.font="16px FontAwesomeForScreen";let{width:o}=t.measureText("");16===o?(d=!0,e()):Date.now()-n>2e3?(console.error("FontAwesomeForScreen not loaded for canvas... waited too long... aborting !"),e()):(console.warn("FontAwesomeForScreen not loaded for canvas... waiting...",o),setTimeout(i,20))}i()}))}(t),n.openView(e),t.started&&o?t.resetAndRestart():t.start(),localStorage.lastRendered=e}i&&this.currentRenderView===i&&!o||(i?(t&&i.updateParams(t),r(i)):f(this,e,t,r))},u.prototype.closeRenderView=function(e){let t=this.renderViews.closeView(e);t.reset(),t.stop()},u.prototype.restartCurrentView=function(){const{currentRenderView:e}=this;e?e.resetAndRestart():console.warn("Can not restart : no current view")},u.prototype.pauseRequestAnimationFrames=function(){const{currentRenderView:e}=this;e&&(this.viewWithPausedFrame=e,e.pauseRequestAnimationFrames())},u.prototype.resumeRequestAnimationFrames=function(){const{viewWithPausedFrame:e}=this;e&&e.visible&&e.resumeRequestAnimationFrames(),delete this.viewWithPausedFrame},u.prototype.adjustSize=function(){g(this),m(this),e.emit("renderZone resized",this)},u})),define("standalone/discovery_core",["render/load_default_fonts","render/render_zone"],(function(e,t){return{loadDefaultFonts:e,RenderZone:t}})),define("standalone/tools",["event_bus","jquery","standalone/discovery_core"],(function(e,t,n){const{RenderZone:i}=n,{_discoveryContentsCache:o}=window;function r(e){const t=e.currentRenderView;t&&s(e,t.name,{restart:!0})}function s(e,t,n){const i=t.replace("/render/",""),r=`/render/${i}`;if(!o.render[i])throw new Error(`no Discovery render named "${i}"`);const s=e.currentRenderView;s&&s.hide(),e.openRenderView(r,n)}function a(n,o){"string"==typeof o&&(o=t(o)),o.addClass("discovery_render"),0===o.find(".render_background").length&&o.append('\n            <div class="render_background"></div>\n            <div class="render_layers">\n                <canvas class="render_canvas"></canvas>\n            </div>\n            <div class="render_ui"></div>\n            ');const a=new i({$container:o});e.on("wants to restart",(()=>r(a))),e.emit("workspace resized"),s(a,n)}return window.discoveryShow=a,{timersManagers:{},restart:r,goToRender:s,createRenderZone:a}})),
/*! Toxilib error_modifier
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/error_modifier",[],(function(){function lineRegex(){return new RegExp("(\\d+):(\\d+)(\\)?)\n")}const regex=lineRegex();function getLinesAddedByBrowserToFunctionEval(){try{new Function("","error()")()}catch(e){return improveLineAndColumnError(e),e.lineNumber-1}return 0}const AsyncFunction=Object.getPrototypeOf((async function(){})).constructor;function getLinesAddedByBrowserToAsyncFunctionEval(){new AsyncFunction("","error()").call().catch((e=>{improveLineAndColumnError(e),linesAddedByBrowser.asyncFunctionEval=e.lineNumber-1}))}function getLinesAddedByBrowserToEval(){try{eval("error()")}catch(e){return improveLineAndColumnError(e),e.lineNumber-1}return 0}const linesAddedByBrowser={unknown:0};function errorModifier(e,t){e.toxiTrace=e.toxiTrace||[],e.toxiTrace.unshift("Toxilibs - error_modifier.js"),createDefaultMessage(e),createDefaultStack(e),improveLineAndColumnError(e,t),e.alreadyHandledByErrorModifier=!0}function linesToRemove({from:e="unknown",ignoredLines:t=0}={}){return t+linesAddedByBrowser[e]}function createDefaultMessage(e){void 0!==e.message&&""!==e.message||(e.message="Undefined error")}function createDefaultStack(e){if(void 0===e.stack){const{message:t,line:n=1,lineNumber:i=n,columnNumber:o=1,sourceURL:r="<anonymous>"}=e;e.stack=`${t}\nat ${r}:${i}:${o}`}}function improveLineAndColumnError(e,t){let n=linesToRemove(t);e.stack=e.stack.replace(regex,(function(t,i,o,r){return e.lineNumber=parseInt(i,10)-n,e.columnNumber=parseInt(o,10),`${e.lineNumber}:${e.columnNumber}${r}`}))}return linesAddedByBrowser.eval=getLinesAddedByBrowserToEval(),linesAddedByBrowser.functionEval=getLinesAddedByBrowserToFunctionEval(),getLinesAddedByBrowserToAsyncFunctionEval(),errorModifier.linesToRemove=linesToRemove,errorModifier.addLastPositionToExecutionError=function(e,t){if(e){let{line:n,column:i,sourceName:o}=e;t.lineNumber=n,t.column=i,t.sourceName=o,t.originalMessage=t.message,t.message=`in source "${o}" line ${n}, ${t.message}`}},errorModifier})),
/*! Toxilib execute_get_current_line
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/execute_get_current_line",["./string_utils","./error_modifier"],(function(e,t){return function({name:n,source:i,errorModifierParams:o,receiveGetCurrentLine:r}){const s=i.split("\n"),a=new RegExp(`${e.escapeForRegExp(encodeURIComponent(n))}[ .].*:(\\d*):(\\d*)[^\\d]*\\n`,"m");r((function(){let e=new Error("fake error").stack.match(a);if(e){let n=parseInt(e[1],10)-t.linesToRemove(o);return{lineNumber:n,content:s[n-1]}}return console.warn("This browser is not supported by Toxilib execute_get_current_line"),{}}))}})),define("standalone/modules_accessor",[],(function(){const{_discoveryContentsCache:e}=window,{modules:t}=e;return function(e){const n={},i=new Set;let o;function r(t,r){Object.defineProperty(n,t,{get:()=>{if(i.has(t))throw new Error(`Circular dependency detected, from ${o} to ${t}`);i.add(t),o=t;let s=r(e);return i.delete(t),Object.defineProperty(n,t,{writable:!0}),n[t]=s,s},configurable:!0})}e.m=n;for(let e in t)r(e,t[e]);return n}})),
/*! Toxilib timer
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/timer",[],(function(){function e({endCallback:e,secondsRemainingCallback:t,duration:n=3e4,bonusDelay:i=n/3}={}){this.endCallback=e,this.secondsRemainingCallback=t,this.duration=n,this.bonusDelay=i,this.paused=!0,this.wasNeverLaunched=!0}function t(e){clearTimeout(e.currentTimeout),clearTimeout(e.secondsRemainingTimeout)}function n(e){if(e.secondsRemainingCallback){let t=e.remainingTime();if(t<=0)return;e.secondsRemainingTimeout=setTimeout((function(){e.secondsRemainingCallback(Math.round(e.remainingTime()/1e3)),n(e)}),t%1e3)}}function i(i,o){i.wasNeverLaunched=!1,t(i),i.paused=!1,i.timerStop=e.now()+o,i.timerDelay=o,o<=0?i.endCallback&&i.endCallback():(n(i),i.endCallback&&(i.currentTimeout=setTimeout(i.endCallback,o)))}return e.now=function(){return(new Date).getTime()},e.prototype.launch=function(t){this.startedAt=e.now(),this.pauseDuration=0,this.duration=t||this.duration,i(this,this.duration)},e.prototype.addBonusDelay=function(){this.timerStop-e.now()<this.bonusDelay&&i(this,this.bonusDelay)},e.prototype.add=function(t){if(this.paused)this.remainingTimeAfterPause+=t;else if(this.ended())this.duration+=t;else{i(this,this.timerStop-e.now()+t)}},e.prototype.togglePause=function(){this.paused?this.unPause():this.pause()},e.prototype.pause=function(){this.paused||(t(this),this.paused=!0,this.pausedAt=e.now(),this.remainingTimeAfterPause=this.timerStop-e.now())},e.prototype.unPause=function(){this.wasNeverLaunched?this.launch():this.paused&&(i(this,this.remainingTimeAfterPause),this.pauseDuration+=e.now()-this.pausedAt)},e.prototype.reset=function(){this.pause(),this.pauseDuration=0,this.startedAt=e.now(),this.pausedAt=this.startedAt},e.prototype.restart=function(){this.reset(),this.launch(this.duration)},e.prototype.remainingTime=function(){return this.paused?this.remainingTimeAfterPause:this.timerStop-e.now()},e.prototype.totalTime=function(){if(this.wasNeverLaunched)return 0;return(this.paused?this.pausedAt:e.now())-this.startedAt-this.pauseDuration},e.prototype.ended=function(){return!this.paused&&e.now()>=this.timerStop},e})),
/*! Toxilib on_every_frame
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/on_every_frame",[],(function(){function e({forceDeltaTime:e,timeSpeed:t}){return void 0===e?function(e=1){let t=Date.now();const n=e/1e3;return function(){let e=Date.now(),i=(e-t)*n;return t=e,Math.round(1e5*i)/1e5}}(t):()=>e}return function(t=requestAnimationFrame){return function(n,i={}){i.skip?function(n,{skip:i,elapsedTime:o,deltaTime:r=o,timeSpeed:s}={}){let a=e({forceDeltaTime:r,timeSpeed:s}),l=0;function c(){0===l&&n(a()),l<i?l++:l=0,t(c)}t(c)}(n,i):function(n,{elapsedTime:i,deltaTime:o=i,timeSpeed:r}={}){let s=e({forceDeltaTime:o,timeSpeed:r});function a(){n(s()),t(a)}t(a)}(n,i)}}})),
/*! Toxilib timers_manager
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/timers_manager",["./timer","./on_every_frame"],(function(e,t){let n={};function i({id:e="global",errorCallback:t,requestAnimationFrameHasToBeTriggered:i=!1}={}){let r=n[e];return r||(r={},t&&(r.errorCallback=t),o(r,{requestAnimationFrameHasToBeTriggered:i}),n[e]=r),r}function o(n,{requestAnimationFrameHasToBeTriggered:i}={}){let o={},s=0;n.setTimeout=function(t,i){let a=new e({endCallback:r(n,t),duration:i});return s++,o[s]=a,a.launch(),s},n.delay=n.setTimeout,n.setInterval=function(e,t){let i;return t<=0&&(t=1),i=n.setTimeout((function(){o[i].restart(),e()}),t),i},i?function(e){let t=[];function n(){let e=t;t=[],e.forEach((e=>e()))}e.requestAnimationFrame=function(e){t.push(e)},n=r(e,n),e.triggerAnimationFrame=function(){e.requestAnimationFramePaused||n()},e.clearRequestAnimationFrames=function(){t=[]},e.resumeRequestAnimationFrames=function(){e.requestAnimationFramePaused=!1}}(n):function(e){let t=new Set,n=[];function i(t){return function(){e.requestAnimationFramePaused?n.push(t):t()}}e.requestAnimationFrame=function(n){function o(){t.delete(s),r(e,n)()}let s=requestAnimationFrame(i(o));t.add(s)},e.clearRequestAnimationFrames=function(){t.forEach((e=>cancelAnimationFrame(e))),t=new Set},e.resumeRequestAnimationFrames=function(){e.requestAnimationFramePaused=!1,n.forEach((e=>e())),n=[]}}(n),n.pauseRequestAnimationFrames=function(){this.requestAnimationFramePaused=!0},n.onEveryFrame=t(n.requestAnimationFrame),n.clearTimer=function(e){e in o?(o[e].pause(),delete o[e]):console.warn("Timers Manager - could not clear the given timer : timer not found")},n.clearTimeout=n.clearTimer,n.clearInterval=n.clearTimer,n.clearAll=function(){for(let e in o)n.clearTimer(e);n.clearRequestAnimationFrames()},n.pauseTimer=function(e){e in o?o[e].pause():console.warn(`Timer ${e} could not be paused : timer not found`)},n.resumeTimer=function(e){e in o?o[e].unPause():console.warn(`Timer ${e} could not be resumed : timer not found`)},n.pauseAll=function(){n.pauseRequestAnimationFrames();for(let e in o)n.pauseTimer(e)},n.resumeAll=function(){n.resumeRequestAnimationFrames();for(let e in o)n.resumeTimer(e)}}function r(e,t){return e.errorCallback?function(){try{t()}catch(t){t.toxiTrace=t.toxiTrace||[],t.toxiTrace.unshift("Toxilibs - timers_manager.js - encapsulateWithErrorCallback"),e.errorCallback(t)}}:t}return o(i),i})),
/*! Toxilib grid
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/grid",["./random","./deprecation"],(function(e,t){function n(e){let t=e.width;e.width=e.height,e.height=t;let n=e.toricX;e.toricX=e.toricY,e.toricY=n,(n||e.toricX)&&s(e,Array.isArray(e.cells)),l(e)}function i(e){let{cells:t,coordKey:n,width:i,height:o,forEachDefinedCell:r}=e,a={cells:t,coordKey:n,width:i,height:o,forEachDefinedCell:r};return(e.toricX||e.toricY)&&s(a,Array.isArray(t)),a}function o(){return!0}function r(e,t){return this.cells[`${e}_${t}`]}function s(e,t){function n(t){return a(t,e.width)}function i(t){return a(t,e.height)}e.nonToricCoordKey=t?function(e,t){return e+this.width*t}:function(e,t){return`${e}_${t}`},e.toric?e.coordKey=t?function(e,t){return n(e)+this.width*i(t)}:function(e,t){return`${n(e)}_${i(t)}`}:e.toricX?e.coordKey=t?function(e,t){return n(e)+this.width*t}:function(e,t){return`${n(e)}_${t}`}:e.toricY?e.coordKey=t?function(e,t){return e+this.width*i(t)}:function(e,t){return`${e}_${i(t)}`}:e.coordKey=e.nonToricCoordKey,(e.toric||e.toricX)&&(e.toricCoordX=n),(e.toric||e.toricY)&&(e.toricCoordY=i)}function a(e,t){return(e%t+t)%t}function l(e){let t=e.width===1/0||e.toricX,n=e.height===1/0||e.toricY;e.isInside=t&&n?o:t?u:n?h:c}function c(e,t){return e>=0&&t>=0&&e<this.width&&t<this.height}function u(e,t){return t>=0&&t<this.height}function h(e){return e>=0&&e<this.width}const d={},p={};function f(e,{x:t,y:n,step:i,range:o=!1,limit:r=!1,filter:s,includeStart:a=!0,includeUndefined:l=!1,withCoords:c=!1}){const u=[],{x:h=0,y:d=0}=i;o=function(e,{xOrigin:t,yOrigin:n,stepX:i,stepY:o,range:r,limit:s}){if(!1!==r)return r;if(!1===s){let t=0!==i&&(e.toricX||e.width===1/0);if(0!==o&&(e.toricY||e.height===1/0)){if(t)throw new Error("Range or limit must be specified");throw new Error("Range or limit must be specified to search in the y direction")}if(t)throw new Error("Range or limit must be specified to search in the x direction")}r=i>0?Math.floor((e.width-1-t)/i):i<0?Math.floor(t/-i):1/0;if(o>0)r=Math.min(r,Math.floor((e.height-1-n)/o));else if(o<0)r=Math.min(r,Math.floor(n/-o));else if(0===i)throw new Error("Step can not be x: 0 and y: 0");return r}(e,{xOrigin:t,yOrigin:n,stepX:h,stepY:d,range:o,limit:r});for(let i=a?0:1;i<=o;i++){let o=t+i*h,a=n+i*d;if(!e.isInside(o,a))continue;e.toricCoordX&&(o=e.toricCoordX(o)),e.toricCoordY&&(a=e.toricCoordY(a));const p=e.getCell(o,a);if((void 0!==p||l)&&(!s||s(p,o,a))){const e=c?{cell:p,x:o,y:a}:p;if(u.push(e),u.length===r)return u}}return u}function g(e,{x:t,y:n,filter:i,includeUndefined:o}){let r=[];return function(e,t,n){n(e-1,t),n(e+1,t),n(e,t-1),n(e,t+1)}(t,n,((t,n)=>{y(e,r,{x:t,y:n,filter:i,includeUndefined:o})})),r}function m(e,{x:t,y:n,filter:i,includeUndefined:o}){let r=[];return function(e,t,n){n(e-1,t-1),n(e,t-1),n(e+1,t-1),n(e-1,t),n(e+1,t),n(e-1,t+1),n(e,t+1),n(e+1,t+1)}(t,n,((t,n)=>{y(e,r,{x:t,y:n,filter:i,includeUndefined:o})})),r}function y(e,t,{x:n,y:i,filter:o,includeUndefined:r}){let s=e.getCell(n,i);(r||void 0!==s)&&o(s,n,i)&&(e.toricCoordX&&(n=e.toricCoordX(n)),e.toricCoordY&&(i=e.toricCoordY(i)),t.push({cell:s,x:n,y:i}))}return d.setCell=function(e,t,n){return!!this.isInside(e,t)&&(this.cells[this.coordKey(e,t)]=n,!0)},d.setCellFast=function(e,t,n){this.cells[this.coordKey(e,t)]=n},p.setCell=function(e,t,n){return!!this.isInside(e,t)&&this.setCellInfinity(e,t,n)},p.setCellFast=function(e,t,n){this.setCellInfinity(e,t,n)},d.forEachDefinedCellFast=function(e){for(let t=0;t<this.cells.length;t++)void 0!==this.cells[t]&&e(this.cells[t])},p.forEachDefinedCellFast=function(e){for(let t in this.cells)e(this.cells[t])},d.forEachDefinedCell=function(e){for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++){let i=this.cells[this.coordKey(t,n)];void 0!==i&&e(i,t,n)}},p.forEachDefinedCell=function(e){for(let t in this.cells){let n=t.split("_");e(this.cells[t],parseInt(n[0],10),parseInt(n[1],10))}},d.definedCellsCount=function(){let e=0;for(let t=0;t<this.cells.length;t++)void 0!==this.cells[t]&&e++;return e},p.definedCellsCount=function(){return Object.keys(this.cells).length},d.someCellMatch=function(e){for(let t=0;t<this.cells.length;t++)if(e(this.cells[t]))return!0;return!1},p.someCellMatch=function(e){for(let t in this.cells)if(e(this.cells[t]))return!0;return!1},d.everyCellMatch=function(e){for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++)if(!e(this.cells[this.coordKey(t,n)],t,n))return!1;return!0},p.everyCellMatch=function(e){for(let t in this.cells)if(!e(this.cells[t]))return!1;return!0},d.countCellsMatching=function(e){let t=0;for(let n=0;n<this.width;n++)for(let i=0;i<this.height;i++)e(this.cells[this.coordKey(n,i)],n,i)&&(t+=1);return t},p.countCellsMatching=function(e){let t=0;for(let n in this.cells)e(this.cells[n])&&(t+=1);return t},d.deleteAllCells=function(){this.cells=new Array(this.width*this.height)},p.deleteAllCells=function(){this.cells={}},function o(a,c){a.width=c.width,a.height=c.height,function(e,{toric:t,toricX:n,toricY:i}){e.toric=t,e.toricX=t||n,e.toricY=t||i}(a,c);let u=function(e,t){return e.width!==1/0&&e.height!==1/0&&!t.dontUseArray}(a,c);a.cells=u?new Array(a.width*a.height):{},s(a,u),t.add("Grid",a,{neighboursOf:"fourNeighborsOf",forEachCellWithinRange:"forEachCellInRange",forEachCellWithInBox:"forEachCellInBox",clear:"deleteAllCells",forEachCellWithCoords:"forEachCell",forEachDefinedCellWithCoords:"forEachDefinedCell"}),l(a);let{random:h=e}=c;a.getCell=function(e,t){return this.isInside(e,t)?this.cells[this.coordKey(e,t)]:void 0},a.getCellFast=function(e,t){return this.cells[this.coordKey(e,t)]},a.width===1/0&&a.height===1/0&&(a.getCell=r),a.getOrCreateCell=function(e,t,n){if(this.isInside(e,t)){let i=this.coordKey(e,t),o=this.cells[i];return o||(this.cells[i]=n),o||n}},a.deleteCell=function(e,t){this.setCell(e,t,void 0)},a.deleteCellFast=function(e,t){this.setCellFast(e,t,void 0)};let y=u?d:p;a.forEachDefinedCellFast=y.forEachDefinedCellFast,a.forEachDefinedCell=y.forEachDefinedCell,a.setCell=y.setCell,a.setCellFast=y.setCellFast,a.everyCellMatch=y.everyCellMatch,a.someCellMatch=y.someCellMatch,a.definedCellsCount=y.definedCellsCount,a.countCellsMatching=y.countCellsMatching,a.deleteAllCells=y.deleteAllCells,u?function(e){e.forEachCellFast=function(e){for(let t=0;t<this.cells.length;t++)e(this.cells[t])},e.forEachCell=function(e){for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++)e(this.cells[this.coordKey(t,n)],t,n)},e.setCells=function(t){let{cells:n}=this;this.forEachCell((function(i,o,r){n[e.coordKey(o,r)]="function"==typeof t?t(o,r):t}))}}(a):function(e){e.setCellInfinity=function(e,t,n){return void 0===n?delete this.cells[this.coordKey(e,t)]:this.cells[this.coordKey(e,t)]=n,!0},e.width===1/0&&e.height===1/0&&(e.setCell=e.setCellInfinity)}(a),a.addCellToSelection=function(e,t,n){let i=this.getCell(e,t);return void 0!==i&&n.push(i),n},a.neighborsOf=function(e,t,{includeDiagonals:n=!1}={}){return n?a.eightNeighborsOf(e,t):a.fourNeighborsOf(e,t)},a.fourNeighborsOf=function(e,t){const n=[];return this.addCellToSelection(e-1,t,n),this.addCellToSelection(e+1,t,n),this.addCellToSelection(e,t-1,n),this.addCellToSelection(e,t+1,n),n},a.eightNeighborsOf=function(e,t){const n=[];return this.addCellToSelection(e-1,t-1,n),this.addCellToSelection(e,t-1,n),this.addCellToSelection(e+1,t-1,n),this.addCellToSelection(e-1,t,n),this.addCellToSelection(e+1,t,n),this.addCellToSelection(e-1,t+1,n),this.addCellToSelection(e,t+1,n),this.addCellToSelection(e+1,t+1,n),n},a.forEachCellInRange=function({x:e,y:t,range:n=0,includeUndefined:i},o){let r=Math.floor(e-n),s=Math.floor(e+n),l=Math.floor(t-n),c=Math.floor(t+n);for(let e=r;e<=s;e++)for(let t=l;t<=c;t++){let n=a.getCell(e,t);(i||void 0!==n)&&o(n,e,t)}},a.forEachCellInBox=function({xMin:e,xMax:t,yMin:n,yMax:i,includeUndefined:o},r){e=Math.floor(e),t=Math.floor(t),n=Math.floor(n),i=Math.floor(i);for(let s=e;s<=t;s++)for(let e=n;e<=i;e++){let t=a.getCell(s,e);(o||void 0!==t)&&r(t,s,e)}},a.findFirstInSequence=function(e){let t=f(this,Object.assign({},e,{limit:1}));return 1===t.length?t[0]:null},a.findFirstInSequenceWithCoords=function(e){let t=f(this,Object.assign({},e,{limit:1,withCoords:!0}));return t.length>0?t[0]:null},a.findAllInSequence=function(e){return f(this,e)},a.findAllInSequenceWithCoords=function(e){return f(this,Object.assign({},e,{withCoords:!0}))},a.forEachDefinedCellInSequence=function(e,t){f(this,Object.assign({},e,{withCoords:!0,includeUndefined:!1})).forEach((({cell:e,x:n,y:i})=>t(e,n,i)))},a.forEachCellInSequence=function(e,t){f(this,Object.assign({},e,{withCoords:!0,includeUndefined:!0})).forEach((({cell:e,x:n,y:i})=>t(e,n,i)))},a.findCellsConnectedTo=function({x:e,y:t,filter:n,maxPathLength:i=1/0,includeUndefined:o,withCoords:r,includeDiagonals:s}){if(!a.isInside(e,t))return[];let l=a.getCell(e,t);if(void 0===l||!n(l))return[];let c={};c[a.coordKey(e,t)]=!0;let u=[{cell:l,x:e,y:t}],h=[u[0]],d=0,p=s?m:g;function f({x:e,y:t}){let n=a.coordKey(e,t);return!(n in c)&&(c[n]=!0,!0)}function y({x:e,y:t}){return p(a,{x:e,y:t,filter:n,includeUndefined:o}).filter(f)}for(;u.length>0&&d<i;){d+=1,u=u.map(y).flat(),h.push(...u)}return r?h:h.map((({cell:e})=>e))},a.import=function(e,{cellImporter:t,clear:n=!0}={}){n&&a.deleteAllCells(),function({width:e,height:t,toricX:n,toricY:i}){void 0!==e&&(a.width=e);void 0!==t&&(a.height=t);void 0!==n&&(a.toricX=n);void 0!==i&&(a.toricY=i)}(e),t=t||a.cellImporter;const{cells:i}=e;for(let e in i){let[n,o]=e.split("_");n=parseInt(n,10),o=parseInt(o,10);let r=i[e];a.importCell?a.importCell(r,n,o):(t&&(r=t(r,n,o)),a.setCell(n,o,r))}},a.serialize=function({cellSerializer:e}={}){const t={};this.forEachDefinedCell(((n,i,o)=>{const r=`${i}_${o}`;e?t[r]=e(n,i,o):"object"==typeof n&&n.serialize?t[r]=n.serialize():t[r]=n}));const{width:n,height:i,toricX:o,toricY:r}=this;return{width:n,height:i,toricX:o,toricY:r,cells:t}},a.clone=function(){const e={};return o(e,this),this.forEachDefinedCell(((t,n,i)=>{e.setCell(n,i,t)})),e},a.transpose=function(){let e=i(this);n(a),this.deleteAllCells(),e.forEachDefinedCell(((e,t,n)=>{this.setCell(n,t,e)}))},a.flip=function(e="horizontal"){let t=i(this);if(this.deleteAllCells(),"horizontal"===e){let{width:e}=this;e===1/0?t.forEachDefinedCell(((e,t,n)=>{this.setCell(-t,n,e)})):t.forEachDefinedCell(((t,n,i)=>{this.setCell(e-n-1,i,t)}))}else{let{height:e}=this;e===1/0?t.forEachDefinedCell(((e,t,n)=>{this.setCell(t,-n,e)})):t.forEachDefinedCell(((t,n,i)=>{this.setCell(n,e-i-1,t)}))}},a.rotate=function(e=90){if(0===(e=(e+720)%360))return;let t,o,r=i(this);90!==e&&270!==e||n(this),this.deleteAllCells();let{width:s,height:a}=this;90===e?(t=s===1/0?(e,t)=>-t:(e,t)=>s-t-1,o=e=>e):180===e?(t=s===1/0?e=>-e:e=>s-e-1,o=a===1/0?(e,t)=>-t:(e,t)=>a-t-1):270===e&&(o=a===1/0?e=>-e:e=>a-e-1,t=(e,t)=>t),r.forEachDefinedCell(((e,n,i)=>{this.setCell(t(n,i),o(n,i),e)}))},c.content&&a.setCells(c.content)}})),
/*! Toxilib http_loader
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/http_loader",["jquery"],(function(e){let t={jpg:"image",png:"image",gif:"image",bmp:"image",html:"xhr",txt:"xhr",css:"xhr",glsl:"xhr",json:"json",mp3:"audio"};let n={};function i(e,i,o){let r=function(e){let n=function(e){return e.split("?").shift().split(".").pop().toLowerCase()}(e),i=t[n]||null;if(!i)throw new Error(`No loader type found for ${n}`);return i}(e),s=function(e){let t=n[e]||null;if(!t)throw new Error(`No loader found for ${e}`);return t}(r);s(e,i,o||function(e){let t=new Error(`Could not load ${e}`);return function(){throw t}}(e))}return n.image=function(e,t,n){let i=new Image;i.crossOrigin="Anonymous",i.addEventListener("load",(function(...e){t(i,...e)})),i.addEventListener("error",n),i.src=e},n.xhr=function(t,n,i){e.get(t,n).fail(i)},n.json=function(e,t,i){n.xhr(e,(function(...e){"string"==typeof e[0]&&(e[0]=JSON.parse(e[0])),t(...e)}),i)},Object.assign(i,n),i})),
/*! Toxilib noise_2D
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/noise_2D",["./random"],(function(e){const t=(Math.sqrt(3)-1)/2,n=(3-Math.sqrt(3))/6,i=2*n-1,o=[];function r(e){this.setSeed(e)}r.prototype.setSeed=function(t=!1){let n;n=!1===t?e:e.createNew(t),0===o.length&&function(){const e=Math.sqrt(2);for(let t=0;t<32;t++){const n=2*t*Math.PI/32;o[t]={x:e*Math.cos(n),y:e*Math.sin(n)}}}();const i=[],r=[];for(let e=0;e<256;e++)i.push(e),r.push(o[e%32]);n.shuffleArray(i),n.shuffleArray(r),i.push(i[0]);const s=new Array(512);for(let e=0;e<256;e++){let t=r[e];s[e]=t,s[e+256]=t}this.perm=i,this.gradPerm=s},r.prototype.perlin=function(e,t){const{gradPerm:n,perm:i}=this;let o=Math.floor(e),r=Math.floor(t);e-=o,t-=r,o&=255,r&=255;const s=o+i[r],a=o+i[r+1];return function(e,t,n,i,o,r){const s=c(o);return u(u(e,t,s),u(n,i,s),c(r))}(l(n[s],e,t),l(n[s+1],e-1,t),l(n[a],e,t-1),l(n[a+1],e-1,t-1),e,t)},r.prototype.simplex=function(e,o){const{gradPerm:r,perm:l}=this,c=(e+o)*t;let u=Math.floor(e+c),h=Math.floor(o+c);const d=(u+h)*n,p=e-u+d,f=o-h+d;let g=0;p>f&&(g=1);let m=1-g;u&=255,h&=255;const y=u+l[h],v=u+g+l[h+m],b=u+1+l[h+1],x=r[y],w=r[v],_=r[b];return s*(a(p,f,x)+a(p-g+n,f-m+n,w)+a(p+i,f+i,_))};const s=70.148;function a(e,t,n){let i=.5-e*e-t*t;return i<0?0:(i*=i,i*i*l(n,e,t))}function l({x:e,y:t},n,i){return e*n+t*i}function c(e){return e*e*e*(e*(6*e-15)+10)}function u(e,t,n){return(1-n)*e+n*t}return r})),
/*! Toxilib bezier_path
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/bezier_path",["./bezier"],(function(e){function t({origin:e}={}){this.portions=[],this.origin=e,this.end=e}function n({x:e,y:t},n){return n?{x:e+n.x,y:t+n.y}:void 0}return t.prototype.length=function(){var e;return"computedLength"in this||((e=this).computedLength=0,e.portions.forEach((t=>{t.startingDistance=e.computedLength,e.computedLength+=t.length()}))),this.computedLength},t.prototype.appendBezier=function(e){this.portions.push(e),this.beforeEnd=this.end,this.end=e.end},t.prototype.appendPortion=function({nextPoint:t,controlOrigin:n=this.end,controlEnd:i=t}){let o=new e({origin:this.end,end:t,controlOrigin:n,controlEnd:i});this.appendBezier(o),this.end=t},t.prototype.addPoint=function(e,t){this.addPoints([e],t)},t.prototype.addPoints=function(t,{smooth:i=0,smoothJunction:o=!0,close:r}={}){let s=!1,{end:a}=this;if(i&&o&&this.beforeEnd)if(a.controlPrevious){let{x:e,y:n}=a.controlPrevious;a.controlNext={x:-e,y:-n},t=[a,...t]}else s=!0,t=[this.beforeEnd,a,...t];else a?t=[a,...t]:(this.origin=t[0],this.end=this.origin);t=e.pointsWithDefaultControlPoints({points:t,smooth:i,close:r}),s&&(t.shift(),this.lastPortion().controlEnd=n(t[0],t[0].controlPrevious));let l=t[0];for(let e=1;e<t.length;e++){const i=t[e];this.appendPortion({controlOrigin:n(l,l.controlNext),nextPoint:i,controlEnd:n(i,i.controlPrevious)}),l=i}},t.prototype.lastPortion=function(){return this.portions[this.portions.length-1]},t.prototype.coords=function(e){let{portion:t,relativeDistance:n}=function(e,t){let{portions:n,length:i}=e;if(t>i)return!1;let o=0;for(let e=0;e<n.length;e++){let i=n[e],r=o+i.length();if(r>t)return{portion:i,relativeDistance:t-o};o=r}return!1}(this,e);return t.coords(n)},t})),
/*! Toxilib 2d_rigid_body_physics
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/2d_rigid_body_physics",[],(function(){const e=180/Math.PI,t=1/e;function n({acceleration:e,mass:t},n){const i=function(e){let t=0,n=0;return e.forEach((({x:e,y:i})=>{t+=e,n+=i})),{x:t,y:n}}(n);e.x+=i.x/t,e.y+=i.y/t}function i(t,n){let i=function(e,{x:t,y:n}){let i=0;return e.forEach((e=>{const{appliedAt:o}=e;o&&(i+=(o.x-t)*e.y-(o.y-n)*e.x)})),i}(n,t);t.angularAcceleration+=e*i/t.angularMass}return function(e,o={}){!function(e,t){let n={mass:1,angularMass:1,x:0,y:0,velocity:{x:0,y:0},orientation:0,angularVelocity:0,forces:()=>[],reactions:!1};for(let i in n)e[i]=e[i]||t[i]||n[i]}(e,o),e.move=function(t){e.acceleration={x:0,y:0},e.angularAcceleration=0;let o=this.forces();n(this,o),i(this,o),this.reactions&&function(e,t){let o=e.reactions(t,e);n(e,o),i(e,o)}(this,t),function(e,t){const{velocity:n}=e;let i=n.x,o=n.y;n.x+=t*e.acceleration.x,n.y+=t*e.acceleration.y,e.x+=t*(i+n.x)/2,e.y+=t*(o+n.y)/2;let r=e.angularVelocity;e.angularVelocity+=t*e.angularAcceleration,e.orientation+=t*(e.angularVelocity+r)/2}(e,t)},e.accelerationAt=function({x:e,y:n}){const{acceleration:i,angularAcceleration:o}=this,r=t*o;let s=-r*(n-this.y),a=r*(e-this.x);return{x:i.x+s,y:i.y+a}},e.velocityAt=function({x:e,y:n}){const{velocity:i,angularVelocity:o}=this;let r=t*o,s=-r*(n-this.y),a=r*(e-this.x);return{x:i.x+s,y:i.y+a}},e.forceToProduceAccelerationAt=function({point:e,acceleration:t}){let{x:n,y:i,mass:o,angularMass:r}=this;n=e.x-n,i=e.y-i;const s=r/o,a=s+i*i,l=s+n*n,c=n*i;let u=r/(a*l-c*c);return{x:(l*t.x+c*t.y)*u,y:(a*t.y+c*t.x)*u,appliedAt:e}},e.reactionToProduceAccelerationAt=function({point:e,acceleration:t}){let n=this.accelerationAt(e);return t.x-=n.x,t.y-=n.y,this.forceToProduceAccelerationAt({point:e,acceleration:t})},e.reactionToProduceVelocityAt=function({point:e,velocity:t,elapsedTime:n}){let i=this.velocityAt(e),o={x:(t.x-i.x)/n,y:(t.y-i.y)/n};return this.reactionToProduceAccelerationAt({point:e,acceleration:o})}}})),
/*! Toxilib sprite_collection
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/sprite_collection",["./topleft_and_pivot","./screen_image_utils","./screen_image","./object_utils"],(function(e,t,n,i){const{getTopLeftPoint:o}=e,{deepClone:r}=i;function s(e={}){let{whenSequenceCompleted:t}=e;if(this.whenSequenceCompleted=t,this.sequences={},"frames"in e)return this.default={},void this.add(e);this.defaults=e,"sprites"in e&&function(e,t){const{sprites:n}=t;if(Array.isArray(n))!function(e,t){let{sprites:n}=t,{index:i=0}=e.defaults;n.forEach(((t,n)=>{e.add({name:t,index:n+i,frames:1})}))}(e,t);else for(let t in n){let i=n[t];Array.isArray(i)?e.add(Object.assign({name:t},{frames:i})):e.add(Object.assign({name:t},i))}}(this,e)}function a(e,t,{screen:n,scale:i,drawnImages:o,infoColor:r}){const{sequences:s}=e,a=s[t],{frames:l}=a;l.forEach(((t,c)=>{let{image:u,cropSource:h}=t,{topLeft:d}=o.get(u),{topLeft:p,width:f,height:g}=h,{x:y,y:v}=p,b=r;a===e.currentSequence&&c===a.currentFrame&&(b="yellow"),p={x:d.x+y*i,y:d.y-v*i},f*=i,g*=i;let x=a.name;"main"===a.name&&1===Object.keys(s).length&&(x=""),l.length>1&&(x+=`#${c}`),function({screen:e,text:t,width:n,height:i,topLeft:o,color:r}){let s=m(e);e[`${s}Text`]({text:t,topLeft:o,color:r,width:n,height:i/4}),e[`${s}Rectangle`]({width:n,height:i,topLeft:o,strokeColor:r})}({screen:n,text:x,width:f,height:g,topLeft:p,color:b})}))}function l(e){let t=e.currentSequence.getCurrent();if(!t)return;let{image:n,cropSource:i,flip:o}=t;return e.image=n,e.cropSource=i,e.flip=o,{image:n,cropSource:i,flip:o}}function c(e,t={}){e=Object.assign({},t,e);let{image:n,flip:i}=e,o={image:n,cropSource:u(e)};return i&&(o.flip=i),o}function u(e){const{image:n}=e;if(!n)throw new Error("An image must be specified");const{topLeftX:i,topLeftY:o,width:r,height:s}=t.getCropParams({width:f(n),height:g(n)},e);return{topLeft:{x:i,y:o},width:r,height:s}}function h(e,t){const n=e.sequences[t];if(!n)throw e.currentSequenceName?new Error(`No sprites named ${t} in spriteCollection`):new Error("SpriteCollection does not contain referenced sprites yet.");return n}function d({frames:e,name:t,ticksPerFrame:n}){this.name=t,this.frames=e,this.length=e.length,void 0!==n&&(this.ticksPerFrame=n),this.currentFrame=0}function p(e,t){let{length:n}=e;return(Math.floor(t)%n+n)%n}function f(e){return e.widthInPixels||e.width}function g(e){return e.heightInPixels||e.height}function m(e){if("drawImage"in e)return"draw";if("addImage"in e)return"add";throw new Error("wrong screen")}return s.prototype.add=function(e){e=Object.assign({name:"main"},this.defaults,e);const{name:t}=e;e.frames=function(e){let{frames:t}=e;if(t=function(e,t){"all"===e&&(e=function(e){let{image:t,width:n,height:i}=function(e){let{image:t}=e;if(!t)throw new Error("An image must be specified");let{width:n=f(t),height:i=g(t)}=e;return{image:t,width:n,height:i}}(e),{index:o=0}=e,r=Math.floor(f(t)/n),s=Math.floor(g(t)/i);return r*s-o}(t));"number"==typeof e&&(e=[...Array(e).keys()]);return e}(t,e),void 0===t)return[c(e)];if("number"==typeof t[0])return function(e,t){let{image:n}=t,{topLeft:i,width:o,height:r}=u(t),{index:s=0}=t,a=i.x/o,l=Math.floor(f(n)/o);return e.map((e=>{let t=(a+(e+=s))%l*o,c=i.y+Math.floor(e/l)*r;return{image:n,cropSource:{topLeft:{x:t,y:c},width:o,height:r}}}))}(t,e);{let n;return t.map((t=>{let{deltaX:i,deltaY:o}=t;void 0===i&&void 0===o||(t=Object.assign({topLeft:{x:n.x+(i||0),y:n.y+(o||0)}},t));let r=c(t,e);return n=r.cropSource.topLeft,r}))}}(e),this.sequences[t]=new d(e),this.currentSequenceName||this.switchTo(t)},s.prototype.get=function(e=this.currentSequenceName,t=void 0){"number"==typeof e&&(t=e,e=this.currentSequenceName);return h(this,e).get(t)},s.prototype.switchTo=function(e,t=0){"number"==typeof e&&(t=e,e=this.currentSequenceName);const n=h(this,e);return this.currentSequence=n,this.currentSequenceName=e,this.currentSequence.goTo(t),l(this)},s.prototype.goTo=s.prototype.switchTo,s.prototype.next=function(e){if(!this.currentSequence)return;return function(e,t){0===t&&e.whenSequenceCompleted&&e.whenSequenceCompleted(e.currentSequenceName)}(this,this.currentSequence.next(e)),l(this)},s.prototype.previous=function(e){if(this.currentSequence)return this.currentSequence.previous(e),l(this)},s.prototype.drawSpriteSheet=function(e,t={}){let{sequences:n}=this,{name:i,backgroundColor:r,infoColor:s="teal"}=t;i&&(n={},n[i]=h(this,i));let{drawnImages:l,scale:c,debugTopLeft:u}=function(e,t,n){let i=new Map,r=t.boundingBoxForWholeView(),{width:s=r.width}=n,a=0,l=0;for(let t in e){let{frames:n}=e[t];for(let e=0;e<n.length;e++){let{image:t}=n[e];i.has(t)||(i.set(t,!0),a+=f(t),l=Math.max(l,g(t)))}}let c=s/a,u=o(n,s,l*c)||r.topLeft;return{drawnImages:i,scale:c,debugTopLeft:u}}(n,e,t),d=u.x;function p(t){let n={x:d,y:u.y},i=f(t)*c,o=g(t)*c;d+=i;let a=m(e);r&&e[`${a}Rectangle`]({topLeft:n,width:i,height:o,color:r}),e[`${a}Rectangle`]({topLeft:n,width:i,height:o,strokeColor:s}),e[`${a}Image`]({image:t,width:i,topLeft:n,smoothing:!1}),e[`${a}Text`]({text:`image width : ${f(t)} px\nimage height: ${g(t)} px`,topLeft:{x:n.x,y:n.y-o},color:s,font:"20px serif"}),l.set(t,{topLeft:n})}for(const e of l.keys())p(e);for(i in n)a(this,i,{screen:e,scale:c,drawnImages:l,infoColor:s})},s.prototype.createAnimator=function(e={}){let t,n,i,o=this,{sequences:r}=o,{durationUnit:s="calls",tickDuration:a}=o.defaults,{durationUnit:l=s}=e,c=e,u=()=>0,d=0;const f=()=>{d+=1;const e=p(t,u()),n=t.frames[e];return Object.assign({},n)};return f.tickDuration=a,f.switchTo=e=>{if(e in r&&e!==n){t=h(o,e),n=e;let r=c[e]||{};i=Date.now(),u=function(e,t){if(1===e.length)return()=>0;let{ticksPerFrame:n=e.ticksPerFrame||1,tickDuration:o=f.tickDuration}=t;if("calls"===l){void 0===o&&(o=1);let e=0,t=n*o;return()=>(d>t&&(d=0,e+=1),e)}{void 0===o&&(o=.1);let e=n*o;return"seconds"===l&&(e*=1e3),()=>(Date.now()-i)/e}}(t,r)}},f.switchTo(o.currentSequenceName),f},s.fetch=async function(e,t){let i={};r(e,{hook:e=>{"object"==typeof e&&"string"==typeof e.image&&(i[e.image]=!1)}});let{removeBackgroundColor:o}=e,a=[];for(let e in i)a.push(t(e).then((t=>{o&&(t=new n({source:t,useOpacity:!0})).removeBackground(o),i[e]=t})));return await Promise.all(a),new s(r(e,{hook:e=>{"object"==typeof e&&"string"==typeof e.image&&(e.image=i[e.image])}}))},d.prototype.get=function(e=this.currentFrame){return e=p(this,e),Object.assign({},this.frames[e])},d.prototype.next=function(e=1){return this.goTo(this.currentFrame+e)},d.prototype.previous=function(e=1){return this.goTo(this.currentFrame-e)},d.prototype.goTo=function(e){return this.currentFrame=p(this,e),Object.assign({},this.currentFrame)},d.prototype.getCurrent=function(){return Object.assign({},this.frames[this.currentFrame])},s})),
/*! Toxilib recorder
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/recorder",[],(function(){function e({autoStart:e}={}){this.autoStart=e,this.elements=[]}function t(e,n){const i=e.elements[e.playIndex];if(!i)return;const{params:o,time:r}=i;function s(){n(...o),e.playIndex+=1,t(e,n)}const a=r-(Date.now()-e.startedPlayingAt);a>0?e.currentTimer=setTimeout(s,a):s()}return e.prototype.start=function(){this.startedAt=Date.now(),this.started=!0},e.prototype.stop=function(){delete this.startedAt,this.started=!1,this.currentTimer&&clearTimeout(this.currentTimer)},e.prototype.toJson=function(){const e=[];let t=0;return this.elements.forEach((({params:n,time:i})=>{e.push([i-t,...n]),t=i})),e},e.prototype.fromJson=function(e){let t=0;this.elements.length=0,e.forEach((([e,...n])=>{t+=e,this.elements.push({time:t,params:n})}))},e.prototype.send=function(...e){if(!this.started){if(!this.autoStart)return;this.start()}this.elements.push({params:e,time:Date.now()-this.startedAt})},e.prototype.play=function(e){this.currentTimer&&clearTimeout(this.currentTimer),this.playIndex=0,this.startedPlayingAt=Date.now(),t(this,e)},e})),define("toxilibs/embedded_extlibs/qrcodegen-v1.8.0-es5",[],(function(){var e;return function(e){var t=function(){function t(e,n,i,r){if(this.version=e,this.errorCorrectionLevel=n,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=4*e+17;for(var s=[],a=0;a<this.size;a++)s.push(!1);for(a=0;a<this.size;a++)this.modules.push(s.slice()),this.isFunction.push(s.slice());this.drawFunctionPatterns();var l=this.addEccAndInterleave(i);if(this.drawCodewords(l),-1==r){var c=1e9;for(a=0;a<8;a++){this.applyMask(a),this.drawFormatBits(a);var u=this.getPenaltyScore();u<c&&(r=a,c=u),this.applyMask(a)}}o(0<=r&&r<=7),this.mask=r,this.applyMask(r),this.drawFormatBits(r),this.isFunction=[]}return t.encodeText=function(n,i){var o=e.QrSegment.makeSegments(n);return t.encodeSegments(o,i)},t.encodeBinary=function(n,i){var o=e.QrSegment.makeBytes(n);return t.encodeSegments([o],i)},t.encodeSegments=function(e,i,s,a,l,c){if(void 0===s&&(s=1),void 0===a&&(a=40),void 0===l&&(l=-1),void 0===c&&(c=!0),!(t.MIN_VERSION<=s&&s<=a&&a<=t.MAX_VERSION)||l<-1||l>7)throw new RangeError("Invalid value");var u,h;for(u=s;;u++){var d=8*t.getNumDataCodewords(u,i),p=r.getTotalBits(e,u);if(p<=d){h=p;break}if(u>=a)throw new RangeError("Data too long")}for(var f=0,g=[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH];f<g.length;f++){var m=g[f];c&&h<=8*t.getNumDataCodewords(u,m)&&(i=m)}for(var y=[],v=0,b=e;v<b.length;v++){var x=b[v];n(x.mode.modeBits,4,y),n(x.numChars,x.mode.numCharCountBits(u),y);for(var w=0,_=x.getData();w<_.length;w++){var S=_[w];y.push(S)}}o(y.length==h);var C=8*t.getNumDataCodewords(u,i);o(y.length<=C),n(0,Math.min(4,C-y.length),y),n(0,(8-y.length%8)%8,y),o(y.length%8==0);for(var k=236;y.length<C;k^=253)n(k,8,y);for(var A=[];8*A.length<y.length;)A.push(0);return y.forEach((function(e,t){return A[t>>>3]|=e<<7-(7&t)})),new t(u,i,A,l)},t.prototype.getModule=function(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]},t.prototype.drawFunctionPatterns=function(){for(var e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);var t=this.getAlignmentPatternPositions(),n=t.length;for(e=0;e<n;e++)for(var i=0;i<n;i++)0==e&&0==i||0==e&&i==n-1||e==n-1&&0==i||this.drawAlignmentPattern(t[e],t[i]);this.drawFormatBits(0),this.drawVersion()},t.prototype.drawFormatBits=function(e){for(var t=this.errorCorrectionLevel.formatBits<<3|e,n=t,r=0;r<10;r++)n=n<<1^1335*(n>>>9);var s=21522^(t<<10|n);o(s>>>15==0);for(r=0;r<=5;r++)this.setFunctionModule(8,r,i(s,r));this.setFunctionModule(8,7,i(s,6)),this.setFunctionModule(8,8,i(s,7)),this.setFunctionModule(7,8,i(s,8));for(r=9;r<15;r++)this.setFunctionModule(14-r,8,i(s,r));for(r=0;r<8;r++)this.setFunctionModule(this.size-1-r,8,i(s,r));for(r=8;r<15;r++)this.setFunctionModule(8,this.size-15+r,i(s,r));this.setFunctionModule(8,this.size-8,!0)},t.prototype.drawVersion=function(){if(!(this.version<7)){for(var e=this.version,t=0;t<12;t++)e=e<<1^7973*(e>>>11);var n=this.version<<12|e;o(n>>>18==0);for(t=0;t<18;t++){var r=i(n,t),s=this.size-11+t%3,a=Math.floor(t/3);this.setFunctionModule(s,a,r),this.setFunctionModule(a,s,r)}}},t.prototype.drawFinderPattern=function(e,t){for(var n=-4;n<=4;n++)for(var i=-4;i<=4;i++){var o=Math.max(Math.abs(i),Math.abs(n)),r=e+i,s=t+n;0<=r&&r<this.size&&0<=s&&s<this.size&&this.setFunctionModule(r,s,2!=o&&4!=o)}},t.prototype.drawAlignmentPattern=function(e,t){for(var n=-2;n<=2;n++)for(var i=-2;i<=2;i++)this.setFunctionModule(e+i,t+n,1!=Math.max(Math.abs(i),Math.abs(n)))},t.prototype.setFunctionModule=function(e,t,n){this.modules[t][e]=n,this.isFunction[t][e]=!0},t.prototype.addEccAndInterleave=function(e){var n=this.version,i=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(n,i))throw new RangeError("Invalid argument");for(var r=t.NUM_ERROR_CORRECTION_BLOCKS[i.ordinal][n],s=t.ECC_CODEWORDS_PER_BLOCK[i.ordinal][n],a=Math.floor(t.getNumRawDataModules(n)/8),l=r-a%r,c=Math.floor(a/r),u=[],h=t.reedSolomonComputeDivisor(s),d=0,p=0;d<r;d++){var f=e.slice(p,p+c-s+(d<l?0:1));p+=f.length;var g=t.reedSolomonComputeRemainder(f,h);d<l&&f.push(0),u.push(f.concat(g))}var m=[],y=function(e){u.forEach((function(t,n){(e!=c-s||n>=l)&&m.push(t[e])}))};for(d=0;d<u[0].length;d++)y(d);return o(m.length==a),m},t.prototype.drawCodewords=function(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var n=0,r=this.size-1;r>=1;r-=2){6==r&&(r=5);for(var s=0;s<this.size;s++)for(var a=0;a<2;a++){var l=r-a,c=!(r+1&2)?this.size-1-s:s;!this.isFunction[c][l]&&n<8*e.length&&(this.modules[c][l]=i(e[n>>>3],7-(7&n)),n++)}}o(n==8*e.length)},t.prototype.applyMask=function(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(var t=0;t<this.size;t++)for(var n=0;n<this.size;n++){var i=void 0;switch(e){case 0:i=(n+t)%2==0;break;case 1:i=t%2==0;break;case 2:i=n%3==0;break;case 3:i=(n+t)%3==0;break;case 4:i=(Math.floor(n/3)+Math.floor(t/2))%2==0;break;case 5:i=n*t%2+n*t%3==0;break;case 6:i=(n*t%2+n*t%3)%2==0;break;case 7:i=((n+t)%2+n*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][n]&&i&&(this.modules[t][n]=!this.modules[t][n])}},t.prototype.getPenaltyScore=function(){for(var e=0,n=0;n<this.size;n++){for(var i=!1,r=0,s=[0,0,0,0,0,0,0],a=0;a<this.size;a++)this.modules[n][a]==i?5==++r?e+=t.PENALTY_N1:r>5&&e++:(this.finderPenaltyAddHistory(r,s),i||(e+=this.finderPenaltyCountPatterns(s)*t.PENALTY_N3),i=this.modules[n][a],r=1);e+=this.finderPenaltyTerminateAndCount(i,r,s)*t.PENALTY_N3}for(a=0;a<this.size;a++){i=!1;var l=0;for(s=[0,0,0,0,0,0,0],n=0;n<this.size;n++)this.modules[n][a]==i?5==++l?e+=t.PENALTY_N1:l>5&&e++:(this.finderPenaltyAddHistory(l,s),i||(e+=this.finderPenaltyCountPatterns(s)*t.PENALTY_N3),i=this.modules[n][a],l=1);e+=this.finderPenaltyTerminateAndCount(i,l,s)*t.PENALTY_N3}for(n=0;n<this.size-1;n++)for(a=0;a<this.size-1;a++){var c=this.modules[n][a];c==this.modules[n][a+1]&&c==this.modules[n+1][a]&&c==this.modules[n+1][a+1]&&(e+=t.PENALTY_N2)}for(var u=0,h=0,d=this.modules;h<d.length;h++){u=d[h].reduce((function(e,t){return e+(t?1:0)}),u)}var p=this.size*this.size,f=Math.ceil(Math.abs(20*u-10*p)/p)-1;return o(0<=f&&f<=9),o(0<=(e+=f*t.PENALTY_N4)&&e<=2568888),e},t.prototype.getAlignmentPatternPositions=function(){if(1==this.version)return[];for(var e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2)),n=[6],i=this.size-7;n.length<e;i-=t)n.splice(1,0,i);return n},t.getNumRawDataModules=function(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version number out of range");var n=(16*e+128)*e+64;if(e>=2){var i=Math.floor(e/7)+2;n-=(25*i-10)*i-55,e>=7&&(n-=36)}return o(208<=n&&n<=29648),n},t.getNumDataCodewords=function(e,n){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[n.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][e]},t.reedSolomonComputeDivisor=function(e){if(e<1||e>255)throw new RangeError("Degree out of range");for(var n=[],i=0;i<e-1;i++)n.push(0);n.push(1);var o=1;for(i=0;i<e;i++){for(var r=0;r<n.length;r++)n[r]=t.reedSolomonMultiply(n[r],o),r+1<n.length&&(n[r]^=n[r+1]);o=t.reedSolomonMultiply(o,2)}return n},t.reedSolomonComputeRemainder=function(e,n){for(var i=n.map((function(e){return 0})),o=function(e){var o=e^i.shift();i.push(0),n.forEach((function(e,n){return i[n]^=t.reedSolomonMultiply(e,o)}))},r=0,s=e;r<s.length;r++){o(s[r])}return i},t.reedSolomonMultiply=function(e,t){if(e>>>8!=0||t>>>8!=0)throw new RangeError("Byte out of range");for(var n=0,i=7;i>=0;i--)n=n<<1^285*(n>>>7),n^=(t>>>i&1)*e;return o(n>>>8==0),n},t.prototype.finderPenaltyCountPatterns=function(e){var t=e[1];o(t<=3*this.size);var n=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(n&&e[0]>=4*t&&e[6]>=t?1:0)+(n&&e[6]>=4*t&&e[0]>=t?1:0)},t.prototype.finderPenaltyTerminateAndCount=function(e,t,n){return e&&(this.finderPenaltyAddHistory(t,n),t=0),t+=this.size,this.finderPenaltyAddHistory(t,n),this.finderPenaltyCountPatterns(n)},t.prototype.finderPenaltyAddHistory=function(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)},t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t}();function n(e,t,n){if(t<0||t>31||e>>>t!=0)throw new RangeError("Value out of range");for(var i=t-1;i>=0;i--)n.push(e>>>i&1)}function i(e,t){return!!(e>>>t&1)}function o(e){if(!e)throw new Error("Assertion error")}e.QrCode=t;var r=function(){function e(e,t,n){if(this.mode=e,this.numChars=t,this.bitData=n,t<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}return e.makeBytes=function(t){for(var i=[],o=0,r=t;o<r.length;o++){n(r[o],8,i)}return new e(e.Mode.BYTE,t.length,i)},e.makeNumeric=function(t){if(!e.isNumeric(t))throw new RangeError("String contains non-numeric characters");for(var i=[],o=0;o<t.length;){var r=Math.min(t.length-o,3);n(parseInt(t.substr(o,r),10),3*r+1,i),o+=r}return new e(e.Mode.NUMERIC,t.length,i)},e.makeAlphanumeric=function(t){if(!e.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");var i,o=[];for(i=0;i+2<=t.length;i+=2){var r=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i));n(r+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i+1)),11,o)}return i<t.length&&n(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i)),6,o),new e(e.Mode.ALPHANUMERIC,t.length,o)},e.makeSegments=function(t){return""==t?[]:e.isNumeric(t)?[e.makeNumeric(t)]:e.isAlphanumeric(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]},e.makeEci=function(t){var i=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)n(t,8,i);else if(t<16384)n(2,2,i),n(t,14,i);else{if(!(t<1e6))throw new RangeError("ECI assignment value out of range");n(6,3,i),n(t,21,i)}return new e(e.Mode.ECI,0,i)},e.isNumeric=function(t){return e.NUMERIC_REGEX.test(t)},e.isAlphanumeric=function(t){return e.ALPHANUMERIC_REGEX.test(t)},e.prototype.getData=function(){return this.bitData.slice()},e.getTotalBits=function(e,t){for(var n=0,i=0,o=e;i<o.length;i++){var r=o[i],s=r.mode.numCharCountBits(t);if(r.numChars>=1<<s)return 1/0;n+=4+s+r.bitData.length}return n},e.toUtf8ByteArray=function(e){e=encodeURI(e);for(var t=[],n=0;n<e.length;n++)"%"!=e.charAt(n)?t.push(e.charCodeAt(n)):(t.push(parseInt(e.substr(n+1,2),16)),n+=2);return t},e.NUMERIC_REGEX=/^[0-9]*$/,e.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,e.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e}();e.QrSegment=r}(e||(e={})),function(e){!function(e){var t=function(){function e(e,t){this.ordinal=e,this.formatBits=t}return e.LOW=new e(0,1),e.MEDIUM=new e(1,0),e.QUARTILE=new e(2,3),e.HIGH=new e(3,2),e}();e.Ecc=t}(e.QrCode||(e.QrCode={}))}(e||(e={})),function(e){!function(e){var t=function(){function e(e,t){this.modeBits=e,this.numBitsCharCount=t}return e.prototype.numCharCountBits=function(e){return this.numBitsCharCount[Math.floor((e+7)/17)]},e.NUMERIC=new e(1,[10,12,14]),e.ALPHANUMERIC=new e(2,[9,11,13]),e.BYTE=new e(4,[8,16,16]),e.KANJI=new e(8,[8,10,12]),e.ECI=new e(7,[0,0,0]),e}();e.Mode=t}(e.QrSegment||(e.QrSegment={}))}(e||(e={})),e})),
/*! Toxilib qr_code
 * Copyright 2014 Toxicode, pierre.lancien @ toxicode.fr
*/
define("toxilibs/qr_code",["./embedded_extlibs/qrcodegen-v1.8.0-es5","./screen_image"],(function({QrCode:e},t){return function(n){let{text:i,format:o="image"}=n;const r=e.encodeText(i,e.Ecc.MEDIUM);return"image"===o?function(e,{border:n=2,lightColor:i="white",darkColor:o="black"}){let r=e.size+2*n,s=new t({widthInPixels:r,heightInPixels:r});s.fillWithColor(i);for(let t=0;t<e.size;t++)for(let i=0;i<e.size;i++)e.getModule(i,t)&&s.setColorAtPixelCoords({x:i+n,y:t+n},o);return s}(r,n):"svg"===o?function(e,{border:t=2,lightColor:n="white",darkColor:i="black"}){let o=[];for(let n=0;n<e.size;n++)for(let i=0;i<e.size;i++)e.getModule(i,n)&&o.push(`M${i+t},${n+t}h1v1h-1z`);return`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 ${e.size+2*t} ${e.size+2*t}" stroke="none">\n<rect width="100%" height="100%" fill="${n}"/>\n<path d="${o.join(" ")}" fill="${i}"/>\n</svg>\n`}(r,n):r}})),define("user_code/readable",["toxilibs/number_utils"],(function(e){return function(t){if("number"==typeof t){let n=Math.abs(t);return n<100?e.roundToSignificantDigits(t,3):n<1e4?e.roundToSignificantDigits(t,4):e.roundToSignificantDigits(t,5)}return t}})),define("user_code/geometry_api",["toxilibs/vector","toxilibs/collision_detector"],(function(e,t){const{distanceToRectangle:n,distanceToPolygon:i,closestShape:o,isInside:r,isInsideShape:s,distanceToShape:a,rectangleIntersectsWithRectangle:l}=t,c=Math.PI/180;function u({x:e,y:t},{x:n,y:i}){const o=n-e,r=i-t;return o*o+r*r}return{cos:function(e){return Math.cos(e*c)},sin:function(e){return Math.sin(e*c)},tan:function(e){return Math.tan(e*c)},acos:function(e){return Math.acos(e)/c},asin:function(e){return Math.asin(e)/c},atan:function(e){return Math.atan(e)/c},atan2:function(e,t){return Math.atan2(e,t)/c},distance:function({x:e,y:t,z:n=0},{x:i,y:o,z:r=0}={x:0,y:0,z:0}){const s=i-e,a=o-t,l=r-n;return Math.sqrt(s*s+a*a+l*l)},closestFrom:function(e,t){let n,i=1/0;return t.forEach((t=>{if(t!==e){let o=u(e,t);o<i&&(i=o,n=t)}})),{closest:n,distance:Math.sqrt(i)}},isFarFrom:function(e,t,n){let i=n*n;for(let n=0;n<t.length;n+=1){if(u(e,t[n])<i)return!1}return!0},directionFromTo:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)/c},angleBetweenVectors:function(e,t){let n=(Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x))/c;return n>180?n-360:n<-180?n+360:n},angleDifference:function(e,t){let n=Math.abs(e-t);return n=(n%360+360)%360,n>180?360-n:n},distanceToRectangle:n,distanceToPolygon:i,rayCircleIntersection:function(t,n){let i=new e({direction:t.direction}),o=n.center||n,{radius:r}=n,s=t.x-o.x,a=t.y-o.y,l=i.x,c=i.y,u=l*s+c*a,h=s*s+a*a-r*r,d=u*u-(l*l+c*c)*h;if(d<0)return!1;let p,f=h<0;if(p=f?h/(-Math.sqrt(d)-u):h/(Math.sqrt(d)-u),p<0)return!1;let g={x:t.x+p*l,y:t.y+p*c};return{point:g,normal:new e({from:o,to:g,length:1}),distance:p,fromInside:f}},rayPolygonIntersection:function(t,{points:n}){let i=n.length,o=1/0,r=!1;if(n.forEach(((s,a)=>{const l=n[(a+1)%i],c=function(t,n,i){let o=new e({direction:t.direction}),r=new e({from:n,to:i}),s=o.crossProduct(r);if(0===s)return!1;let a=new e({from:t,to:n}),l=a.crossProduct(o)/s;if(l>=0&&l<=1){let e=a.crossProduct(r)/s;return!(e<0)&&{point:{x:t.x+e*o.x,y:t.y+e*o.y},distance:e,normal:r.rotate90().normalize()}}return!1}(t,s,l);if(!c)return;const{distance:u}=c;u<o&&(o=u,r=c)})),r){const{normal:n}=r,i=new e({direction:t.direction});r.fromInside=n.dotProduct(i)>0}return r},rectangleIntersectsWithRectangle:l,closestShapeFrom:o,isInsideShapes:r,isInsideShape:s,distanceToShape:a}})),define("user_code/stats_api",[],(function(){function e(e,t){return e-t}return{createBins:function(t,n={}){t=t.sort(e);let{steps:i=50,min:o=t[0],max:r=t[t.length-1]}=n,s=1.000000001*(r-o)/i,a=[];for(let e=0;e<i;e+=1)a.push({x:o+(.5+e)*s,y:0});return t.forEach((e=>{let t=Math.floor((e-o)/s);a[t].y+=1})),a}}})),define("user_code/agent_api",["toxilibs/vector","./geometry_api"],(function(e,t){const{distance:n,directionFromTo:i,closestFrom:o}=t;function r({x:t=0,y:n=0,direction:i=0,speed:o=0}={}){this.x=t,this.y=n,this.velocity=new e({direction:i,length:o}),this.vectorGoals=[]}function s(e,t){return"object"==typeof t?"direction"in t?t.direction:e.directionTo(t):t}return r.prototype.applyMotion=function(t){let{velocity:n}=this;this.vectorGoals.length>0&&(n.direction=function(t){let n=0,i=0;return t.vectorGoals.forEach((({x:e,y:t})=>{n+=e,i+=t})),new e(n,i)}(this).direction,this.vectorGoals=[],this.x+=t*n.x,this.y+=t*n.y)},r.prototype.distanceTo=function(e){return n(this,e)},r.prototype.directionTo=function(e){return i(this,e)},r.prototype.closest=function(e){return o(this,e).target},r.prototype.rotate=function(e){this.velocity.rotate$(e)},r.prototype.addGoal=function(t,n=1){this.vectorGoals.push(new e({length:n,direction:s(this,t)}))},r.prototype.setDirection=function(e){this.velocity.direction=s(this,e)},r.prototype.avoid=function(e){this.velocity.direction=s(this,e)+180},{createAgent:function(e){return new r(e)}}})),function(e){"use strict";var t={},n=t,i="object"==typeof module&&module.exports,o="function"==typeof define&&define.amd;i?module.exports=t:o?define("toxilibs/extlibs/pizzicato-0.6.4",[],t):e.Pizzicato=e.Pz=t;var r=e.AudioContext||e.webkitAudioContext;if(r){t.context=new r;var s=t.context.createGain();s.connect(t.context.destination),t.Util={isString:function(e){return"[object String]"===toString.call(e)},isObject:function(e){return"[object Object]"===toString.call(e)},isFunction:function(e){return"[object Function]"===toString.call(e)},isNumber:function(e){return"[object Number]"===toString.call(e)&&e===+e},isArray:function(e){return"[object Array]"===toString.call(e)},isInRange:function(e,t,i){return!!(n.Util.isNumber(e)&&n.Util.isNumber(t)&&n.Util.isNumber(i))&&(e>=t&&e<=i)},isBool:function(e){return"boolean"==typeof e},isOscillator:function(e){return e&&"[object OscillatorNode]"===e.toString()},isAudioBufferSourceNode:function(e){return e&&"[object AudioBufferSourceNode]"===e.toString()},isSound:function(e){return e instanceof n.Sound},isEffect:function(e){for(var n in t.Effects)if(e instanceof t.Effects[n])return!0;return!1},normalize:function(e,t,i){if(n.Util.isNumber(e)&&n.Util.isNumber(t)&&n.Util.isNumber(i))return(i-t)*e/1+t},getDryLevel:function(e){return!n.Util.isNumber(e)||e>1||e<0?0:e<=.5?1:1-2*(e-.5)},getWetLevel:function(e){return!n.Util.isNumber(e)||e>1||e<0?0:e>=.5?1:1-2*(.5-e)}};var a=t.context.createGain(),l=Object.getPrototypeOf(Object.getPrototypeOf(a)),c=l.connect;l.connect=function(e){var t=n.Util.isEffect(e)?e.inputNode:e;return c.call(this,t),e},Object.defineProperty(t,"volume",{enumerable:!0,get:function(){return s.gain.value},set:function(e){n.Util.isInRange(e,0,1)&&s&&(s.gain.value=e)}}),Object.defineProperty(t,"masterGainNode",{enumerable:!1,get:function(){return s},set:function(e){console.error("Can't set the master gain node")}}),t.Events={on:function(e,t,n){e&&t&&(this._events=this._events||{},(this._events[e]||(this._events[e]=[])).push({callback:t,context:n||this,handler:this}))},trigger:function(e){var t,n,i,o;if(e&&(this._events=this._events||{},t=this._events[e]||(this._events[e]=[]))){for(n=Math.max(0,arguments.length-1),i=[],o=0;o<n;o++)i[o]=arguments[o+1];for(o=0;o<t.length;o++)t[o].callback.apply(t[o].context,i)}},off:function(e){e?this._events[e]=void 0:this._events={}}},t.Sound=function(e,i){var o=this,r=t.Util,s=function(e){if(e&&!r.isFunction(e)&&!r.isString(e)&&!r.isObject(e))return"Description type not supported. Initialize a sound using an object, a function or a string.";if(r.isObject(e)){if(!r.isString(e.source)||-1===["wave","file","input","script","sound"].indexOf(e.source))return"Specified source not supported. Sources can be wave, file, input or script";if(!("file"!==e.source||e.options&&e.options.path))return"A path is needed for sounds with a file source";if(!("script"!==e.source||e.options&&e.options.audioFunction))return"An audio function is needed for sounds with a script source"}}(e),a=r.isObject(e)&&r.isObject(e.options);if(s)throw console.error(s),new Error("Error initializing Pizzicato Sound: "+s);function l(e,i){e=e||{},this.getRawSourceNode=function(){var n=this.sourceNode?this.sourceNode.frequency.value:e.frequency,i=t.context.createOscillator();return i.type=e.type||"sine",i.frequency.value=n||440,i},this.sourceNode=this.getRawSourceNode(),this.sourceNode.gainSuccessor=n.context.createGain(),this.sourceNode.connect(this.sourceNode.gainSuccessor),r.isFunction(i)&&i()}function c(e,n){e=r.isArray(e)?e:[e];var i=new XMLHttpRequest;i.open("GET",e[0],!0),i.responseType="arraybuffer",i.onload=function(i){t.context.decodeAudioData(i.target.response,function(e){o.getRawSourceNode=function(){var n=t.context.createBufferSource();return n.loop=this.loop,n.buffer=e,n},r.isFunction(n)&&n()}.bind(o),function(t){if(console.error("Error decoding audio file "+e[0]),e.length>1)return e.shift(),void c(e,n);t=t||new Error("Error decoding audio file "+e[0]),r.isFunction(n)&&n(t)}.bind(o))},i.onreadystatechange=function(t){4===i.readyState&&200!==i.status&&console.error("Error while fetching "+e[0]+". "+i.statusText)},i.send()}function u(e,n){var i=r.isFunction(e)?e:e.audioFunction,o=r.isObject(e)&&e.bufferSize?e.bufferSize:null;if(!o)try{t.context.createScriptProcessor()}catch(e){o=2048}this.getRawSourceNode=function(){var e=t.context.createScriptProcessor(o,1,1);return e.onaudioprocess=i,e}}this.detached=a&&e.options.detached,this.masterVolume=t.context.createGain(),this.fadeNode=t.context.createGain(),this.fadeNode.gain.value=0,this.detached||this.masterVolume.connect(t.masterGainNode),this.lastTimePlayed=0,this.effects=[],this.effectConnectors=[],this.playing=this.paused=!1,this.loop=a&&e.options.loop,this.attack=a&&r.isNumber(e.options.attack)?e.options.attack:.04,this.volume=a&&r.isNumber(e.options.volume)?e.options.volume:1,a&&r.isNumber(e.options.release)?this.release=e.options.release:a&&r.isNumber(e.options.sustain)?(console.warn("'sustain' is deprecated. Use 'release' instead."),this.release=e.options.sustain):this.release=.04,e?r.isString(e)?c.bind(this)(e,i):r.isFunction(e)?u.bind(this)(e,i):"file"===e.source?c.bind(this)(e.options.path,i):"wave"===e.source?l.bind(this)(e.options,i):"input"===e.source?function(e,n){if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,!navigator.getUserMedia&&!navigator.mediaDevices.getUserMedia)return void console.error("Your browser does not support getUserMedia");var i=function(e){o.getRawSourceNode=function(){return t.context.createMediaStreamSource(e)},r.isFunction(n)&&n()}.bind(o),s=function(e){r.isFunction(n)&&n(e)};navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then(i).catch(s):navigator.getUserMedia({audio:!0},i,s)}.bind(this)(e,i):"script"===e.source?u.bind(this)(e.options,i):"sound"===e.source&&function(e,t){this.getRawSourceNode=e.sound.getRawSourceNode,e.sound.sourceNode&&n.Util.isOscillator(e.sound.sourceNode)&&(this.sourceNode=this.getRawSourceNode(),this.frequency=e.sound.frequency)}.bind(this)(e.options,i):l.bind(this)({},i)},t.Sound.prototype=Object.create(t.Events,{play:{enumerable:!0,value:function(e,i){this.playing||(n.Util.isNumber(i)||(i=this.offsetTime||0),n.Util.isNumber(e)||(e=0),this.playing=!0,this.paused=!1,this.sourceNode=this.getSourceNode(),this.applyAttack(),n.Util.isFunction(this.sourceNode.start)&&(this.lastTimePlayed=t.context.currentTime-i,this.sourceNode.start(n.context.currentTime+e,i)),this.trigger("play"))}},stop:{enumerable:!0,value:function(){(this.paused||this.playing)&&(this.paused=this.playing=!1,this.stopWithRelease(),this.offsetTime=0,this.trigger("stop"))}},pause:{enumerable:!0,value:function(){if(!this.paused&&this.playing){this.paused=!0,this.playing=!1,this.stopWithRelease();var e=n.context.currentTime-this.lastTimePlayed;this.sourceNode.buffer?this.offsetTime=e%(this.sourceNode.buffer.length/n.context.sampleRate):this.offsetTime=e,this.trigger("pause")}}},clone:{enumerable:!0,value:function(){for(var e=new t.Sound({source:"sound",options:{loop:this.loop,attack:this.attack,release:this.release,volume:this.volume,sound:this}}),n=0;n<this.effects.length;n++)e.addEffect(this.effects[n]);return e}},onEnded:{enumerable:!0,value:function(e){return function(){this.sourceNode&&this.sourceNode!==e||(this.playing&&this.stop(),this.paused||this.trigger("end"))}}},addEffect:{enumerable:!0,value:function(e){if(!n.Util.isEffect(e))return console.error("The object provided is not a Pizzicato effect."),this;this.effects.push(e);var t=this.effectConnectors.length>0?this.effectConnectors[this.effectConnectors.length-1]:this.fadeNode;t.disconnect(),t.connect(e);var i=n.context.createGain();return this.effectConnectors.push(i),e.connect(i),i.connect(this.masterVolume),this}},removeEffect:{enumerable:!0,value:function(e){var t=this.effects.indexOf(e);if(-1===t)return console.warn("Cannot remove effect that is not applied to this sound."),this;var n=this.playing;n&&this.pause();var i=0===t?this.fadeNode:this.effectConnectors[t-1];i.disconnect();var o,r=this.effectConnectors[t];return r.disconnect(),e.disconnect(r),this.effectConnectors.splice(t,1),this.effects.splice(t,1),o=t>this.effects.length-1||0===this.effects.length?this.masterVolume:this.effects[t],i.connect(o),n&&this.play(),this}},connect:{enumerable:!0,value:function(e){return this.masterVolume.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.masterVolume.disconnect(e),this}},connectEffects:{enumerable:!0,value:function(){for(var e=[],t=0;t<this.effects.length;t++){var i=t===this.effects.length-1?this.masterVolume:this.effects[t+1].inputNode;e[t]=n.context.createGain(),this.effects[t].outputNode.disconnect(this.effectConnectors[t]),this.effects[t].outputNode.connect(i)}}},volume:{enumerable:!0,get:function(){if(this.masterVolume)return this.masterVolume.gain.value},set:function(e){n.Util.isInRange(e,0,1)&&this.masterVolume&&(this.masterVolume.gain.value=e)}},frequency:{enumerable:!0,get:function(){return this.sourceNode&&n.Util.isOscillator(this.sourceNode)?this.sourceNode.frequency.value:null},set:function(e){this.sourceNode&&n.Util.isOscillator(this.sourceNode)&&(this.sourceNode.frequency.value=e)}},sustain:{enumerable:!0,get:function(){return console.warn("'sustain' is deprecated. Use 'release' instead."),this.release},set:function(e){console.warn("'sustain' is deprecated. Use 'release' instead."),n.Util.isInRange(e,0,10)&&(this.release=e)}},getSourceNode:{enumerable:!0,value:function(){if(this.sourceNode){var e=this.sourceNode;e.gainSuccessor.gain.setValueAtTime(e.gainSuccessor.gain.value,n.context.currentTime),e.gainSuccessor.gain.linearRampToValueAtTime(1e-4,n.context.currentTime+.2),setTimeout((function(){e.disconnect(),e.gainSuccessor.disconnect()}),200)}var t=this.getRawSourceNode();return t.gainSuccessor=n.context.createGain(),t.connect(t.gainSuccessor),t.gainSuccessor.connect(this.fadeNode),this.fadeNode.connect(this.getInputNode()),n.Util.isAudioBufferSourceNode(t)&&(t.onended=this.onEnded(t).bind(this)),t}},getInputNode:{enumerable:!0,value:function(){return this.effects.length>0?this.effects[0].inputNode:this.masterVolume}},applyAttack:{enumerable:!1,value:function(){this.fadeNode.gain.value;if(this.fadeNode.gain.cancelScheduledValues(n.context.currentTime),this.attack){var e=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,t=this.attack;e||(t=(1-this.fadeNode.gain.value)*this.attack),this.fadeNode.gain.setTargetAtTime(1,n.context.currentTime,2*t)}else this.fadeNode.gain.setTargetAtTime(1,n.context.currentTime,.001)}},stopWithRelease:{enumerable:!1,value:function(e){var t=this.sourceNode,i=function(){return n.Util.isFunction(t.stop)?t.stop(0):t.disconnect()};this.fadeNode.gain.value;if(this.fadeNode.gain.cancelScheduledValues(n.context.currentTime),!this.release)return this.fadeNode.gain.setTargetAtTime(0,n.context.currentTime,.001),void i();var o=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,r=this.release;o||(r=this.fadeNode.gain.value*this.release),this.fadeNode.gain.setTargetAtTime(1e-5,n.context.currentTime,r/5),window.setTimeout((function(){i()}),1e3*r)}}}),t.Group=function(e){e=e||[],this.mergeGainNode=n.context.createGain(),this.masterVolume=n.context.createGain(),this.sounds=[],this.effects=[],this.effectConnectors=[],this.mergeGainNode.connect(this.masterVolume),this.masterVolume.connect(n.masterGainNode);for(var t=0;t<e.length;t++)this.addSound(e[t])},t.Group.prototype=Object.create(n.Events,{connect:{enumerable:!0,value:function(e){return this.masterVolume.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.masterVolume.disconnect(e),this}},addSound:{enumerable:!0,value:function(e){n.Util.isSound(e)?this.sounds.indexOf(e)>-1?console.warn("The Pizzicato.Sound object was already added to this group"):e.detached?console.warn("Groups do not support detached sounds. You can manually create an audio graph to group detached sounds together."):(e.disconnect(n.masterGainNode),e.connect(this.mergeGainNode),this.sounds.push(e)):console.error("You can only add Pizzicato.Sound objects")}},removeSound:{enumerable:!0,value:function(e){var t=this.sounds.indexOf(e);-1!==t?(e.disconnect(this.mergeGainNode),e.connect(n.masterGainNode),this.sounds.splice(t,1)):console.warn("Cannot remove a sound that is not part of this group.")}},volume:{enumerable:!0,get:function(){if(this.masterVolume)return this.masterVolume.gain.value},set:function(e){n.Util.isInRange(e,0,1)&&(this.masterVolume.gain.value=e)}},play:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].play();this.trigger("play")}},stop:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].stop();this.trigger("stop")}},pause:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].pause();this.trigger("pause")}},addEffect:{enumerable:!0,value:function(e){if(!n.Util.isEffect(e))return console.error("The object provided is not a Pizzicato effect."),this;this.effects.push(e);var t=this.effectConnectors.length>0?this.effectConnectors[this.effectConnectors.length-1]:this.mergeGainNode;t.disconnect(),t.connect(e);var i=n.context.createGain();return this.effectConnectors.push(i),e.connect(i),i.connect(this.masterVolume),this}},removeEffect:{enumerable:!0,value:function(e){var t=this.effects.indexOf(e);if(-1===t)return console.warn("Cannot remove effect that is not applied to this group."),this;var n=0===t?this.mergeGainNode:this.effectConnectors[t-1];n.disconnect();var i,o=this.effectConnectors[t];return o.disconnect(),e.disconnect(o),this.effectConnectors.splice(t,1),this.effects.splice(t,1),i=t>this.effects.length-1||0===this.effects.length?this.masterVolume:this.effects[t],n.connect(i),this}}}),t.Effects={};var u=Object.create(null,{connect:{enumerable:!0,value:function(e){return this.outputNode.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.outputNode.disconnect(e),this}}});t.Effects.Delay=function(e){this.options={},e=e||this.options;var n={feedback:.5,time:.3,mix:.5};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.delayNode.connect(this.feedbackGainNode),this.feedbackGainNode.connect(this.delayNode),this.inputNode.connect(this.delayNode),this.delayNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Delay.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNode.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}}}),t.Effects.Compressor=function(e){this.options={},e=e||this.options;var n={threshold:-24,knee:30,attack:.003,release:.25,ratio:12};for(var i in this.inputNode=this.compressorNode=t.context.createDynamicsCompressor(),this.outputNode=t.context.createGain(),this.compressorNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Compressor.prototype=Object.create(u,{threshold:{enumerable:!0,get:function(){return this.compressorNode.threshold.value},set:function(e){t.Util.isInRange(e,-100,0)&&(this.compressorNode.threshold.value=e)}},knee:{enumerable:!0,get:function(){return this.compressorNode.knee.value},set:function(e){t.Util.isInRange(e,0,40)&&(this.compressorNode.knee.value=e)}},attack:{enumerable:!0,get:function(){return this.compressorNode.attack.value},set:function(e){t.Util.isInRange(e,0,1)&&(this.compressorNode.attack.value=e)}},release:{enumerable:!0,get:function(){return this.compressorNode.release.value},set:function(e){t.Util.isInRange(e,0,1)&&(this.compressorNode.release.value=e)}},ratio:{enumerable:!0,get:function(){return this.compressorNode.ratio.value},set:function(e){t.Util.isInRange(e,1,20)&&(this.compressorNode.ratio.value=e)}},getCurrentGainReduction:function(){return this.compressorNode.reduction}}),t.Effects.LowPassFilter=function(e){p.call(this,e,"lowpass")},t.Effects.HighPassFilter=function(e){p.call(this,e,"highpass")};var h=Object.create(u,{frequency:{enumerable:!0,get:function(){return this.filterNode.frequency.value},set:function(e){t.Util.isInRange(e,10,22050)&&(this.filterNode.frequency.value=e)}},peak:{enumerable:!0,get:function(){return this.filterNode.Q.value},set:function(e){t.Util.isInRange(e,1e-4,1e3)&&(this.filterNode.Q.value=e)}}});t.Effects.LowPassFilter.prototype=h,t.Effects.HighPassFilter.prototype=h,t.Effects.Distortion=function(e){this.options={},e=e||this.options;var n={gain:.5};for(var i in this.waveShaperNode=t.context.createWaveShaper(),this.inputNode=this.outputNode=this.waveShaperNode,n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Distortion.prototype=Object.create(u,{gain:{enumerable:!0,get:function(){return this.options.gain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.gain=e,this.adjustGain())}},adjustGain:{writable:!1,configurable:!1,enumerable:!1,value:function(){for(var e,t=n.Util.isNumber(this.options.gain)?parseInt(100*this.options.gain,10):50,i=44100,o=new Float32Array(i),r=Math.PI/180,s=0;s<i;++s)e=2*s/i-1,o[s]=(3+t)*e*20*r/(Math.PI+t*Math.abs(e));this.waveShaperNode.curve=o}}}),t.Effects.Flanger=function(e){this.options={},e=e||this.options;var n={time:.45,speed:.2,depth:.1,feedback:.1,mix:.5};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.inputFeedbackNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.oscillatorNode=t.context.createOscillator(),this.gainNode=t.context.createGain(),this.feedbackNode=t.context.createGain(),this.oscillatorNode.type="sine",this.inputNode.connect(this.inputFeedbackNode),this.inputNode.connect(this.dryGainNode),this.inputFeedbackNode.connect(this.delayNode),this.inputFeedbackNode.connect(this.wetGainNode),this.delayNode.connect(this.wetGainNode),this.delayNode.connect(this.feedbackNode),this.feedbackNode.connect(this.inputFeedbackNode),this.oscillatorNode.connect(this.gainNode),this.gainNode.connect(this.delayNode.delayTime),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),this.oscillatorNode.start(0),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Flanger.prototype=Object.create(u,{time:{enumberable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.time=e,this.delayNode.delayTime.value=n.Util.normalize(e,.001,.02))}},speed:{enumberable:!0,get:function(){return this.options.speed},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.speed=e,this.oscillatorNode.frequency.value=n.Util.normalize(e,.5,5))}},depth:{enumberable:!0,get:function(){return this.options.depth},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.depth=e,this.gainNode.gain.value=n.Util.normalize(e,5e-4,.005))}},feedback:{enumberable:!0,get:function(){return this.options.feedback},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.feedback=e,this.feedbackNode.gain.value=n.Util.normalize(e,0,.8))}},mix:{enumberable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}}}),t.Effects.StereoPanner=function(e){this.options={},e=e||this.options;var n={pan:0};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),t.context.createStereoPanner?(this.pannerNode=t.context.createStereoPanner(),this.inputNode.connect(this.pannerNode),this.pannerNode.connect(this.outputNode)):t.context.createPanner?(console.warn("Your browser does not support the StereoPannerNode. Will use PannerNode instead."),this.pannerNode=t.context.createPanner(),this.pannerNode.type="equalpower",this.inputNode.connect(this.pannerNode),this.pannerNode.connect(this.outputNode)):(console.warn("Your browser does not support the Panner effect."),this.inputNode.connect(this.outputNode)),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.StereoPanner.prototype=Object.create(u,{pan:{enumerable:!0,get:function(){return this.options.pan},set:function(e){n.Util.isInRange(e,-1,1)&&(this.options.pan=e,this.pannerNode&&(this.pannerNode.toString().indexOf("StereoPannerNode")>-1?this.pannerNode.pan.value=e:this.pannerNode.setPosition(e,0,1-Math.abs(e))))}}}),t.Effects.Convolver=function(e,i){this.options={},e=e||this.options;var o=this,r=new XMLHttpRequest,s={mix:.5};for(var a in this.callback=i,this.inputNode=t.context.createGain(),this.convolverNode=t.context.createConvolver(),this.outputNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.inputNode.connect(this.convolverNode),this.convolverNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),s)this[a]=e[a],this[a]=void 0===this[a]||null===this[a]?s[a]:this[a];e.impulse?(r.open("GET",e.impulse,!0),r.responseType="arraybuffer",r.onload=function(e){var i=e.target.response;t.context.decodeAudioData(i,(function(e){o.convolverNode.buffer=e,o.callback&&n.Util.isFunction(o.callback)&&o.callback()}),(function(e){e=e||new Error("Error decoding impulse file"),o.callback&&n.Util.isFunction(o.callback)&&o.callback(e)}))},r.onreadystatechange=function(t){4===r.readyState&&200!==r.status&&console.error("Error while fetching "+e.impulse+". "+r.statusText)},r.send()):console.error("No impulse file specified.")},t.Effects.Convolver.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}}}),t.Effects.PingPongDelay=function(e){this.options={},e=e||this.options;var n={feedback:.5,time:.3,mix:.5};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.delayNodeLeft=t.context.createDelay(),this.delayNodeRight=t.context.createDelay(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.channelMerger=t.context.createChannelMerger(2),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.delayNodeLeft.connect(this.channelMerger,0,0),this.delayNodeRight.connect(this.channelMerger,0,1),this.delayNodeLeft.connect(this.delayNodeRight),this.feedbackGainNode.connect(this.delayNodeLeft),this.delayNodeRight.connect(this.feedbackGainNode),this.inputNode.connect(this.feedbackGainNode),this.channelMerger.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.PingPongDelay.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNodeLeft.delayTime.value=e,this.delayNodeRight.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}}}),t.Effects.Reverb=function(e){this.options={},e=e||this.options;var n={mix:.5,time:.01,decay:.01,reverse:!1};for(var i in this.inputNode=t.context.createGain(),this.reverbNode=t.context.createConvolver(),this.outputNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.inputNode.connect(this.reverbNode),this.reverbNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i];f.bind(this)()},t.Effects.Reverb.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,1e-4,10)&&(this.options.time=e,f.bind(this)())}},decay:{enumerable:!0,get:function(){return this.options.decay},set:function(e){n.Util.isInRange(e,1e-4,10)&&(this.options.decay=e,f.bind(this)())}},reverse:{enumerable:!0,get:function(){return this.options.reverse},set:function(e){n.Util.isBool(e)&&(this.options.reverse=e,f.bind(this)())}}}),t.Effects.Tremolo=function(e){this.options={},e=e||this.options;var n={speed:4,depth:1,mix:.8};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.tremoloGainNode=t.context.createGain(),this.tremoloGainNode.gain.value=0,this.lfoNode=t.context.createOscillator(),this.shaperNode=t.context.createWaveShaper(),this.shaperNode.curve=new Float32Array([0,1]),this.shaperNode.connect(this.tremoloGainNode.gain),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.lfoNode.connect(this.shaperNode),this.lfoNode.type="sine",this.lfoNode.start(0),this.inputNode.connect(this.tremoloGainNode),this.tremoloGainNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Tremolo.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},speed:{enumerable:!0,get:function(){return this.options.speed},set:function(e){n.Util.isInRange(e,0,20)&&(this.options.speed=e,this.lfoNode.frequency.value=e)}},depth:{enumerable:!0,get:function(){return this.options.depth},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.depth=e,this.shaperNode.curve=new Float32Array([1-e,1]))}}}),t.Effects.DubDelay=function(e){this.options={},e=e||this.options;var n={feedback:.6,time:.7,mix:.5,cutoff:700};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.bqFilterNode=t.context.createBiquadFilter(),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.inputNode.connect(this.wetGainNode),this.inputNode.connect(this.feedbackGainNode),this.feedbackGainNode.connect(this.bqFilterNode),this.bqFilterNode.connect(this.delayNode),this.delayNode.connect(this.feedbackGainNode),this.delayNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.DubDelay.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNode.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}},cutoff:{enumerable:!0,get:function(){return this.options.cutoff},set:function(e){n.Util.isInRange(e,0,4e3)&&(this.options.cutoff=e,this.bqFilterNode.frequency.value=this.cutoff)}}}),t.Effects.RingModulator=function(e){this.options={},e=e||this.options;var n={speed:30,distortion:1,mix:.5};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.vIn=t.context.createOscillator(),this.vIn.start(0),this.vInGain=t.context.createGain(),this.vInGain.gain.value=.5,this.vInInverter1=t.context.createGain(),this.vInInverter1.gain.value=-1,this.vInInverter2=t.context.createGain(),this.vInInverter2.gain.value=-1,this.vInDiode1=new d(t.context),this.vInDiode2=new d(t.context),this.vInInverter3=t.context.createGain(),this.vInInverter3.gain.value=-1,this.vcInverter1=t.context.createGain(),this.vcInverter1.gain.value=-1,this.vcDiode3=new d(t.context),this.vcDiode4=new d(t.context),this.outGain=t.context.createGain(),this.outGain.gain.value=3,this.compressor=t.context.createDynamicsCompressor(),this.compressor.threshold.value=-24,this.compressor.ratio.value=16,this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.inputNode.connect(this.vcInverter1),this.inputNode.connect(this.vcDiode4.node),this.vcInverter1.connect(this.vcDiode3.node),this.vIn.connect(this.vInGain),this.vInGain.connect(this.vInInverter1),this.vInGain.connect(this.vcInverter1),this.vInGain.connect(this.vcDiode4.node),this.vInInverter1.connect(this.vInInverter2),this.vInInverter1.connect(this.vInDiode2.node),this.vInInverter2.connect(this.vInDiode1.node),this.vInDiode1.connect(this.vInInverter3),this.vInDiode2.connect(this.vInInverter3),this.vInInverter3.connect(this.compressor),this.vcDiode3.connect(this.compressor),this.vcDiode4.connect(this.compressor),this.compressor.connect(this.outGain),this.outGain.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]};var d=function(e){this.context=e,this.node=this.context.createWaveShaper(),this.vb=.2,this.vl=.4,this.h=1,this.setCurve()};return d.prototype.setDistortion=function(e){return this.h=e,this.setCurve()},d.prototype.setCurve=function(){var e,t,n,i,o,r,s;for(t=1024,e=r=0,s=(o=new Float32Array(t)).length;0<=s?r<s:r>s;e=0<=s?++r:--r)n=(e-512)/512,i=(n=Math.abs(n))<=this.vb?0:this.vb<n&&n<=this.vl?this.h*(Math.pow(n-this.vb,2)/(2*this.vl-2*this.vb)):this.h*n-this.h*this.vl+this.h*(Math.pow(this.vl-this.vb,2)/(2*this.vl-2*this.vb)),o[e]=i;return this.node.curve=o},d.prototype.connect=function(e){return this.node.connect(e)},t.Effects.RingModulator.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},speed:{enumerable:!0,get:function(){return this.options.speed},set:function(e){n.Util.isInRange(e,0,2e3)&&(this.options.speed=e,this.vIn.frequency.value=e)}},distortion:{enumerable:!0,get:function(){return this.options.distortion},set:function(e){if(n.Util.isInRange(e,.2,50)){this.options.distortion=parseFloat(e,10);for(var t=[this.vInDiode1,this.vInDiode2,this.vcDiode3,this.vcDiode4],i=0,o=t.length;i<o;i++)t[i].setDistortion(e)}}}}),t.Effects.Quadrafuzz=function(e){this.options={},e=e||this.options;var t={lowGain:.6,midLowGain:.8,midHighGain:.5,highGain:.6};this.inputNode=n.context.createGain(),this.outputNode=n.context.createGain(),this.dryGainNode=n.context.createGain(),this.wetGainNode=n.context.createGain(),this.lowpassLeft=n.context.createBiquadFilter(),this.lowpassLeft.type="lowpass",this.lowpassLeft.frequency.value=147,this.lowpassLeft.Q.value=.7071,this.bandpass1Left=n.context.createBiquadFilter(),this.bandpass1Left.type="bandpass",this.bandpass1Left.frequency.value=587,this.bandpass1Left.Q.value=.7071,this.bandpass2Left=n.context.createBiquadFilter(),this.bandpass2Left.type="bandpass",this.bandpass2Left.frequency.value=2490,this.bandpass2Left.Q.value=.7071,this.highpassLeft=n.context.createBiquadFilter(),this.highpassLeft.type="highpass",this.highpassLeft.frequency.value=4980,this.highpassLeft.Q.value=.7071,this.overdrives=[];for(var i=0;i<4;i++)this.overdrives[i]=n.context.createWaveShaper(),this.overdrives[i].curve=g();this.inputNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode);var o=[this.lowpassLeft,this.bandpass1Left,this.bandpass2Left,this.highpassLeft];for(i=0;i<o.length;i++)this.wetGainNode.connect(o[i]),o[i].connect(this.overdrives[i]),this.overdrives[i].connect(this.outputNode);for(var r in t)this[r]=e[r],this[r]=void 0===this[r]||null===this[r]?t[r]:this[r]},t.Effects.Quadrafuzz.prototype=Object.create(u,{lowGain:{enumerable:!0,get:function(){return this.options.lowGain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.lowGain=e,this.overdrives[0].curve=g(n.Util.normalize(this.lowGain,0,150)))}},midLowGain:{enumerable:!0,get:function(){return this.options.midLowGain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.midLowGain=e,this.overdrives[1].curve=g(n.Util.normalize(this.midLowGain,0,150)))}},midHighGain:{enumerable:!0,get:function(){return this.options.midHighGain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.midHighGain=e,this.overdrives[2].curve=g(n.Util.normalize(this.midHighGain,0,150)))}},highGain:{enumerable:!0,get:function(){return this.options.highGain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.highGain=e,this.overdrives[3].curve=g(n.Util.normalize(this.highGain,0,150)))}}}),t}function p(e,i){this.options={},e=e||this.options;var o={frequency:350,peak:1};for(var r in this.inputNode=this.filterNode=n.context.createBiquadFilter(),this.filterNode.type=i,this.outputNode=t.context.createGain(),this.filterNode.connect(this.outputNode),o)this[r]=e[r],this[r]=void 0===this[r]||null===this[r]?o[r]:this[r]}function f(){var e,i,o=n.context.sampleRate*this.time,r=t.context.createBuffer(2,o,n.context.sampleRate),s=r.getChannelData(0),a=r.getChannelData(1);for(i=0;i<o;i++)e=this.reverse?o-i:i,s[i]=(2*Math.random()-1)*Math.pow(1-e/o,this.decay),a[i]=(2*Math.random()-1)*Math.pow(1-e/o,this.decay);this.reverbNode.buffer&&(this.inputNode.disconnect(this.reverbNode),this.reverbNode.disconnect(this.wetGainNode),this.reverbNode=t.context.createConvolver(),this.inputNode.connect(this.reverbNode),this.reverbNode.connect(this.wetGainNode)),this.reverbNode.buffer=r}function g(e){for(var t=n.context.sampleRate,i=new Float32Array(t),o=Math.PI/180,r=0;r<t;r++){var s=2*r/t-1;i[r]=(3+e)*s*20*o/(Math.PI+e*Math.abs(s))}return i}console.error("No AudioContext found in this environment. Please ensure your window or global object contains a working AudioContext constructor function.")}("undefined"!=typeof window?window:global),define("user_code/sound",["event_bus","toxilibs/extlibs/pizzicato-0.6.4"],(function(e,t){const n=[],i=["sine","square","triangle","sawtooth"];function o(){n.forEach((e=>e.stop())),n.length=0}return e.on("all scripts loaded",(function(){e.emit("renderView beforeExecutionHook added",o)})),{createSound:function(e={}){let{source:o="sine",duration:r=!1,volume:s=1,release:a=.04,attack:l=.04}=e;const c={volume:s,release:a,attack:l};if("function"==typeof o)c.audioFunction=o,e.bufferSize&&(c.bufferSize=e.bufferSize),o="script";else if(i.includes(o)){let{frequency:t=440}=e;c.type=o,c.frequency=t,o="wave"}else if("input"!==o){const{loop:t=!1}=e;c.loop=t,c.path=o,o="file"}let u=new t.Sound({source:o,options:c});return!1!==r&&u.on("play",(function(){setTimeout((()=>u.stop()),1e3*r)})),n.push(u),u}}})),define("user_code/chat_gpt",["./http"],(function(e){const{httpPost:t}=e;async function n(e){return await t({url:"/ask_gpt",params:{messages:e}})}return{send:n,createConversation:function({contextMessages:e=[]}){const t=[...e];return{send:async function(e){t.push({role:"user",content:e});let i=await n(t);return t.push({role:"assistant",content:i}),i}}},createRPGCharacter:function({description:e,language:t,clues:i}){let o="You will assume the role of a character in a role play, you will always speak from first person perspective from the voice of your character, and reply to the player who talks to you. You will make short answers.";t&&(o+="You will answer in correct "+t+"."),o+="\nHere is you character brief :\n"+e,i&&("string"==typeof i&&(i=[i]),o+="\nFinally, there are some useful informations you have for the player, but don't tell them right away... give the player these infos only if he asks for it (in some lose way). These informations are :\n",o+="-"+i.join("\n- "));const r=[{role:"user",content:o}];return{send:async function(e){r.push({role:"user",content:e});let t=await n(r);return r.push({role:"assistant",content:t}),t}}}}})),define("view/api",["event_bus"],(function(e){return{enterFullScreen:()=>e.emit("system wants to update disposition",{mode:"full_render"}),exitFullScreen:()=>e.emit("system wants to exit full render")}})),define("user_code/basic_api",["event_bus","editor/snippet_tools","jquery","toxilibs/random","toxilibs/event_capabilities_queued","toxilibs/color","toxilibs/vector","toxilibs/grid","toxilibs/interpolate","toxilibs/screen_group","toxilibs/http_loader","toxilibs/webgl_image","toxilibs/noise_2D","toxilibs/stroke","toxilibs/bezier","toxilibs/bezier_path","toxilibs/2d_rigid_body_physics","toxilibs/sprite_collection","toxilibs/recorder","toxilibs/smart_smooth_state","toxilibs/qr_code","user_code/readable","user_code/test_suite","user_code/geometry_api","user_code/stats_api","user_code/agent_api","user_code/sound","render/hybrid_screen_image","user_code/pause","user_code/http","user_code/chat_gpt","user_code/webgl_errors_handler","view/api","toxilibs/url_params","toxilibs/download","toxilibs/language_detector","logger","user_code/deprecate"],(function(e,t,n,i,o,r,s,a,l,c,u,h,d,p,f,g,m,y,v,b,x,w,_,S,C,k,A,M,T,E,$,L,R,P,I,O,D,F){const{addMethodSnippet:N}=t,B={},{urlFor:j,httpPost:H,httpPostForImage:W,fetchImageSource:z,fetchSound:V,fetchSounds:G,fetchBlob:U,fetchAssets:q}=E;function K(){i.reset()}e.on("all scripts loaded",(function(){e.emit("renderView beforeExecutionHook added",K)}));const Y={between:[1,10],intBetween:[1,10],oneChanceIn:3,letters:5,shuffleArray:"[]",weightedChoice:['["apple", 2]','["banana", 1]','["peach", 10]']};for(let e in i){let t=Y[e];t&&N(i[e],e,t)}B.smoothState={};const X=P(),J=window.location.href,{pushStateAdd:Q,pushStateRemove:Z,pushStateReplace:ee}=P,te={add:Q,remove:Z,replace:ee};B.createGrid={width:"",height:""},B.vector="simpleFunction",B.createScreenGroup="simpleFunctionNoArg",B.fetchImageSource='urlFor("astronauts-rh8QCX0G.jpg")',B.fetchSound='urlFor("laugh-Qoi6XRfX.ogg")',B.fetchSounds='{\n        music: urlFor("GJ - Port Song-mEX57KUC.mp3"),\n        laugh: urlFor("laugh-Qoi6XRfX.ogg"),\n    }',B.fetchAssets='{\n        astronaut: urlFor("astronauts-rh8QCX0G.jpg"),\n        music: urlFor("GJ - Port Song-mEX57KUC.mp3"),\n        laugh: urlFor("laugh-Qoi6XRfX.ogg"),\n    }',B.createImage={source:'urlFor("exploration-kp7uPbT8.jpg")',width:5,center:{x:0,y:0}},B.createWebGLImage={source:"",shader:'""',data:{}},B.createColor={hue:.5,saturation:1,lightness:.5};const{createSound:ne}=A,{downloadAsFile:ie}=I;B.createSpriteCollection={image:'""',width:64,height:64,frames:'"all"'},l._snippet="interpolate(${1:a}, ${2:b}, ${3:t})",B.downloadAsFile={name:'"my_file.txt"',content:'"hello"'};let oe={window:window,$:n,localStorage:localStorage,globals:{},random:i,addEventCapabilities:o,pause:T,geometry:S,geo:S,stats:C,readable:w,vector:function(e,t){return new s(e,t)},Color:r,createColor:function(e){return new r(e)},createGrid:function(e){let t={};return a(t,e),t},addGridCapabilities:a,createScreenGroup:function(e){return new c(e)},createImage:M,createWebGLImage:function(e){return e=Object.assign({},e,{handleErrorsAndWarnings:L}),new h(e)},interpolate:l,smoothState:b,Noise2D:d,Stroke:p,Bezier:f,BezierPath:g,add2DRigidBodyPhysics:m,createSpriteCollection:function(...e){return new y(...e)},fetchSpriteCollection:function(e){return y.fetch(e,E.fetchImageSource)},createRecorder:function(e){return new v(e)},createSound:ne,createQRCode:function(e={}){if(!(e="string"==typeof e?{text:e}:Object.assign({},e)).text){let t=Object.assign({},e);delete t.format,e.text=X.extendUrlWithParams(window.parent.location.href,t)}return x(e)},expect:_.expect,spec:_,chatGPT:$,downloadAsFile:ie,ajax:n.ajax,getJSON:n.getJSON,openUrl:function(e){window.open(e,"_blank").focus()},goToUrl:function(e){window.parent.location.href=e},httpPost:H,httpPostForImage:W,fetch:fetch,fetchImageSource:z,fetchSound:V,fetchSounds:G,fetchAssets:q,fetchBlob:U,importExternalLib:function(e){return new Promise((t=>{require([e],t)}))},currentUrl:J,urlParams:X,urlState:te,urlFor:j,detectLang:O};F(oe,{screenGroup:"createScreenGroup"}),Object.assign(oe,D,k,R);for(let e in oe){let t=B[e];t&&N(oe[e],e,t)}return oe})),define("assets_bank/api_disabled",[],(function(){return{uploadFile:()=>console.error("uploadFile is disabled in standalone mode"),uploadImagined:()=>console.error("uploadFile is disabled in standalone mode"),uploadIsAllowed:!1}})),define("standalone/api_for_standalone",["standalone/tools","standalone/modules_accessor","toxilibs/timers_manager","user_code/basic_api","assets_bank/api_disabled"],(function(e,t,n,i,o){const{restart:r,goToRender:s,timersManagers:a}=e;let l=0;return function(e){const c={};var u;return Object.assign(c,i,e.api,o,(u=e.renderZone,{me:"Guest",restart:()=>r(u),goToRender:(...e)=>s(u,...e)})),function(e){const{name:t}=e;if(!(t in a)){let i=n({id:t+l++,requestAnimationFrameHasToBeTriggered:!1});e.pauseRequestAnimationFrames=function(){i.pauseRequestAnimationFrames()},e.resumeRequestAnimationFrames=function(){i.resumeRequestAnimationFrames()},a[t]=i}}(e),c.onEveryFrame=a[e.name].onEveryFrame,window.loadDiscoveryApi||(window.loadDiscoveryApi=`var {${Object.keys(c).join(",")},m} = scope`),t(c),c}})),define("standalone/executability",["standalone/tools","toxilibs/execute_get_current_line","standalone/api_for_standalone"],(function(e,t,n){const{_discoveryContentsCache:i}=window,{timersManagers:o}=e;return function(e,{beforeExecutionStarted:r=()=>{},onExecutionStarted:s=()=>{},onExecutionStopped:a=()=>{}}={}){let{name:l}=e,c=l.replace("/render/","");e.start=function(){if(e.started)return;let t=i.render[c];if(!t)throw new Error("no Discovery render named "+c);let o=n(e);e.reset(),e.started=!0,e.executedAt=Date.now(),e.tempStorageForThisExecution={},e.show(),r(e),t(o),s(e)},e.restart=function(){this.stop(),this.start()},e.stop=function(){this.started=!1,o[e.name].clearAll(),a(e)},e.createExecutionErrorHandler=e=>function(t){throw console.error(e),t},t({name:c,source:i.render[c].toString(),errorModifierParams:{ignoredLines:1},receiveGetCurrentLine:function(t){e.getCurrentLine=t}})}}));const _discoveryContentsCache={modules:{},render:{}};window._discoveryContentsCache=_discoveryContentsCache,window.discoveryDefine=function(e,t){let n=e.match(/\/([^/]*)\/(.*)/);if(!n)throw new Error("path "+e+" is not a Discovery path");let[,i,o]=n;i in _discoveryContentsCache||(_discoveryContentsCache[i]={}),_discoveryContentsCache[i][o]=t},define("event_bus",["raw_event_bus","draw_loop"],(function(e,t){return t(e),e})),define("discovery",["event_bus","jquery","toxilibs/css_injector","standalone/discovery_core","standalone/tools","standalone/executability"],(function(e,t,n,i,o,r){if(window.discoveryInExplorers)return console.warn("discovery loaded for Explorers"),i;const{createRenderZone:s}=o,{loadDefaultFonts:a}=i;return e.emit("execution_capabilities added",r),e.emit("all scripts loaded"),t((async function(){await n({file:window.discoveryCssPath||"style/discovery.css?bust="+Date.now()}),await a(),e.emit("app initialized",{}),e.emit("page ready"),t(window).on("resize",e.emitter("workspace resized"));let i=Object.keys(_discoveryContentsCache.render),o=t(".discovery_render");1===o.length&&1===i.length?s(i[0],o):t("[data-discovery]").each((function(){let e=t(this);s(e.attr("data-discovery"),e)}))})),i})),require(["discovery"],(()=>{})),define("mains/main_standalone",(function(){})),ace.define("ace/mode/jsdoc_comment_highlight_rules",[],(function(e,t,n){"use strict";var i=e("../lib/oop"),o=e("./text_highlight_rules").TextHighlightRules,r=function(){this.$rules={start:[{token:["comment.doc.tag","comment.doc.text","lparen.doc"],regex:"(@(?:param|member|typedef|property|namespace|var|const|callback))(\\s*)({)",push:[{token:"lparen.doc",regex:"{",push:[{include:"doc-syntax"},{token:"rparen.doc",regex:"}|(?=$)",next:"pop"}]},{token:["rparen.doc","text.doc","variable.parameter.doc","lparen.doc","variable.parameter.doc","rparen.doc"],regex:/(})(\s*)(?:([\w=:\/\.]+)|(?:(\[)([\w=:\/\.]+)(\])))/,next:"pop"},{token:"rparen.doc",regex:"}|(?=$)",next:"pop"},{include:"doc-syntax"},{defaultToken:"text.doc"}]},{token:["comment.doc.tag","text.doc","lparen.doc"],regex:"(@(?:returns?|yields|type|this|suppress|public|protected|private|package|modifies|implements|external|exception|throws|enum|define|extends))(\\s*)({)",push:[{token:"lparen.doc",regex:"{",push:[{include:"doc-syntax"},{token:"rparen.doc",regex:"}|(?=$)",next:"pop"}]},{token:"rparen.doc",regex:"}|(?=$)",next:"pop"},{include:"doc-syntax"},{defaultToken:"text.doc"}]},{token:["comment.doc.tag","text.doc","variable.parameter.doc"],regex:'(@(?:alias|memberof|instance|module|name|lends|namespace|external|this|template|requires|param|implements|function|extends|typedef|mixes|constructor|var|memberof\\!|event|listens|exports|class|constructs|interface|emits|fires|throws|const|callback|borrows|augments))(\\s+)(\\w[\\w#.:/~"\\-]*)?'},{token:["comment.doc.tag","text.doc","variable.parameter.doc"],regex:"(@method)(\\s+)(\\w[\\w.\\(\\)]*)"},{token:"comment.doc.tag",regex:"@access\\s+(?:private|public|protected)"},{token:"comment.doc.tag",regex:"@kind\\s+(?:class|constant|event|external|file|function|member|mixin|module|namespace|typedef)"},{token:"comment.doc.tag",regex:"@\\w+(?=\\s|$)"},r.getTagRule(),{defaultToken:"comment.doc",caseInsensitive:!0}],"doc-syntax":[{token:"operator.doc",regex:/[|:]/},{token:"paren.doc",regex:/[\[\]]/}]},this.normalizeRules()};i.inherits(r,o),r.getTagRule=function(e){return{token:"comment.doc.tag.storage.type",regex:"\\b(?:TODO|FIXME|XXX|HACK)\\b"}},r.getStartRule=function(e){return{token:"comment.doc",regex:"\\/\\*(?=\\*)",next:e}},r.getEndRule=function(e){return{token:"comment.doc",regex:"\\*\\/",next:e}},t.JsDocCommentHighlightRules=r})),ace.define("ace/mode/javascript_highlight_rules",[],(function(e,t,n){"use strict";var i=e("../lib/oop"),o=e("./jsdoc_comment_highlight_rules").JsDocCommentHighlightRules,r=e("./text_highlight_rules").TextHighlightRules,s="[a-zA-Z\\$_¡-￿][a-zA-Z\\d\\$_¡-￿]*",a=function(e){var t=this.createKeywordMapper({"variable.language":"Array|Boolean|Date|Function|Iterator|Number|Object|RegExp|String|Proxy|Symbol|Namespace|QName|XML|XMLList|ArrayBuffer|Float32Array|Float64Array|Int16Array|Int32Array|Int8Array|Uint16Array|Uint32Array|Uint8Array|Uint8ClampedArray|Error|EvalError|InternalError|RangeError|ReferenceError|StopIteration|SyntaxError|TypeError|URIError|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|eval|isFinite|isNaN|parseFloat|parseInt|JSON|Math|this|arguments|prototype|window|document",keyword:"const|yield|import|get|set|async|await|break|case|catch|continue|default|delete|do|else|finally|for|function|if|in|of|instanceof|new|return|switch|throw|try|typeof|let|var|while|with|debugger|__parent__|__count__|escape|unescape|with|__proto__|class|enum|extends|super|export|implements|private|public|interface|package|protected|static|constructor","storage.type":"const|let|var|function","constant.language":"null|Infinity|NaN|undefined","support.function":"alert","constant.language.boolean":"true|false"},"identifier"),n="\\\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|u{[0-9a-fA-F]{1,6}}|[0-2][0-7]{0,2}|3[0-7][0-7]?|[4-7][0-7]?|.)";this.$rules={no_regex:[o.getStartRule("doc-start"),c("no_regex"),{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0(?:[xX][0-9a-fA-F]+|[oO][0-7]+|[bB][01]+)\b/},{token:"constant.numeric",regex:/(?:\d\d*(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+\b)?/},{token:["storage.type","punctuation.operator","support.function","punctuation.operator","entity.name.function","text","keyword.operator"],regex:"("+s+")(\\.)(prototype)(\\.)("+s+")(\\s*)(=)",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+s+")(\\.)("+s+")(\\s*)(=)(\\s*)(function\\*?)(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+s+")(\\s*)(=)(\\s*)(function\\*?)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+s+")(\\.)("+s+")(\\s*)(=)(\\s*)(function\\*?)(\\s+)(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","entity.name.function","text","paren.lparen"],regex:"(function\\*?)(\\s+)("+s+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","paren.lparen"],regex:"("+s+")(\\s*)(:)(\\s*)(function\\*?)(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)(function\\*?)(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"from(?=\\s*('|\"))"},{token:"keyword",regex:"(?:case|do|else|finally|in|instanceof|return|throw|try|typeof|yield|void)\\b",next:"start"},{token:"support.constant",regex:/that\b/},{token:["storage.type","punctuation.operator","support.function.firebug"],regex:/(console)(\.)(warn|info|log|error|debug|time|trace|timeEnd|assert)\b/},{token:t,regex:s},{token:"punctuation.operator",regex:/[.](?![.])/,next:"property"},{token:"storage.type",regex:/=>/,next:"start"},{token:"keyword.operator",regex:/--|\+\+|\.{3}|===|==|=|!=|!==|<+=?|>+=?|!|&&|\|\||\?:|[!$%&*+\-~\/^]=?/,next:"start"},{token:"punctuation.operator",regex:/[?:,;.]/,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"comment",regex:/^#!.*$/}],property:[{token:"text",regex:"\\s+"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+s+")(\\.)("+s+")(\\s*)(=)(\\s*)(function\\*?)(?:(\\s+)(\\w+))?(\\s*)(\\()",next:"function_arguments"},{token:"punctuation.operator",regex:/[.](?![.])/},{token:"support.function",regex:/(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|lter|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward|rEach)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:"support.function.dom",regex:/(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName|ClassName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:"support.constant",regex:/(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:"identifier",regex:s},{regex:"",token:"empty",next:"no_regex"}],start:[o.getStartRule("doc-start"),c("start"),{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],regex:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],regex_character_class:[{token:"regexp.charclass.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],default_parameter:[{token:"string",regex:"'(?=.)",push:[{token:"string",regex:"'|$",next:"pop"},{include:"qstring"}]},{token:"string",regex:'"(?=.)',push:[{token:"string",regex:'"|$',next:"pop"},{include:"qqstring"}]},{token:"constant.language",regex:"null|Infinity|NaN|undefined"},{token:"constant.numeric",regex:/0(?:[xX][0-9a-fA-F]+|[oO][0-7]+|[bB][01]+)\b/},{token:"constant.numeric",regex:/(?:\d\d*(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+\b)?/},{token:"punctuation.operator",regex:",",next:"function_arguments"},{token:"text",regex:"\\s+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],function_arguments:[c("function_arguments"),{token:"variable.parameter",regex:s},{token:"punctuation.operator",regex:","},{token:"text",regex:"\\s+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],qqstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]},e&&e.noES6||(this.$rules.no_regex.unshift({regex:"[{}]",onMatch:function(e,t,n){if(this.next="{"==e?this.nextState:"","{"==e&&n.length)n.unshift("start",t);else if("}"==e&&n.length&&(n.shift(),this.next=n.shift(),-1!=this.next.indexOf("string")||-1!=this.next.indexOf("jsx")))return"paren.quasi.end";return"{"==e?"paren.lparen":"paren.rparen"},nextState:"start"},{token:"string.quasi.start",regex:/`/,push:[{token:"constant.language.escape",regex:n},{token:"paren.quasi.start",regex:/\${/,push:"start"},{token:"string.quasi.end",regex:/`/,next:"pop"},{defaultToken:"string.quasi"}]},{token:["variable.parameter","text"],regex:"("+s+")(\\s*)(?=\\=>)"},{token:"paren.lparen",regex:"(\\()(?=.+\\s*=>)",next:"function_arguments"},{token:"variable.language",regex:"(?:(?:(?:Weak)?(?:Set|Map))|Promise)\\b"}),this.$rules.function_arguments.unshift({token:"keyword.operator",regex:"=",next:"default_parameter"},{token:"keyword.operator",regex:"\\.{3}"}),this.$rules.property.unshift({token:"support.function",regex:"(findIndex|repeat|startsWith|endsWith|includes|isSafeInteger|trunc|cbrt|log2|log10|sign|then|catch|finally|resolve|reject|race|any|all|allSettled|keys|entries|isInteger)\\b(?=\\()"},{token:"constant.language",regex:"(?:MAX_SAFE_INTEGER|MIN_SAFE_INTEGER|EPSILON)\\b"}),e&&0==e.jsx||l.call(this)),this.embedRules(o,"doc-",[o.getEndRule("no_regex")]),this.normalizeRules()};function l(){var e=s.replace("\\d","\\d\\-"),t={onMatch:function(e,t,n){var i="/"==e.charAt(1)?2:1;return 1==i?(t!=this.nextState?n.unshift(this.next,this.nextState,0):n.unshift(this.next),n[2]++):2==i&&t==this.nextState&&(n[1]--,(!n[1]||n[1]<0)&&(n.shift(),n.shift())),[{type:"meta.tag.punctuation."+(1==i?"":"end-")+"tag-open.xml",value:e.slice(0,i)},{type:"meta.tag.tag-name.xml",value:e.substr(i)}]},regex:"</?"+e,next:"jsxAttributes",nextState:"jsx"};this.$rules.start.unshift(t);var n={regex:"{",token:"paren.quasi.start",push:"start"};this.$rules.jsx=[n,t,{include:"reference"},{defaultToken:"string"}],this.$rules.jsxAttributes=[{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",onMatch:function(e,t,n){return t==n[0]&&n.shift(),2==e.length&&(n[0]==this.nextState&&n[1]--,(!n[1]||n[1]<0)&&n.splice(0,2)),this.next=n[0]||"start",[{type:this.token,value:e}]},nextState:"jsx"},n,c("jsxAttributes"),{token:"entity.other.attribute-name.xml",regex:e},{token:"keyword.operator.attribute-equals.xml",regex:"="},{token:"text.tag-whitespace.xml",regex:"\\s+"},{token:"string.attribute-value.xml",regex:"'",stateName:"jsx_attr_q",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',stateName:"jsx_attr_qq",push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},t],this.$rules.reference=[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}]}function c(e){return[{token:"comment",regex:/\/\*/,next:[o.getTagRule(),{token:"comment",regex:"\\*\\/",next:e||"pop"},{defaultToken:"comment",caseInsensitive:!0}]},{token:"comment",regex:"\\/\\/",next:[o.getTagRule(),{token:"comment",regex:"$|^",next:e||"pop"},{defaultToken:"comment",caseInsensitive:!0}]}]}i.inherits(a,r),t.JavaScriptHighlightRules=a})),ace.define("ace/mode/matching_brace_outdent",[],(function(e,t,n){"use strict";var i=e("../range").Range,o=function(){};(function(){this.checkOutdent=function(e,t){return!!/^\s+$/.test(e)&&/^\s*\}/.test(t)},this.autoOutdent=function(e,t){var n=e.getLine(t).match(/^(\s*\})/);if(!n)return 0;var o=n[1].length,r=e.findMatchingBracket({row:t,column:o});if(!r||r.row==t)return 0;var s=this.$getIndent(e.getLine(r.row));e.replace(new i(t,0,t,o-1),s)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(o.prototype),t.MatchingBraceOutdent=o})),ace.define("ace/mode/folding/cstyle",[],(function(e,t,n){"use strict";var i=e("../../lib/oop"),o=e("../../range").Range,r=e("./fold_mode").FoldMode,s=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};i.inherits(s,r),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(e,t,n){var i=e.getLine(n);if(this.singleLineBlockCommentRe.test(i)&&!this.startRegionRe.test(i)&&!this.tripleStarBlockCommentRe.test(i))return"";var o=this._getFoldWidgetBase(e,t,n);return!o&&this.startRegionRe.test(i)?"start":o},this.getFoldWidgetRange=function(e,t,n,i){var o,r=e.getLine(n);if(this.startRegionRe.test(r))return this.getCommentRegionBlock(e,r,n);if(o=r.match(this.foldingStartMarker)){var s=o.index;if(o[1])return this.openingBracketBlock(e,o[1],n,s);var a=e.getCommentFoldRange(n,s+o[0].length,1);return a&&!a.isMultiLine()&&(i?a=this.getSectionRange(e,n):"all"!=t&&(a=null)),a}if("markbegin"!==t&&(o=r.match(this.foldingStopMarker))){s=o.index+o[0].length;return o[1]?this.closingBracketBlock(e,o[1],n,s):e.getCommentFoldRange(n,s,-1)}},this.getSectionRange=function(e,t){for(var n=e.getLine(t),i=n.search(/\S/),r=t,s=n.length,a=t+=1,l=e.getLength();++t<l;){var c=(n=e.getLine(t)).search(/\S/);if(-1!==c){if(i>c)break;var u=this.getFoldWidgetRange(e,"all",t);if(u){if(u.start.row<=r)break;if(u.isMultiLine())t=u.end.row;else if(i==c)break}a=t}}return new o(r,s,a,e.getLine(a).length)},this.getCommentRegionBlock=function(e,t,n){for(var i=t.search(/\s*$/),r=e.getLength(),s=n,a=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,l=1;++n<r;){t=e.getLine(n);var c=a.exec(t);if(c&&(c[1]?l--:l++,!l))break}if(n>s)return new o(s,i,n,t.length)}}.call(s.prototype)})),ace.define("ace/mode/javascript",[],(function(e,t,n){"use strict";var i=e("../lib/oop"),o=e("./text").Mode,r=e("./javascript_highlight_rules").JavaScriptHighlightRules,s=e("./matching_brace_outdent").MatchingBraceOutdent,a=e("../worker/worker_client").WorkerClient,l=e("./behaviour/cstyle").CstyleBehaviour,c=e("./folding/cstyle").FoldMode,u=function(){this.HighlightRules=r,this.$outdent=new s,this.$behaviour=new l,this.foldingRules=new c};i.inherits(u,o),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.$quotes={'"':'"',"'":"'","`":"`"},this.$pairQuotesAfter={"`":/\w/},this.getNextLineIndent=function(e,t,n){var i=this.$getIndent(t),o=this.getTokenizer().getLineTokens(t,e),r=o.tokens,s=o.state;if(r.length&&"comment"==r[r.length-1].type)return i;if("start"==e||"no_regex"==e)(a=t.match(/^.*(?:\bcase\b.*:|[\{\(\[])\s*$/))&&(i+=n);else if("doc-start"==e){if("start"==s||"no_regex"==s)return"";var a;(a=t.match(/^\s*(\/?)\*/))&&(a[1]&&(i+=" "),i+="* ")}return i},this.checkOutdent=function(e,t,n){return this.$outdent.checkOutdent(t,n)},this.autoOutdent=function(e,t,n){this.$outdent.autoOutdent(t,n)},this.createWorker=function(e){var t=new a(["ace"],"ace/mode/javascript_worker","JavaScriptWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t},this.$id="ace/mode/javascript",this.snippetFileId="ace/snippets/javascript"}.call(u.prototype),t.Mode=u})),ace.require(["ace/mode/javascript"],(function(e){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=e)})),define("toxilibs/embedded_extlibs/ace/mode-javascript",(function(){})),ace.define("ace/ext/static-css",[],(function(e,t,n){n.exports=".ace_static_highlight {\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'Source Code Pro', 'source-code-pro', 'Droid Sans Mono', monospace;\n    font-size: 12px;\n    white-space: pre-wrap\n}\n\n.ace_static_highlight .ace_gutter {\n    width: 2em;\n    text-align: right;\n    padding: 0 3px 0 0;\n    margin-right: 3px;\n    contain: none;\n}\n\n.ace_static_highlight.ace_show_gutter .ace_line {\n    padding-left: 2.6em;\n}\n\n.ace_static_highlight .ace_line { position: relative; }\n\n.ace_static_highlight .ace_gutter-cell {\n    -moz-user-select: -moz-none;\n    -khtml-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    position: absolute;\n}\n\n\n.ace_static_highlight .ace_gutter-cell:before {\n    content: counter(ace_line, decimal);\n    counter-increment: ace_line;\n}\n.ace_static_highlight {\n    counter-reset: ace_line;\n}\n"})),ace.define("ace/ext/static_highlight",[],(function(e,t,n){"use strict";var i=e("../edit_session").EditSession,o=e("../layer/text").Text,r=e("./static-css"),s=e("../config"),a=e("../lib/dom"),l=e("../lib/lang").escapeHTML,c=function(){function e(e){this.className,this.type=e,this.style={},this.textContent=""}return e.prototype.cloneNode=function(){return this},e.prototype.appendChild=function(e){this.textContent+=e.toString()},e.prototype.setAttribute=function(){},e.prototype.toString=function(){var e=[];if("fragment"!=this.type){e.push("<",this.type),this.className&&e.push(" class='",this.className,"'");var t=[];for(var n in this.style)t.push(n,":",this.style[n]);t.length&&e.push(" style='",t.join(""),"'"),e.push(">")}return this.textContent&&e.push(this.textContent),"fragment"!=this.type&&e.push("</",this.type,">"),e.join("")},e}(),u={createTextNode:function(e,t){return l(e)},createElement:function(e){return new c(e)},createFragment:function(){return new c("fragment")}},h=function(){this.config={},this.dom=u};h.prototype=o.prototype;var d=function(e,t,n){var i=e.className.match(/lang-(\w+)/),o=t.mode||i&&"ace/mode/"+i[1];if(!o)return!1;var r=t.theme||"ace/theme/textmate",s="",l=[];if(e.firstElementChild)for(var c=0,u=0;u<e.childNodes.length;u++){var h=e.childNodes[u];3==h.nodeType?(c+=h.data.length,s+=h.data):l.push(c,h)}else s=e.textContent,t.trim&&(s=s.trim());d.render(s,o,r,t.firstLineNumber,!t.showGutter,(function(t){a.importCssString(t.css,"ace_highlight",!0),e.innerHTML=t.html;for(var i=e.firstChild.firstChild,o=0;o<l.length;o+=2){var r=t.session.doc.indexToPosition(l[o]),s=l[o+1],c=i.children[r.row];c&&c.appendChild(s)}n&&n()}))};d.render=function(e,t,n,o,r,a){var l,c=1,u=i.prototype.$modes;function h(){var i=d.renderSync(e,t,n,o,r);return a?a(i):i}return"string"==typeof n&&(c++,s.loadModule(["theme",n],(function(e){n=e,--c||h()}))),t&&"object"==typeof t&&!t.getTokenizer&&(t=(l=t).path),"string"==typeof t&&(c++,s.loadModule(["mode",t],(function(e){u[t]&&!l||(u[t]=new e.Mode(l)),t=u[t],--c||h()}))),--c||h()},d.renderSync=function(e,t,n,o,s){o=parseInt(o||1,10);var a=new i("");a.setUseWorker(!1),a.setMode(t);var l=new h;l.setSession(a),Object.keys(l.$tabStrings).forEach((function(e){if("string"==typeof l.$tabStrings[e]){var t=u.createFragment();t.textContent=l.$tabStrings[e],l.$tabStrings[e]=t}})),a.setValue(e);var c=a.getLength(),d=u.createElement("div");d.className=n.cssClass;var p=u.createElement("div");p.className="ace_static_highlight"+(s?"":" ace_show_gutter"),p.style["counter-reset"]="ace_line "+(o-1);for(var f=0;f<c;f++){var g=u.createElement("div");if(g.className="ace_line",!s){var m=u.createElement("span");m.className="ace_gutter ace_gutter-cell",m.textContent="",g.appendChild(m)}l.$renderLine(g,f,!1),g.textContent+="\n",p.appendChild(g)}return d.appendChild(p),{css:r+n.cssText,html:d.toString(),session:a}},n.exports=d,n.exports.highlight=d})),ace.require(["ace/ext/static_highlight"],(function(e){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=e)})),define("toxilibs/embedded_extlibs/ace/ext-static_highlight",(function(){}));